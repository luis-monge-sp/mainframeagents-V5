/*
 * Version Information:
 * ====================
 * File name       : %name: esaofl.h %
 * Created on      : %date_created: Thu Jan 08 12:00:01 2004 %
 * Current Version : %version: 2 %
 * Last Modified by: %derived_by: ihoffma %
 * Last Modified on: %date_modified: Thu Jan 08 12:00:02 2004 %
 */

/***********************************************
 * Mod.ID  Who      When         Description
 * =============================================
 *
 * BSAN102349   Nmore    25-Jan-05  Adding RSSPARAM to ignore uppercase
 *                                  conversion
 * v33xxMF      AvnerL   02-DEC-2009 Adjust to line len <= 80 for MF
 **********************************************/

#ifndef ESAOFL_H_included
#define ESAOFL_H_included

#include "globs.h"
/*
 *   Common code header files
 */

#include ESA_API
#include ESA_DIAG
#include ESA_API_CODES
#include ESA_INIT
#include ESA_CHKSUM
#include ESA_OS_OFLI
#include ESA_ESAADI
#include ESA_ADMIN

/* for MVS only */
#define   my_strtok                          ofgn001
#define   SetEndTimeDate                     ofgn002
#define   BuildOfflParams                    ofgn003
#define   GetOfliKeywords                    ofgn004
#define   GetUserInfo                        ofgn005
#define   GetSingleUserInfo                  ofgn006
#define   GetGroupInfo                       ofgn007
#define   GetOEInfo                          ofgn008
#define   GetSingleGroupInfo                 ofgn009
#define   GetSingleOEInfo                    ofgn010
#define   GetConnectionInfo                  ofgn011
#define   AddAllUsersConnections             ofgn012
#define   AddAllGroupsConnections            ofgn013
#define   GetSingleConnectionPairInfo        ofgn014
#define   GetRSSParamsInfo                   ofgn015
#define   GetRSSParamsInfoForOS              ofgn016
#define   CompareInfo                        ofgn017
#define   GetStatData                        ofgn018
#define   CheckFileExistance                 ofgn019
#define   OS_OFLI_get_keywords_from_env      ofgn020
#define   PrintOfflineInterceptorStatistics  ofgn021
#define   PutOSRecord                        ofgn022
#define   IsCheckSumKeyword                  ofgn023
#define   GetAddinfo                         ofgn024
#define   GetOECheckSum                      ofgn025
#define   GetUserCheckSum                    ofgn026
#define   GetRSSCheckSum                     ofgn027
#define   SaveKeywords                       ofgn028
#define   GetConnectionCheckSum              ofgn029
#define   GetGroupCheckSum                   ofgn030
#define   FreeAddinfo                        ofgn031
#define   keywords_sort_compare              ofgn032
#define   GetCAREOE                          ofgn035    /* ps0381 */
#define   GetConnectionInfoByOE              ofgn036    /* ps0381 */
#define   GetConnectionInfoByOE              ofgn036
#define   GetCAREOETable                     ofgn037
#define   UncompressDBRecord                 ofgn038
#define   BuildKeyFromOSfile                 ofgn039
#define   OSFile2Memory                      ofgn040
#define   CheckMaxDelExceeded                ofgn041
 /* MVS */

#define API_LOGIN                                                   \
	if (offl_params->ofli_admin_login_req EQ 'Y')   {               \
      ESA_DIAG_printf (ESA_COMP_RSS_INTERCEPT, DIAG_BASIC,   \
    "-> Call to CTSRSSLogin USA-API for rss=%s adm=%s ug=%s mode=%s(%d).",  \
		offl_params->rss_name, offl_params->ofli_admin_user,  \
		offl_params->ofli_admin_group,                        \
		"LOGIN_MODE", LOGIN_MODE);                            \
      rc= (offl_params->func_ptr->rss_login_ptr) (                  \
                         offl_params->rss_name,                     \
                         offl_params->ofli_admin_user,              \
                         offl_params->ofli_admin_group,             \
                         offl_params->ofli_admin_pswd,              \
                         LOGIN_MODE,                                \
                         &(offl_params->admin_params.login_handle), \
                         &offl_params->admin_params,                \
                         offl_params->err);                         \
      ESA_DIAG_printf (ESA_COMP_RSS_INTERCEPT, DIAG_BASIC,     \
			"    <- CTSRSSLogin USA-API completed with rc=%d (%s) hndl=%p.",         \
		rc, (rc EQ ESA_OK) ? "UsaApi==OK" : "UsaApi##OK",       \
        offl_params->admin_params.login_handle);                \
    }                                                               \

#define API_LOGOUT                                            \
   if (offl_params->ofli_admin_login_req EQ 'Y') {            \
      ESA_DIAG_printf (ESA_COMP_RSS_INTERCEPT, DIAG_BASIC,   \
    "-> Call to CTSRSSLogout USA-API for rss=%s adm=%s ug=%s mode=%s(%d).", \
		offl_params->rss_name, offl_params->ofli_admin_user,  \
		offl_params->ofli_admin_group,                        \
		"LOGOUT_MODE", LOGOUT_MODE);                          \
     (offl_params->func_ptr->rss_logout_ptr) (                \
                   offl_params->rss_name,                     \
                   offl_params->ofli_admin_user,              \
                   offl_params->ofli_admin_group,             \
                   LOGOUT_MODE,                               \
                   &(offl_params->admin_params.login_handle), \
                   &offl_params->admin_params,                \
                   offl_params->err);                         \
      ESA_DIAG_printf (ESA_COMP_RSS_INTERCEPT, DIAG_BASIC,   \
			"    <- CTSRSSLogout USA-API completed with rc=%d (%s) hndl=%p.",      \
		 ESA_OK,"UsaApi==OK",                                 \
         offl_params->admin_params.login_handle);             \
   }

#define  OFLI_ADMIN_LOGIN_REQ_PARAM    ADMIN_USER_REQUEST
#define  OFLI_ADMIN_PSWD_REQ_PARAM     ADMIN_FILE_REQUEST
#define  OFLI_ADMIN_GROUP_PARAM        "OFLI_ADMIN_GROUP"

/* WSAN101173 */
#define  OFLI_MAX_DELETE_PERCENT       "OFLI_MAX_DELETE_PERCENT"

#define OFLI_GET_MAX_USER              MAX_GET
#define OFLI_GET_MAX_GROUP             MAX_GET
#define OFLI_GET_MAX_CONNECTION        MAX_GET
#define OFLI_GET_MAX_OE                MAX_GET

#define CHECK_SUM_CONTINUE             0
#define CHECK_SUM_LAST                 1

#define GET_DONE_SUCCESS               0
#define GET_DONE_WITH_ERR              1
#define GET_DONE_WITH_FATAL            2


#define DUMMY_CHANGES                  '0'
#define OBJECT_UPDATED                 'U'
#define OBJECT_ADDED                   'A'
#define OBJECT_DELETED                 'D'
#define CHANGED_BY_ESS                 'E'

#define ADDINFO_TYP_1A                 "1A"
#define CALCULATE_CHECK_SUM2           "2"
#define CALCULATE_CHECK_SUM4           "4"
#define KEYWORD_TYPE2                  '2'
#define KEYWORD_TYPE4                  '4'
#define USER_API_KEYWORDS              FUNC_ADDUSER    /* "03" */
#define GROUP_API_KEYWORDS             FUNC_ADDUG      /* "08" */
#define CONNECTION_API_KEYWORDS        FUNC_ADDU2UG    /* "11" */
#define RSS_API_KEYWORDS               FUNC_GTRSPRM    /* "38" */
#define OE_API_KEYWORDS                FUNC_ADDOE      /* "58" */
#define WAIT_ON_Q_RETRY				   10000 /* miliseconds */
#define MAX_CAREOE					   200   /* ps0381 */

typedef enum {
    OFFLINE_INTERCEPTOR,
    OS_OFLI
} OFFLINE_RUN_type;

 /*
  *   RSS parameters block for rsxxxxx functions
  */

typedef struct {
    RSS_typ                   type;
    RSS_typ                   name;
    void                    * handle;
    CTSAMSG_PARAMS_rec_typ  * msg_params;
} INTERCEPT_RSS_PARAMS_rec_typ, *INTERCEPT_RSS_PARAMS_rec_ptr ;

typedef char ADDINFO_KWD [MAX_RSS_ADDINFO_KWD_LEN+1];
typedef struct {
    ADDINFO_KWD               kwd;
    ADDINFO_typ               typ;
}  OFLI_KWD_type_rec, *OFLI_KWD_type_ptr;

typedef struct {
    unsigned short              cnt;
    unsigned int                amount;
    OFLI_KWD_type_rec         * kwds;
    ADDINFO_rec_typ           * addinfo;
} OFLI_KEYWORDS_rec_typ,  *OFLI_KEYWORDS_rec_ptr;

typedef struct {
    USER_typ           obj1;
    USER_typ           obj2;
    CHECKSUM_typ       CheckSum;
    char               ess_flag;
    char               eol;
} OFFLINE_INTERCEPT_DB_RECORD_rec_typ,
  *OFFLINE_INTERCEPT_DB_RECORD_rec_ptr;

typedef struct {
    char               db_action;
    char               fil1;
    USER_typ           obj1;
    USER_typ           obj2;
    char               ess_flag;
    char               eol;
} OFFLINE_INTERCEPT_RS_RECORD_rec_typ,
  *OFFLINE_INTERCEPT_RS_RECORD_rec_ptr;

typedef struct {
    RSS_typ             rss_type;             /* RSS type          */
    RSS_typ             rss_name;             /* RSS name           */
    RESOURCE_typ        ofli_path;            /* ofli db path       */
    USER_typ            ofli_admin_user;      /* user for login     */
    UG_typ              ofli_admin_group;     /* group for login    */
    PASSWD_typ          ofli_admin_pswd;      /* password           */
    char                ofli_admin_login_req; /* login required Y/N */
    char                ofli_admin_pswd_req;  /* Password req   Y/N */
    void                   *login_handle;     /* handle for CTSLogin*/
    ADMIN_PARAMS_rec_typ    admin_params;     /* admin params       */
    CTSAMSG_PARAMS_rec_typ  msg_params;       /* msg_params         */
    CTSAMSG_HANDLE_rec_typ      *msgs;        /* ctsamsg stuff      */
    CTSAMSG_DEST_TABLE_rec_typ  *dest;        /* ctsamsg stuff      */
    ERR_STRUCT_rec_typ     *err;              /* err structure      */
    int                     login_first_done; /* flag first login   */
    FUNC_PTR_rec_typ       *func_ptr;         /* ptrs to API        */
    void                   *lock_handle;      /* Lock handle        */
    FILE                   *lock_file_handle; /* Lock file handle   */
    int                     lock_done;        /* lock done flag     */
    int                     adm_load_done;    /* ADM_load() flag    */
    int                     max_del;          /* Max delete percent */
    char                    respect_rss_case ;  /* BSAN102349         */
} OFFLINE_INTERCEPT_STUFF_rec_typ, *OFFLINE_INTERCEPT_STUFF_rec_ptr;

struct stat_data {
	int old;
    int total;
    int added;
    int deleted;
    int updated;
};

typedef struct {
   struct stat_data  user_stat;
   struct stat_data  group_stat;
   struct stat_data  connection_stat;
   struct stat_data  rss_stat;
   struct stat_data  oe_stat;
} OFFLINE_INTERCEPT_STAT_DATA_rec_typ,
  *OFFLINE_INTERCEPT_STAT_DATA_rec_ptr;

/**************************************************************
*                                                             *
* Subroutine name : my_strtok                                 *
*                                                             *
* DESCRIPTION     : strtok                                    *
*                                                             *
* INPUT           : sptr        - ptr to string               *
*                   charset     - ptr to char set             *
*                   handle      - ptr to handle(must be NULL) *
*                                                             *
* OUTPUT          : none                                      *
*                                                             *
* RETURN VALUE    : ptr to current token                      *
*                                                             *
**************************************************************/

EXT char * my_strtok (char        * sptr,
                      const char  * charset,
                      void       ** handle);

/**************************************************************
*                                                             *
* Subroutine name : SetEndTimeDate                            *
*                                                             *
* DESCRIPTION     : Obtain current date,time                  *
*                                                             *
* INPUT           : none                                      *
*                                                             *
* OUTPUT          : date, time                                *
*                                                             *
* RETURN VALUE    : none                                      *
*                                                             *
**************************************************************/

EXT void  SetEndTimeDate (char * rdate,
                          char * rtime);

/**************************************************************
*                                                             *
* Subroutine name : BuildOfflParams                           *
*                                                             *
* DESCRIPTION     : Build Internal CTSOFLI, OSOFLI env parm   *
*                                                             *
* INPUT           : rss_name                                  *
*                   rss_type                                  *
*                   admin_params                              *
*                                                             *
* OUTPUT          : offl_params                               *
*                                                             *
* RETURN VALUE    : none                                      *
*                                                             *
**************************************************************/

ESA_RC  BuildOfflParams (OFFLINE_RUN_type                  offltype,
                         RSS_typ                           rss_name,
                         RSS_typ                           rss_type,
                         ADMIN_PARAMS_rec_typ            * admin_params,
                         OFFLINE_INTERCEPT_STUFF_rec_typ * offl_params);

/**************************************************************
*                                                             *
* Subroutine name : GetOfliKeywords                           *
*                                                             *
* DESCRIPTION     : Get interesting keywords                  *
*                                                             *
* INPUT           : rss_type                                  *
*                   user_keywords                             *
*                   group_keywords                            *
*                   connection_kewords                        *
*                   rss_keywords                              *
*                                                             *
* OUTPUT          : none                                      *
*                                                             *
* RETURN VALUE    : ESA_RC                                    *
*                                                             *
**************************************************************/

EXT ESA_RC GetOfliKeywords (
        RSS_typ                      rss_type,
        RESOURCE_typ                 file_keywords,
        OFLI_KEYWORDS_rec_typ      * user_keywords,
        OFLI_KEYWORDS_rec_typ      * group_keywords,
        OFLI_KEYWORDS_rec_typ      * connection_keywords,
        OFLI_KEYWORDS_rec_typ      * rss_keywords,
        OFLI_KEYWORDS_rec_typ      * oe_keywords,
        CTSAMSG_DEST_TABLE_rec_typ * dest,
        CTSAMSG_HANDLE_rec_typ     * msgs);

/**************************************************************
*                                                             *
* Subroutine name : GetUserInfo                               *
*                                                             *
* DESCRIPTION     : get user information                      *
*                                                             *
* INPUT           : user_file - user result file              *
*                   users_keywords                            *
*                                                             *
* OUTPUT          : none                                      *
*                                                             *
* RETURN VALUE    : ESA_RC                                    *
*                                                             *
**************************************************************/

EXT ESA_RC GetUserInfo (char                            * user_file,
/* BSAN100422 */        char                            * oe_file,
                        OFLI_KEYWORDS_rec_typ           * user_keywords,
                        OFFLINE_INTERCEPT_STUFF_rec_typ * offl_params,
/* BSAN100874 */        char                            * gtoe);

/**************************************************************
*                                                             *
* Subroutine name : GetSingleUserInfo                         *
*                                                             *
* DESCRIPTION     : get user information                      *
*                                                             *
* INPUT           : user                                      *
*                   users_keywords                            *
*                                                             *
* OUTPUT          : CheckSum                                  *
*                   def_group                                 *
*                                                             *
* RETURN VALUE    : ESA_RC                                    *
*                                                             *
**************************************************************/

EXT ESA_RC GetSingleUserInfo (
        USER_typ                          user,
        CHECKSUM_typ                    * CheckSum,
        OFLI_KEYWORDS_rec_typ           * user_keywords,
        OFFLINE_INTERCEPT_STUFF_rec_typ * offl_params,
        UG_typ                            def_group,
  /* WSAN100361 */ int                  * user_renamed,
  /* WSAN100361 */ char                 * new_user_name);

/**************************************************************
*                                                             *
* Subroutine name : GetGroupInfo                              *
*                                                             *
* DESCRIPTION     : get group information                     *
*                                                             *
* INPUT           : group_file - group result file            *
*                   group_keywords                            *
*                                                             *
* OUTPUT          : none                                      *
*                                                             *
* RETURN VALUE    : ESA_RC                                    *
*                                                             *
**************************************************************/

ESA_RC GetGroupInfo (char                            * group_file,
/* BSAN100422 */     char                            * oe_file,
                     OFLI_KEYWORDS_rec_typ           * group_keywords,
                     OFFLINE_INTERCEPT_STUFF_rec_typ * offl_params,
/* BSAN100874 */     char                            * gtoe);

/**************************************************************
*                                                             *
* Subroutine name : GetOEInfo                                 *
*                                                             *
* DESCRIPTION     : get oe information                        *
*                                                             *
* INPUT           : oe_file - oe result file                  *
*                   oe_keywords                               *
*                                                             *
* OUTPUT          : none                                      *
*                                                             *
* RETURN VALUE    : ESA_RC                                    *
*                                                             *
**************************************************************/

ESA_RC GetOEInfo (char                            * oe_file,
                  OFLI_KEYWORDS_rec_typ           * oe_keywords,
                  OFFLINE_INTERCEPT_STUFF_rec_typ * offl_params,
/* BSAN100874 */  char                            * gtoe);

/**************************************************************
*                                                             *
* Subroutine name : GetSingleGroupInfo                        *
*                                                             *
* DESCRIPTION     : get group information                     *
*                                                             *
* INPUT           : group                                     *
*                   group_keywords                            *
*                                                             *
* OUTPUT          : CheckSum                                  *
*                                                             *
* RETURN VALUE    : ESA_RC                                    *
*                                                             *
**************************************************************/

EXT ESA_RC GetSingleGroupInfo (
        UG_typ                            group,
        CHECKSUM_typ                    * CheckSum,
        OFLI_KEYWORDS_rec_typ           * group_keywords,
        OFFLINE_INTERCEPT_STUFF_rec_typ * offl_params,
 /* WSAN100361 */ int                   * group_renamed,
 /* WSAN100361 */ char                  * new_group_name);

/**************************************************************
*                                                             *
* Subroutine name : GetSingleOEInfo                           *
*                                                             *
* DESCRIPTION     : get OE information                        *
*                                                             *
* INPUT           : oe                                        *
*                   oe_keywords                               *
*                                                             *
* OUTPUT          : CheckSum                                  *
*                                                             *
* RETURN VALUE    : ESA_RC                                    *
*                                                             *
**************************************************************/

EXT ESA_RC GetSingleOEInfo (
        UG_typ                            oe,
        CHECKSUM_typ                    * CheckSum,
        OFLI_KEYWORDS_rec_typ           * oe_keywords,
        OFFLINE_INTERCEPT_STUFF_rec_typ * offl_params);

/**************************************************************
*                                                             *
* Subroutine name : GetConnectionInfo                         *
*                                                             *
* DESCRIPTION     : get connection information                *
*                                                             *
* INPUT           : connection_file - connection result file  *
*                   connection_keywords                       *
*                                                             *
* OUTPUT          : none                                      *
*                                                             *
* RETURN VALUE    : ESA_RC                                    *
*                                                             *
**************************************************************/

EXT ESA_RC GetConnectionInfo (
        char                            * connection_file,
/* BSAN100422 */ char                   * user_file,
/* BSAN100422 */ char                   * group_file,
        OFLI_KEYWORDS_rec_typ           * connection_keywords,
        OFFLINE_INTERCEPT_STUFF_rec_typ * offl_params);

/**************************************************************
*                                                             *
* Subroutine name : AddAllUsersConnections                    *
*                                                             *
* DESCRIPTION     : get users connection information          *
*                                                             *
* INPUT           : user                                      *
*                   connection_keywords                       *
*                                                             *
* OUTPUT          : none                                      *
*                                                             *
* RETURN VALUE    : ESA_RC                                    *
*                                                             *
**************************************************************/

EXT ESA_RC AddAllUsersConnections (
        USER_typ                          user,
        char                            * db_file,
        OFLI_KEYWORDS_rec_typ           * connection_keywords,
        OFFLINE_INTERCEPT_STUFF_rec_typ * offl_params);

/**************************************************************
*                                                             *
* Subroutine name : AddAllGroupsConnections                   *
*                                                             *
* DESCRIPTION     : get group connection information          *
*                                                             *
* INPUT           : group                                     *
*                   connection_keywords                       *
*                                                             *
* OUTPUT          : none                                      *
*                                                             *
* RETURN VALUE    : ESA_RC                                    *
*                                                             *
**************************************************************/

EXT ESA_RC AddAllGroupsConnections (
        UG_typ                            group,
        char                            * db_file,
        OFLI_KEYWORDS_rec_typ           * connection_keywords,
        OFFLINE_INTERCEPT_STUFF_rec_typ * offl_params);

/**************************************************************
*                                                             *
* Subroutine name : GetSingleConnectionPairInfo               *
*                                                             *
* DESCRIPTION     : get connection (pair) information         *
*                                                             *
* INPUT           : user                                      *
*                   group                                     *
*                   connection_keywords                       *
*                                                             *
* OUTPUT          : CheckSum                                  *
*                                                             *
* RETURN VALUE    : ESA_RC                                    *
*                                                             *
**************************************************************/

EXT ESA_RC GetSingleConnectionPairInfo (
        USER_typ                          user,
        UG_typ                            group,
        CHECKSUM_typ                    * CheckSum,
        OFLI_KEYWORDS_rec_typ           * connection_keywords,
        OFFLINE_INTERCEPT_STUFF_rec_typ * offl_params);

/**************************************************************
*                                                             *
* Subroutine name : GetRSSParamsInfo                          *
*                                                             *
* DESCRIPTION     : get rss parameters information            *
*                                                             *
* INPUT           : rss_file - rss result file                *
*                   rss_keywords                              *
*                                                             *
* OUTPUT          : none                                      *
*                                                             *
* RETURN VALUE    : ESA_RC                                    *
*                                                             *
**************************************************************/

EXT ESA_RC GetRSSParamsInfo (
        char                            * rss_file,
        OFLI_KEYWORDS_rec_typ           * rss_keywords,
        OFFLINE_INTERCEPT_STUFF_rec_typ * offl_params);

/**************************************************************
*                                                             *
* Subroutine name : GetRSSParamsInfoForOS                     *
*                                                             *
* DESCRIPTION     : get rss parameters information            *
*                                                             *
* INPUT           : rss_file - rss result file                *
*                   rss_keywords                              *
*                                                             *
* OUTPUT          : none                                      *
*                                                             *
* RETURN VALUE    : ESA_RC                                    *
*                                                             *
**************************************************************/

EXT ESA_RC GetRSSParamsInfoForOS (
               CHECKSUM_typ                    * CheckSum,
               OFLI_KEYWORDS_rec_typ           * rss_keywords,
               OFFLINE_INTERCEPT_STUFF_rec_typ * offl_params);

/**************************************************************
*                                                             *
* Subroutine name : CompareInfo                               *
*                                                             *
* DESCRIPTION     : compare info                              *
*                                                             *
* INPUT           : init_file                                 *
*                   regular_file                              *
*                                                             *
* OUTPUT          : none                                      *
*                                                             *
* RETURN VALUE    : ESA_RC                                    *
*                                                             *
**************************************************************/

EXT ESA_RC CompareInfo (char                       * init_file,
                        char                       * regular_file,
                        char                       * result_file,
                        struct stat_data           * stat_d,
                        int                          db_type,
                        CTSAMSG_DEST_TABLE_rec_typ * dest,
                        CTSAMSG_HANDLE_rec_typ     * msgs,
                        OFFLINE_INTERCEPT_STUFF_rec_typ *offl_params);

/**************************************************************
*                                                             *
* Subroutine name : Event2RS                                  *
*                                                             *
* DESCRIPTION     : Notify of event to Control-SA             *
*                                                             *
* INPUT           : compare results files                     *
*                                                             *
* OUTPUT          : none                                      *
*                                                             *
* RETURN VALUE    : ESA_RC                                    *
*                                                             *
**************************************************************/

EXT ESA_RC Event2RS (
  char                            * user_compare_result_file,
  char                            * group_compare_result_file,
  char                            * connection_compare_result_file,
  char                            * rss_compare_result_file,
  char                            * oe_compare_result_file,
  char                            * careoeof,
  INTERCEPT_RSS_PARAMS_rec_typ    * rss_parm,
  OFFLINE_INTERCEPT_STUFF_rec_typ * offl_params,
/* BSAN100874 */   char           * gtoe);

/**************************************************************
*                                                             *
* Subroutine name : GetStatData                               *
*                                                             *
* DESCRIPTION     : Obtain initial stat data                  *
*                                                             *
* INPUT           : user_file                                 *
*                   group_file                                *
*                   connection_file                           *
*                   rss_file                                  *
*                   oe_file                                   *
*                                                             *
* OUTPUT          : stat_data structure                       *
*                                                             *
* RETURN VALUE    : ESA_RC                                    *
*                                                             *
**************************************************************/

EXT ESA_RC  GetStatData (
        char                                * user_file,
        char                                * group_file,
        char                                * connection_file,
        char                                * rss_file,
        char                                * oe_file,
        OFFLINE_INTERCEPT_STAT_DATA_rec_typ * stat_data,
        CTSAMSG_DEST_TABLE_rec_typ          * dest,
        CTSAMSG_HANDLE_rec_typ              * msgs);

/**************************************************************
*                                                             *
* Subroutine name : CheckFileExistance                        *
*                                                             *
* DESCRIPTION     : Check file existance                      *
*                                                             *
* INPUT           : user_file                                 *
*                   group_file                                *
*                   connection_file                           *
*                   rss_file                                  *
*                                                             *
* OUTPUT          : none                                      *
*                                                             *
* RETURN VALUE    : ESA_RC                                    *
*                                                             *
**************************************************************/

EXT ESA_RC CheckFileExistance (
        char                       * user_file,
        char                       * group_file,
        char                       * connection_file,
        char                       * rss_file,
        char                       * oe_file,
        CTSAMSG_DEST_TABLE_rec_typ * dest,
        CTSAMSG_HANDLE_rec_typ     * msgs);

/**************************************************************
*                                                             *
* Subroutine name : OS_OFLI_get_keywords_from_env             *
*                                                             *
* DESCRIPTION     : Get interesting keywords from environment *
*                                                             *
* INPUT           : rss_type                                  *
*                   env_keywords                              *
*                   env_kwd_num                               *
*                   keywords_type                             *
*                                                             *
* OUTPUT          : keywords                                  *
*                                                             *
* RETURN VALUE    : ESA_RC                                    *
*                                                             *
**************************************************************/

EXT ESA_RC OS_OFLI_get_keywords_from_env (
        RSS_typ                      rss_type,
        RSSAPI_KWD_rec_ptr           envir_keywrds,
        int                          envir_kwd_num,
        const int                    keywords_type,
        OFLI_KEYWORDS_rec_typ      * keywords,
        CTSAMSG_DEST_TABLE_rec_typ * dest,
        CTSAMSG_HANDLE_rec_typ     * msgs);


/***************************************************************
 * Procedure Name: do_offl_stats                               *
 * Description   : Print statistics to MSG file and Log        *
 * Input         :                                             *
 * Output        :                                             *
 * Input/Output  :                                             *
 * Return Value  :                                             *
 * Side Effects  : 3 messages are written to log event queue   *
 *                 (optional) and to MSG.                      *
 * Scope         : Local                                       *
 **************************************************************/

EXT  void PrintOfflineInterceptorStatistics (
           INTERCEPT_RSS_PARAMS_rec_typ        * rss_parm,
           OFFLINE_INTERCEPT_STAT_DATA_rec_typ * stat_data,
           ADMIN_PARAMS_rec_typ                * admin_params);

/**************************************************************
*                                                             *
* Subroutine name : PutOSRecord                               *
*                                                             *
* DESCRIPTION     : Compress, Put OSOFLI record               *
*                                                             *
* INPUT           : res_rec    - ptr to event record          *
*                   result_file - file full path              *
*                   result_fptr - ptr to FILE struct          *
*                                                             *
* OUTPUT          : none                                      *
*                                                             *
* RETURN VALUE    : ESA_RC                                    *
*                                                             *
**************************************************************/

EXT ESA_RC PutOSRecord (char                       * os_file,
                        char                         action,
                        const char                 * obj1,
                        const char                 * obj2,
                        CHECKSUM_typ                 CheckSum,
                        CTSAMSG_DEST_TABLE_rec_typ * dest,
                        CTSAMSG_HANDLE_rec_typ     * msgs);

/**************************************************************
*                                                             *
* Subroutine name : IsCheckSumKeyword                         *
*                                                             *
* DESCRIPTION     : Determine whether keyword belongs to      *
*                   check sum calculated group fields         *
*                                                             *
* INPUT           : addinfo_typ  - addinfo typ                *
*                   chksum_flg   - check sum flag             *
*                                                             *
* OUTPUT          : none                                      *
*                                                             *
* RETURN VALUE    : ESA_RC - keyword belongs to               *
*                            check sum calculated group fields*
*                   ESA_ERR- no                               *
*                                                             *
**************************************************************/

EXT ESA_RC IsCheckSumKeyword (char        * kwd_name, /* WSAN100361 */
                              char        * addinfo_typ,
                              char        * chksum_flg,
                              ADDINFO_typ * kwd_typ);

/**************************************************************
*                                                             *
* Subroutine name : GetAddinfo                                *
*                                                             *
* DESCRIPTION     : Allocate addinfo                          *
*                                                             *
* INPUT           : keywords                                  *
*                                                             *
* OUTPUT          : addinfo                                   *
*                                                             *
* RETURN VALUE    : ESA_RC                                    *
*                                                             *
**************************************************************/

EXT ESA_RC GetAddinfo (ADDINFO_rec_ptr            ** addinfo,
                       short                         num_objs,
                       OFLI_KEYWORDS_rec_typ       * keywords,
                       CTSAMSG_DEST_TABLE_rec_typ  * dest,
                       CTSAMSG_HANDLE_rec_typ      * msgs);

/**************************************************************
*                                                             *
* Subroutine name : GetOECheckSum                             *
*                                                             *
* DESCRIPTION     : Calculate Check sum                       *
*                                                             *
* INPUT           : oe_params                                 *
*                   addinfo                                   *
*                                                             *
* OUTPUT          : checksum                                  *
*                                                             *
* RETURN VALUE    : ESA_RC                                    *
*                                                             *
**************************************************************/

EXT void GetOECheckSum (CHECKSUM_typ      * CheckSum,
                        OE_PARAMS_rec_typ * oe_params,
                        ADDINFO_rec_typ   * addinfo);

/**************************************************************
*                                                             *
* Subroutine name : GetUserCheckSum                           *
*                                                             *
* DESCRIPTION     : Calculate Check sum                       *
*                                                             *
* INPUT           : user_params                               *
*                   addinfo                                   *
*                                                             *
* OUTPUT          : checksum                                  *
*                                                             *
* RETURN VALUE    : ESA_RC                                    *
*                                                             *
**************************************************************/

EXT void GetUserCheckSum (CHECKSUM_typ        * CheckSum,
                          USER_PARAMS_rec_typ * user_params,
                          ADDINFO_rec_typ     * addinfo);

/**************************************************************
*                                                             *
* Subroutine name : GetRSSCheckSum                            *
*                                                             *
* DESCRIPTION     : Calculate Check sum                       *
*                                                             *
* INPUT           : rss_params                                *
*                   addinfo                                   *
*                                                             *
* OUTPUT          : checksum                                  *
*                                                             *
* RETURN VALUE    : ESA_RC                                    *
*                                                             *
**************************************************************/

EXT void GetRSSCheckSum (CHECKSUM_typ       * CheckSum,
                         RSS_PARAMS_rec_typ * rss_params,
                         ADDINFO_rec_typ    * addinfo);

/**************************************************************
*                                                             *
* Subroutine name : SaveKeywords                              *
*                                                             *
* DESCRIPTION     : Save keywords in internal tables          *
*                                                             *
* INPUT           : rss_name                                  *
*                   user_keywords                             *
*                   group_keywords                            *
*                   connection_kewords                        *
*                                                             *
* OUTPUT          : none                                      *
*                                                             *
* RETURN VALUE    : ESA_RC                                    *
*                                                             *
**************************************************************/

EXT ESA_RC SaveKeywords (OFLI_KEYWORDS_rec_typ      * keywords,
                         char                       * kwd_name,
                         ADDINFO_typ                  kwd_typ,
                         CTSAMSG_DEST_TABLE_rec_typ * dest,
                         CTSAMSG_HANDLE_rec_typ     * msgs);

/**************************************************************
*                                                             *
* Subroutine name : GetConnectionCheckSum                     *
*                                                             *
* DESCRIPTION     : Calculate Check sum                       *
*                                                             *
* INPUT           : u2ug_params                               *
*                   addinfo                                   *
*                                                             *
* OUTPUT          : checksum                                  *
*                                                             *
* RETURN VALUE    : ESA_RC                                    *
*                                                             *
**************************************************************/

EXT void GetConnectionCheckSum (CHECKSUM_typ        * CheckSum,
                                U2UG_PARAMS_rec_typ * u2ug_params,
                                ADDINFO_rec_typ     * addinfo);

/**************************************************************
*                                                             *
* Subroutine name : GetGroupCheckSum                          *
*                                                             *
* DESCRIPTION     : Calculate Check sum                       *
*                                                             *
* INPUT           : ug_params                                 *
*                   addinfo                                   *
*                                                             *
* OUTPUT          : checksum                                  *
*                                                             *
* RETURN VALUE    : ESA_RC                                    *
*                                                             *
**************************************************************/

EXT void GetGroupCheckSum (CHECKSUM_typ      * CheckSum,
                           UG_PARAMS_rec_typ * ug_params,
                           ADDINFO_rec_typ   * addinfo);

/**************************************************************
*                                                             *
* Subroutine name : FreeAddinfo                               *
*                                                             *
* DESCRIPTION     : Free ADDINFO                              *
*                                                             *
* INPUT           : addinfo                                   *
*                                                             *
* OUTPUT          : none                                      *
*                                                             *
* RETURN VALUE    : none                                      *
*                                                             *
**************************************************************/

EXT void FreeAddinfo (short              max_cnt,
                      ADDINFO_rec_ptr ** addinfo);

/**************************************************************
*                                                             *
* Subroutine name : keywords_sort_compare                     *
*                                                             *
* DESCRIPTION     : keywords(compare function)                *
*                   Invoked by qsort                          *
*                                                             *
* INPUT           : rec1                                      *
*                   rec2                                      *
*                                                             *
*                                                             *
* OUTPUT          : none                                      *
*                                                             *
* RETURN VALUE    : 0, >0, <0                                 *
*                                                             *
**************************************************************/

EXT int  keywords_sort_compare (const void * rec1,
                                const void * rec2);

/* ps0381 */

/**************************************************************
*                                                             *
* Subroutine name : GetConnectionInfoByOE                     *
*                                                             *
* DESCRIPTION     : get connection information                *
*                                                             *
* INPUT           : connection_file - connection result file  *
*                   connection_keywords                       *
*                                                             *
* OUTPUT          : none                                      *
*                                                             *
* RETURN VALUE    : ESA_RC                                    *
*                                                             *
**************************************************************/

EXT ESA_RC GetConnectionInfoByOE (
        char                            * connection_file,
        char                            * user_file,
        char                            * group_file,
        OFLI_KEYWORDS_rec_typ           * connection_keywords,
        OFFLINE_INTERCEPT_STUFF_rec_typ * offl_params);


/**************************************************************
*                                                             *
* Subroutine name : GetCAREOE                                 *
*                                                             *
* DESCRIPTION     : get care OE    information                *
*                                                             *
* INPUT           : rss_name                                  *
*                                                             *
* OUTPUT          : none                                      *
*                                                             *
* RETURN VALUE    : ESA_RC                                    *
*                                                             *
**************************************************************/

EXT ESA_RC GetCAREOE (char                        *rss_name,
                      char                        *file_name,
                      int                          msg_flag,
                      CTSAMSG_DEST_TABLE_rec_typ  *dest,
                      CTSAMSG_HANDLE_rec_typ      *msgs);

/**************************************************************
*                                                             *
* Subroutine name : GetCAREOETable                            *
*                                                             *
* DESCRIPTION     : get care OE  table			              *
*                                                             *
* INPUT           : none	                                  *
*                                                             *
* OUTPUT          : _careoe_cnt                               *
*					_care_oe_table							  *
*                                                             *
* RETURN VALUE    : ESA_RC                                    *
*                                                             *
**************************************************************/

EXT ESA_RC GetCAREOETable (int       *_careoe_cnt,
						   OE_typ    *_care_oe_table);

#endif  /* ESAOFL_H_included */

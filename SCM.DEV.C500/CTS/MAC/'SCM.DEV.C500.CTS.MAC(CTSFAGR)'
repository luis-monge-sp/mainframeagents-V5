**********************************************************************  00010000
*   MACRO CTSFAGR                                                    *  00020000
*                                                                    *  00030000
*   FUNCTION:   CREATE PARAMETERS LIST FOR INVOKE EXCTRACTOR         *  00040000
*               DATAS FROM RACF DATA BASE                            *  00050000
*   REGISTERS USAGE : R1 , R15                                       *  00060000
*   PARAMETERS DESCRIPTION :                                         *  00070000
*   &MF     - MACRO FORM PARAMETER. DEFAULT MF=I                     *  00080000
*             MF=I - INTERNAL FORM. BUILDING PARAMETERS LIST:        *  00090000
*             - EXTRACTOR PARAMETER LIST                             *  00100000
*             - ICHEINTY MACRO PER REQUETED SEGMENT                  *  00110000
*             - ICHETEST MACRO IF REQUESTED SEGMENT                  *  00120000
*             - ICHEACTN MACRO PER REQUESTED FIELDS                  *  00130000
*             - CALL TO EXTRACTOR                                    *  00140000
*             MF=L - LIST     FORM. BUILDING PARAMETERS LIST:        *  00150000
*             - EXTRACTOR PARAMETER LIST                             *  00160000
*             - ICHEINTY MACRO PER REQUETED SEGMENT                  *  00170000
*             - ICHETEST MACRO IF REQUESTED SEGMENT                  *  00180000
*             - ICHEACTN MACRO PER REQUESTED FIELDS                  *  00190000
*             MF=(E,ADDR) WHERE ADDR ADDRESS OF LIST FORM MACRO      *  00200000
*             OR MF=(E,(REG)) WHERE REG REGISTER WITH ADDR OF        *  00210000
*                             MACRO LIST FORM                        *  00220000
*                WITH EXECUTE FORM VALID PARAMETERS:                 *  00230000
*             - &OPTION                                              *  00240000
*             - &RC                                                  *  00250000
*             - &ENTRY                                               *  00260000
*             PERFORM CALL TO EXTRACTOR WITH PARAMETER LIST          *  00270000
*   &OPTION - SPECIFIES OPERATION THAT RACF IS TO PERFORM ON THE     *  00280000
*             SPECIFIED PROFILE. VALID VALUES : LOCATE , NEXT, NEXTC *  00290000
*   &TYPE   - SPECIFIES THE TYPE OF THE ENTRY AS GROUP(GRP),         *  00300000
*             USER(USR),CONNECT(CON),DATASET(DS),GEN RESOURCE(GEN)   *  00310000
*   &CLASS  - CLASS NAME. REQUIRED WHEN TYPE='GEN'                   *  00320000
*   &SEGMENT- REQUEST TO A SPECIFIC SEGMENT IN THE PROFILE           *  00330000
*   &GETPRG - ADDRESS OF EXTRACTOR . V-CONST                         *  00340000
*   &ENTRY  - ADDRES OF ENTRY NAME                                   *  00350000
*   &GENERIC- YES,NO,UNCOND - SEE. EXPLAIN THIS PARAMETERS RACF DOC. *  00360000
*   &RESET  - YES,NO          CLEAR/NO PREFIX OF RETURN AREA         *  00370000
*   &TEST   - ADDRES OF TEST ROUTINE                                 *  00380000
*   &DELAY  - DELAY ICHEINTY ADDR                                    *  00381000
*   &CHAIN  - ADDR OF NEXT CTSFAGR MACRO                             *  00390000
*             USE FOR EXTRACT INFORMATION FROM NUMBER OF SEGMENTS    *  00400000
*             IN ONE ACCESS TO EXTRACTOR                             *  00410000
*   &EOE    - END-OF-ENTRY FLAG.                                     *  00420000
*             VALID VALUES : NO - ACCORDING CURRENT ENTRY WILL BE    *  00430000
*                                 NEXT ACCESS TO RACF DATA BASE TO   *  00440000
*                                 ANOTHER SEGMENT FOR INSTANCE       *  00450000
*                            YES                                     *  00460000
*   &DATAMAP- DETERMAINES FORMAT OF THE WORKAREA. VALID : NEW / OLD  *  00470000
*   &OUTEP  - ADDRESS OF EXTERNAL OUTPUT ROUTINE                     *  00480000
*   &OUTAREA- ADDRESS OF OUTPUT AREA                                 *  00490000
*   &VOLUME - VOLUME ADDRESS                                         *  00491000
*   &FORMAT - TYPE OF OUTPUT INFORMATION.                            *  00500000
*             VALID VALUE : TEXT                                     *  00510000
*                           STRUCTURE : TEXT BEFORE                  *  00520000
*                                       FIELD                        *  00530000
*                                       TEXT AFTER                   *  00540000
*                           INTERNAL                                 *  00550000
*                           STRUCTURE : LENGTH TEXT BEFORE           *  00560000
*                                       LENGTH FIELD                 *  00570000
*                                       LENGTH TEXT AFTER            *  00580000
*           - LIST OF FIELDS PARAMETERS LIST                         *  00590000
* CAUTION:  MAX NUMBER OF FIELDS 40, THIS LIMIT DEPENDS OF MAX LENGTH*  00600000
*           OF ACTIONS PARAMETERS <= 255 BYTE.                       *  00610000
*           SEE BUILD ICHEINTY MACRO ACTIONS=   PARAMETER            *  00620000
* LIST PARAM  FROM 2 TO 12 FIELDS PARAMETER LIST                     *  00630000
*             1-ST PARAM FROM LIST FIELD ENTRY DESCRIPTION           *  00640000
*             FROM 2-ND  PARAM REQUESTED FIELD FROM RACF DATA BASE   *  00650000
*             STRUCTURE :                                            *  00660000
*              (FIELD_NAME,FIELD_TYPE,FORMATí,TRN=' 'ùí,TXTL=' 'ù    *  00670000
*               í,TXTR=' 'ùí,EOL=ùí,NL=ùí,IGNORE=ùí,REPEAT=ù         *  00680000
*             WHERE :                                                *  00690000
*               FIELD_NAME - NAME OF FIELD IN THE RACF DATA BASE     *  00700000
*                            ACCORDING TAMPLATE                      *  00710000
*               FIELD_TYPE - E - ELEMENTARY DATA, L - LIST DATA      *  00720000
*                            ( IF DATAMAP=OLD AND FIELD_TYPE=L,      *  00730000
*                            INSTEAD FIELD_TYPE=L MUST BE TIPED      *  00740000
*                            LENGTH OF ONE DATA IN THE LIST          *  00750000
*                            EXAMPLE : DATA_TYPE=8 )                 *  00760000
*               FORMAT     - X - HEX DATA                            *  00770000
*                            D - DECIMAL DATA                        *  00780000
*                            C - CHARACTER DATA / OR STRING          *  00790000
*                            T - TIME                                *  00800000
*               TRN        - TRANSLATE TABLE                         *  00810000
*               TXTL       - LEFT  TEXT .WILL BE PUT BEFORE FIELD    *  00820000
*               TXTR       - RIGHT TEXT .WILL BE PUT AFTER  FIELD    *  00830000
*               EOL        - Y - LOOP INSIDE LIST DATA               *  00840000
*                            N - GOTO TO THE NEXT FIELD. USE TO      *  00850000
*                                CREATE GROUP STRINGS FROM THE       *  00860000
*                                DIFFERENT LISTS DATA                *  00870000
*               NL         - Y - AFTER PUT THIS FIELD PUT OUTPUT LINE*  00880000
*                          - NO  NOPUT LINE. USE TO BUILD IN ONE LINE*  00890000
*                                MANY FIELDS                         *  00900000
*               IGNORE     - N - PUT FIELD INTO OUTPUT LINE          *  00910000
*                          - Y - NOPUT                               *  00920000
*               REPEAT     - Y - PUT THIS FIELD INTO EACH LINE       *  00930000
*                                VALID ONLY FOR ENTRY OR E-TYPE DATA *  00940000
*   EXPLANATION GENERIC PARAMETER :                                  *  00950000
*   1. USE IN CTSFAGR MACRO .                                        *  00960000
*   2. USE IN ICHEINTY INTERNAL MACRO.                               *  00970000
*                                                                    *  00980000
*   FIRST OF ALL THIS PARAMETER VALID ONLY FOR RESOURCES.            *  00990000
* - IN CTSFAGR MACRO THIS PARAMETER USE FOR BUILD INTERNAL VAR       *  01000000
*   FOR FURTHER EXTRACTOR PROCESSING.                                *  01010000
*                                                                    *  01020000
* - DEFAULT VALUE - GENERIC=NO IN INTERNAL ICHEINTY MACRO MEANS:     *  01030000
*   THE RACF MANAGER DOES NOT ATTEMPT TO CONVERT THE NAME            *  01040000
*   SPECIFIED BY THE ENTRY OPERAND FROM EXTERNAL TO INTERNAL FORM.   *  01050000
*   EXAMPLE:                                                         *  01060000
*   SEE LISTING        RLIST PROGRAM  IKF*                           *  01070000
*   THIS RESOURCE IS NOT GENERIC IN SPITE OF INCLUDING '*'           *  01080000
*   CHANGE ACTIVITY:                                                 *  01090000
**********************************************************************  01100000
         MACRO                                                          01110000
&NAME    CTSFAGR &OPTION,&CLASS=,&SEGMENT=,&GETPRG=0,                  *01120000
               &ENTRY=,&TYPE=,&DEBUG=,&RC=,&GENERIC=,&RESET=,          *01130000
               &RELEASE=1.8,&MF=I,&DELAY=0,&WKAREA=,                   *01140000
               &EOE=NO,&TEST=,&VOLUME=,&DATAMAP=NEW,&CHAIN=,           *01160000
               &OUTEP=0,&OUTAREA=0,                                    *01180000
               &FORMAT=INTERNAL          TEXT       WITHOUT LENGTH      01190000
.*                                       INTERNAL   WITH     -"-        01200000
         GBLC  &AL(255)                ACTIONS  LIST                    01210000
         GBLB  &DLYFLG(255)            DELAY FLAGS                      01211000
         GBLC  &EL(255)                ICHEINTY LIST                    01220000
         GBLC  &GF1(255)               GLOBAL FOR F1                    01230000
         GBLC  &GF2(255)               GLOBAL FOR F2                    01240000
         GBLC  &GLB(255)               GLOBAL LABELS                    01250000
         GBLC  &GSG(255)               GLOBAL SEGMENT'S LIST            01251000
         GBLC  &GSGI(255)              GLOBAL SEGMENT'S ICHEINTY LIST   01252000
         GBLA  &GCNF                   GLOBAL FIELDS COUNTER            01260000
         GBLA  &GCNG                   GLOBAL SEGMENTS COUNTER          01261000
         GBLC  &LGO                    LABEL GOTO EXTRACTOR             01270000
         GBLC  &LAL                    LABEL ACTIONS LIST               01280000
         GBLC  &DAL                    LABEL FOR WORK VAR               01290000
         GBLC  &EINTY                  LABEL FOR ICHEINTY MACRO         01300000
         GBLC  &NMW                    WORK AREA                        01310000
         GBLA  &GC                     GLOBAL COUNTER FOR ACTIONS       01320000
         GBLA  &GCNT                   GLOBAL COUNTER FOR ICHEINTY      01330000
         GBLC  &NMF                    FIELD PARAMETER LIST             01340000
         GBLC  &NMDB                   DEBUG LEVEL                      01350000
         GBLC  &NMRC                   RETURN CODE                      01360000
         GBLC  &NM1LN                  ONE LINE PARAMETER               01370000
         GBLC  &LRULE                  LABEL FOR RILE PARAMETERS        01380000
         GBLC  &DMP                    DATAMAP PARAMETER                01390000
         GBLC  &TPY                    PROFILE TYPE PARAMETER           01400000
         GBLC  &ENTR                   ENTRY PARAMETER                  01410000
         GBLC  &CLS                    CLASS PARAMETER                  01420000
         GBLC  &RCFA                   LABEL FOR RACF EXTRACT AREA      01421000
         GBLC  &RCFSGM                 LABEL FOR RACF SEGMENT'S LIST    01422000
.*   ---------------------------------------------------------          01430000
.*      FIRST ACCESS TO CTSFAGR MACRO                                   01440000
.*   ---------------------------------------------------------          01450000
&NMDLY   SETC  '&DELAY'                                                 01451000
&GCNT    SETA  &GCNT+1                                                  01460000
         AIF   (&GCNT GT 1).SKGC                                        01470000
&LGO     SETC  'EX&SYSNDX'             LABEL FOR GOTO EXTRACTOR         01480000
&LAL     SETC  'AL&SYSNDX'             LABEL FOR ACTIONS LIST           01490000
&DAL     SETC  'DL&SYSNDX'             LABEL FOR WORK VAR               01500000
&RCFA    SETC  'XT&SYSNDX'             LABEL FOR RACF EXTRACT AREA      01500100
&RCFSGM  SETC  'XG&SYSNDX'             LABEL FOR RACF SEGMENT'S LIST    01500200
         AIF   (T'&WKAREA NE 'O').YESWKR1                               01501000
&NMW     SETC  'RCFW&SYSNDX'           WORK AREA                        01510000
         AGO   .YESWKRC                                                 01510100
.YESWKR1 ANOP  ,                                                        01511000
&NMW     SETC  '&WKAREA'               WORK AREA                        01511100
.YESWKRC ANOP  ,                                                        01512000
&NMF     SETC  'F&SYSNDX'              FIELD PARAMETER                  01520000
&NMDB    SETC  'RCFD&SYSNDX'           DEBUG LEVEL                      01530000
&NMRC    SETC  'RCFR&SYSNDX'           RETURN CODE                      01540000
&NM1LN   SETC  'RCF1&SYSNDX'           ONE LINE PARAMETER               01550000
&LRULE   SETC  'RULE&SYSNDX'           LABEL FOR RILE PARAMETERS        01560000
&DMP     SETC  '&DATAMAP'              DATAMAP PARAMETER                01570000
&TPY     SETC  '&TYPE'                 PROFILE TYPE PARAMETER           01580000
&ENTR    SETC  '&ENTRY'                ENTRY PARAMETER                  01590000
&CLS     SETC  '&CLASS'                CLASS PARAMETER                  01600000
.SKGC    ANOP  ,                                                        01610000
         AIF   (&GCNT GT 1).CHLEV2                                      01620000
&EINTY   SETC  'EI&GCNT&SYSNDX'        LABEL FOR 1-ST ICHEINTY MACRO    01630000
&EL(&GCNT) SETC '&EINTY'               SAVE 1-ST ICHEINTY LABEL         01640000
&GCNT    SETA  &GCNT+1                 ICHEINTY MACRO COUNTER           01650000
&EINTY   SETC  'EI&GCNT&SYSNDX'        LABEL FOR ICHEINTY MACRO         01660000
&EL(&GCNT) SETC '&EINTY'               LABEL FOR NEXT ICHEINTY          01670000
&GCNTN   SETA  &GCNT                   INDEX OF NEXT NAME OF ICHEINTY   01680000
&GCNT    SETA  &GCNT-1                 INDEX OF CURR NAME OF ICHEINTY   01690000
         AGO   .CHLEV3                                                  01700000
.CHLEV2  ANOP  ,                                                        01710000
&GCNT    SETA  &GCNT+1                 ICHEINTY MACRO COUNTER           01720000
&EINTY   SETC  'EI&GCNT&SYSNDX'        LABEL FOR ICHEINTY MACRO         01730000
&EL(&GCNT) SETC '&EINTY'               SAVE CURRENT ICHEINTY LABEL      01740000
&GCNTN   SETA  &GCNT                   INDEX NEXT NAME OF ICHEINTY      01750000
&GCNT    SETA  &GCNT-1                 INDEX CURRENT NAME OF ICHEINTY   01760000
.CHLEV3  ANOP  ,                                                        01770000
.*   ---------------------------------------------------------          01780000
.*     OUTAREA AREA PARAMETER                                           01790000
.*   ---------------------------------------------------------          01800000
         AIF   ((T'&OUTAREA EQ 'O') AND                                *01810000
               ('&MF' EQ 'I')).EOUTA                                    01820000
         AIF   ((T'&OUTEP   EQ 'O') AND                                *01830000
               ('&MF' EQ 'I')).EOUTA                                    01840000
         CNOP  0,4                                                      01850000
.*   ---------------------------------------------------------          01851000
.*      CHECK WHETHER DETECTED CHAIN                                    01852000
.*   ---------------------------------------------------------          01853000
         AIF   (&GCNT GT 1).CHKCH      CHAIN PROCESSING                 01860000
         AIF   ('&MF' EQ 'I').MFI1     INTERNAL FORM                    01870000
         AIF   ('&MF' EQ 'L').MFL1     LIST FORM                        01880000
         AIF   ('&MF(2)'(1,1) NE '(').MFREG    EXECUTE REGISTER FORM    01890000
&I       SETA  K'&MF(2)                SECOND PARAM - ICHEINTY LABEL    01900000
         AIF   (&I LE 2).INVMF                                          01910000
&I       SETA  &I-2                                                     01920000
&GNREG   SETC  '&MF(2)'(2,&I)                                           01930000
         LR    1,&GNREG             LOAD ICHEINTY ADDR (REG FORM)       01940000
         AGO   .MFEXC                                                   01950000
.MFREG   ANOP  ,                                                        01960000
&GNREG   SETC  '1'                                                      01970000
         LA    &GNREG,&MF(2)        LOAD ICHEINTY ADDR                  01980000
         AGO   .MFEXC                                                   01990000
.MFL1    ANOP  ,                                                        02000000
&NAME    DS    0D                                                       02010000
         AGO   .MFGEN1                                                  02020000
.MFI1    ANOP  ,                                                        02030000
&NAME    BAL   1,&LGO               CALL TO EXTRACTOR                   02040000
.MFGEN1  ANOP  ,                                                        02050000
         DC    A(&EL(1))            ICHEINTY MACRO                      02060000
         DC    A(&GETPRG)           GET PROGRAM                         02070000
         AIF   (T'&DEBUG NE 'O').YESDBG                                 02110000
         DC    A(0)                 DEBUG LEVEL                         02120000
         AGO   .CHKOPT                                                  02130000
.YESDBG  ANOP  ,                                                        02140000
&NMDB    SETC  '&DEBUG'             DEBUG LEVEL LABEL                   02150000
         DC    A(&NMDB)             DEBUG LEVEL VAR                     02160000
.CHKOPT  ANOP  ,                                                        02170000
         DC    A(&NMRC)             RETURN CODE                         02180000
         DC    CL8'&OPTION'         OPTION CODE                         02190000
         DC    CL8&TYPE             PROFILE TYPE                        02200000
         DC    A(&ENTRY)            ENTRY NAME                          02210000
         AIF   ('&NMDLY' EQ 'YES').DLYES2                               02211000
         DC    A(&NMF)              FIELD PARAMETER                     02211100
         AGO   .DLYES2C                                                 02211200
.DLYES2  ANOP  ,                                                        02212000
         DC    A(0)                 FIELD PARAMETER                     02212100
.DLYES2C ANOP  ,                                                        02213000
&K       SETA  1                                                        02230000
&T1E     SETC  'T&K&SYSNDX'         LABEL FOR TXT PARAMETERS            02240000
         AIF   ('&NMDLY' EQ 'YES').DLYES3                               02241000
         DC    A(&T1E)              TEXT PARAMETER FOR ENTRY            02250000
         AGO   .DLYES3C                                                 02250100
.DLYES3  ANOP  ,                                                        02251000
         DC    A(0)                 TEXT PARAMETER FOR ENTRY            02252000
.DLYES3C ANOP  ,                                                        02253000
         DC    A(&OUTEP)            EXTERNAL OUTPUT ROUTINE             02260000
         DC    A(&OUTAREA)          EXTRACT AREA                        02270000
         DC    A(&NM1LN)            ONE LINE PARAMETER                  02280000
         AIF   ('&NMDLY' EQ 'YES').DLYES4                               02281000
         DC    A(&LAL)              RACF ACTIONS MACROS LIST            02290000
         DC    A(&LRULE)            RULE PARAMETERS LIST                02290100
         AGO   .DLYES4C                                                 02291000
.DLYES4  ANOP  ,                                                        02292000
         DC    A(0)                 ACTIONS LIST                        02293000
         DC    A(0)                 RULE PARAMETERS LIST                02293100
.DLYES4C ANOP  ,                                                        02294000
         AIF   (T'&GENERIC NE 'O').YESGEN                               02340000
&NMG     SETC  'GN&SYSNDX'          GENERIC PARAMETER                   02350000
         AGO   .YESGEN1                                                 02360000
.YESGEN  ANOP  ,                                                        02370000
&NMG     SETC  '&GENERIC'           GENERIC PARAMETER LABEL             02380000
.YESGEN1 ANOP  ,                                                        02390000
         DC    A(&NMG)              GENERIC PARAMETER ADDR              02400000
.CHKRST  ANOP  ,                                                        02440000
         AIF   (T'&RESET NE 'O').YESRST                                 02450000
&NMZ     SETC  'RS&SYSNDX'          RESET PARAMETER                     02460000
         AGO   .YESRST1                                                 02470000
.YESRST  ANOP  ,                                                        02480000
&NMZ     SETC  '&RESET'             RESET PARAMETER LABEL               02490000
.YESRST1 ANOP  ,                                                        02500000
         DC    A(&NMZ)              RESET PARAMETER ADDR                02510000
.CHKTST  ANOP  ,                                                        02550000
         AIF   (T'&TEST EQ 'O').NOTEST                                  02560000
&NMI     SETC  '&TEST'                                                  02570000
         DC    A(&NMI)              EXTERNAL TEST ROUTINE               02580000
         AGO   .WRKAREA                                                 02590000
.NOTEST  ANOP  ,                                                        02600000
         DC    A(0)                 EXTERNAL TEST ROUTINE               02610000
.WRKAREA ANOP  ,                                                        02620000
         DC    A(&NMW)              WORK AREA                           02630000
&NMMP    SETC  'MAP&SYSNDX'         MAP PARAMETER LABEL                 02640000
         DC    A(&NMMP)             MAP PARAMETER ADDR                  02650000
         AIF   ('&NMDLY' EQ 'YES').DLYES1                               02650200
         DC    A(&NMDLY)            DELAY ICHEINTY ADDR                 02651000
         AGO   .DLCNT1                                                  02652000
.DLYES1  ANOP  ,                                                        02652100
         DC    A(0)                 EMPTY DELAY ICHEINTY ADDR           02652200
.DLCNT1  ANOP  ,                                                        02653000
         DC    A(&RCFA)             RACF EXTRACT AREA                   02654000
         AIF   ('&NMDLY' EQ 'YES').DLYES1A                              02654100
         DC    A(&RCFSGM)           RACF SEGMENT'S LIST                 02654200
         AGO   .DLCNT1A                                                 02654300
.DLYES1A ANOP  ,                                                        02654400
         DC    A(0)                 EMPTY DELAY ICHEINTY SGM LIST       02654500
.DLCNT1A ANOP  ,                                                        02654600
.*   ---------------------------------------------------------          02656000
.*     END-OF MAIN PARAMETER LIST                                       02657000
.*   ---------------------------------------------------------          02658000
&RCFA    DC    A(0)                 RACF EXTRACT AREA                   02659000
         AIF   (T'&GENERIC NE 'O').CHKRSTA                              02660000
&NMG     DC    CL8'NO'                                                  02670000
.CHKRSTA ANOP  ,                                                        02680000
         AIF   (T'&RESET NE 'O').CNT1A                                  02690000
&NMZ     DC    CL4'YES'                                                 02700000
.CNT1A   ANOP  ,                                                        02710000
&NMMP    DC    CL4'&DATAMAP'                                            02720000
&NMRC    DS    3F                   RETURN CODE                         02730000
&NM1LN   DC    CL4'&EOE'            END-OF-ENTRY PARAMETER              02740000
         AIF   (T'&WKAREA NE 'O').YCHAIN                                02741000
.*   ---------------------------------------------------------          02742000
.*     MINIMUM OF RACF EXTRCAT AREA  (EXTRACT AREA PREFIX)              02743000
.*   ---------------------------------------------------------          02744000
&NMW     DS    0F                   WORK AREA                           02750000
         DC    F'30'                MINIMUM LENGTH OF AREA              02760000
         DC    XL6'00'              RBA RETURN AREA                     02770000
         DC    X'00'                GENERIC FLAG                        02780000
         DC    X'00'                RESERVED                            02790000
         DC    F'0'                 DUPLICATE DATASET NAME COUNT        02800000
         DC    XL8'00'              RESERVED                            02810000
         DS    CL40                 RESERVED                            02820000
         AGO   .YCHAIN                                                  02830000
.*                                                                      02840000
.CHKCH   ANOP  ,                                                        02850000
         AIF   ('&MF' EQ 'L').MFL1CH   MF LIST FORM                     02860000
&NAME    L     1,&EL(1)             LOAD PARAMETER LIST ADDR            02870000
         B     &LGO                                                     02880000
         AGO   .YCHAIN                                                  02890000
.MFL1CH  ANOP  ,                                                        02900000
&NAME    DS    0F                                                       02910000
         AGO   .YCHAIN                                                  02920000
.MFEXC   ANOP  ,                                                        02930000
         AIF   ('&OUTAREA' EQ '0').MFEXC1                               02940000
         MVC   48(4,1),=A(&OUTAREA)         OUTAREA                     02950000
.MFEXC1  ANOP  ,                                                        02960000
         AIF   ('&OUTEP'  EQ '0').MFEXC2                                02970000
         MVC   44(4,1),=A(&OUTEP)           OTEP                        02980000
.MFEXC2  ANOP  ,                                                        02990000
         AIF   (T'&OPTION EQ 'O').MFEXC3                                03000000
         MVC   16(8,1),=CL8'&OPTION'        OPTION                      03010000
.MFEXC3  ANOP  ,                                                        03020000
         AIF   (T'&GENERIC EQ 'O').MFEXC4                               03030000
         MVC   65(4,1),=A(&GENERIC)         GENERIC                     03040000
.MFEXC4  ANOP  ,                                                        03050000
         AIF   (T'&TYPE  EQ 'O').MFEXC5                                 03060000
         MVC   24(8,1),=CL8&TYPE            TYPE                        03070000
.MFEXC5  ANOP  ,                                                        03080000
         AIF   (T'&ENTRY EQ 'O').MFEXC6                                 03090000
         MVC   32(4,1),=A(&ENTRY)           ENTRY                       03100000
         AIF   (T'&GENERIC EQ 'O').MFEXC6                               03110000
.MFEXC6  ANOP  ,                                                        03120000
         AIF   (T'&RESET EQ 'O').MFEXC7                                 03130000
         MVC   68(4,1),=A(&RESET)           RESET                       03140000
.MFEXC7  ANOP  ,                                                        03150000
         AIF   (T'&TEST EQ 'O').MFEXC8                                  03160000
         MVC   4(8,1),=A(&TEST)             TEST                        03170000
.MFEXC8  ANOP  ,                                                        03180000
         AIF   ('&GETPRG' EQ '0').MFEXC9                                03190000
         MVC   4(4,1),=A(&GETPRG)           GET PROGRAM                 03200000
         L     R15,&GETPRG                                              03210000
         AGO   .MFEXC10                                                 03220000
.MFEXC9  ANOP  ,                                                        03230000
         L     15,4(1)                      GET PROGRAM                 03240000
         AGO   .MFEXC10                                                 03250000
.MFEXC10 ANOP  ,                                                        03260000
         L     15,0(15)                                                 03270000
         CALL  (15)                                                     03280000
         L     1,12(1)                   ADDR RETURN CODE               03290000
         L     15,0(1)                   RACF RETURN CODE               03300000
         A     15,4(1)                   RACF REASON CODE               03310000
         A     15,8(1)                   EXTRACTOR RETURN CODE          03320000
         AIF   (T'&RC EQ 'O').EXITE                                     03330000
         MVC   &RC.(4),0(1)                                             03340000
         MVC   &RC.+4(4),4(1)                                           03350000
         MVC   &RC.+8(4),8(1)                                           03360000
         AGO   .EXITE                                                   03370000
.YCHAIN  ANOP  ,                                                        03380000
.*   ---------------------------------------------------------          03390000
.*       FORMAT PARAMETER                                               03400000
.*   ---------------------------------------------------------          03410000
         AIF   ('&FORMAT' EQ 'TEXT').FTXT                               03420000
&F9      SETC  'LENGTH=YES'                                             03430000
         AGO   .FLDPRM                                                  03440000
.FTXT    ANOP  ,                                                        03450000
&F9      SETC  'LENGTH=NO'                                              03460000
.*   ---------------------------------------------------------          03470000
.*                     FIELDS  PARAMETER                                03480000
.*   ---------------------------------------------------------          03490000
.FLDPRM  ANOP  ,                                                        03500000
         LCLC  &L1(10)                 ADDITIONAL PARAMETERS            03510000
         LCLC  &F1(255)                NAME OF FIELD                    03520000
         LCLC  &F2(255)                RULE OF FIELD                    03530000
         LCLC  &F3(255)                TEXT BEFORE                      03540000
         LCLC  &F4(255)                TYPE OF FIELD(C-CHAR,X-HEX)      03550000
         LCLC  &F5(255)                TRANSLATE TABLE                  03560000
         LCLC  &F6(255)                PRINT=YES/NO                     03570000
         LCLC  &F7(255)                PUT=YES/NO                       03580000
         LCLC  &F8(255)                ALWAYS=YES/NO                    03590000
         LCLC  &F9A(255)               END-OF-LIST                      03600000
         LCLC  &F10(255)               TEXT AFTER                       03610000
         LCLC  &T1(255)                LABELS TEXT PARAMETERS           03620000
         LCLC  &FTST(255)              TESTS PARAMETER                  03630000
         LCLC  &FDLY(255)              DELAY PARAMETER                  03631000
         LCLC  &A1(255)                LABELS ACTIONS PARAMETERS        03632000
         LCLC  &LE                     LINE FOR ICHEINTY MACRO          03640000
&MAXF    SETA  N'&SYSLIST                                               03650000
&JMAX    SETA  &MAXF                                                    03660000
         AIF   (&JMAX EQ 1).BEINTY     WITHOUT FIELDS PARAMETERS        03660200
.* ----SET DEFAULTS FOR PARAMETERS: DELAY, TESTS ---------------        03661000
&K       SETA  1                                                        03662000
.LSET1   ANOP  ,                                                        03663000
&FTST(&K) SETC  'TST=NO'                TESTS PARAMETER DEFAULT         03663100
&FDLY(&K) SETC  'DELAY=NO'              DELAY PARAMETER DEFAULT         03663200
&K       SETA  &K+1                                                     03665000
         AIF   (&K LE 255).LSET1                                        03666000
.* ------------------------------------------------------------         03668000
&J       SETA  2                                                        03670000
&K       SETA  1                        TOTAL PARM COUNTER              03680000
.STRF2   ANOP  ,                                                        03690000
&T1(&K)  SETC  'T&K&SYSNDX'             LABEL FOR TXT PARAMETERS        03700000
.* --------D E F A U L T S----------------------------------            03720000
&F6(&K)  SETC  'NL=NO'                  PRINT=NO                        03730000
&F7(&K)  SETC  'IGNORE=NO'              PUT=YES                         03740000
&F8(&K)  SETC  'REPEAT=NO'              ALWAYS=NO                       03750000
&F9A(&K) SETC  'EOL=YES'                END-OF-LIST                     03760000
.* --------D E F A U L T S----------------------------------            03770000
         AIF   (&K EQ 1).LABE           ENTRY FIELD                     03780000
         AIF   (&K EQ 2).LABF                                           03790000
         AGO   .CRTF                                                    03800000
.LABE    ANOP  ,                        ENTRY FIELD                     03810000
.* ---------------------------------------------------------            03820000
&ADDPRM  SETA  1                                                        03830000
&F4(&K)  SETC  'C'                   FIELD FORMAT(C-CHAR,X-HEX,D-DEC)   03840000
.ADD11   ANOP  ,                                                        03850000
&L1(&ADDPRM) SETC '&SYSLIST(&J,&ADDPRM)'                                03860000
         AIF   (T'&L1(&ADDPRM) EQ 'O').ADD22                            03870000
&ADDPRM  SETA  &ADDPRM+1                                                03880000
         AGO   .ADD11                                                   03890000
.ADD22   ANOP  ,                                                        03900000
&ADDPRM  SETA  &ADDPRM-1                                                03910000
         AIF   (&ADDPRM EQ 0).LABE1                                     03920000
&ADDPRMM SETA  1                                                        03930000
.ADD33   ANOP  ,                                                        03940000
&AK      SETA  K'&L1(&ADDPRMM)                                          03950000
         AIF   ('&L1(&ADDPRMM)'(1,5) EQ 'TXTL=').TXTL0   TEXT BEFORE    03960000
         AIF   ('&L1(&ADDPRMM)'(1,5) EQ 'TXTR=').TXTR0   TEXT AFTER     03970000
         AIF   ('&L1(&ADDPRMM)'(1,4) EQ 'TRN=').TRNT0    TRNS TABLE     03980000
         AIF   ('&L1(&ADDPRMM)'(1,4) EQ 'EOL=').EOL0     END-OF-LIST    03990000
         AIF   ('&L1(&ADDPRMM)'(1,3) EQ 'NL=').NLINE0    PRINT PARM     04000000
         AIF   ('&L1(&ADDPRMM)'(1,7) EQ 'IGNORE=').IGN0  PUT PARM       04010000
         AIF   ('&L1(&ADDPRMM)'(1,7) EQ 'REPEAT=').ALW0  REPEAT PARM    04020000
         MNOTE 12,'* INVALID PARAMETER - &L1(&ADDPRMM).'                04030000
         AGO   .ADD44                                                   04040000
.TXTL0   ANOP  ,                                                        04050000
&AK1     SETA  6                                                        04060000
&AK2     SETA  &AK-6+1                                                  04070000
&F3(&K)  SETC  '&L1(&ADDPRMM)'(&AK1,&AK2)     TEXT BEFORE               04080000
         AGO   .ADD44                                                   04090000
.TXTR0   ANOP  ,                                                        04100000
&AK1     SETA  6                                                        04110000
&AK2     SETA  &AK-6+1                                                  04120000
&F10(&K) SETC  '&L1(&ADDPRMM)'(&AK1,&AK2)     TEXT AFTER                04130000
         AGO   .ADD44                                                   04140000
.TRNT0   ANOP  ,                                                        04150000
&AK1     SETA  5                                                        04160000
&AK2     SETA  &AK-5+1                                                  04170000
&F5(&K)  SETC  '&L1(&ADDPRMM)'(&AK1,&AK2)     TRANSLATE TABLE           04180000
         AGO   .ADD44                                                   04190000
.NLINE0  ANOP  ,                                                        04200000
&F6(&K)  SETC  '&L1(&ADDPRMM)'                PRINT=YES/NO (NL=YES/NO)  04210000
         AGO   .ADD44                                                   04220000
.IGN0    ANOP  ,                                                        04230000
&F7(&K)  SETC  '&L1(&ADDPRMM)'                PUT=YES/NO(IGNORE=YES/NO) 04240000
         AGO   .ADD44                                                   04250000
.ALW0    ANOP  ,                                                        04260000
&F8(&K)  SETC  '&L1(&ADDPRMM)'                RPT=YES/NO(REPEAT=YES/NO) 04270000
         AGO   .ADD44                                                   04280000
.EOL0    ANOP  ,                                                        04290000
&F9A(&K) SETC  '&L1(&ADDPRMM)'                EOL=YES/NO                04300000
         AGO   .ADD44                                                   04310000
.ADD44   ANOP  ,                                                        04320000
&ADDPRMM SETA  &ADDPRMM+1                                               04330000
         AIF   (&ADDPRMM LE &ADDPRM).ADD33                              04340000
.* ----------------------------------------------------------           04350000
         AGO   .LABE1                                                   04360000
.LABF    ANOP  ,                                                        04370000
         AGO   .CRTF                                                    04380000
.CRTF    ANOP  ,                                                        04390000
&F1(&K)  SETC  '&SYSLIST(&J,1)'        FIELD NAME                       04400000
&F2(&K)  SETC  '&SYSLIST(&J,2)'        RULL TYPE                        04410000
&F4(&K)  SETC  '&SYSLIST(&J,3)'        FIELD FORMAT(C-CHAR,X-HEX,D-DEC) 04420000
.* ----------------------------------------------------------           04430000
&ADDPRM  SETA  1                                                        04440000
.ADD1    ANOP  ,                                                        04450000
&ADDPRM3 SETA  &ADDPRM+3                                                04460000
&L1(&ADDPRM) SETC '&SYSLIST(&J,&ADDPRM3)'                               04470000
         AIF   (T'&L1(&ADDPRM) EQ 'O').ADD2                             04480000
&ADDPRM  SETA  &ADDPRM+1                                                04490000
         AGO   .ADD1                                                    04500000
.ADD2    ANOP  ,                                                        04510000
&ADDPRM  SETA  &ADDPRM-1                                                04520000
         AIF   (&ADDPRM EQ 0).ADD5                                      04530000
&ADDPRMM SETA  1                                                        04540000
.ADD3    ANOP  ,                                                        04550000
&AK      SETA  K'&L1(&ADDPRMM)                                          04560000
         AIF   ('&L1(&ADDPRMM)'(1,5) EQ 'TXTL=').TXTL1   TEXT BEFORE    04570000
         AIF   ('&L1(&ADDPRMM)'(1,5) EQ 'TXTR=').TXTR1   TEXT AFTER     04580000
         AIF   ('&L1(&ADDPRMM)'(1,4) EQ 'TRN=').TRNT1    TRNS TABLE     04590000
         AIF   ('&L1(&ADDPRMM)'(1,4) EQ 'EOL=').EOL1     END-OF-LIST    04600000
         AIF   ('&L1(&ADDPRMM)'(1,3) EQ 'NL=').NLINE1    PRINT PARM     04610000
         AIF   ('&L1(&ADDPRMM)'(1,7) EQ 'IGNORE=').IGN1  PUT PARM       04620000
         AIF   ('&L1(&ADDPRMM)'(1,7) EQ 'REPEAT=').ALW1  REPEAT PARM    04630000
         AIF   ('&L1(&ADDPRMM)'(1,4) EQ 'TST=').TST1     TESTS PARM     04631000
         AIF   ('&L1(&ADDPRMM)'(1,6) EQ 'DELAY=').DLY1   DELAY PARM     04632000
         MNOTE 12,'* INVALID PARAMETER - &L1(&ADDPRMM).'                04640000
         AGO   .ADD4                                                    04650000
.TXTL1   ANOP  ,                                                        04660000
&AK1     SETA  6                                                        04670000
&AK2     SETA  &AK-6+1                                                  04680000
&F3(&K)  SETC  '&L1(&ADDPRMM)'(&AK1,&AK2)     TEXT BEFORE               04690000
         AGO   .ADD4                                                    04700000
.TXTR1   ANOP  ,                                                        04710000
&AK1     SETA  6                                                        04720000
&AK2     SETA  &AK-6+1                                                  04730000
&F10(&K) SETC  '&L1(&ADDPRMM)'(&AK1,&AK2)     TEXT AFTER                04740000
         AGO   .ADD4                                                    04750000
.TRNT1   ANOP  ,                                                        04760000
&AK1     SETA  5                                                        04770000
&AK2     SETA  &AK-5+1                                                  04780000
&F5(&K)  SETC  '&L1(&ADDPRMM)'(&AK1,&AK2)     TRANSLATE TABLE           04790000
         AGO   .ADD4                                                    04800000
.NLINE1  ANOP  ,                                                        04810000
&F6(&K)  SETC  '&L1(&ADDPRMM)'                PRINT=YES/NO (NL=YES/NO)  04820000
         AGO   .ADD4                                                    04830000
.IGN1    ANOP  ,                                                        04840000
&F7(&K)  SETC  '&L1(&ADDPRMM)'                PUT=YES/NO(IGNORE=YES/NO) 04850000
         AGO   .ADD4                                                    04860000
.ALW1    ANOP  ,                                                        04870000
&F8(&K)  SETC  '&L1(&ADDPRMM)'                RPT=YES/NO(REPEAT=YES/NO) 04880000
         AGO   .ADD4                                                    04890000
.TST1    ANOP  ,                                                        04891000
&FTST(&K) SETC  '&L1(&ADDPRMM)'              TESTS PARAMETER            04892000
         AGO   .ADD4                                                    04893000
.DLY1    ANOP  ,                                                        04894000
&FDLY(&K) SETC  '&L1(&ADDPRMM)'              DELAY PARAMETER            04895000
         AGO   .ADD4                                                    04896000
.EOL1    ANOP  ,                                                        04900000
&F9A(&K) SETC  '&L1(&ADDPRMM)'               EOL=YES/NO                 04910000
         AGO   .ADD4                                                    04920000
.ADD4    ANOP  ,                                                        04930000
&ADDPRMM SETA  &ADDPRMM+1                                               04940000
         AIF   (&ADDPRMM LE &ADDPRM).ADD3                               04950000
.ADD5    ANOP  ,                                                        04960000
.* -------------------------------------------------------------        04970000
.*    CREATE  FIELD PARAMETERS LIST                                     04980000
.* ------------------------------------------------------------         04990000
&GCNF    SETA  &GCNF+1                                                  05000000
&GF1(&GCNF) SETC '&F1(&K)'                                              05010000
&GF2(&GCNF) SETC '&F2(&K)'                                              05020000
&GLB(&GCNF) SETC '&T1(&K)'                                              05030000
.LABE1   ANOP  ,                                                        05040000
&J       SETA  &J+1                                                     05050000
&K       SETA  &K+1                                                     05060000
         AIF   (&J LE &JMAX).STRF2                                      05070000
.* -------------------------------------------------------------        05080000
&J       SETA  2                                                        05090000
&K       SETA  1                                                        05100000
&M       SETA  2                        ACTIONS COUNTER                 05101000
.STRF3   ANOP  ,                                                        05110000
.* -------------------------------------------------------------        05120000
.*      CREATE TEXT  PARAMETERS FIELD                                   05130000
.* -------------------------------------------------------------        05140000
         CTSFART &F1(&K),&F2(&K),&F3(&K),&F4(&K),&F5(&K),              105150000
               &F6(&K),&F7(&K),&F8(&K),&F9,&F9A(&K),&F10(&K),          205160000
               LABEL=&T1(&K)                                            05170000
         AIF   (&K LT 2).STRF3A                                         05180000
.* -------------------------------------------------------------        05190000
.*      CREATE ICHEACTN MACRO                                           05200000
.* -------------------------------------------------------------        05210000
&ACTLBL  SETC  'A&K&SYSNDX'            LABEL FOR ACTIONS                05210100
&GC      SETA  &GC+1                   GLOBAL ACTIONS COUNTER           05210300
&AL(&GC) SETC  '&ACTLBL'                                                05210400
&DLYFLG(&GC) SETB ('&FDLY(&K)' NE 'DELAY=NO')       DELAY FLAG          05210600
         CTSFARA &K,&ACTLBL,&F1(&K),&DAL,&FTST(&K)                      05220000
         AIF   ('&FDLY(&K)' NE 'DELAY=NO').STRF3A   DELAY PARM          05221000
&A1(&M)  SETC  '&ACTLBL'               LABEL FOR ACTIONS                05230000
&M       SETA  &M+1                                                     05241000
.STRF3A  ANOP  ,                                                        05250000
&J       SETA  &J+1                                                     05260000
&K       SETA  &K+1                                                     05270000
         AIF   (&J LE &JMAX).STRF3                                      05280000
.* -------------------------------------------------------------        05300000
.*      CREATE ICHEINTY MACRO                                           05310000
.* -------------------------------------------------------------        05320000
.BEINTY  ANOP  ,                                                        05321000
         AIF   ('&NMDLY' NE 'YES').DLYNO1                               05322000
.* -------------------------------------------------------------        05322100
.*      CREATE DELAY ACTIONS LIST                                       05322200
.* -------------------------------------------------------------        05322300
&K       SETA  2                                                        05322400
&M       SETA  2                        ACTIONS COUNTER                 05322500
.STRF4   ANOP  ,                                                        05322600
.* -------------------------------------------------------------        05322700
.*      CREATE DELAY ICHEACTN LIST                                      05323300
.* -------------------------------------------------------------        05323400
&ACTLBL  SETC  '&AL(&K)'                LABEL FOR ACTIONS               05323500
         AIF   (NOT &DLYFLG(&K)).STRF4A DELAY PARM                      05323900
&A1(&M)  SETC  '&ACTLBL'                LABEL FOR ACTIONS               05324000
&M       SETA  &M+1                                                     05324100
.STRF4A  ANOP  ,                                                        05324200
&K       SETA  &K+1                                                     05324400
         AIF   (&K LE 255).STRF4                                        05324500
.* ---------------------------------------------------------------      05324600
.DLYNO1  ANOP  ,                                                        05325000
         AIF   (T'&SEGMENT EQ 'O').NTST                                 05330000
&TSTSEG  SETC  'TS&SYSNDX'             LABEL FOR TEST ROUTINE           05340000
&TSTSGF  SETC  'TF&SYSNDX'             LABEL FOR SEGMENT NAME FIELD     05350000
&CNTT    SETA  1                       TEST COUNT                       05360000
         AGO   .CRTNTY                                                  05370000
.NTST    ANOP  ,                                                        05380000
&TSTSEG  SETC  ''                                                       05390000
&CNTT    SETA  0                       TEST COUNT                       05400000
.CRTNTY  ANOP  ,                                                        05410000
         AIF   (T'&CHAIN EQ 'O').NCHN1                                  05420000
&CHAIN1  SETC  '&EL(&GCNTN)'                                            05430000
         AGO   .CHAINF1                                                 05440000
.NCHN1   ANOP  ,                                                        05450000
&CHAIN1  SETC  ''                                                       05460000
         AGO   .CHAINF1                                                 05470000
.CHAINF1 ANOP  ,                                                        05480000
.* -------------------------------------------------------------        05481000
.*      SAVE SEGMENT NAME                                               05482000
.* -------------------------------------------------------------        05483000
&GCNG    SETA  &GCNG+1                                                  05484000
         AIF   (T'&SEGMENT EQ 'O').BSSGM   BASE SEGMENT                 05484100
&GSG(&GCNG)  SETC '&SEGMENT'           SEGMENT NAME                     05485000
         AGO   .SVSGP                  SAVE SEGMENT PTR                 05485100
.BSSGM   ANOP  ,                                                        05485200
&GSG(&GCNG)  SETC 'BASE'               SEGMENT NAME                     05485300
         AGO   .SVSGP                  SAVE SEGMENT PTR                 05485400
.SVSGP   ANOP  ,                                                        05485500
&GSGI(&GCNG) SETC '&EL(&GCNT)'         GLOBAL SEGMENT'S ICHEINTY LIST   05486000
.* -------------------------------------------------------------        05487000
&EL(&GCNT) ICHEINTY &OPTION,RELEASE=&RELEASE,MF=L,                     105490001
               WKAREA=&NMW,GENERIC=NO,VOLUME=&VOLUME,                  205500001
               DATAMAP=NEW,WKSP=0,CHAIN=&CHAIN1,                       305520001
               TYPE=&TPY,ENTRY=&ENTR,CLASS=&CLS,                       405550001
               SEGMENT=&SEGMENT,TESTS=&TSTSEG,                         505560001
               ACTIONS=(&A1(2),&A1(3),&A1(4),&A1(5),&A1(6),&A1(7),     X05570001
               &A1(8),&A1(9),&A1(10),&A1(11),&A1(12),&A1(13),          X05580001
               &A1(14),&A1(15),&A1(16),&A1(17),&A1(18),&A1(19),        X05590001
               &A1(20),&A1(21),&A1(22),&A1(23),&A1(24),&A1(25),        X05600001
               &A1(26),&A1(27),&A1(28),&A1(29),&A1(30),&A1(31),        X05610001
               &A1(32),&A1(33),&A1(34),&A1(35),&A1(36),&A1(37),        X05620001
               &A1(38),&A1(39),&A1(40),&A1(41))                         05630000
         AIF   (T'&SEGMENT EQ 'O').CRALT                                05640000
.* -------------------------------------------------------------        05650000
.*       ICHETEST MACRO                                                 05660000
.* -------------------------------------------------------------        05670000
&TSTSEG  ICHETEST FIELD=SEGNAME,COND=EQ,FLDATA=(8,&TSTSGF)              05680000
&TSTSGF  DC    CL8'&SEGMENT'            SEGMENT NAME                    05690000
.CRALT   ANOP  ,                                                        05700000
         AIF   (T'&CHAIN NE 'O').EXITE                                  05710000
         AIF   (&JMAX EQ 1).EXITE       WITHOUT FIELDS PARAMETERS       05711000
&LAL     DS    0F                       ACTIONS LIST                    05720000
&K       SETA  1                                                        05730000
.ACTL    ANOP  ,                                                        05740000
         DC    A(&AL(&K))                                               05750000
&K       SETA  &K+1                                                     05760000
         AIF   (&K LE &GC).ACTL                                         05770000
         DC    A(0)                     END OF ACTIONS LIST             05780000
.*-----------------------------------------------------------           05790000
.*         CREATE FIELDS PARAMETER LIST                                 05800000
.*-----------------------------------------------------------           05810000
&LSTR    SETC  ''                                                       05820000
&NMF     DS    0D                       FIELD PARAMETER LIST            05830000
&K       SETA  1                                                        05840000
.FLDL    ANOP  ,                                                        05850000
         CTSFARF &GF1(&K),&GF2(&K),&AL(&K),&DLYFLG(&K),                105860000
               LABEL=&GLB(&K),DATAMAP=NEW                               05870001
&LSTR    SETC  '&LSTR'.'&GF2(&K)'                                       05880000
&K       SETA  &K+1                                                     05890000
         AIF   (&K LE &GC).FLDL                                         05900000
         DC    C'********'               END OF FIELD LIST              05910000
&LRULE   DC    H'&GC'                    NUMBER OF RULES                05920000
         DC    C'&LSTR'                                                 05930000
&RCFSGM  DS    0D                        ICHEINTY SEGMENT TABLE         05930100
         DC    H'0'                      UPDATE ICHEINTY DONE PARAM     05930200
         DC    H'&GCNG'                  RACF SEGMENT'S LIST            05930300
         AIF   (&GCNG EQ 0).SGMLE                                       05930400
.*-----------------------------------------------------------           05930500
.*         CREATE SEGMENT LIST TABLE                                    05930600
.*-----------------------------------------------------------           05930700
&K       SETA  1                                                        05930800
.SGML    ANOP  ,                                                        05930900
         DC    CL8'&GSG(&K)',A(&GSGI(&K)),A(0)                          05931000
&K       SETA  &K+1                                                     05931100
         AIF   (&K LE &GCNG).SGML                                       05931200
.SGMLE   ANOP  ,                                                        05931300
         DC    CL8'********',A(0),A(0)   END OF SEGMENTS LIST           05931400
.*-----------------------------------------------------------           05932000
&DAL     DC    25F'0'                                                   05940000
         AIF   ('&MF' EQ 'L').EXITE                                     05950000
&LGO     DS    0D                                                       05960000
         L     15,4(1)                   GET PROGRAM                    05970000
         L     15,0(15)                                                 05980000
         CALL  (15)                                                     05990000
         L     R15,&NMRC                 RACF RETURN CODE               06000000
         A     R15,&NMRC+4               RACF REASON CODE               06010000
         A     R15,&NMRC+8               EXTRACTOR RETURN CODE          06020000
         AIF   (T'&RC EQ 'O').NORC                                      06030000
         MVC   &RC.(4),&NMRC                                            06040000
         MVC   &RC.+4(4),&NMRC+4                                        06050000
         MVC   &RC.+8(4),&NMRC+8                                        06060000
.NORC    ANOP  ,                                                        06070000
         AGO   .EXITE                                                   06080000
.EOUTA   MNOTE 12,'* OUTAREA PARAMETER REQUIRED.'                       06090000
         AGO   .EXITE                                                   06100000
.EOUTEP  MNOTE 12,'* OUTEP   PARAMETER REQUIRED.'                       06110000
         AGO   .EXITE                                                   06120000
.EXITE   ANOP                                                           06130000
         AIF   (T'&CHAIN NE 'O').EXITE1                                 06140000
&GC      SETA  0             GLOBAL COUNTER FOR ACTIONS                 06150000
&GCNT    SETA  0             GLOBAL COUNTER FOR ICHEINTY                06160000
&GCNF    SETA  0             GLOBAL FIELDS COUNTER                      06170000
&GCNG    SETA  0             GLOBAL SEGMENTS COUNTER                    06171000
.EXITE1  ANOP                                                           06180000
         MEXIT                                                          06190000
         MEND                                                           06200000

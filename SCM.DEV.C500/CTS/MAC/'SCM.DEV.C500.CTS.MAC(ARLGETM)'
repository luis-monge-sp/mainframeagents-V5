.*   ARLGETM MACRO 27.8.90  (SOURCE:N.W)
.* AFTER ACTIVATING THIS MACRO R1 AND R0 ARE UNKNOWN
.* PARAMETERS:
.*   GETTYPE - TYPE OF GETMAIN (R,RC,RU)
.*   LEN     - LENGTH REQUESTED
.*   ERRLABEL- LABEL TO JUMP OVER IF FAILED IN GETMAIN
.*   WAPTR   - THE BASE REGISTER TO POINT TO THE WORK AREA (OPTIONAL)
.*
.* IS10188 NY 06/10/24 MOVE OUR MODULES ABOVE 16M LINE
.*
         MACRO
&NAME    ARLGETM  &GETTYPE=RC,&LEN=,&ERRLABEL=FAILGET,&WAPTR=
.*IS10188 &NAME    GETMAIN &GETTYPE,LV=&LEN
&NAME    GETMAIN &GETTYPE,LV=&LEN,LOC=RES                      IS10188
.*  FOR GETTYPE=R, LOC IS IGNORED AND IS ALWAYS 24             IS10188
         AIF ('&ERRLABEL' EQ '').CONT
         LTR   R15,R15
         BNZ   &ERRLABEL
.*
.* CLEANING THE WORK AREA
.*
.CONT    LR    R4,R1
         LR    R0,R1                    R0 POINTS TO START OF WA
         LA    R1,&LEN                  R1 CONTAINS AMOUNT TO CLEAR
         SLR   R14,R14                  R14 = 0
         SLR   R15,R15                  R15 = 0
         MVCL  R0,R14                   CLEAR WORKAREA TO ZEROS
         LR    R1,R4
.*
         AIF ('&WAPTR' EQ '').END
         LR    &WAPTR,R1
.END     MEND

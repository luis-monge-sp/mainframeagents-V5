/**************************************************************
*                                                             *
*  <!><!> ATTENTION <!><!>                                    *
*  =-=-=-=-=-=-=-=-=-=-=-=                                    *
*                                                             *
*  When updating this member, do not forget to update         *
*  CTSOADI in ALL.CMAC as well.                               *
*                                                             *
*                                                             *
**************************************************************/
/**************************************************************
*                                                             *
* Title            : Additional Info Manipulation             *
*                                                             *
* File Name        : addinfo.h                                *
*                                                             *
* Author           : Doron Cohen                              *
*                                                             *
* Creation Date    : 21/03/94                                 *
*                                                             *
* Description      :                                          *
*                                                             *
* Assumptions and                                             *
*   Considerations :                                          *
*                                                             *
**************************************************************/

/**************************************************************
* Mod.Id   Who      When     Description                      *
* -------- -------- -------- -------------------------------- *
*                                                             *
* spr125   Alex     07/09/95 Add new enum value KDT_KEYG      *
* PS0288   Alex     09/07/98 Add new param ADDINFO_dup_check  *
*                                       ADDINFO_prefix_search *
* ps0292   AS       23/07/98 Digital certificate support      *
* PS0349   Guy      06/12/98 Add new enum value KDT_KEYM      *
* IS0208   AmirH    30/12/03 Add ADDINFO_value_addval function*
* IS10100A NuritY   14/10/13 Add ADDINFO_Split_by_Prefix      *
*                            to support RACF command          *
*                            limitations.                     *
* sasc     NuritY   24/08/16 Adapt to CC changes.             *
* WS10070  KailasP  13/03/18 Add ADDINFO_list_getnextvalue    *
* WS10079N Nurity   12/01/21 Add ADDINFO_list_match           *
* WS10082  mauriC   29/09/22 ADD ADDINFO macro to call cc     *
*                            ADDINFO routines.                *
**************************************************************/
#ifndef ADDINFO_H_included
#define ADDINFO_H_included

 /* sasc - not needed anymore because it is defined in GLOBS
#ifdef EXT
#undef EXT
#endif
#ifndef ADDINFO_owner
#define EXT extern
#else
#define EXT
#endif
*/
/* ws10082 start
#define ADDINFO_search                 radi010
#define ADDINFO_dup_check              radi011
#define ADDINFO_prefix_search          radi012
#define ADDINFO_insert                 radi013
#define ADDINFO_insert_cond            radi014
#define ADDINFO_addval                 radi015
#define ADDINFO_updval                 radi016
#define ADDINFO_delete                 radi017
#define ADDINFO_dump                   radi018
#define ADDINFO_alloc                  radi019
#define ADDINFO_free                   radi020
#define ADDINFO_copy                   radi021
#define ADDINFO_kdt_search             radi022
#define ADDINFO_kdt_modify             radi023
#define ADDINFO_mkt_check              radi024
#define ADDINFO_rkt_check              radi025
#define ADDINFO_concat                 radi026
#define ADDINFO_list_search            radi027
#define ADDINFO_list_diff              radi028
#define ADDINFO_clear_value            radi032
#define ADDINFO_clear                  radi033
#define ADDINFO_get_value              radi034
#define ADDINFO_strip_prefix           radi035
#define ADDINFO_get_next               radi036
#define ADDINFO_copy_by_prefix         radi037
#define ADDINFO_convert_list_sep       radi038
#define ADDINFO_masupd                 radi039
#define ADDINFO_expand_from_buffer     radi040
#define ADDINFO_pack_to_buffer         radi041

#define ADDINFO_insert_dgt             radi051
#define ADDINFO_updval_dgt             radi052
#define ADDINFO_addval_dgt             radi053
#define ADDINFO_value_addval           radi054
#define ADDINFO_split_by_prefix        radi055
#define ADDINFO_count_by_prefix        radi056
#define ADDINFO_list_getnextvalue      radi057
#define ADDINFO_list_match             radi058
   WS10082 end */

/* WS10082 start */
#define ADDINFO_spi_init               radi059
#define admin_params_copy              vadmpcpy
/* WS10082 end */

/* WS10082 start
#define ERROR_dump                     radi029
#define ERROR_add                      radi030
#define ERROR_print                    radi031
   WS10082 end */

#include ESA_API

#define KWD_FLAG_ON       "Y"
#define KWD_FLAG_OFF      "N"
#define ADDINFO_MAX_ST 1025
#define ERROR_MAX_ST   1025
#define ADDINFO_LIST_MAX_ITEM 513
#define ADDINFO_LIST_INSEP    ", "
#define ADDINFO_LIST_OUTSEP   ","
#define ADDINFO_LIST_TEXT_SEP_STR   ","
#define ADDINFO_LIST_HEX_SEP1_CHAR  0x01
#define ADDINFO_LIST_HEX_SEP2_CHAR  0x02

/* WS10082K **
#define ADDINFO_size(num)                          \
        sizeof(ADDINFO_rec_typ)+((num-1)*sizeof(ONE_FIELD_rec_typ))
#define ADDINFO_empty(addinfo)                     \
        addinfo->num_pairs = 0
 ** WS10082K*/

#define BUILD_STRING_SEPARATOR( str_sep, char_sep )  \
   (str_sep)[0] = (char_sep);                        \
   (str_sep)[1] = NULL_CHAR;

/* WS10082 not needed in CTS anymore

typedef enum {
 UNIQUE, MULTIPLE
 } ADDINFO_DUPLICATE;
/* Keyword types for KDT

typedef enum {
 KDT_KEY, KDT_FLG, KDT_IGN ,
 KDT_KEYG,  ** spr125 **
 KDT_KEYM   ** PS0349 **
 } ADDINFO_KWD_typ;

**
 *  MKTE - Mandatory Keywords Table Entry definition
 **

typedef struct {
   char kwd[MAX_RSS_ADDINFO_KWD_LEN+1];
 } ADDINFO_MKTE_rec_typ, *ADDINFO_MKTE_rec_ptr;

**
 *  RKTE - Forbiddeb Keywords Table Entry definition
 **

typedef struct {
   char kwd[MAX_RSS_ADDINFO_KWD_LEN+1];
 } ADDINFO_RKTE_rec_typ, *ADDINFO_RKTE_rec_ptr;

**
 *  KDTE - Keyword Description Entry definition
 **

typedef struct {
   char                  kwd[MAX_RSS_ADDINFO_KWD_LEN+1];
   ADDINFO_KWD_typ       type;
   char                  neg_kwd[MAX_RSS_ADDINFO_KWD_LEN+1];
   char                  *txtl;
   char                  *txtr;
 } ADDINFO_KDTE_rec_typ, *ADDINFO_KDTE_rec_ptr;

**
 *  PKB  - Primary Keyword Buffer definition
 **

typedef struct {
  int    no_pkb;
  char   name[MAX_RSS_ADDINFO_KWD_LEN+1];
  char   *buff;
  short  size;
 } ADDINFO_PKB_rec_typ, *ADDINFO_PKB_rec_ptr ;

typedef enum {
 ADDINFO_masupd_Merge,
 ADDINFO_masupd_NoMerge
} ADDINFO_masupd_mode;
   WS10082 END   */

static int i_snap;
static int j_snap;
static char m_snap;
#define    SNAP_AREA( title, ptr, len )                       \
  printf("\n>>> %s addr=%x len=%d <<<\n", title, ptr, len );  \
  for( i_snap=0; i_snap LT len; i_snap++)   {                 \
     if ( ( i_snap % 16 ) EQ 0 )                              \
       printf("%4.4X ",i_snap);                               \
     printf("%2.2X", *((char *)ptr+i_snap) );                 \
     if ( ( ( i_snap + 1 ) % 4 ) EQ 0 )                       \
           printf(" ");                                       \
     if ( ( ( i_snap + 1 ) % 16) EQ 0 )                       \
      {                                                       \
      for (j_snap=0;j_snap LT 16;j_snap++)                    \
       {                                                      \
       m_snap = (char) *((char *)ptr +i_snap-15+j_snap);      \
       if (isprint(m_snap) EQ 0)                              \
        printf(".");                                          \
       else                                                   \
        printf("%c",m_snap);                                  \
        };                                                    \
      printf("\n");                                           \
      };                                                      \
  };                                                          \
  printf("\n");                                               \
  printf("\n");

ADMIN_PARAMS_rec_typ  *admin_params_copy;  /* WS10082 */

/* WS10082 start */

/**************************************************************
*                                                             *
* PROCEDURE NAME : ADDINFO_spi_init                           *
*                                                             *
* DESCRIPTION    : Store Admin parameters pointer.            *
*                                                             *
* INPUT          : admin_params     -  Admin params ptr       *
*                                                             *
* OUTPUT         : none                                       *
*                                                             *
* RETURN VALUE   : none                                       *
*                                                             *
**************************************************************/
EXT ESA_RC ADDINFO_spi_init(ADMIN_PARAMS_rec_typ  *admin_params);

/* WS10082 end /*

/**************************************************************
*                                                             *
* PROCEDURE NAME : ADDINFO_search adies01                     *
*                                                             *
* DESCRIPTION    : Search a keyword in additional info        *
*                                                             *
*                                                             *
* INPUT          : kwd              -  keyword                *
*                  pair             -  entry to start search  *
*                  limit            -  max entries to search  *
*                                                             *
* OUTPUT         : none                                       *
*                                                             *
* RETURN VALUE   : ONE_FIELD_rec_ptr (or NULL if not found)   *
*                                                             *
**************************************************************/
/* WS10082 EXT ONE_FIELD_rec_ptr ADDINFO_search (char *p_kwd,
                                       int   max_kwdlen,
                                       ONE_FIELD_rec_ptr p_pair,
                                       short p_limit) ;   */
 /* WS10082 - start */
#define ADDINFO_search(...)    \
admin_params_copy->cs_func.ADDINFO_func_ptr->\
ADDINFO_search_ptr \
        (##__VA_ARGS__)

/* WS10082 end */

/**************************************************************
*                                                             *
* PROCEDURE NAME : ADDINFO_insert adies02                     *
*                                                             *
* DESCRIPTION    : Insert a keyword in additional info        *
*                                                             *
* INPUT          : type             -  addinfo type           *
*                  kwd              -  keyword                *
*                  value            -  value                  *
*                  addinfo          -  additional info        *
*                  dupflag          -  allow duplicate flag   *
*                                                             *
* OUTPUT         : none                                       *
*                                                             *
* RETURN VALUE   : ESA_RC                                     *
*                                                             *
**************************************************************/

/* WS10082 EXT ESA_RC ADDINFO_insert  (ADDINFO_typ        type,
                            char               *kwd,
                            char               *val,
                            ADDINFO_rec_ptr    addinfo,
                            int                max_kwdlen,
                            int                max_vallen,
                            ADDINFO_DUPLICATE  dupflag);  */
/* WS10082 - start */
#define ADDINFO_insert(...) \
admin_params_copy->cs_func.ADDINFO_func_ptr->\
ADDINFO_insert_ptr \
        (##__VA_ARGS__)

/* WS10082 - end */


/**************************************************************
*                                                             *
* PROCEDURE NAME : ADDINFO_updval adies03                     *
*                                                             *
* DESCRIPTION    : Update a value of an exiting entry         *
*                                                             *
* INPUT          : value     - Value to be added              *
*                  pair      - Addinto entry                  *
*                                                             *
* OUTPUT         : none                                       *
*                                                             *
* RETURN VALUE   : ESA_RC                                     *
*                                                             *
**************************************************************/
/* WS10082 EXT ESA_RC ADDINFO_updval (char               *addval,
                           int                max_vallen,
                           ONE_FIELD_rec_ptr  pair);  */
/* WS10082 - start */
#define ADDINFO_updval(...) \
admin_params_copy->cs_func.ADDINFO_func_ptr->\
ADDINFO_updval_ptr \
        (##__VA_ARGS__)


/* WS10082 - end */

/**************************************************************
*                                                             *
* PROCEDURE NAME : ADDINFO_dump adies04                       *
*                                                             *
* DESCRIPTION    : Dump Additional info area                  *
*                                                             *
* INPUT          : addinfo          -  additional info        *
*                  print_empty      -  1 print in any case    *
*                                   -  0 print only if value  *
*                                        length > 0           *
*                                                             *
*                                                             *
* OUTPUT         : none                                       *
*                                                             *
* RETURN VALUE   : ESA_RC                                     *
*                                                             *
**************************************************************/
/* WS10082 EXT ESA_RC ADDINFO_dump (ADDINFO_rec_ptr   p_addinfo,
                         int               print_empty);  */

/* WS10082 - start */
#define ADDINFO_dump(...) \
admin_params_copy->cs_func.ADDINFO_func_ptr->\
ADDINFO_dump_ptr \
        (##__VA_ARGS__)

/* WS10082 - end */


/**************************************************************
*                                                             *
* PROCEDURE NAME : ADDINFO_alloc adies05                      *
*                                                             *
* DESCRIPTION    : Allocate addtional info area               *
*                                                             *
* INPUT          : max_pairs        -  max_pairs              *
*                : addinfo_ptr      -  additional info pointer*
*                                                             *
* OUTPUT         : none                                       *
*                                                             *
* RETURN VALUE   : ESA_RC                                     *
*                                                             *
**************************************************************/
/* Ws10082 EXT ESA_RC ADDINFO_alloc (char                      * func,
                          short                       max_pairs,
                          ADDINFO_rec_ptr           * addinfo_ptr,
                          CTSAMSG_DEST_TABLE_rec_ptr  dest,
                          CTSAMSG_HANDLE_rec_ptr      msgs);  */

/* WS10082 - start */
#define ADDINFO_alloc(...) \
admin_params_copy->cs_func.ADDINFO_func_ptr->\
ADDINFO_alloc_ptr \
        (##__VA_ARGS__)

/* WS10082 - end */


/**************************************************************
*                                                             *
* PROCEDURE NAME : ADDINFO_free adies06                       *
*                                                             *
* DESCRIPTION    : Free addtional info area                   *
*                                                             *
* INPUT          : addinfo_ptr      -  additional info pointer*
*                                                             *
* OUTPUT         : none                                       *
*                                                             *
* RETURN VALUE   : ESA_RC                                     *
*                                                             *
**************************************************************/

/* WS10082 EXT ESA_RC ADDINFO_free (ADDINFO_rec_ptr *addinfo_ptr); */

/* WS10082 - start */
#define ADDINFO_free(...) \
admin_params_copy->cs_func.ADDINFO_func_ptr->\
ADDINFO_free_ptr \
        (##__VA_ARGS__)

/* WS10082 - end */


/**************************************************************
*                                                             *
* PROCEDURE NAME : ADDINFO_clear_value adies07                *
*                                                             *
* DESCRIPTION    : Clear value of entering pair               *
*                                                             *
* INPUT          : pair      - Addinto entry                  *
*                                                             *
* OUTPUT         : none                                       *
*                                                             *
* RETURN VALUE   : ESA_RC                                     *
*                                                             *
**************************************************************/

/* WS10082 EXT ESA_RC ADDINFO_clear_value(ONE_FIELD_rec_ptr  pair); */

/* WS10082 - start */
#define ADDINFO_clear_value(...) \
admin_params_copy->cs_func.ADDINFO_func_ptr->\
ADDINFO_clear_value_ptr \
        (##__VA_ARGS__)
/* WS10082 - end */


/**************************************************************
*                                                             *
* PROCEDURE NAME : ADDINFO_clear adies08                      *
*                                                             *
* DESCRIPTION    : Clear Addtional info area                  *
*                                                             *
* INPUT          : Addinfo          -  additional info        *
*                                                             *
* OUTPUT         : none                                       *
*                                                             *
* RETURN VALUE   : ESA_RC                                     *
*                                                             *
**************************************************************/

/* WS10082 EXT ESA_RC ADDINFO_clear(ADDINFO_rec_ptr addinfo); */

/* WS10082 - start */
#define ADDINFO_clear(...) \
admin_params_copy->cs_func.ADDINFO_func_ptr->\
ADDINFO_clear_ptr \
        (##__VA_ARGS__)
/* WS10082 - end */


/**************************************************************
*                                                             *
* PROCEDURE NAME : ADDINFO_addval adies09                     *
*                                                             *
* DESCRIPTION    : Conactenate a value to an exiting one      *
*                                                             *
* INPUT          : addval    - Value to be added              *
*                  addsep    - Sperator between value list    *
*                  pair      - Addinto entry                  *
*                                                             *
* OUTPUT         : none                                       *
*                                                             *
* RETURN VALUE   : ESA_RC                                     *
*                                                             *
**************************************************************/

/* WS10082 EXT ESA_RC ADDINFO_addval (char                     *addval,
                           int                         max_vallen,
                           char                        addsep,
                           ONE_FIELD_rec_ptr           pair,
                           CTSAMSG_DEST_TABLE_rec_ptr  dest,
                           CTSAMSG_HANDLE_rec_ptr      msgs); */

/* WS10082 - start */
#define ADDINFO_addval(...) \
admin_params_copy->cs_func.ADDINFO_func_ptr->\
ADDINFO_addval_ptr \
        (##__VA_ARGS__)

/* WS10082 - end */



/**************************************************************
*                                                             *
* PROCEDURE NAME : ADDINFO_delete adies10                     *
*                                                             *
* DESCRIPTION    : Delete from addtional info area            *
*                  and compress                               *
*                                                             *
* INPUT          : Addinfo          -  additional info        *
*                  keyword          -  keyword                *
*                                                             *
* OUTPUT         : none                                       *
*                                                             *
* RETURN VALUE   : ESA_RC                                     *
*                                                             *
**************************************************************/

/* WS10082 ESA_RC ADDINFO_delete(ADDINFO_rec_ptr addinfo,
                      char            *keyword) ;         */

/* WS10082 - start */
#define ADDINFO_delete(...) \
admin_params_copy->cs_func.ADDINFO_func_ptr->\
ADDINFO_delete_ptr \
        (##__VA_ARGS__)

/* WS10082 - end */



 /**************************************************************
 *                                                             *
 * Procedure Name : ADDINFO_dup_check adies11                  *
 *                                                             *
 * Description    : Check duplicate keywords in ADDINFO        *
 *                                                             *
 * Input          : addinfo                                    *
 *                  keyword                                    *
 *                                                             *
 * Output         : ptr to found record                        *
 *                                                             *
 * Input/Output   :                                            *
 *                                                             *
 * Return Value   : ESA_RC, ESA_FATAL - Duplicate keywords     *
 *                                                             *
 * Side Effects   :                                            *
 *                                                             *
 * Comments       :                                            *
 *                                                             *
 **************************************************************/

/* WS10082  ESA_RC ADDINFO_dup_check(ADDINFO_rec_typ         * addinfo,
                          char                      * kwd,
                          int                         max_kwdlen,
                          int                         exists_when_empty,
                          ONE_FIELD_rec_ptr         * pair,
                          CTSAMSG_DEST_TABLE_rec_ptr  dest,
                          CTSAMSG_HANDLE_rec_ptr      msgs);   */

/* WS10082 - start */
#define ADDINFO_dup_check(...) \
admin_params_copy->cs_func.ADDINFO_func_ptr->\
ADDINFO_dup_check_ptr \
        (##__VA_ARGS__)

/* WS10082 - end */

/**************************************************************
*                                                             *
* PROCEDURE NAME : ADDINFO_prefix_search adies12              *
*                                                             *
* DESCRIPTION    : Search a keyword in additional info        *
*                                                             *
* INPUT          : kwd              -  keyword prefix         *
*                  pair             -  entry to start search  *
*                  limit            -  max entries to search  *
*                                                             *
* OUTPUT         : None                                       *
*                                                             *
* RETURN VALUE   : ONE_FIELD_rec_ptr (or NULL if not found)   *
*                                                             *
**************************************************************/

/* Ws10082 ONE_FIELD_rec_ptr ADDINFO_prefix_search (char           *kwd,
                                      int          max_kwdlen,
                                      int          exists_when_empty,
                                      ONE_FIELD_rec_ptr p_pair,
                                      short             p_limit); */

/* WS10082 - start */
#define ADDINFO_prefix_search(...) \
admin_params_copy->cs_func.ADDINFO_func_ptr->\
ADDINFO_prefix_search_ptr \
        (##__VA_ARGS__)

/* WS10082 - end */


/**************************************************************
*                                                             *
* PROCEDURE NAME : ADDINFO_insert_cond adies13                *
*                                                             *
* DESCRIPTION    : Search a kwd1 with val1 in addinfo1        *
*                  and if it matches, add kwd2 with val2      *
*                  to addinfo2 .                              *
*                                                             *
* INPUT          : kwd1                                       *
*                  val1                                       *
*                  addinfo1                                   *
*                  kwd2                                       *
*                  val2                                       *
*                                                             *
* OUTPUT         : addinfo2                                   *
*                                                             *
* RETURN VALUE   : none                                       *
*                                                             *
**************************************************************/

/* WS10082 EXT void ADDINFO_insert_cond( char              * kwd1,
                              char              * val1,
                              ADDINFO_rec_typ   * addinfo1,
                              char              * kwd2,
                              char              * val2,
                              int                 max_kwdlen,
                              int                 max_vallen,
                              ADDINFO_rec_typ   * addinfo2 ) ;  */

/* WS10082 - start */
#define ADDINFO_insert_cond(...) \
admin_params_copy->cs_func.ADDINFO_func_ptr->\
ADDINFO_insert_cond_ptr \
        (##__VA_ARGS__)
/* WS10082 - end */


/**************************************************************
*                                                             *
* PROCEDURE NAME : ADDINFO_copy adies14                       *
*                                                             *
* DESCRIPTION    : Copy additional info area                  *
*                                                             *
* INPUT          : to               -  additional info        *
*                  from             -  additional info        *
*                                                             *
* OUTPUT         : none                                       *
*                                                             *
* RETURN VALUE   : ESA_RC                                     *
*                                                             *
**************************************************************/

/* WS10082 EXT ESA_RC ADDINFO_copy  (ADDINFO_rec_ptr to,
                          ADDINFO_rec_ptr from);   */

/* WS10082 - start */
#define ADDINFO_copy(...) \
admin_params_copy->cs_func.ADDINFO_func_ptr->\
ADDINFO_copy_ptr \
        (##__VA_ARGS__)

/* WS10082 - end */


 /**************************************************************
 *                                                             *
 * PROCEDURE NAME : ADDINFO_get_value adies15                  *
 *                                                             *
 * DESCRIPTION    : Get parameter from ADDINFO                 *
 *                                                             *
 * INPUT          : addinfo                                    *
 *                  parameter_name                             *
 *                                                             *
 * OUTPUT         : parameter_value                            *
 *                                                             *
 * RETURN VALUE   : ESA_RC                                     *
 *                                                             *
 **************************************************************/

/* WS10082 EXT ESA_RC ADDINFO_get_value(ADDINFO_rec_typ    * addinfo,
                              char               * parameter_name,
                              char               * parameter_val,
                              int                  max_kwdlen,
                              int                  max_vallen); */

/* WS10082 - start */
#define ADDINFO_get_value(...) \
admin_params_copy->cs_func.ADDINFO_func_ptr->\
ADDINFO_get_value_ptr \
        (##__VA_ARGS__)
/* WS10082 - end */


 /**************************************************************
 *                                                             *
 * PROCEDURE NAME : ADDINFO_strip_prefix adies16               *
 *                                                             *
 * DESCRIPTION    : Copy prefix keyword from source addinfo    *
 *                  to target addinfo with removing prefix from*
 *                  from keyword                               *
 *                                                             *
 * INPUT          : addinfo                                    *
 *                  keyword                                    *
 *                                                             *
 * OUTPUT         : laddinfo                                   *
 *                                                             *
 * RETURN VALUE   : ESA_RC                                     *
 *                                                             *
 **************************************************************/
/* WS10082 EXT ESA_RC ADDINFO_strip_prefix(char               * keyword,
                                 int                  max_kwdlen,
                                 int                  max_vallen,
                                 ADDINFO_rec_typ    * addinfo,
                                 ADDINFO_rec_typ    * laddinfo); */

/* WS10082 - start */
#define ADDINFO_strip_prefix(...) \
admin_params_copy->cs_func.ADDINFO_func_ptr->\
ADDINFO_strip_prefix_ptr \
        (##__VA_ARGS__)
/* WS10082 - end */



/**************************************************************
*                                                             *
* PROCEDURE NAME : ADDINFO_get_next adies17                   *
*                                                             *
* DESCRIPTION    : Get next item from ADDINFO                 *
*                                                             *
* INPUT          : pair             -  entry to start loop    *
*                                                             *
* OUTPUT         : None                                       *
*                                                             *
* RETURN VALUE   : ONE_FIELD_rec_ptr (or NULL if finished)    *
*                                                             *
**************************************************************/
/* WS10082
EXT ONE_FIELD_rec_ptr ADDINFO_get_next(ADDINFO_rec_typ  *addinfo,
                                       ONE_FIELD_rec_ptr p_pair); */

/* WS10082 - start */
#define ADDINFO_get_next(...) \
admin_params_copy->cs_func.ADDINFO_func_ptr->\
ADDINFO_get_next_ptr \
        (##__VA_ARGS__)

/* WS10082 - end */


/**************************************************************
*                                                             *
* PROCEDURE NAME : ADDINFO_copy_by_prefix adies18             *
*                                                             *
* DESCRIPTION    : Copy ADDINFO pairs by prefix               *
*                                                             *
* INPUT          : addinfo_in                                 *
*                  prefix
*                                                             *
* OUTPUT         : addinfo_out                                *
*                                                             *
* RETURN VALUE   : ONE_FIELD_rec_ptr (or NULL if finished)    *
*                                                             *
**************************************************************/

/* WS10082 ESA_RC ADDINFO_copy_by_prefix(char              *prefix,
                              int                max_kwdlen,
                              int                max_vallen,
                              int                drop_prefix,
                              ADDINFO_rec_typ   *addinfo_in,
                              ADDINFO_rec_typ   *addinfo_out); */

/* WS10082 - start */
#define ADDINFO_copy_by_prefix(...) \
admin_params_copy->cs_func.ADDINFO_func_ptr->\
ADDINFO_copy_by_prefix_ptr \
        (##__VA_ARGS__)

/* WS10082 - end */


/**************************************************************
*                                                             *
* PROCEDURE NAME : ADDINFO_kdt_search adies19                 *
*                                                             *
* DESCRIPTION    : Locate a keyword in KDT (Keyword           *
*                  Description Table )                        *
*                                                             *
* INPUT          : p_kwd            - keyword to be searched  *
*                  p_desc           - KDTE to start search    *
*                                                             *
* OUTPUT         : none                                       *
*                                                             *
* RETURN VALUE   : ADDINFO_KDTE_rec_ptr                       *
*                                                             *
**************************************************************/

/* WS10082 EXT ADDINFO_KDTE_rec_ptr ADDINFO_kdt_search   ( char *kwd,
                              ADDINFO_KDTE_rec_ptr   p_kdte); */

/* WS10082 - start */
#define ADDINFO_kdt_search(...) \
admin_params_copy->cs_func.ADDINFO_func_ptr->\
ADDINFO_kdt_search_ptr \
        (##__VA_ARGS__)

/* WS10082 - end */


/**************************************************************
*                                                             *
* PROCEDURE NAME : ADDINFO_kdt_modify adies20                 *
*                                                             *
* DESCRIPTION    : Modify the textl, tetxr for specified      *
*                  entry in KDT table                         *
*                                                             *
* INPUT          : kwd              - keyword                 *
*                  p_kdte           - KDTE table              *
*                  char             - text left               *
*                  char             - text right              *
*                                                             *
* OUTPUT         : none                                       *
*                                                             *
* RETURN VALUE   : ESA_OK, ESA_ERR - specified keyword        *
*                                    not found                *
*                                                             *
**************************************************************/

/* WS10082 ESA_RC ADDINFO_kdt_modify(char                 *kwd,
                          ADDINFO_KDTE_rec_ptr  p_kdte,
                          char                 *txtl,
                          char                 *txtr) ; */

/* WS10082 - start */
#define ADDINFO_kdt_modify(...) \
admin_params_copy->cs_func.ADDINFO_func_ptr->\
ADDINFO_kdt_modify_ptr \
        (##__VA_ARGS__)

/* WS10082 - end */


/**************************************************************
*                                                             *
* PROCEDURE NAME : ADDINFO_mkt_check adies21                  *
*                                                             *
* DESCRIPTION    : Check that all mandatory keywords were     *
*                  specified                                  *
*                                                             *
* INPUT          : p_func        - function name              *
*                  p_numaddi     - number of addinfo buffers  *
*                  p_addinfo     - pointer to addinfo vector  *
*                  p_mkte        - MKTE to start with         *
*                  p_kdt         - KDT for commnad            *
*                  p_dest        - Vector of error msg dests  *
*                  p_msgs        - Error messages buffer      *
*                                                             *
* OUTPUT         : none                                       *
*                                                             *
* RETURN VALUE   : ESA_RC                                     *
*                                                             *
**************************************************************/

/* WS10082 EXT ESA_RC ADDINFO_mkt_check (char                   *p_func,
                              short                  p_numaddi,
                              ADDINFO_rec_ptr        *p_addinfo,
                              ADDINFO_MKTE_rec_ptr   p_mkte,
                              ADDINFO_KDTE_rec_ptr   p_kdt,
                              CTSAMSG_DEST_TABLE_rec_ptr p_dest,
                              CTSAMSG_HANDLE_rec_ptr p_msgs); */

/* WS10082 - start */
#define ADDINFO_mkt_check(...) \
admin_params_copy->cs_func.ADDINFO_func_ptr->\
ADDINFO_mkt_check_ptr \
        (##__VA_ARGS__)

/* WS10082 - end */


/**************************************************************
*                                                             *
* PROCEDURE NAME : ADDINFO_rkt_check adies22                  *
*                                                             *
* DESCRIPTION    : verify that no reserved keywords are used  *
*                                                             *
* INPUT          : func          - function name              *
*                  numaddi       - addinfo buffer             *
*                  addinfo       - addinfo vector pointer     *
*                  rkte          - RKTE to start with         *
*                  p_dest        - Vector of error msg dests  *
*                  p_msgs        - Error messages buffer      *
*                                                             *
* OUTPUT         : none                                       *
*                                                             *
* RETURN VALUE   : ESA_RC                                     *
*                                                             *
**************************************************************/

/* WS10082 EXT ESA_RC ADDINFO_rkt_check(char                    *p_func,
                            short                      p_numaddi,
                            ADDINFO_rec_ptr           *p_addinfo,
                            ADDINFO_RKTE_rec_ptr       p_rkte,
                            CTSAMSG_DEST_TABLE_rec_ptr p_dest,
                            CTSAMSG_HANDLE_rec_ptr     p_msgs); */

/* WS10082 - start */
#define ADDINFO_rkt_check(...) \
admin_params_copy->cs_func.ADDINFO_func_ptr->\
ADDINFO_rkt_check_ptr \
        (##__VA_ARGS__)

/* WS10082 - end */


/**************************************************************
*                                                             *
* PROCEDURE NAME : ADDINFO_concat adies23                     *
*                                                             *
* DESCRIPTION    : Concatenate Additional Info buffers to     *
*                  command buffer                             *
*                                                             *
* INPUT          :                                            *
*                                                             *
* OUTPUT         : none                                       *
*                                                             *
* RETURN VALUE   : ESA_RC                                     *
*                                                             *
**************************************************************/

/* WS10082 EXT ESA_RC ADDINFO_concat( char                      *p_func,
                           char                      *p_cmd,
                           short                      p_numaddi,
                           ADDINFO_rec_ptr           *p_addinfo,
                           ADDINFO_KDTE_rec_ptr       p_kdt,
                           CTSAMSG_DEST_TABLE_rec_ptr p_dest,
                           CTSAMSG_HANDLE_rec_ptr     p_msgs); */

/* WS10082 - start */
#define ADDINFO_concat(...) \
admin_params_copy->cs_func.ADDINFO_func_ptr->\
ADDINFO_concat_ptr \
        (##__VA_ARGS__)

/* WS10082 - end */


/**************************************************************
*                                                             *
* PROCEDURE NAME : ADDINFO_list_search adies24                *
*                                                             *
* DESCRIPTION    : Locate an item in addinfo list value       *
*                                                             *
* INPUT          : list     - list string (items spearted by  *
*                             commas)                         *
*                  item     - searched item                   *
*                  sep      - string of list seperators       *
*                                                             *
* OUTPUT         : none                                       *
*                                                             *
* RETURN VALUE   : Pointer to list item or NULL               *
*                                                             *
**************************************************************/
/* WS10082
EXT char *ADDINFO_list_search (char *list, char *item, char  sep);*/

/* WS10082 - start */
#define ADDINFO_list_search(...) \
admin_params_copy->cs_func.ADDINFO_func_ptr->\
ADDINFO_list_search_ptr \
        (##__VA_ARGS__)

/* WS10082 - end */


/**************************************************************
*                                                             *
* PROCEDURE NAME : ADDINFO_list_diff adies25                  *
*                                                             *
* DESCRIPTION    : Build list of items found in first         *
*                  list, but not in second list .             *
*                                                             *
* INPUT          : inlist1  - first list                      *
*                  inlist2  - second list                     *
*                  outlist  - list of added items             *
*                  insep    - string of list sperators        *
*                  outsep   - sepearator in output list       *
*                                                             *
* OUTPUT         : outlist  - list of added items             *
*                                                             *
*                  is a preallocated output buffer in the size*
*                  of the first input list.                   *
*                                                             *
* RETURN VALUE   : ESA_OK                                     *
*                                                             *
**************************************************************/

/* WS10082 EXT ESA_RC ADDINFO_list_diff (char *inlist1, char *inlist2,
                              char *outlist, char  insep,
                              char  outsep); */

/* WS10082 - start */
#define ADDINFO_list_diff(...) \
admin_params_copy->cs_func.ADDINFO_func_ptr->\
ADDINFO_list_diff_ptr \
        (##__VA_ARGS__)

/* WS10082 - end */


/**************************************************************
*                                                             *
* PROCEDURE NAME : ADDINFO_list_getnextvalue adies26          *
*                                                             *
* DESCRIPTION    : Get one value from list field.             *
*                  The routine can be used to get list values *
*                  one by one                                 *
*                  Note:                                      *
*                  This routine does not handle sub-fields.   *
*                                                             *
*                                                             *
* INPUT          : pair - add_info pair to be parsed          *
*                  field_separator - delimiter to get field   *
*                                    from list                *
*                  lasts - lasts position to continue getting *
*                          values lasts must be NULL          *
*                          when called for first time         *
*                                                             *
* OUTPUT         : token - A copy of the next value from the  *
*                          list-type value, NULL_CHAR when    *
*                          end of values. Token should be     *
*                          defined by the caller as a string  *
*                          variable with length enough to get *
*                          the longest expected value.        *
*                                                             *
* RETURN VALUE   : ESA_OK                                     *
*                                                             *
**************************************************************/

/* WS10082 ESA_RC ADDINFO_list_getnextvalue(ONE_FIELD_rec_ptr pair,
                                char field_separator,
                                char *token,
                                char **lasts); */

/* WS10082 - start */
#define ADDINFO_list_getnextvalue(...) \
admin_params_copy->cs_func.ADDINFO_func_ptr->\
ADDINFO_list_getnextvalue_ptr \
        (##__VA_ARGS__)

/* WS10082 - end */


/**************************************************************
*                                                             *
* PROCEDURE NAME : ADDINFO_list_match adies27                 *
*                                                             *
* DESCRIPTION    : Build a list of items in the first string, *
*                  which also appear in the 2nd string        *
*                                                             *
* INPUT          : inlist1  - first list                      *
*                  inlist2  - second list                     *
*                  outlist  - pointer to area at least as     *
*                             large as inlist1                *
*                  insep_c  - char of input list seperator    *
*                  outsep-c - char of output list seperator   *
*                                                             *
* OUTPUT         : outlist  - list of common items            *
*                                                             *
* RETURN VALUE   : ESA_OK                                     *
*                                                             *
**************************************************************/

/* WS10082 ESA_RC ADDINFO_list_match (char     *inlist1,
                           char     *inlist2,
                           char     *outlist,
                           char      insep_c,
                           char      outsep_c); */

/* WS10082 - start */
#define ADDINFO_list_match(...) \
admin_params_copy->cs_func.ADDINFO_func_ptr->\
ADDINFO_list_match_ptr \
        (##__VA_ARGS__)

/* WS10082 - end */


 /**************************************************************
 *                                                             *
 * PROCEDURE NAME : ADDINFO_convert_list_sep adies28           *
 *                                                             *
 * DESCRIPTION    : Convert string containing old seperators   *
 *                  to new seperators                          *
 *                                                             *
 * INPUT          : src_entry_sep - source entry sep           *
 *                  src_subf_sep  - source subfield  sep       *
 *                  trg_entry_sep - target entry sep           *
 *                  trg_subf_sep  - target subfield  sep       *
 *                                                             *
 * input/output   : buff    - string buffer                    *
 *                                                             *
 * RETURN VALUE   : ESA_RC                                     *
 *                                                             *
 **************************************************************/

/* WS10082  EXT ESA_RC ADDINFO_convert_list_sep(char    * buff,
                                     char      src_entry_sep,
                                     char      src_subf_sep,
                                     char      trg_entry_sep,
                                     char      trg_subf_sep); */

/* WS10082 - start */
#define ADDINFO_convert_list_sep(...) \
admin_params_copy->cs_func.ADDINFO_func_ptr->\
ADDINFO_convert_list_sep_ptr \
        (##__VA_ARGS__)
/* WS10082 - end */


 /**************************************************************
 *                                                             *
 * PROCEDURE NAME : ADDINFO_masupd adies29                     *
 *                                                             *
 * DESCRIPTION    : Massive updates of field in addinfo_to by  *
 *                  values of same_name fields in addinfo_from *
 *                                                             *
 * RETURN VALUE   : NONE                                       *
 *                                                             *
 **************************************************************/

/* WS10082 EXT void ADDINFO_masupd(ADDINFO_rec_ptr           addinfo_to,
                        ADDINFO_rec_ptr              addinfo_from,
                        ADDINFO_masupd_mode          mode,
                        CTSAMSG_DEST_TABLE_rec_typ * dest,
                        CTSAMSG_HANDLE_rec_typ     * msgs);  */

/* WS10082 - start */
#define ADDINFO_masupd(...) \
admin_params_copy->cs_func.ADDINFO_func_ptr->\
ADDINFO_masupd_ptr \
        (##__VA_ARGS__)
/* WS10082 - end */


 /**************************************************************
 *                                                             *
 * PROCEDURE NAME : ADDINFO_expand_from_buffer adies30         *
 *                                                             *
 * DESCRIPTION    : build addinfo object from a buffer of      *
 *                  null-terminated pairs (kwd,type,value).    *
 *                                                             *
 * RETURN VALUE   : NONE                                       *
 *                                                             *
 **************************************************************/

/* WS10082 ESA_RC ADDINFO_expand_from_buffer (char *buffer,
                                   int  buffer_length,
                                   ADDINFO_rec_ptr addinfo);  */

/* WS10082 - start */
#define ADDINFO_expand_from_buffer(...) \
admin_params_copy->cs_func.ADDINFO_func_ptr->\
ADDINFO_expand_from_buffer_ptr \
        (##__VA_ARGS__)
/* WS10082 - end */


 /**************************************************************
 *                                                             *
 * PROCEDURE NAME : ADDINFO_pack_to_buffer adies31             *
 *                                                             *
 * DESCRIPTION    : build a buffer of null-terminated strings  *
 *                  from addinfo object.                       *
 *                                                             *
 * RETURN VALUE   : NONE                                       *
 *                                                             *
 **************************************************************/

/* WS10082 ESA_RC ADDINFO_pack_to_buffer (char *buffer,
                              int  buffer_length,
                              ADDINFO_rec_ptr addinfo,
                              int *actual_buffer_length);  */

/* WS10082 - start */
#define ADDINFO_pack_to_buffer(...) \
admin_params_copy->cs_func.ADDINFO_func_ptr->\
ADDINFO_pack_to_buffer_ptr \
        (##__VA_ARGS__)
/* WS10082 - end */


/* ps0292 */

/* WS10082 start */
/**************************************************************
*                                                             *
* PROCEDURE NAME : ADDINFO_insert_nonstr  adies22             *
*                                                             *
* DESCRIPTION    : Insert a keyword in additional info        *
*                                                             *
* INPUT          : type             -  addinfo type           *
*                  kwd              -  keyword                *
*                  value            -  value                  *
*                  addinfo          -  additional info        *
*                  dupflag          -  allow duplicate flag   *
*                                                             *
* OUTPUT         : none                                       *
*                                                             *
* RETURN VALUE   : ESA_RC                                     *
*                                                             *
**************************************************************/

/* WS10082 ESA_RC ADDINFO_insert_dgt  (ADDINFO_typ        type,
                            char               *kwd,
                            char               *val,
                            int                vallen,
                            ADDINFO_rec_ptr    addinfo,
                            int                max_kwdlen,
                            int                max_vallen,
                            ADDINFO_DUPLICATE  dupflag);  */

/* WS10082 - start */
#define ADDINFO_insert_nonstr(...) \
admin_params_copy->cs_func.ADDINFO_func_ptr->\
ADDINFO_insert_nonstr_ptr \
        (##__VA_ARGS__)
/* WS10082 - end */


/**************************************************************
*                                                             *
* PROCEDURE NAME : ADDINFO_updval_nonstr adies33              *
*                                                             *
* DESCRIPTION    : Update a value of an exiting entry         *
*                                                             *
* INPUT          : value     - Value to be updated            *
*                  pair      - Addinto entry                  *
*                                                             *
* OUTPUT         : none                                       *
*                                                             *
* RETURN VALUE   : ESA_RC                                     *
*                                                             *
**************************************************************/

/* WS10082 ESA_RC ADDINFO_updval_dgt (char               *addval,
                           int                vallen,
                           int                max_vallen,
                           ONE_FIELD_rec_ptr  pair);  */

/* WS10082 - start */
#define ADDINFO_updval_nonstr(...) \
admin_params_copy->cs_func.ADDINFO_func_ptr->\
ADDINFO_updval_nonstr_ptr \
        (##__VA_ARGS__)
/* WS10082 - end */

/* WS10082 - removed - not used and cannt be used.
                       if the data is not a string it cannot be
                       a vaid multi-value value because it may
                       contain the list or sub-list separator.
/@*************************************************************
*                                                             *
* PROCEDURE NAME : ADDINFO_addval_dgt adies34                 *
*                                                             *
* DESCRIPTION    : Conactenate a value to an exiting one      *
*                                                             *
* INPUT          : addval    - Value to be added              *
*                  addsep    - Seperator between value list   *
*                  pair      - Addinto entry                  *
*                                                             *
* OUTPUT         : none                                       *
*                                                             *
* RETURN VALUE   : ESA_RC                                     *
*                                                             *
*************************************************************@/
ESA_RC ADDINFO_addval_dgt (char                      *addval,
                           int                        vallen,
                           int                        max_vallen,
                           char                       addsep_c,
                           ONE_FIELD_rec_ptr          pair,
                           CTSAMSG_DEST_TABLE_rec_ptr p_dest,
                           CTSAMSG_HANDLE_rec_ptr     p_msgs);

*/

/**************************************************************
*                                                      IS0208 *
* PROCEDURE NAME : ADDINFO_value_addval adies35               *
*                                                             *
* DESCRIPTION    : Conactenate a value to an value string     *
*                  and update string length                   *
*                                                             *
* INPUT          : addval    - Subfield / Entry to be added   *
*                  addval_len - Added string length           *
*                  current_val - Addinfo value string         *
*                  current_val_len - Addinfo value string len *
*                  ( passed by address for update )           *
*                  max_vallen - Max value string length       *
*                  addsep_c  - Sufield / List entry seperator *
*                                                             *
* OUTPUT         : none                                       *
*                                                             *
* RETURN VALUE   : ESA_RC                                     *
*                                                             *
**************************************************************/

/* WS10082 ESA_RC ADDINFO_value_addval (char                    *addval,
                             int                       addval_len,
                             char                     *current_val,
                             int                      *current_val_len,
                             int                       max_vallen,
                             char                      addsep_c,
                             ADMIN_PARAMS_rec_typ     *admin_params); */

/* WS10082 - start  */
#define ADDINFO_value_addval(...) \
admin_params_copy->cs_func.ADDINFO_func_ptr->\
ADDINFO_value_addval_ptr \
        (##__VA_ARGS__)
/* WS10082 end */


/* IS10100A - start  */
/**************************************************************
*                                                             *
* PROCEDURE NAME : ADDINFO_split_by_prefix adies36            *
*                                                             *
* DESCRIPTION    : split the addinfo to 2 or more addinfos:   *
*                  - entries matching the prefix are copied   *
*                    to to_prefix.                            *
*                  - all other entries are copied to          *
*                    to_general.                              *
*                                                             *
* INPUT          : from - input addinfo.                      *
*                  to_prefix_num - number of addinfos in      *
*                                  to_prefix vector.          *
*                  prefix - prefix for split.                 *
*                                                             *
* OUTPUT         : to_general - addinfo for non-prefix        *
*                               entries.                      *
*                  to_prefix - vector of pointers to addinfos *
*                              for prefix entries.            *
*                                                             *
* RETURN VALUE   : ESA_OK - when all OK.                      *
*                  ESA_ERR - when output overflow.            *
*                                                             *
*                                                             *
**************************************************************/
/* WS10082 ESA_RC  ADDINFO_split_by_prefix(ADDINFO_rec_ptr  from,
                                ADDINFO_rec_ptr  to_general,
                                ADDINFO_rec_ptr *to_prefix,
                                int              to_prefix_num,
                                char            *prefix);  */
/* WS10082 - start */
#define ADDINFO_split_by_prefix(...) \
admin_params_copy->cs_func.ADDINFO_func_ptr->\
ADDINFO_split_by_prefix_ptr \
        (##__VA_ARGS__)
/* WS10082 - end */

/* IS10100A - end    */

/* IS10100 - start */
/**************************************************************
*                                                             *
* PROCEDURE NAME : ADDINFO_count_by_prefix adies37            *
*                                                             *
* DESCRIPTION    : Count the number of entries with a         *
*                  specific prefix.                           *
*                                                             *
* INPUT          : addinfo - ut addinfo.                      *
*                  prefix - prefix for count.                 *
*                  prefix_with_data - count only pairs with   *
*                                     data (TRUE) or all      *
*                                     (FALSE).                *
*                  other_with_data - count only pairs with    *
*                                    data (TRUE) or all       *
*                                    (FALSE).                 *
*                                                             *
* OUTPUT         : prefix_num - number of entries with        *
*                               prefix.                       *
*                  other_num - number of other entries.       *
*                                                             *
* RETURN VALUE   :                                            *
*                                                             *
**************************************************************/

/* WS10082 void  ADDINFO_count_by_prefix(ADDINFO_rec_ptr  addinfo,
                              char            *prefix,
                              int             *prefix_num,
                              int             *other_num,
                              int              prefix_with_data,
                              int              other_with_data); */

/* WS10082 - start */
#define ADDINFO_count_by_prefix(...) \
admin_params_copy->cs_func.ADDINFO_func_ptr->\
ADDINFO_count_by_prefix_ptr \
        (##__VA_ARGS__)
/* WS10082 - end */



/* WS10082 - remove the ERROR_xxx routines - not used.

***************************************************************
*                                                             *
* PROCEDURE NAME : ERROR_add   radi29                         *
*                                                             *
* DESCRIPTION    : Add error message to error buffer          *
*                                                             *
* INPUT          : p_line   - line to add to buffer           *
*                  p_err    - error buffer                    *
*                                                             *
* OUTPUT         : none                                       *
*                                                             *
* RETURN VALUE   : ESA_RC                                     *
*                                                             *
***************************************************************
EXT ESA_RC ERROR_add (char                 *p_line,
                      ERR_STRUCT_rec_ptr   p_err   );

***************************************************************
*                                                             *
* PROCEDURE NAME : ERROR_dump radi30                          *
*                                                             *
* DESCRIPTION    : Dump error message buffer                  *
*                                                             *
* INPUT          : p_err    - error buffer                    *
*                                                             *
* OUTPUT         : none                                       *
*                                                             *
* RETURN VALUE   : ESA_RC                                     *
*                                                             *
***************************************************************
EXT ESA_RC ERROR_dump (ERR_STRUCT_rec_ptr p_err) ;

***************************************************************
*                                                             *
* PROCEDURE NAME : ERROR_print radi31                         *
*                                                             *
* DESCRIPTION    : Print error message buffer to stdout       *
*                                                             *
* INPUT          : p_err    - error buffer                    *
*                                                             *
* OUTPUT         : none                                       *
*                                                             *
* RETURN VALUE   : ESA_RC                                     *
*                                                             *
***************************************************************
EXT ESA_RC ERROR_print (ERR_STRUCT_rec_ptr p_err) ;

 WS10082 - end of removed code.*/


#endif  /* ADDINFO_H_included */

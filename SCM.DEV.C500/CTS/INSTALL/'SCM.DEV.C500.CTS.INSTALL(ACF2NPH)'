         TITLE 'SA-AGENT NPWPEXIT EXIT FOR ACF2 ONLINE INTERCEPTOR'     00010000
*********************************************************************** 00020000
****                                                               **** 00030000
****  SA-AGENT VERSION 4.0.XX                                      **** 00040000
****                                                               **** 00050000
****  (C) COPYRIGHT 1999-2000 BMC SOFTWARE INC.                    **** 00060000
****                                                               **** 00070000
*********************************************************************** 00080000
*                                                                       00090000
*********************************************************************** 00100000
*                                                                     * 00110000
* Module Name : NPWPEXIT (Static Version)                             * 00120000
*                                                                     * 00130000
* Description : SA-Agent NPWPEXIT ACF2 exit ROUTINE for passphrase    * 00140000
*               change interception                                   * 00150000
* Function:                                                           * 00160000
*                                                                     * 00170000
*    NPWPEXIT is ACF2 new password phrase (passphrase) exit which     * 00180000
*    SA-Agent uses for passphrase syncronization support.             * 00190000
*    The exit intercepts passphrase changes that were generated by    * 00200000
*    the ACF2 commands 'INSERT' and 'CHANGE', as well as when         * 00210000
*    the user changes his passphrase during LOGON, due to his/her     * 00220000
*    request or ACF2 request when passphrase interval time expires.   * 00230000
*    Once the exit intercept the passphrase change, it notifies of    * 00240000
*    the event to SA-Agent online interceptor server via cross        * 00250000
*    memory services.                                                 * 00260000
*                                                                     * 00270000
* Attributes  : the exit module should be link-edited with RMODE ANY  * 00280000
*               and AMODE 31, reusable and reentrable.                * 00290000
*                                                                     * 00300000
* Environment : The exit receives control in Supervisor state         * 00310000
*               and key zero.                                         * 00320000
*                                                                     * 00330000
* Restrictions : None                                                 * 00340000
*                                                                     * 00350000
* Register usage :  R0  - Temporary work register                     * 00360000
*                   R1  - Temporary work register                     * 00370000
*                   R4  -> new password                               * 00380000
*                   R3  -> ACF2 Request Block                         * 00390000
*                   R5  -  length register                            * 00400000
*                   R6  -> user-id                                    * 00410000
*                   R7  -  not used                                   * 00420000
*                   R8  -> not used                                   * 00430000
*                   R9  -> not used                                   * 00440000
*                   R10 -> not used                                   * 00450000
*                   R11 -> ACNPWPXT ACF2's DSECT                        00460000
*                   R12 -> program base                               * 00470000
*                   R13 -> Dynamic Work Area (save area)              * 00480000
*                   R14 -  return address                             * 00490000
*                   R15 -  return code                                * 00500000
*                                                                     * 00510000
*  ACF2 documentation error:                                          * 00520000
*        In the ACF2's NPWPEXIT documentaion the possible values      * 00530000
*        for the request block first byte is X'01' and X'02',         * 00540000
*        but as the exit shows it is X'01' for logon processing       * 00550000
*        or X'0A' for INSERT/CHANGE                                   * 00560000
*                                                                     * 00570000
* Input :                                                             * 00580000
*                                                                     * 00590000
*    Register 1 points to a ACF2 password phrase exit parameter list  * 00600000
*    which is mapped by the ACNPWPXT mapping macro                    * 00610000
*                                                                     * 00620000
* Output:                                                             * 00630000
*                                                                     * 00640000
*    This exit always returns a Return Code of 0.                     * 00650000
*                                                                     * 00660000
* CHANGE ACTIVITY :                                                   * 00670000
*                                                                     * 00680000
*    04/01/18 MS Created                                              * 00690000
*                                                                     * 00700000
*********************************************************************** 00710000
*                                                                       00720000
****************************************************************        00730000
*        Configurations Definition                             *        00740000
****************************************************************        00750000
*                                                                       00760000
****************************************************************        00770000
*        REGISTER EQUATES                                      *        00780000
****************************************************************        00790000
*                                                                       00800000
R0       EQU   0                                                        00810000
R1       EQU   1                                                        00820000
R2       EQU   2                                                        00830000
R3       EQU   3                                                        00840000
R4       EQU   4                                                        00850000
R5       EQU   5                                                        00860000
R6       EQU   6                                                        00870000
R7       EQU   7                                                        00880000
R8       EQU   8                                                        00890000
R9       EQU   9                                                        00900000
R10      EQU   10                                                       00910000
R11      EQU   11                                                       00920000
R12      EQU   12                                                       00930000
R13      EQU   13                                                       00940000
R14      EQU   14                                                       00950000
R15      EQU   15                                                       00960000
*                                                                       00970000
ACF2NPH  CSECT ,                                                        00980000
ACF2NPH  AMODE 31                                                       00990000
ACF2NPH  RMODE ANY                                                      01000000
****************************************************************        01010000
*        PROLOG CODE                                           *        01020000
****************************************************************        01030000
         SAVE  (14,12),,ACF2NPH-&SYSDATE-&SYSTIME                       01040000
         LR    R12,R15                 R12 -> PROGRAM BASE              01050000
         USING ACF2NPH,R12             PROGRAM ADDRESSABILITY           01060000
         CTSLEVEL ,                                                     01070000
         LR    R11,R1                  R11 -> PARAMETERS LIST           01080000
         USING ACNPWPXT,R11            ADDRESSABILITY                   01090000
*----------------------------------------------------------------*      01100000
*        Test Passphrase existance                               *      01110000
*----------------------------------------------------------------*      01120000
         ICM   R4,15,ACNPWP_NPW        passphrase exist?                01130000
         JZ    RETURN                  ..no, get out                    01140000
         ICM   R5,15,ACNPWP_NPWL       its length?                      01150000
         JZ    RETURN                  ..no, get out                    01160000
         L     R3,ACNPWP_RB            point to ACF2 RB                 01170000
*----------------------------------------------------------------*      01180000
*        Obtain workarea                                         *      01190000
*----------------------------------------------------------------*      01200000
START    DS    0H                                                       01210000
         GETMAIN RC,LV=WORKLEN,LOC=ANY                                  01220000
         LTR   R15,R15                                                  01230000
         JZ    CHAINSA                                                  01240000
         WTO   'ACF2NPH: GETMAIN FAILED ERROR'                          01250000
         J     RETURN                                                   01260000
CHAINSA  DS    0H                                                       01270000
         ST    R1,8(R13)               CHAIN                            01280000
         ST    R13,4(R1)               SAVE AREAS                       01290000
         LR    R13,R1                  ESTABLISH WORK AREA              01300000
         USING WORKAREA,R13            addressability                   01310000
*----------------------------------------------------------------*      01320000
*        Create recovery environment                             *      01330000
*----------------------------------------------------------------*      01340000
         XC    ABNDCODE,ABNDCODE       CLEAR ABEND CODE                 01350000
         MVC   WRKESTAE,LSTESTAE                                        01360000
         ESTAE ABNDEXIT,PARAM=WORKAREA,TERM=YES,MF=(E,WRKESTAE)         01370000
*----------------------------------------------------------------*      01380000
*        Build RQC and EVT                                       *      01390000
*----------------------------------------------------------------*      01400000
*                                                                *      01410000
* 'RQC' is the 'request control block' which is used by the PC   *      01420000
* routines to pass information to the SA-Agent online            *      01430000
* interceptor .                                                  *      01440000
*                                                                *      01450000
* 'EVT' is the 'Event Control Block' which is imbeded in the     *      01460000
* request block for 'Notify Requests' . it describes the         *      01470000
* event that occured including the entity (user, group etc...)   *      01480000
* and the event action type (add, deleted, modify, password      *      01490000
* changed, etc...) .                                             *      01500000
*                                                                *      01510000
* the following code formats these control blocks and fill them  *      01520000
* with the relevant info so they can be passed on to the PC      *      01530000
* routines and be transfered to the online interceptor server.   *      01540000
*                                                                *      01550000
*----------------------------------------------------------------*      01560000
         AIF   ('&SYSPARM(1)' NE 'DEBUG').SKP01                  @DBG   01570000
*        display ACF2 Request Block code & passphrase's length   @DBG   01580000
         CVD   R5,PACKD                                          @DBG   01590000
         MVC   WTOAREA(WTODSPL),WTODSP                           @DBG   01600000
         UNPK  X2C(3),0(2,R3)                                    @DBG   01610000
         TR    X2C(2),HEX2CHAR                                   @DBG   01620000
         MVC   WTOAREA+11(2),X2C                                 @DBG   01630000
         UNPK  X2C(3),PACKD                                      @DBG   01640000
         OI    X2C+2,X'F0'                                       @DBG   01650000
         MVC   WTOAREA+14(3),X2C                                 @DBG   01660000
*        LA    R0,WTOAREA+18                                     @DBG   01670000
*        LA    R1,WTODSPL-27                                     @DBG   01680000
*        LR    R15,R5                                            @DBG   01690000
*        ICM   R15,B'1000',=C' '                                 @DBG   01700000
*        LR    R14,R4                                            @DBG   01710000
*        MVCL  R0,R14                                            @DBG   01720000
         WTO   MF=(E,WTOAREA)                                    @DBG   01730000
.SKP01   ANOP  ,                                                 @DBG   01740000
*                                                                       01750000
*        initialize RQC                                                 01760000
*                                                                       01770000
         LA    R0,RQCAREA              CLEAR THE AREA                   01780000
         LA    R1,RQCLEN               SET LENGTH                       01790000
         XR    R15,R15                 PADD WITH X'00'                  01800000
         MVCL  R0,R14                  CLEAR                            01810000
         USING RQC,RQCAREA             MAP IT                           01820000
         TIME  DEC                     GET TIME                         01830000
         STM   R0,R1,RQCTSTMP          TIMESTAMP RQC                    01840000
         MVI   RQCTYPE,RQCTNOTX        REQUEST TYPE IS 'NOTIFY'         01850000
*                                                                       01860000
*        build EVT                                                      01870000
*                                                                       01880000
         USING EVT,RQCEVT              MAP EVENT BLOCK                  01890000
         MVC   EVTEVT,=CL4'EVT '       SET EVENT BLOCK EYE CATCHER      01900000
         MVC   EVTFLAG,=A(EVTFULL)     SET EVT INFO ON                  01910000
         MVI   EVTTYPE,EVTTUSER        TYPE = USER                      01920000
*                                                                       01930000
         TIME  BIN                                                      01940000
         ST    R0,EVTTIME              EVENT TIME STAMP                 01950000
         ST    R1,EVTDATE              EVENT TIME STAMP                 01960000
*                                                                       01970000
         L     R6,ACNPWP_LID           R6->logon-id                     01980000
         MVC   EVTOUID,0(R6)           move logon-id                    01990000
         MVC   EVTUSER,0(R6)           move logon-id                    02000000
         CLI   0(R3),X'01'             ACVALD REQ ?                     02010000
         JNE   VALDCONT                YES, HANDLE IT                   02020000
         MVC   EVTUSER,ACVLID-ACVALD(R3) UID from ACVALD                02030000
VALDCONT DS    0H                                                       02040000
*                                                                       02050000
*        Originator User-ID                                             02060000
*                                                                       02070000
         L     R1,PSATOLD-PSA         R1 -> CURRENT TCB                 02080000
         ICM   R1,15,TCBSENV-TCB(R1)  R1 -> TASK ACEE                   02090000
         JNZ   COPYOUID               HAVE IT, COPY TO EVT              02100000
         L     R1,PSAAOLD-PSA         R1 -> CURRENT ASCB                02110000
         L     R1,ASCBASXB-ASCB(R1)   R1 -> ASXB                        02120000
         ICM   R1,15,ASXBSENV-ASXB(R1) R1 -> ADDRESS SPACE ACEE         02130000
         JZ    SKIPOUID               NO, FAIL TO FIND AN ACEE          02140000
COPYOUID DS    0H                                                       02150000
         MVC   EVTOUID,ACEEUSRI-ACEE(R1) COPY UID FROM ACEE             02160000
SKIPOUID DS    0H                                                       02170000
*                                                                       02180000
*        set originator details from LID record                         02190000
*                                                                       02200000
SETORG   DS    0H                                                       02210000
         L     R1,PSAAOLD-PSA            R1 -> ASCB                     02220000
         ICM   R15,15,ASCBJBNI-ASCB(R1)  JOBNAME EXISTS ?               02230000
         JNZ   COPYOJBN                  YES, THEN COPY IT              02240000
         ICM   R15,15,ASCBJBNS-ASCB(R1)  STCNAME EXISTS ?               02250000
         JZ    SKIPOJBN                  NO, NOTHING CAN BE COPIED      02260000
COPYOJBN DS    0H                                                       02270000
         MVC   EVTOJBN,0(R15)            COPY JOBNAME/STCNAME           02280000
SKIPOJBN DS    0H                                                       02290000
*                                                                       02300000
*        copy new PassPhrase                                            02310000
*                                                                       02320000
         STC   R5,EVTPWPH-1            save length                      02330000
         LA    R0,EVTPWPH              R0-> destination passphrase      02340000
         LHI   R1,L'EVTPWPH            R1=destination length            02350000
         MVCL  R0,R4                   move passphrase                  02360000
*                                      ..and also padd with nulls       02370000
*                                      ..because R5's high order byte   02380000
*                                      ..is null                        02390000
         MVI   EVTACT,EVTAPPH          ACTION = PASSphrase CHANGE       02400000
         MVI   EVTPHCLR,EVTPH$OT       default caller is 'OTHER'        02410000
*----------------------------------------------------------------*      02420000
*                                                                *      02430000
*        In the ACF2's NPWPEXIT documentaion the possible values *      02440000
*        for the request block first byte is X'01' and X'02',    *      02450000
*        but as the exit shows it is X'01' for logon processing  *      02460000
*        or X'0A' for INSERT/CHANGE                              *      02470000
*                                                                *      02480000
*        X'01' in the first byte of the request block indicates  *      02490000
*        that phrase change done during logon.                   *      02500000
*                                                                *      02510000
*----------------------------------------------------------------*      02520000
         CLI   0(R3),X'01'             from LOGON?                      02530000
         JNE   *+8                     no, leave the default            02540000
         MVI   EVTPHCLR,EVTPH$LG       mark it comes from LOGON         02550000
*----------------------------------------------------------------*      02560000
*        Notify server via PC routine                            *      02570000
*----------------------------------------------------------------*      02580000
         AIF   ('&SYSPARM(1)' NE 'DEBUG').SKP02                  @DBG   02590000
*        display EVT block header                                @DBG   02600000
         MVC   WTOAREA(WTODSPL),WTODSP                           @DBG   02610000
         MVC   WTOAREA+11(01),EVTPHCLR                           @DBG   02620000
         MVC   WTOAREA+12(50),EVTTYPE                            @DBG   02630000
         WTO   MF=(E,WTOAREA)                                    @DBG   02640000
.SKP02   ANOP  ,                                                 @DBG   02650000
         CALL  CTSAPCC,(FUJIFLAG,                                      X02660000
               SSNAME,                                                 X02670000
               JOBNAME,                                                X02680000
               RQCAREA,                                                X02690000
               PCCWORK),                                               X02700000
               MF=(E,CALLAREA)                                          02710000
         LTR   R15,R15                 REQUEST PASSED SUCCESSFULLY ?    02720000
         JZ    CLEANUP                 YES, CONITNUE                    02730000
*                                                                       02740000
         CHI   R15,8                   FREE CHAIN EXISTS ?              02750000
         JE    NOFRCHN                 NO, FREE CHAIN RUN OUT           02760000
*                                                                       02770000
         CHI   R15,160                 IS SERVER UP ?                   02780000
         JNH   CLEANUP                 NO, THEN FINISH                  02790000
*----------------------------------------------------------------*      02800000
*        notify routine internal error - issue  error message    *      02810000
*----------------------------------------------------------------*      02820000
         CVD   R15,PACKD               CONVERT RC TO EBCDIC             02830000
         UNPK  CHARRC,PACKD            CONVERT RC TO EBCDIC             02840000
         OI    CHARRC+7,X'F0'          CONVERT RC TO EBCDIC             02850000
         MVC   WTOAREA(WTONTFYL),WTONTFY                                02860000
         MVC   WTOAREA+WTONTFYL-4(4),CHARRC+4                           02870000
         WTO   MF=(E,WTOAREA)                                           02880000
         J     CLEANUP                 FINISH                           02890000
*----------------------------------------------------------------*      02900000
*        Notify free chain is empty                              *      02910000
*----------------------------------------------------------------*      02920000
NOFRCHN  DS    0H                                                       02930000
         MVC   WTOAREA(WTOEVTL),WTOEVT                                  02940000
         MVC   WTOAREA+22(L'EVTUSER),EVTUSER                            02950000
         WTO   MF=(E,WTOAREA)                                           02960000
         J     CLEANUP                                                  02970000
*----------------------------------------------------------------*      02980000
*        issue Abend messgae                                     *      02990000
*----------------------------------------------------------------*      03000000
CLEANUP  DS    0H                                                       03010000
         ICM   R2,15,ABNDCODE          R2 -> ABEND CODE WORD            03020000
         JZ    NOABEND                 ZERO, NO ABEND OCCURED           03030000
         MVI   ABNDTYPE,C'U'           ASSUME USER ABNED                03040000
         N     R2,=XL4'00000FFF'       ISOLATE USER ABEND CODE          03050000
         JNZ   ABENDMSG                HAVE IT, ISSUE THE MESSAGE       03060000
         L     R2,ABNDCODE             TRY AGAIN FOR SYSTEM ABNED       03070000
         SRL   R2,12                   ISOLATE SYSTEM ABEND CODE        03080000
         MVI   ABNDTYPE,C'S'           SET SYSTEM ABEND TYPE            03090000
ABENDMSG DS    0H                                                       03100000
         ST    R2,ABNDBIN              SAVE ISOLATED ABEND CODE         03110000
         UNPK  ABNDCHAR(9),ABNDBIN(5)  CONVERT ABEND CODE TO ZONED      03120000
         TR    ABNDCHAR(8),HEX2CHAR    CONEVRT TO CHARACTERS            03130000
         MVC   ABNDCHAR+4(1),ABNDTYPE  SET ABEND TYPE CHARACTER         03140000
         MVC   WTOAREA(WTOABNDL),WTOABND                                03150000
         MVC   WTOAREA+WTOABNDL-4(4),ABNDCHAR+4                         03160000
         WTO   MF=(E,WTOAREA)                                           03170000
NOABEND  DS    0H                                                       03180000
*----------------------------------------------------------------*      03190000
*        Clear recovery environment                              *      03200000
*----------------------------------------------------------------*      03210000
*                                                                       03220000
         ESTAE 0                                                        03230000
*                                                                       03240000
*----------------------------------------------------------------*      03250000
*        Release workarea storage                                *      03260000
*----------------------------------------------------------------*      03270000
         DROP  R13                                                      03280000
         LR    R1,R13                  ADDRESS FOR FREEMAIN             03290000
         L     R13,4(R13)              RESTORE CALLERS SAVE AREA        03300000
         LA    R0,WORKLEN              R0 = WORK AREA LENGTH            03310000
         FREEMAIN RC,LV=(R0),A=(R1)    FREE WORK AREA                   03320000
         LTR   R15,R15                 SUCCESS ?                        03330000
         JZ    RETURN                  YES, CONTINUE                    03340000
         WTO   'ACF2NPH: FREEMAIN FAILED ERROR'                         03350000
*----------------------------------------------------------------*      03360000
*        Terminate to caller                                     *      03370000
*----------------------------------------------------------------*      03380000
RETURN   DS    0H                                                       03390000
         SR    R15,R15                 LOAD RETURN CODE                 03400000
         RETURN (14,12),T,RC=(15)      RESTORE REGISTERS AND RETURN     03410000
*----------------------------------------------------------------*      03420000
*        Constants                                             *        03430000
*----------------------------------------------------------------*      03440000
         DS    0D                                                       03450000
FUJIFLAG DC    AL1(128)                FIXED FLAG FOR MVS SYSTEM        03460000
SSNAME   DC    CL4'    '                                                03470000
JOBNAME  DC    CL8'CTSAONI'            CROSS MEMEORY JOBNAME            03480000
*                                                                       03490000
LSTESTAE ESTAE MF=L                    LIST FORM FOR ESTAE              03500000
LENESTAE EQU   *-LSTESTAE                                               03510000
*                                                                       03520000
WTONTFY  WTO   'NPWPEXIT: SA-AGENT ONLINE INTERCEPTOR NOTIFY HAS FAILED*03530000
                RC=XXXX',MF=L                                           03540000
WTONTFYL EQU   *-WTONTFY                                                03550000
WTOABND  WTO   'NPWPEXIT: SA-AGENT ACF2 EXIT ACF2NPH  HAS ABENDED. ABEN*03560000
               D CODE=XXXX',MF=L                                        03570000
WTOABNDL EQU   *-WTOABND                                                03580000
WTOEVT   WTO   'NWNPEXIT: CHNG PWD <USERID> EVENT IS LOST. START AGENT *03590000
               ASAP TO EMPTY QUEUE AND MEMORY.',MF=L                    03600000
WTOEVTL  EQU   *-WTOEVT                                                 03610000
*                                                                       03620000
         AIF   ('&SYSPARM(1)' NE 'DEBUG').SKP03                  @DBG   03630000
WTODSP   WTO   'Debug:                                                 X03640000
                                                            ',MF=L,    X03650000
               ROUTCDE=(2)                                              03660000
WTODSPL  EQU   *-WTODSP                                                 03670000
.SKP03   ANOP ,                                                  @DBG   03680000
*                                                                       03690000
HEXDIG   DC    CL16'0123456789ABCDEF'                                   03700000
HEX2CHAR EQU   HEXDIG-C'0'                                              03710000
         LTORG                                                          03720000
         DROP                                                           03730000
*----------------------------------------------------------------*      03740000
*        ABEND recovery routine                                *        03750000
*----------------------------------------------------------------*      03760000
ABNDEXIT DS    0H                                                       03770000
         USING ABNDEXIT,R15            ABEND EXIT ADDRESSABILITY        03780000
         L     R12,=A(ACF2NPH)         RESTORE LMOD BASE REG            03790000
         DROP  R15                                                      03800000
         USING ACF2NPH,R12             RESTORE ITS ADDRESSABILITY       03810000
         C     R0,=F'12'               SDWA PROVIDED ?                  03820000
         JE    NOSDWA                  NO, CAN NOT RETRY                03830000
         USING SDWA,R1                 MAP SDWA                         03840000
         L     R13,SDWAPARM            RESTORE WORKAREA REGISTER        03850000
         USING WORKAREA,R13            MAP WORKAREA                     03860000
         MVC   ABNDCODE,SDWAABCC       SET ABEND CODE                   03870000
         TM    SDWAERRD,SDWACLUP       RETRY ALLOWED ?                  03880000
         JNZ   NORETRY                 NO, CAN NOT RETRY                03890000
*                                                                       03900000
RETRY    DS    0H                                                       03910000
         ST    R12,SDWASR12            SET BASE REGISTER FOR RETRY      03920000
         ST    R13,SDWASR13            SET WORKAREA REGISTER FOR RETRY  03930000
         SETRP RETREGS=YES,RC=4,RETADDR=CLEANUP,                       X03940000
               FRESDWA=YES,DUMP=YES                                     03950000
         BR    R14                                                      03960000
*                                                                       03970000
NOSDWA   DS    0H                                                       03980000
         LR    R13,R2                   NO SDWA, PARM IN R2             03990000
         ST    R1,ABNDCODE              SAVE ABEND CODE                 04000000
         XR    R1,R1                    CLEAR                           04010000
NORETRY  DS    0H                                                       04020000
         XR    R15,R15                  INDICATE NO RETRY               04030000
         BR    R14                      RETURN TO RTM                   04040000
         LTORG                                                          04050000
         DROP                                                           04060000
****************************************************************        04070000
*        DYNAMIC WORK AREA DSECT                               *        04080000
****************************************************************        04090000
WORKAREA DSECT                                                          04100000
SAVEAREA DS    18F                     SAVE AREA TO CALL OTHERS         04110000
CALLAREA CALL  ,(,,,,),MF=L            EXECUTE FORM CALL AREA           04120000
PCCWORK  DS    XL512                   WORK AREA FOR CTSAPCC ROUTINE    04130000
RQCAREA  DS    CL(RQCLEN)              AREA FOR RQC                     04140000
PACKD    DS    D                       RETURN CODE CONVERSION           04150000
CHARRC   DS    CL8                     RETURN CODE CONVERSION           04160000
WTOAREA  DS    XL384                   WTO WORK AREA                    04170000
ABNDCODE DS    XL4                     ABCODE SAVED BY ESTAE ROUTINE    04180000
ABNDBIN  DS    XL5                     ISOLATED ABEND CODE + PAD BYTE   04190000
ABNDTYPE DS    CL1                     ABEND TYPE (S/U)                 04200000
ABNDCHAR DS    CL9                     CHARCTER ABEND CODE FOR MSG      04210000
X2C      EQU   ABNDCHAR,9                                          @DBG 04220000
WRKESTAE DS    CL(LENESTAE)            EXECUTE FORM FOR ESTAE           04230000
RESERVED DS    16X                     RESERVED AREA                    04240000
WORKLEN  EQU   *-WORKAREA                                               04250000
****************************************************************        04260000
*        SA-AGENT CONTROL BLOCKS                               *        04270000
****************************************************************        04280000
RQC      DSECT                                                          04290000
         COPY  CTSRQC                  XMS REQUEST ELEMENT              04300000
EVT      DSECT                                                          04310000
         COPY  CTSEVT                  EVENT CONTROL BLOCK              04320000
****************************************************************        04330000
*        SYSTEM DSECTS                                         *        04340000
****************************************************************        04350000
         IHASDWA                                                        04360000
         IHAPSA                                                         04370000
         CVT   DSECT=YES                                                04380000
         IHAASCB                                                        04390000
         IHAASXB                                                        04400000
         IHAACEE                                                        04410000
         IKJTCB                                                         04420000
****************************************************************        04430000
*        ACF2 DSECTS                                           *        04440000
****************************************************************        04450000
         ACNPWPXT ,  ACF2 parameters macro area mapping                 04460000
         ACVALD   ,                                                     04470000
         ACALT    ,                                                     04480000
**                                                                      04490000
         END                                                            04500000

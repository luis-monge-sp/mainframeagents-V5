/* REXX */                                                              00010000
                                                                        00020000
/****************************************************************/      00030000
/***                                                          ***/      00040000
/***   SA-AGENT VERSION 4.0.XX                                ***/      00040100
/***                                                          ***/      00040200
/***   (C) COPYRIGHT 1999-2004 BMC SOFTWARE, INC.             ***/      00040300
/***   ALL RIGHTS RESERVED.                                   ***/      00041000
/***                                                          ***/      00042000
/****************************************************************/      00050000
                                                                        00100000
/****************************************************************/      00110000
/***                                                          ***/      00120000
/***    TITLE       : RACF COMMAND EXECUTOR REXX              ***/      00130000
/***                                                          ***/      00140000
/***    FILE NAME   : CTSACMD                                 ***/      00150000
/***                                                          ***/      00160000
/***    DESCRIPTION : REXX SCRIPT TO EXECUTE A RACF COMMAND   ***/      00170000
/***                  TRAP ITS OUTPUT AND WRITE IT TO EXECOUT ***/      00180000
/***                  DDCARD .                                ***/      00190000
/***                                                          ***/      00200000
/****************************************************************/      00210000
                                                                        00220000
/****************************************************************/      00230000
/***                                                          ***/      00240000
/***       INITIALIZATION                                     ***/      00250000
/***                                                          ***/      00260000
/****************************************************************/      00270000
                                                                        00280000
PARSE ARG DDN ADMIN COMMAND                                             00290000
ADDRESS TSO                                                             00300000
"PROFILE NOPREFIX"                                                      00310000
                                                                        00320000
/****************************************************************/      00330000
/***                                                          ***/      00340000
/***       SET OUTPUT TRAPPING                                ***/      00350000
/***                                                          ***/      00360000
/****************************************************************/      00370000
                                                                        00380000
X = OUTTRAP("LINE.","*", CONCAT )                                       00390000
CALL CTS1CMD "CTSAEXC " || COMMAND                                      00400000
X = OUTTRAP('OFF')                                                      00410000
CMD_RC = RESULT                                                         00420000
                                                                        00430000
/****************************************************************/      00440000
/***                                                          ***/      00450000
/***       FILTER OUTPUT LINES                                ***/      00460000
/***                                                          ***/      00470000
/****************************************************************/      00480000
                                                                        00490000
J = 0                                                                   00500000
DO I =1 TO LINE.0 BY 1                                                  00510000
   IF WORDS(LINE.I) > 1 THEN DO                                         00520000
      IF WORD(LINE.I,2) ^= "*-*" THEN DO                                00530000
         IF WORD(LINE.I,2) ^= "+++" THEN DO                             00540000
            J = J + 1                                                   00550000
            OUT.J = LINE.I                                              00560000
         END                                                            00570000
      END                                                               00580000
   END                                                                  00590000
   ELSE DO                                                              00600000
      J= J + 1                                                          00610000
      OUT.J = LINE.I                                                    00620000
   END                                                                  00630000
END                                                                     00640000
OUT.0 = J                                                               00650000
                                                                        00660000
/****************************************************************/      00760000
/***                                                          ***/      00770000
/***        WRITE OUTPUT TO RACF OUTPUT FILE                  ***/      00780000
/***                                                          ***/      00790000
/****************************************************************/      00800000
                                                                        00810000
"EXECIO" OUT.0 "DISKW" DDN "( STEM OUT. FINIS "                         00820000
                                                                        00830000
/****************************************************************/      00840000
/***                                                          ***/      00850000
/***        FINISH WITH COMMAND RC                            ***/      00860000
/***                                                          ***/      00870000
/****************************************************************/      00880000
                                                                        00890000
EXIT CMD_RC                                                             00900000

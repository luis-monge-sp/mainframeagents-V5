CTSAMEM  TITLE '  '                                                     00030000
**********************************************************************  00040000
*                                                                    *  00050000
*                                                                    *  00060000
*                             CTMMEM                                 *  00061000
*                             -------                                *  00062000
*                                                                    *  00063000
*                                                                    *  00064000
*                       WRITTEN  BY YNON RAPOPORT AND                *  00065000
*                                   JOSEPH HOLLANDER                 *  00066000
*                                                                    *  00067000
*   THIS PROGRAM OPERATES AS A GENERAL PURPOSE LIBRARY/MEMBER        *  00068000
*   HANDLING PROGRAM.                                                *  00069000
*                                                                    *  00070000
*                                                                    *  00080000
*   PARAMETERS:                                                      *  00090000
*                                                                    *  00100000
*    1.  CL8   FUNCTION  REQUIRED                                    *  00110000
*    2.  CL44  LIBRARY (DATA SET)                                    *  00120000
*    3.  CL8   DDNAME                                                *  00130000
*    4.  CL8   MEMBER NAME                                           *  00140000
*    5.  A     OUTPUT START ADDRESS (OR OUTPUT FOR PUT MEM)          *  00150000
*    6.  X     LIST TYPE (V-VEC(*) CHAR,    D-LIST (DOUBLE POITERED))*  00160000
*    7.  F     MAXIMUM LINES TO READ OR NUMBER TO UPDATE             *  00170000
*    8.  CL8   USERID                                                *  00180000
*    9.  F     FROMLINE  IN THE MEMBER                               *  00190000
*   10.  CL2   CHAR CODE FOR MULTIPLE DDNAMES / SUFFIX OF CTSALIB    *  00200000
*   11.  CL1   PUT OPTION - A-ADD (CREATE) OR R-REPLACE              *  00210000
*   12.  F     ABEND CODE                                            *  00220000
*   13.  F,H,C,C BUFFER SIZE, REAL LRECL, REQUESTED AND REAL RECFM W434 00230000
*                REAL VALUES ARE RETURNED FROM CTMMEM              W434 00240000
*                IF THE PARAMETER IS ABSENT, ASSUMED 80,  ,F,      W434 00250000
*                FOR D-TYPE BUFFER BUFFSIZE MEANS LENGTH OF EACH   W434 00260000
*                RECORD, FOR V-TYPE - IT IS LENGTH OF WHOLE BUFFER W434 00270000
*   14.  F     ACTUAL NUMBER OF PARAMETERS (DEFAULT - 15)        WM1161 00280000
*   15.  F     RETURN CODE                                           *  00290000
*   16.  F     AREA SIZE (TO READ DIRECTORY IN).                 WM1161 00290000
*              ON RETURN CONTAINS REMAINED MEMORY OR, IF         WM1161 00290000
*              NEGATIVE, ADDITIONAL AMOUNT NEEDED.               WM1161 00290000
*   17   CL80  STATISTICS AREA ON RETURN FROM PUTMEM AND MEMSTAT WM1161
*   18.  F     ACTUAL SIZE OF MEMBER READ (NUMBER OF RECORDS).   WM1643 00290000
*              WILL CONTAIN F'-1' IF GETMAIN FOR ONE RECORD LONG WM1643 00290000
*              BUFFER FAILED.                                    WM1643 00290000
*                                                                    *  00310000
*   FUNCTIONS: 1.  GETMEM  - READ A MEMBER FROM LIBRARY              *  00320000
*              2.  INITMEM - INIT CONNECTION WITH MEMBER (IF YOU     *  00330000
*                            WANT TO READ ONE BY ONE)                *  00340000
*              3.  GETLINE - GET SINGLE LINE IN MEMBER. IF INITMEM   *  00350000
*                            WASNT PERFORMED BY THE USER, THEN IT    *  00360000
*                            IS PERFORMED AUTOMATICALLY.             *  00370000
*              4.  DIRECTOR- GIVE DIRECTORY PLEASE                   *  00380000
*              4A. DIRFULL - GIVE DIRECTORY WITH STAT. INFO.     WM1161 00380000
*              5.  FINISH  - PERFORM YOUR FREEMAINS                  *  00390000
*              6.  ENDLIBDE- FINISH WITH LIBRARY AND DEALLOCATE      *  00400000
*              7.  PUTMEM  - WRITE MEMBER IN LIBRARY                 *  00400100
*              8.  DELMEM  - DELETE A MEMBER.                        *  00400200
*              9.  MEMSTAT - GIVE MEMBER'S STATISTICS                *  00400200
*                                                                    *  00400300
*   RC:                                                              *  00400400
*                                 BE CAREFUL !!   AK                 *  00400500
*      0 - OK                                                        *  00400600
*      4 - EOF (IN GETLINE)                                          *  00400700
*      8 - NOT ENOUGH MEMORY                                         *  00400800
*     12 - MEMBER NOT FOUND                                          *  00400900
*     16 - DSN IS NOT A LIBRARY                                      *  00401000
*     20 - DSN IS NOT FIXED                                          *  00402000
*     24 - LRECL IS NOT 80                                           *  00403000
*     28 - DATA SET IN USE                                           *  00404000
*     32 - INTERNAL ERROR -TYPE IN RC0                               *  00405000
*     36 - DATA SET NOT IN CATALOG                                   *  00406000
*     40 - DYNAMIC ALLOCATION FAILED                                 *  00407000
*     44 - INVALID REQUEST TO CTMMEM                                 *  00408000
*     48 - MAX LINES EXCEEDED (OR DIRECTOR)                          *  00409000
*     52 - ERROR WHEN OPENING/PROCESSING DIRECTORY                   *  00410000
*     56 - STAE HAS CAUGHT AN ABEND                                  *  00420000
*     60 - MEMBER DOES NOT EXIST ON SAVE                             *  00430000
*     64 - MEMBER ALREADY EXIST                                      *  00440000
*     68 - INCONSISTENT TYPE                                     W434*  00450000
*                                                                    *  00460000
*--------------------------------------------------------------------*  00470000
* PTF07 02/09/85 BUGS IN CONNECTION TO CTMLIB                        *  00480000
*                AFTER UNALLOC DID NOT BLANK LAST LIB                *  00490000
*--------------------------------------------------------------------*  00470000
* PTF10 15/11/85 SUPPORT OF LIB=' ' MEANING READ BY DDNAME ONLY !!   *  00510000
*       22/12/85 CORRECTING SUPPORT FOR CHANGING JUST LAST DDNAME    *  00520000
*                AND ADDING PRTDBG IN PRTDMY MODE                    *  00530000
*--------------------------------------------------------------------*  00470000
* PTF12 22/01/86 ENQ SPFEDIT WHEN UPDATING MEMBER                    *  00550000
*                ERROR WILL BE DESIGNATED BY RC 32                   *  00560000
*----------------------P-T-F--1-6-----------------------------PTF16--*  00570000
*  B263  07.07.87  ABEND0C2 IN CTMMEM AFTER CTMLIB ENTERED STAE.     *  00580000
*----------------------P-T-F--1-7-----------------------------PTF17--*  00590000
*  B321  31.11.87  INFINITE LOOP IF CTMLIB ENCOUNTERED S913 AT INIT. *  00600000
*----------------------P-T-F--2-1-0------------------------VER210  --*  00610000
*  W474  10.11.88  OVERRIDE DDNAME FOR SUPPORTING SERVER USERS .     *  00620000
*------------------------- M 2.1.4 ------------------------VER214  --*  00630000
*  B904  24.10.89  OVERRIDE DDNAME WITH TIME STAMP INSTEAD OF TCB ADD*  00640000
*------------------------- I 3.0.0  -----------------------VER220  --*  00650000
*  W434  07.11.90  LN INDEX PAGE MORE THEN 80 CHAR WIDE & RECFM=V    *  00660000
*  BM203 01.03.91  YY NO SPACE IN LIBRARY AFTER STOW                 *  00670000
*------------------------- I 4.0.0 ----------------------------------*  00680000
* BM1514 26.07.91 LN  RC=56 IN CASE OF ABEND DURING INITDSN (WAS 40) *  00690000
* WM1161 08.08.91 EL  SUPPORT ISPF STATISTICS IN PUTMEM AND MEMSTAT  *  00700000
* WM1161 04.10.92 YG  SUPPORT ISPF STATISTICS IN DIRFULL REQUEST     *  00700000
* BM1608 01.10.91 DT  DO NOT RETURN ABEND CODE IF THE PRMABEND INPUT *  00710000
*                     PARAMETER IS NOT DEFINED.                      *  00720000
* IM0384 07.10.91 YY  DELETE A MEMBER (STOW).                        *  00730000
* WM1643 04.10.92 YG  RETURN ACTUAL SIZE OF MEMBER READ              *  00730000
*------------------------- I 5.0.0 ----------------------------------*  00680000
* WI0847 28.03.95 LN  POSSIBILITY TO WORK ABOVE THE LINE             *  00690000
* II0231 07.06.95 HT  CHANGE CTMLEVEL TO IOALEVEL                    *
* PI0499 14.04.96 LN  REMOVE SOME GARBAGE                            *
*------------------------- I 5.1.0 ----------------------------------*  00680000
* BI1018 05.08.96 LN  INITMEM SHOULD CLOSE PREVIOUS MEMBER           *
*IS10188 06.10.24 AL  MOVE OUR MODULES ABOVE 16M LINE                *
**********************************************************************  00740000
         MACRO
         PRTDBG
         MEND
         MACRO                                                   WI0847 00750000
&L       CALLIB &A,&VL                                           WI0847
&L       L      R15,CTMLIBA                                      WI0847
         CALL   (15),&A,&VL                                      WI0847
         MEND                                                    WI0847
         MACRO                                                          00760000
         ACT     &CODE                                                  00770000
&CODE    DC      CL8'&CODE'                                             00780000
         MEND                                                           00790000
         SPACE     3                                                    00800000
         MACRO                                                          00801000
         LIBRC     &ACT=                                                00802000
         LCLA   &I                                                      00803000
         PUSH  PRINT                                                    00804000
         PRINT GEN                                                      00805000
         MVC   CODE(8),=CL8'&ACT'                                       00806000
         B     *+4(R15)                                                 00807000
.LOOP    ANOP                                                           00808000
&I       SETA    &I+1                                                   00809000
         AIF    (&I   GT  N'&SYSLIST).END                               00810000
         B     &SYSLIST(&I)                                             00820000
         AGO    .LOOP                                                   00830000
.END     ANOP                                                           00840000
         POP   PRINT                                                    00850000
         MEND                                                           00860000
         SPACE 3                                                        00870000
         MACRO                                                          00880000
         SETRC  &RC                                                     00890000
         PUSH  PRINT                                                    00900000
         PRINT GEN                                                      00910000
         L     R1,PARMADDR                                              00920000
         USING PRM,R1                                                   00930000
         L     R1,PRMRC                                                 00940000
         LA    R15,&RC                                                  00950000
         ST    R15,0(R1)                                                00960000
         DROP  R1                                                       00970000
         POP   PRINT                                                    00980000
         MEND                                                           00990000
         TITLE 'DSECTS '                                                01000000
LB       DSECT                                                          01010000
LBDSNAM DS    CL44     NAME OF LIBRARY                                  01020000
LBDDNAM DS    CL8      DDNAME FOR LIBRARY                               01030000
LBNUMMIT DS    H        # OF MIT FOR THAT LIBRARY                       01040000
LBMITPTR DS    A        PTR TO CURRENT AVAIBLE ENTRY                    01050000
LBLEN    EQU   *-LB                                                     01060000
         SPACE   3                                                      01070000
INFOUT   DSECT                                                          01080000
INFTYPE  DS    CL4    TYPE                                              01090000
INFDSORG DS    CL2    DSORG                                             01100000
INFRECFM DS    CL2    RECFM                                             01110000
INFBLKSI DS    H      BLOCKSIZE                                         01120000
INFLRECL DS    H      LRECL                                             01130000
INFDSNAM DS    CL44                                                     01140000
         SPACE 3                                                        01150000
PRM      DSECT                                                          01160000
****************** INPUT PARAMETERS ***********                         01170000
PRMFUNC  DS    A  1  FUNCTION  REQUIRE                                  01180000
PRMLIB   DS    A  2  LIBRARY (DATA SET)                                 01190000
PRMDDNAM DS    A  3  DDNAME                                             01200000
PRMMEM   DS    A  4  MEMBER NAME                                        01210000
PRMOUT   DS    A  5  OUTPUT START ADDRESS                               01220000
PRMLISTP DS    A  6  LIST TYPE                                          01230000
PRMLINE# DS    A  7  MAXIMUM LINES TO READ                              01240000
PRMUSRID DS    A  8  USERID                                             01250000
PRMFRMLN DS    A  9  FROMLINE  IN THE MEM                               01260000
PRMCHR2  DS    A  10 CHAR CODE FOR DIFFERENT DDNAMES                    01270000
PRMPUTOP DS    A  11 PUT OPTION A-ADD R-REP                             01280000
PRMABEND DS    A  12 ABEND CODE IN CASE OF ERROR                        01290000
PRMDESC  DS    A  13 REQUESTED/REAL LRECL/RECFM                         01300000
*WM1161PRMFUT5  DS    A FUTURE USE                                      01310000
PRMPRM#  DS    A  14 ACTUAL NUMBER OF PARAMETERS (DEFAULT - 15) WM1161
PRMRC    DS    A  15 RETURN CODE                                        01320000
PRMSIZE  DS    A  16 SIZE OF AN AREA TO READ DIRECTORY IN      WM1161
PRMSTAT  DS    A  17 STATISTICS AREA ADDRESS FROM PUTMEM/MEMSTAT WM1161
PRMALN   DS    A  18 NUMBER OF LINES IN A MEMBER (FOR GETMEM)    WM1643
PRMDESCF DSECT                                                    W434  01321000
PRMDBUF  DS    F    BUFFER SIZE FOR GETMEM OPERATION              W434  01322000
PRMDRLR  DS    H    REAL LRECL                                    W434  01323000
PRMDURF  DS    C    REQ RECFM                                     W434  01324000
PRMDRRF  DS    C    REAL RECFM                                    W434  01325000
         SPACE 3                                                        01328000
         TITLE '    INITIALIZATION '                                    01329000
         DCBD  DSORG=(PS,PO),DEVD=DA                                    01350000
CTSAMEM  CSECT                                                          01360000
CTSAMEM  AMODE 24           MUST BE BELOW THE 16M LINE          IS10188
CTSAMEM  RMODE 24           MUST BE BELOW THE 16M LINE          IS10188
         BEGIN *,R11,R12                                                01370000
         CTSEQUR
*                                                                       01380000
*     LEVEL OF THIS MODULE                                              01390000
*                                                                       01400000
         CTSLEVEL                                                       01410000
**********************************************************************  01420000
****                                                              ****  01430000
****       IOA         RELEASE 5.0.0                              ****  01440000
****                                                              ****  01450000
****       LICENSED MATERIAL - 4TH DIMENSION SOFTWARE LTD.        ****  01460000
****                                                              ****  01470000
**********************************************************************  01480000
         SPACE 3                                                        01490000
*                                                                       01500000
***      STORE PARAMETR ADDRESS                                         01510000
*                                                                       01520000
         ST    R1,PARMADDR                                              01530000
         L      R2,PARMADDR                                             01540000
         USING  PRM,R2                                                  01550000
         LA    R7,INFC                                            W434  01560000
         USING INFOUT,R7                                          W434  01570000
         SPACE 3                                                        01580000
*                                                                       01590000
***      CHECK IF FIRST TIME                                            01600000
*                                                                       01610000
         TM    STATFLAG,$INIT                                           01620000
         BO    SELFUNC                                                  01630000
         SPACE 3                                                        01640000
*                                                                       01650000
*   INIT  CTMLIB                                                        01660000
*                                                                       01670000
         OC    CTMLIBA,CTMLIBA                                   WI0847
         BNE   CALLLIB                                           WI0847
         MVC   LIBNAME,=CL8'CTSALIB'   SET DEFAULT NAME          WI0847
         L     R1,PRMCHR2                                        WI0847
         CLI   0(R1),C' '              IS IT EMPTY?              WI0847
         BNH   LOADLIB                 YES                       WI0847
         MVI   LIBNAME+4,C'B'          FORM NAME                 WI0847
         MVC   LIBNAME+5(3),0(R1)      CTMLBXXX                  WI0847
LOADLIB  LOAD  EPLOC=LIBNAME                                     WI0847
         ST    R0,CTMLIBA                                        WI0847
         MVI   LOADFL,X'FF'                                      WI0847
CALLLIB  CALLIB (INIT)                                           WI0847 01680000
         LTR   R15,R15                                                  01690000
         BNZ   RC8                                                      01700000
         OI    STATFLAG,$INIT                                           01710000
         EJECT                                                          01720000
*                                                                       01730000
*   SELECT FUNCTION                                                     01740000
*                                                                       01750000
SELFUNC  L     R1,PRMFUNC          UPON NAME OF REQUEST                 01760000
         LM    R3,R5,=A(FUNCTAB,12,FNCTBEND)                            01770000
LOOPCOD  CLC   0(8,R1),0(R3)       FOUND ENTRY?                         01780000
         BE    GOROUT              YES , GO HANDLE REQUEST              01790000
         BXLE  R3,R4,LOOPCOD                                            01800000
         B     RC44                UNKNOWN EWQUEST                      01810000
         SPACE  3                                                       01820000
*                                                                       01830000
***      JUMP  TO  OUR FUNCTION HANDLE   ROUTINE                        01840000
*                                                                       01850000
GOROUT   L     R15,8(R3)                                                01860000
         BR    R15                                                      01870000
         SPACE  3                                                       01880000
*                                                                       01890000
*   THE USER WISHES TO FINISH                                           01900000
*                                                                       01910000
FINISH   EQU  *                                                         01920000
         TM    STATFLAG,$MEMOPEN                                        01930000
         BZ    FIN22                                                    01940000
         CALLIB (CLOSEMEM,0,0,0,DDNAMEW)                         WI0847 01950000
    PRTDBG 'CLOSEMEM RC=# DDNAME "_"',(?R15,DDNAMEW,8)                  01960000
         NI    STATFLAG,X'FF'-$MEMOPEN                                  01970000
FIN22    TM    STATFLAG,$DSNOPEN                                        01980000
         BZ    FIN33                                                    01990000
         CALLIB (ENDDSN,0,0,0,LASTDD)                            WI0847 02000000
    PRTDBG ' FIN ENDDSN RC=# DDNAME "_"',(?R15,LASTDD,8)                02010000
         NI    STATFLAG,X'FF'-$DSNOPEN                                  02020000
FIN33    TM    STATFLAG,$DSNALOC                                        02030000
         BZ    FIN44                                                    02040000
         CALLIB (UNALLOC,LASTLIB,0,0,LASTDD)                     WI0847 02050000
    PRTDBG ' FINUNALOC RC=# DD "_" LIB "_"',(?R15,LASTDD,8,LASTLIB,44)  02060000
         NI    STATFLAG,X'FF'-$DSNALOC                                  02070000
FIN44    OC    CTMLIBA,CTMLIBA   DOES CTMLIB EXIST ?             WI0847 02080000
         BZ    AFTFIN            NO                              WI0847
         CALLIB (FIN)            CLOSE IT                        WI0847 02080000
         CLI   LOADFL,0                                          WI0847
         BE    AFTFIN                                            WI0847
         DELETE EPLOC=LIBNAME    DELETE IF NEEDED                WI0847
         MVI   LOADFL,0                                          WI0847
         XC    CTMLIBA,CTMLIBA                                   WI0847 02080000
AFTFIN   MVC   LASTDD,=CL8' '                                           02100000
         MVC   LASTLIB,=CL44' '                                         02110000
         MVI   STATFLAG,X'00'                                           02120000
         PRTDBG 'CLOSE DBG'
         B     RC0                                                      02130000
         EJECT                                                          02140000
*                                                                       02150000
*   GET MEMBER                                                          02160000
*                                                                       02170000
GETMEM   EQU   *                                                        02180000
         BAL   R14,STARTLIB                                             02190000
         BAL   R14,STARTMEM                                             02200000
         SPACE 3                                                        02210000
*                                                                       02220000
*   READ CARDS ONE BY ONE                                               02230000
*                                                                       02240000
         L     R1,PRMLINE#                                              02250000
         L     R5,0(R1)   MAXIMUM LINES TO READ                         02260000
         LA    R6,1      READ COUNTER                                   02270000
         L     R8,PRMOUT  OUTPUT ADDRESS                                02280000
         L     R10,=X'00FFFFFF' UNLIMITED BUFFER                  W434  02290000
         ICM   R1,15,PRMDESC                                      W434  02300000
         BE    LOOP2                                              W434  02301000
         USING PRMDESCF,R1                                        W434  02302000
         L     R10,PRMDBUF                                        W434  02303000
LOOP2    EQU   *                                                        02304000
         CR    R6,R5                                                    02305000
         BH    MAXCOUNT                                                 02306000
         C     R8,=F'8'                                                 02307000
         BNH   MAXCOUNT      NO MORE PLACE IN OUTPUT LIST               02308000
         CH    R10,INFLRECL                                       W434  02309000
         BL    MAXCOUNT      NO PLACE IN BUFFER                   W434  02310000
*    PRTDBG 'CALLING GET MEM  _ DDNAME "_"',(MEMBERW,8,DDNAMEW,8)       02320000
         CALLIB (GET,0,MEMBERW,(8),DDNAMEW)                      WI0847 02330000
*    PRTDBG 'GET RC=#',(?R15)                                           02340000
         LIBRC OKREAD,EOF,UNEXPGET,INVPARM,MISSING,INVCOD,             *02350000
               INVCOD,INVCOD,INVCOD,INVCOD,STAERR,ACT=GET          W434 02360000
         SPACE 3                                                        02370000
*                                                                       02380000
*   EDIT CARD TO OUTPUT AREA                                            02390000
*                                                                       02400000
OKREAD   EQU   *                                                        02410000
         LA    R6,1(R6)                                                 02420000
         L     R1,PRMLISTP                                              02430000
         CLI   0(R1),C'D'           A DOUBLE POINTER LIST ???           02440000
         BE    DLIST                YES HANDLE (NO- VECTOR)             02450000
         CLI   INFRECFM,C'F'                                      W434  02460000
         BNE   RECV                                               W434  02470000
         AH    R8,INFLRECL                                        W434  02480000
         SH    R10,INFLRECL                                       W434  02490000
         B     LOOP2                                                    02500000
RECV     SH    R10,0(R8)                                          W434  02501000
         AH    R8,0(R8)                                           W434  02501100
         B     LOOP2                                              W434  02501200
DLIST    S     R8,=F'4'             NEXT IN LIST                        02501300
         L     R8,0(R8)                                                 02501400
         LA    R8,8(R8)             POSITION ON NEXT ONE                02501500
         B     LOOP2                                                    02501600
         SPACE 3                                                        02501700
*                                                                       02501800
*   FINISH WITH MEMBER                                                  02501900
*                                                                       02502000
EOF      EQU   *                                                        02503000
         BCTR  R6,0                                                     02504000
         L     R1,PRMLINE#                                              02505000
         ST    R6,0(R1)           LINES READ                            02506000
         L     R1,PRMPRM#              ADDRESS OF PARAMETERS #   WM1643
         LTR   R1,R1                                             WM1643
         BZ    SKIPALN                                           WM1643
         CLC   0(4,R1),=F'18'          HOW MANY?                 WM1643
         BL    SKIPALN                                           WM1643
         ICM   R1,15,PRMALN       LOAD PARAMETER ADDRESS         WM1643
         BZ    SKIPALN            SKIP IF ABSENT                 WM1643
         ST    R6,0(R1)           STORE ACTUAL MEMBER SIZE       WM1643
SKIPALN  DS    0H                                                WM1643
         CALLIB (CLOSEMEM,0,0,0,DDNAMEW)                         WI0847 02507000
    PRTDBG 'CLOSMEM RC=# DDNAME "_"',(?R15,DDNAMEW,8)                   02508000
         NI    STATFLAG,X'FF'-$MEMOPEN                                  02509000
         B     RC0                                                      02510000
         SPACE 3                                                        02520000
*                                                                       02530000
*   MAXIMUM TO READ EXCEEDED                                            02540000
*                                                                       02550000
MAXCOUNT EQU   *                                                        02560000
         BCTR  R6,0                                                     02570000
         L     R1,PRMLINE#                                              02580000
         ST    R6,0(R1)           LINES READ                            02590000
         MVI   MAXCFLAG,1              SET FLAG                  WM1643
         L     R1,PRMPRM#              ADDRESS OF PARAMETERS #   WM1643
         LTR   R1,R1                                             WM1643
         BZ    SKIPALN1                                          WM1643
         CLC   0(4,R1),=F'18'          HOW MANY?                 WM1643
         BL    SKIPALN1                                          WM1643
         ICM   R5,15,PRMALN       LOAD PARAMETER ADDRESS         WM1643
         BZ    SKIPALN1           SKIP IF ABSENT                 WM1643
         MVI   MAXCFLAG,0     CLEAR FLAG AND CHECK MAXCOUNT      WM1643
****     GET MAIN STRAGE FOR ONE RECORD                          WM1643 10920000
         LH    R10,INFLRECL                                      WM1643 02309000
         CTSAXGR GETMAIN,LV=(R10),LOC=RES                        WI0847 10960000
         LTR   R15,R15         CHECK RC                          WM1643 10970000
         BZ    COUNT                                             WM1643 10980000
         MVC   0(4,R5),=F'-1'     INDICATE THAT GETMAIN FAILED   WM1643
         B     SKIPALN1                                          WM1643
COUNT    LR    R8,R1                                             WM1643
CNTLOOP  DS    0H                                                WM1643
         CALLIB (GET,0,MEMBERW,(8),DDNAMEW)                      WI0847 02330000
         LIBRC COUNT1,EOFCOUNT,UNEXPGET,INVPARM,MISSING,INVCOD,  WM1643*02350000
               INVCOD,INVCOD,INVCOD,INVCOD,STAERR,ACT=GET        WM1643 02360000
COUNT1   LA    R6,1(R6)                                          WM1643
         MVI   MAXCFLAG,1              SET FLAG                  WM1643
         B     CNTLOOP                                           WM1643
EOFCOUNT DS    0H                                                WM1643
         ST    R6,0(R5)           STORE ACTUAL MEMBER SIZE       WM1643
         CTSAXGR FREEMAIN,LV=(R10),A=(R8)                        WI0847 10960000
SKIPALN1 DS    0H                                                WM1643
         CALLIB (CLOSEMEM,0,0,0,DDNAMEW)                         WI0847 02600000
    PRTDBG 'CLOSMEM RC=# DDNAME "_"',(?R15,DDNAMEW,8)                   02610000
         NI    STATFLAG,X'FF'-$MEMOPEN                                  02620000
         CLI   MAXCFLAG,0      WAS IT REALLY EXCEEDED?           WM1643
         BE    RC0                                               WM1643 02510000
         B     RC48                                                     02630000
         EJECT                                                          02640000
*                                                                       02650000
*   PUT MEMBER                                                          02660000
*                                                                       02670000
PUTMEM   EQU  *                                                         02680000
         BAL  R14,STARTLIB                                              02690000
         SPACE 3                                                        02700000
         BAL  R14,RESERVE          RESERVE LIBRARY BEFORE UPDATE        02710000
         SPACE 3                                                        02720000
*                                                                       02730000
*  OPEN THE MEMBER FOR UPDATE                                           02740000
*                                                                       02750000
         XC    USERDATA,USERDATA       CLEAR STATISTICS          WM1161 02760000
         MVI   ISPSTATY,C'N'           ASSUME NO STATISICS       WM1161 02820000
         L     R6,PRMPRM#              ADDRESS OF PARAMETERS #   WM1161
         LTR   R6,R6                                             WM1161
         BZ    SKIPREPL                                          WM1161
         CLC   0(4,R6),=F'17'          PRMSTAT PRESENT?          WM1161
         BL    SKIPREPL                                          WM1161
         CLC   0(4,R6),=F'164'         AREN'T THEY TOO NUMEROUS? WM1161
         BH    SKIPREPL              THEY ARE. LOOKS SUSPICIOUS. WM1161
         MVI   ISPSTATY,C'Y'           INDICATE STATISICS NEEDED WM1161 02820000
SKIPREPL DS    0H                                                WM1161
         L     R1,PRMMEM                                                02770000
         MVC   MEMBERW,0(R1)                                            02780000
         L     R6,PRMPUTOP                                              02790000
         CLI   0(R6),C'A'                                               02800000
         BE    OPENOUT           IF ADD MEMBER                          02810000
         CLI   ISPSTATY,C'Y'           DEAL WITH ISPF STATS ?    WM1161 02820000
         BNE   SKIPSTT1                NO: SKIP STATISTICS       WM1161 02830000
         CTSGISTT MEM=MEMBERW,DD=DDNAMEW,DATA=USERDATA           WM1161 02840000
SKIPSTT1 EQU   *                                                 WM1161 02850000
         CALLIB (BLDLM,0,MEMBERW,0,DDNAMEW,(6))                  WI0847 02860000
*  PRTDBG 'RC FROM BLDL MEM UPDATE #',(?R15)                            02870000
         LIBRC OPENOUT,RC60,UNEXPOP,INVPARM,MISSING,INVCOD,            *02880000
               INVCOD,INVCOD,INVCOD,INVCOD,STAERR,ACT=BLDLM        W434 02890000
OPENOUT  EQU   *                                                        02900000
         CALLIB (OMEMOUT,0,MEMBERW,0,DDNAMEW,(6))                WI0847 02910000
*  PRTDBG 'RC FROM OPEN MEM UPDATE #',(?R15)                            02920000
         LIBRC OKMEMOP2,ERROR354,UNEXPOP,INVPARM,MISSING,INVCOD,       *02930000
               INVCOD,INVCOD,INVCOD,INVCOD,STAERR,ACT=OMEMOUT           02940000
OKMEMOP2 EQU   *                                                        02950000
         SPACE 3                                                        02960000
*                                                                       02970000
*   WRITE CARDS ONE BY ONE                                              02980000
*                                                                       02990000
         L     R1,PRMLINE#                                              03000000
         ICM   R5,B'1111',0(R1)   MAXIMUM LINES TO WRITE                03010000
         BZ    ENDPUT                                                   03020000
         BM    INVPARM                                                  03030000
         L     R8,PRMOUT  OUTPUT ADDRESS                                03040000
LOOP4P   EQU   *                                                        03050000
*    PRTDBG 'CALLING PUT MEM  _ DDNAME "_"',(MEMBERW,8,DDNAMEW,8)       03060000
         CALLIB (PUT,0,MEMBERW,(8),DDNAMEW)                      WI0847 03070000
*    PRTDBG 'PUT RC=#',(?R15)                                           03080000
         LIBRC  OKPUT,UNEXPGET,UNEXPGET,INVPARM,MISSING,INVCOD,INVCOD, *03090000
               INVCOD,INVCOD,INVCOD,STAERR,RC64,                       *03100000
               ACT=PUT                                                  03110000
         SPACE 3                                                        03120000
*                                                                       03130000
*   EDIT CARD TO OUTPUT AREA                                            03140000
*                                                                       03150000
OKPUT    EQU   *                                                        03160000
         L     R1,PRMLISTP                                              03170000
         CLI   0(R1),C'D'           A DOUBLE POINTER LIST ???           03180000
         BE    DLIST2               YES HANDLE (NO- VECTOR)             03190000
         CLI   INFRECFM,C'F'                                      W434  03200000
         BNE   RECVW                                              W434  03210000
         AH    R8,INFLRECL                                        W434  03220000
         B     LOOP4PC                                                  03230000
RECVW    AH    R8,0(R8)                                           W434  03240000
         B     LOOP4PC                                                  03250000
DLIST2   S     R8,=F'4'             NEXT IN LIST                        03260000
         L     R8,0(R8)                                                 03270000
         LA    R8,8(R8)             POSITION ON NEXT ONE                03280000
LOOP4PC  BCT   R5,LOOP4P                                                03290000
         SPACE 3                                                        03300000
*                                                                       03310000
*   FINISH WITH MEMBER CLOSE IT                                         03320000
*                                                                       03330000
ENDPUT   EQU   *                                                        03340000
         XC    XMEMBER,XMEMBER                                          03350000
         MVC   XMEMBER(8),MEMBERW                                       03360000
         L     R6,PRMPUTOP                                              03370000
         CALLIB (CMEMOUT,0,0,XMEMBER,DDNAMEW,(6))                WI0847 03380000
         LIBRC UPDSTAT,ERROR354,UNEXPOP,INVPARM,MISSING,INVCOD,INVCOD, *03390000
               INVCOD,INVCOD,INVCOD,STAERR,RC64,RC52,                  *03400000
               ACT=CMEMOUT        USED2B :"MAYB64, *" - BM203           03410000
UPDSTAT  EQU   *                                                 WM1161 03420000
         CLI   ISPSTATY,C'Y'           DEAL WITH ISPF STATS?     WM1161 03430000
         BNE   RC0                     NO: SKIP STATISTICS       WM1161 03440000
         LA    R5,USERDATA             R5-> OLD USER DATA        WM1161 03450000
         USING CTSISPFD,R5             ESTABLISH ADDRESSABILITY  WM1161 03460000
         L     R6,PRMUSRID             R6-> USERID IN CONTROL    WM1161 03470000
         MVC   ISPID,0(R6)             SET NEW USER ID           WM1161 03480000
         TR    ISPID,ZER2BLTB          TRANSLATE ZEROS TO BLANKS WM1161 03490000
         MVC   ISPRESV2,=C'  '         SET LAST TWO BLANKS       WM1161 03500000
         MVC   ISPMEMNA,MEMBERW        NO: SET MEMBER NAME       WM1161 03510000
         XR    R6,R6                   ZERO R6 FOR IC            WM1161 03520000
         IC    R6,ISPMM                R6=MODIFICATION LEVEL     WM1161 03530000
         LA    R6,1(R6)                ADD ONE TO MOD LEVEL      WM1161 03540000
         STC   R6,ISPMM                SAVE NEW MOD LEVEL        WM1161 03550000
         L     R6,PRMLINE#             R6-> # OF LINE TO UPDATE  WM1161 03560000
         MVC   ISPSIZE,2(R6)           SET MEMBER SIZE           WM1161 03570000
         XC    ISPMOD,ISPMOD           SET MOD FIELD TO 0        WM1161 03580000
         TIME  ,                                                        03590000
         STCM  R0,B'1100',ISPTHH       SET TIME OF CHANGE        WM1161 03600000
         ST    R1,ISPCHNGD             SET LAST CHANGED DATE     WM1161 03610000
         CLI   ISPINDIC,ISPSTATE       STATISTICS EXIST ?        WM1161 03620000
         BE    OLDEXIST                YES: NO NEED TO RECREATE  WM1161 03630000
         ST    R1,ISPCREAT             SET CREATION DATE         WM1161 03640000
         MVI   ISPINDIC,ISPSTATE       SET USER DATA LENGTH      WM1161 03650000
         MVI   ISPVV,X'01'             SET VERSION NUMBER TO 1   WM1161 03660000
         MVC   ISPINIT,ISPSIZE         SET INIT SIZE             WM1161 03670000
         MVI   ISPMM,X'01'             SET MM NUMBER TO 1        WM1161 03680000
         XC    ISPMOD,ISPMOD           SET MOD TO 0              WM1161 03690000
OLDEXIST EQU   *                                                 WM1161 03700000
         L     R6,PRMSTAT              ADDRESS OF REPLY FIELD    WM1161
         MVC   0(80,R6),USERDATA       MOVE USERDATA TO CALLER   WM1161 03450000
         CTSPISTT MEM=MEMBERW,DD=DDNAMEW,DATA=USERDATA           WM1161 03710000
         LIBRC RC0,RC0,RC0,RC52,RC52,RC28,RC8,ACT=PUTUDAT        WM1161 03720000
*>>>>                                                                   03721000
         SPACE 3                                                        03722000
*                                                                       03723000
*   STAE HAS CAUGHT AN ABEND                                            03724000
*                                                                       03725000
STAERR   EQU  *                                                         03726000
         L    R6,PRMABEND        ADDRESS OFF ABEND CODE                 03727000
         LTR  R6,R6              IS THE PARAM DEFINED ?        BM1608   03728000
         BE   SKIPST             NO, DO NOT KEEP IT            BM1608   03729000
         ST   R0,0(R6)                                                  03730000
SKIPST   EQU  *                                                BM1608   03740000
         CALLIB (EMRCLOSE,0,0,XMEMBER,DDNAMEW)                   WI0847 03750000
    PRTDBG 'EMRCLOSE RC=# DDNAME "_" MEM _',(?R15,DDNAMEW,8,XMEMBER,8)  03760000
         B    RC56                                                      03770000
         SPACE 3                                                        03780000
*                                                                       03790000
*   MAY BE WE SHOULD ISSUE RC64                                         03800000
*                                                                       03810000
*MAYB64   EQU  *                                                  BM203 03820000
*         CLI  0(R6),C'A'         CREATE A NEW TABLE              BM203 03830000
*         BE   RC64                                               BM203 03840000
*         B    RC0                                                BM203 03850000
*         EJECT                                                   BM203 03860000
*                                                                IM0384 03870000
*   DELETE MEMBER                                                IM0384 03880000
*                                                                IM0384 03890000
DELMEM   EQU  *                                                  IM0384 03890100
         BAL  R14,STARTLIB                                       IM0384 03890200
         BAL  R14,RESERVE          RESERVE LIBRARY BEFORE UPDATE IM0384 03890300
         SPACE 3                                                 IM0384 03890400
*                                                                IM0384 03890500
*  OPEN THE MEMBER FOR UPDATE                                    IM0384 03890600
*                                                                IM0384 03890700
         L     R1,PRMMEM                                         IM0384 03890800
         MVC   MEMBERW,0(R1)                                     IM0384 03890900
         CALLIB (BLDLM,0,MEMBERW,0,DDNAMEW,0)                    WI0847 03891000
         LIBRC DELMBL,RC60,UNEXPOP,INVPARM,MISSING,INVCOD,       IM0384*03891100
               INVCOD,INVCOD,INVCOD,INVCOD,STAERR,ACT=BLDLM      IM0384 03891200
DELMBL   EQU   *                                                 IM0384 03891300
         CALLIB (DMEMOUT,0,MEMBERW,0,DDNAMEW,0)                  WI0847 03891400
         LIBRC OKMEMDEL,ERROR354,UNEXPOP,INVPARM,MISSING,INVCOD, IM0384*03891500
               INVCOD,INVCOD,INVCOD,INVCOD,STAERR,ACT=DMEMOUT    IM0384 03891600
OKMEMDEL EQU  *                                                  IM0384 03891700
         B    RC0                                                IM0384 03891800
         EJECT                                                   IM0384 03891900
*                                                                       03892000
*   INIT MEMBER                                                         03893000
*                                                                       03894000
INITMEM  EQU  *                                                         03895000
         TM   STATFLAG,$MEMOPEN                                  BI1018 04170000
         BZ   INITLB                                             BI1018
         CALLIB (CLOSEMEM,0,0,0,DDNAMEW)                         BI1018 04150000
         NI   STATFLAG,X'FF'-$MEMOPEN                            BI1018 04170000
INITLB   BAL  R14,STARTLIB                                              03896000
         BAL  R14,STARTMEM                                              03897000
         B    RC0                                                       03898000
         EJECT                                                          03899000
*                                                                       03900000
*   GET LINE OF MEMBER                                                  03910000
*                                                                       03920000
GETLINE  EQU  *                                                         03930000
         BAL  R14,STARTLIB                                              03940000
         BAL  R14,STARTMEM                                              03950000
         SPACE 3                                                        03960000
*                                                                       03970000
*  READ THE CARD FROM THE MEMBER                                        03980000
*                                                                       03990000
         L     R8,PRMOUT                                                04000000
         CALLIB (GET,0,MEMBERW,(8),DDNAMEW)                      WI0847 04010000
         LIBRC  OKREAD2,EOF2,UNEXPGET,INVPARM,MISSING,INVCOD,          *04020000
               INVCOD,INVCOD,INVCOD,INVCOD,STAERR,ACT=GET          W434 04030000
         SPACE 3                                                        04040000
*                                                                       04050000
*   EDIT CARD TO OUTPUT AREA                                            04060000
*                                                                       04070000
OKREAD2  EQU   *                                                        04080000
         B     RC0                                                      04090000
         SPACE 3                                                        04100000
*                                                                       04110000
*   FINISH WITH MEMBER                                                  04120000
*                                                                       04130000
EOF2     EQU   *                                                        04140000
         CALLIB (CLOSEMEM,0,0,0,DDNAMEW)                         WI0847 04150000
    PRTDBG 'CLOSMEM RC=# DDNAME "_"',(?R15,DDNAMEW,8)                   04160000
         NI    STATFLAG,X'FF'-$MEMOPEN                                  04170000
         B     RC4                                                      04180000
         EJECT                                                          04190000
*                                                                       04200000
*   GET DIRECTORY OF MEMBER                                             04210000
*                                                                       04220000
DIRECTOR EQU  *                                                         04230000
         BAL  R14,STARTLIB                                              04240000
         SPACE 3                                                        04250000
*                                                                       04260000
*   CALL DIRECTORY FUNCTION                                             04270000
*                                                                       04280000
         L     R5,PRMLINE#                                              04290000
         L     R8,PRMOUT  OUTPUT ADDRESS                                04300000
         CALLIB (DIR,0,0,0,DDNAMEW,(8),(5))                      WI0847 04310000
         LTR   R15,R15                                                  04320000
         BZ    RC0                                                      04330000
         C     R15,=F'4'                                                04340000
         BE     RC48              MAXIMUM NUMBER OF LINES EXCEEDED      04350000
         B     RC52               OPEN ERROR                            04360000
         SPACE 3                                                        04370000
*                                                                WM1161 04200000
*   GET DIRECTORY WITH ISPF STATISTICS                           WM1161 04210000
*                                                                WM1161 04220000
DIRFULL  EQU  *                                                  WM1161 04230000
         BAL  R14,STARTLIB                                       WM1161 04240000
*                                                                WM1161 04260000
*   CALL DIRECTORY FUNCTION                                      WM1161 04270000
*                                                                WM1161 04280000
         L     R5,PRMLINE#                                       WM1161 04290000
         L     R8,PRMOUT  OUTPUT ADDRESS                         WM1161 04300000
         L     R14,PRMSIZE       AREA SIZE                       WM1161 04300000
         CALLIB (DIRF,0,0,0,DDNAMEW,(R8),(R5),(R14))             WI0847 04310000
         LTR   R15,R15                                           WM1161 04320000
         BZ    RC0                                               WM1161 04330000
         C     R15,=F'4'                                         WM1161 04340000
         BE     RC48           MAXIMUM NUMBER OF LINES EXCEEDED  WM1161 04350000
         B     RC52               OPEN ERROR                     WM1161 04360000
         SPACE 3                                                        04370000
*                                                                WM1161 04200000
*   GET MEMBER'S STATISTICS                                      WM1161 04210000
*                                                                WM1161 04220000
MEMSTAT  EQU  *                                                  WM1161 04230000
         BAL  R14,STARTLIB                                       WM1161 04240000
*                                                                WM1161 04270000
         XC    USERDATA,USERDATA       CLEAR STATISTICS          WM1161 02760000
         L     R1,PRMMEM                                                02770000
         MVC   MEMBERW,0(R1)                                            02780000
         CTSGISTT MEM=MEMBERW,DD=DDNAMEW,DATA=USERDATA           WM1161 02840000
         LTR   R15,R15                                           WM1161 04320000
         BZ    MEMSTOK                                           WM1161 04330000
         LA    R15,12          MEMBER NOT FOUND                  WM1161 04340000
         B     RETRC2                                            WM1161 04350000
MEMSTOK  L     R6,PRMSTAT              ADDRESS OF REPLY FIELD    WM1161
         MVC   0(80,R6),USERDATA       MOVE USERDATA TO CALLER   WM1161 03450000
         B     RC0                                               WM1161 04330000
         SPACE 3                                                 WM1161 04370000
*                                                                       04380000
*   FINISH WITH LIB (DSN)                                               04390000
*                                                                       04400000
ENDLIBDE EQU  *                                                         04410000
         B    RC0                                                       04420000
         TITLE '  INIT FOR DSN (LIBRARY)'                               04430000
*                                                                       04440000
*       CHECK WHETHER ALLOCATION IS NEEDED OR DEALLOCATION ETC..        04450000
*                                                                       04460000
STARTLIB EQU   *                                                        04470000
         ST    R14,SAVER14                                              04480000
         LA    R9,BADALLOC         IF DYNAMIC ALLOC FAILED              04490000
         L     R1,PRMDDNAM                                              04500000
         CLI   0(R1),0             DDNAME NULL ???                      04510000
         BE    DDALIBS             YES SET DEFAULT DDNAME (DALIBSXX)    04520000
         MVC   DDNAMEW,0(R1)                                            04530000
         B     DDCHID1                                                  04540000
DDALIBS  MVC   DDNAMEW,=CL8'DALIBSXX'                                   04550000
*                                                             W474      04560000
*        OVERIDE DDNAME WITH TCB ADDRESS                      W474      04570000
*                                                             W474      04580000
*        XR    R1,R1                                          W474      04590000
*        USING PSA,R1                                         W474      04600000
*        L     R1,PSATOLD            PIC  TCB ADDRESS         W474      04610000
*                                                                       04620000
*                                                            *B904      04630000
*        OVERIDE 6 RIGHTMOST BYTES OF DDNAME WITH TIME STAMP *B904      04640000
*        FIRST CALL TO THIS COPY OF CTMMEM                   *B904      04650000
*                                                            *B904      04660000
         CLC   TIMESTMP,=F'0'                                *B904      04670000
         BNE   TIMEDONE                                      *B904      04680000
         TIME  DEC                                           *B904      04690000
         ST    R0,TIMESTMP                                   *B904      04700000
TIMEDONE L     R1,TIMESTMP                                   *B904      04710000
         SLL   R1,4             LETS HAVE IT ROLLING FASTER  *B904      04720000
         LA    R15,DDNAMEW+2                                  W474      04730000
         LA    R14,6                                          W474      04740000
OVERLOOP SLL   R1,4                                           W474      04750000
         STCM  R1,B'0100',0(R15)    CONVERT IT TO PRINTABLES W474,B904  04760000
         OI    0(R15),X'F0'                                   W474      04770000
         CLI   0(R15),X'F9'                                   W474      04780000
         BNH   NOTCHAR                                        W474      04790000
         XR    R3,R3                                          W474      04800000
         ICM   R3,B'0001',0(R15)                              W474      04801000
         SH    R3,=X'0039'         CONVER FA-FF TO C1-C6      W474      04802000
         STCM  R3,B'0001',0(R15)                              W474      04802100
NOTCHAR  LA    R15,1(R15)                                     W474      04802200
         BCT   R14,OVERLOOP                                   W474      04802300
DDCHID   L     R1,PRMCHR2                                     W474      04802400
         MVC   DDNAMEW(2),0(R1)  SET DDNAME ID                W474      04802500
         CLI   DDNAMEW,X'F0'                                  W474      04802600
         BL    NOTNUM                                         W474      04802700
         MVI   DDNAMEW,C'Z'                                   W474      04802800
NOTNUM   CLI   DDNAMEW,C' '                                   W474      04802900
         BNE   NOTBL1                                         W474      04803000
         MVI   DDNAMEW,C'U'                                   W474      04803100
NOTBL1   CLI   DDNAMEW+1,C' '                                 W474      04803200
         BNE   DDNAMOK                                        W474      04803300
         MVI   DDNAMEW+1,C'Z'                                 W474      04803400
         B     DDNAMOK                                        W474      04803500
DDCHID1  DS    0H           BELLOW   ORIGINAL CODE BEFORE     W474      04803600
         CLI   LOADFL,X'FF'        IS IT DYNAMIC DDNAME ?        WI0847
         BE    DDNAMOK             DON'T SET CHID                WI0847
         L     R1,PRMCHR2                                               04803700
         MVC   DDNAMEW+6(2),0(R1)  SET DDNAME ID                        04803800
DDNAMOK  L     R1,PRMLIB                                                04804000
         MVC   DSNAMW,0(R1)        MOVE DSNAME TO BE ALLOCATED          04804100
         CLC   LASTW,NAMEW         LIBRARY OR DDNAME CHANGED ??         04804200
         BE    ENDSTDSN            NO - NO NEED TO ALLOCATE -EXIT       04804300
         TM    STATFLAG,$MEMOPEN   MEMBER OPEN ???                      04804400
         BZ    DEALOC1             NO - NO NEED TO CLOSE MEM            04804500
         CALLIB (CLOSEMEM,0,0,0,DDNAMEW)                         WI0847 04804600
    PRTDBG 'CLOSMEM RC=# DDNAME "_"',(?R15,DDNAMEW,8)                   04804700
         NI    STATFLAG,X'FF'-$MEMOPEN                                  04804800
DEALOC1  TM    STATFLAG,$DSNOPEN   DSN INITED ????                      04804900
         BZ    DEALOC2             NO - NO NEED TO END DSN              04805000
         CALLIB (ENDDSN,0,0,0,LASTDD)                            WI0847 04806000
    PRTDBG 'ENDDSN1 RC=# DDNAME "_"',(?R15,LASTDD,8)                    04807000
         NI    STATFLAG,X'FF'-$DSNOPEN                                  04808000
DEALOC2  TM    STATFLAG,$DSNALOC   SPECIAL ALLOCATION DONE ??           04809000
         BZ    DEALOC3             NO - NO NEED TO DEALLOCATE           04810000
         CLC   LASTLIB,=CL44' '                                         04820000
         BE    DEALOC2A            NO - NO NEED TO DEALLOCATE           04830000
         CALLIB (UNALLOC,LASTLIB,0,0,LASTDD)                     WI0847 04840000
    PRTDBG 'UNALLC2 RC=# DDNAME "_" LIB _',(?R15,LASTDD,8,LASTLIB,44)   04850000
DEALOC2A NI    STATFLAG,X'FF'-$DSNALOC                                  04860000
DEALOC3  MVC   LASTW,=CL52' '      CLEAN LAST DDNAME AND DSNAME         04870000
         CLC   DSNAMW,=CL44' '     NO DSN - BY ALLOCATED DD NAME !!     04880000
         BE    MOVEDD2                                                  04890000
         SPACE 3                                                        04900000
*                                                                       04910000
*       ALLOC  DYNAMICALY  NEW  LIBRARY                                 04920000
*                                                                       04930000
ALLOCDO  CALLIB (ALLOC,DSNAMW,0,0,DDNAMEW,0)                     WI0847 04940000
    PRTDBG 'ALLOC RC=# DDNAME "_" LIB _',(?R15,DDNAMEW,8,DSNAMW,44)     04950000
         LIBRC     MOVEDD,NOTCATLG,INUSE,INVPARM,MISSING,INVCOD,       *04960000
               UNEXPAL,UNEXPAL,UNEXPAL,UNEXPAL,STAERR,ACT=ALLOC   W434  04970000
         EJECT                                                          04980000
*                                                                       04990000
***     INIT   ALLOCATTED DSNAME                                        05000000
*                                                                       05010000
MOVEDD   EQU       *                                                    05020000
         OI    STATFLAG,$DSNALOC                                        05030000
MOVEDD2  MVC   LASTLIB,DSNAMW                                           05040000
         MVC   LASTDD,DDNAMEW                                           05050000
         TM    STATFLAG,$DSNOPEN                                        05060000
         BO    ENDSTDSN                                                 05070000
MOVEDD1  LA    R9,BADINIT         IF ANY  BAD  GO UNALLOC LIB           05080000
         CALLIB (INITDSN,0,0,0,DDNAMEW)                          WI0847 05090000
    PRTDBG 'INITDSN RC=# DDNAME "_"',(?R15,DDNAMEW,8)                   05100000
         LIBRC INFLIB1,           00                            B321   *05110000
               INITDSN1,          04                            B321   *05120000
               UNEXPDSN,          08                            B321   *05130000
               INVPARM,           12                            B321   *05140000
               MISSING,           16                            B321   *05150000
               INVCOD,            20                            B321   *05160000
               TOOMANY,           24                            B321   *05170000
               INVCOD,            28      NEW       CHECK       B321   *05180000
               INVCOD,            32      NEW         "         B321   *05190000
               INVCOD,            36      NEW         "         B321   *05200000
               ABENDI,            56      NEW    UNEXPAL, 40    B1514  *05210000
               INVCOD,            44      NEW         "         B321   *05220000
               ACT=INITDSN                                              05230000
         EJECT                                                          05240000
INFLIB1  EQU       *                                                    05250000
*                                                                       05260000
* CHECK  DSNAME IS LIBRARY,RECFM AND LRECL                              05270000
*                                                                       05280000
         BAL   R10,CHECKLIB       IF ANY THING WRONG JUMPING TO "NEXTS" 05290000
         OI    STATFLAG,$DSNOPEN                                        05291000
ENDSTDSN L     R14,SAVER14                                              05292000
         BR    R14                                                      05293000
         SPACE  3                                                       05294000
*                                                                       05295000
*  IF  FAILED   IN  INIT  DSN  OR   NOT  LIBRARY THEN ENDDSN            05296000
*              AND  DALLOC FILE                                         05297000
ABENDI   MVC    RC,=F'56'                                        B1514  05297100
BADINIT  EQU    *                                                       05297200
         CALLIB (ENDDSN,0,0,0,LASTDD)                            WI0847 05297300
    PRTDBG 'ENDDSN RC=# DDNAME "_"',(?R15,LASTDD,8)                     05297400
         NI    STATFLAG,X'FF'-$DSNOPEN                                  05297500
BADLIB   EQU    *                                                       05297600
         TM    STATFLAG,$DSNALOC                                        05297700
         BZ    BADLIBAA                                                 05297800
         CALLIB (UNALLOC,LASTLIB,0,0,LASTDD)                     WI0847 05297900
    PRTDBG 'UNALLC RC=# DDNAME "_" LIB _',(?R15,LASTDD,8,LASTLIB,44)    05298000
         NI    STATFLAG,X'FF'-$DSNALOC                                  05299000
BADLIBAA NI    STATFLAG,X'FF'-$DSNOPEN                                  05300000
         MVC   LASTLIB,=CL44' '                                         05310000
         B     RETRC                                                    05320000
         TITLE   'INIT ON MEMBER IN LIBRARY'                            05330000
*                                                                       05340000
*  OPEN THE MEMBER                                                      05350000
*                                                                       05360000
STARTMEM EQU   *                                                        05370000
         ST    R14,SAVER14                                              05380000
         TM    STATFLAG,$MEMOPEN                                        05390000
         BO    ENDSTMEM                                                 05400000
         L     R1,PRMMEM                                                05410000
         MVC   MEMBERW,0(R1)                                            05420000
         CALLIB (OPENMEM,0,MEMBERW,0,DDNAMEW)                    WI0847 05430000
   PRTDBG 'RC FROM OPEN MEM # DDNAME _',(?R15,DDNAMEW,8)                05440000
         LIBRC OKMEMOP,ERROR354,UNEXPOP,INVPARM,MISSING,INVCOD,        *05450000
               ERROR354,       24                               B263   *05460000
               ERROR354,       28                               B263   *05470000
               ERROR354,       32                               B263   *05480000
               ERROR354,       36                               B263   *05490000
               STAERR,         40    STAE ENCOUNTED             B263   *05500000
               ERROR354,       44                               B263   *05510000
               ACT=OPENMEM                                              05520000
         SPACE 3                                                        05530000
OKMEMOP  OI    STATFLAG,$MEMOPEN                                        05540000
ENDSTMEM L     R14,SAVER14                                              05550000
         BR    R14                                                      05550100
*                                                                       05550200
*  RESERVE LIBRARY BEFORE START OF UPDATE                               05550300
*                                                                       05550400
RESERVE  EQU   *                                                        05550500
         ST    R14,SAVER14                                              05550600
         CLI   RESERVED,C'Y'       DATA SET RESERVED                    05550700
         BE    RESRVER1                                                 05550800
         SR    R6,R6               CLEAN REG FOR WORK                   05550900
         EXTRACT ADDRTIOT,FIELDS=TIOT                                   05551000
         L     R8,ADDRTIOT         ADDR OF TASK IO TABLE                05551100
         LA    R8,24(R8)           ADDR OF FIRST DD ENTRY               05551200
NEXTTIDD CLC   4(8,R8),DDNAMEW     IS IT OUR DDNAME ???                 05551300
         BE    FINDUCB             YES - FIND THE UCB                   05551400
         IC    R6,0(R8)            LENGTH OF DD ENTRY                   05551500
         LA    R8,0(R6,R8)         ADDR OF NEXT DD ENTRY                05551600
         CLC   0(4,R8),=F'0'       END OF TIOT ???                      05551700
         BNE   NEXTTIDD                                                 05551800
    PRTDBG ' DDNAME _ NOT IN TIOT',(DDNAMEW,8)                          05551900
         B     BADTIOT             ERROR - DDNAME NOT FOUND IN TIOT     05552000
FINDUCB  LA    R8,16(R8)           ADDR OF WORD IN TIOT THAT CONTAINS   05552100
*                                  ADDR OF UCB                          05552200
         ST    R8,UCBADDR                                               05552300
         MVC   LASTRSV,LASTLIB                                          05552400
         RESERVE (SPFEDIT,LASTRSV,E,44,SYSTEMS),UCB=(R8),RET=HAVE       05552500
   PRTDBG ' RESREV RC=# DSN=_',(?R15,LASTRSV,44)                        05552600
         LTR   R15,R15                                                  05552700
         BNZ   RESRVERR                                                 05552800
         MVI   RESERVED,C'Y'       MARK DATA SET RESERVED               05552900
         L     R14,SAVER14                                              05553000
         BR    R14                                                      05553100
         SPACE 3                                                        05553200
         TITLE '    ERROR HANDLING  '                                   05553300
*                                                                       05553400
*   OPEN / DELETE (STOW) FAILED FOR CERTAIN MEMBER               IM0384 05553500
*                                                                       05553600
ERROR354 EQU   *                                                        05553700
         LA    R15,12                                                   05553800
         ST    R15,RC                                                   05553900
         B     RETRC                                                    05554000
         SPACE 3                                                        05555000
*                                                                       05556000
***      "MITLIB'  IS  NOT A LIBRARY                                    05557000
*                                                                       05558000
ERROR356 EQU   *                                                        05559000
         MVC   RC,=F'16'                                                05560000
         BR   R9                                                        05570000
         SPACE 3                                                        05580000
*                                                                       05590000
***      "MITLIB'  IS  NOT FIXED   LIBRARY                              05600000
*                                                                       05610000
ERROR357 EQU    *                                                       05620000
         MVC   RC,=F'20'                                                05630000
         BR   R9                                                        05640000
         SPACE 3                                                        05650000
*                                                                       05660000
***      "MITLIB'  LRECL  IS NOT 80                                     05670000
*                                                                       05680000
ERROR358 EQU    *                                                       05690000
         MVC   RC,=F'24'                                                05700000
         BR   R9                                                        05710000
         SPACE 3                                                        05720000
*                                                                       05730000
ERROR359 EQU    *                                                       05740000
         MVC   RC,=F'68'                                                05750000
         BR   R9                                                        05760000
         SPACE 3                                                        05770000
*                                                                       05780000
***       DSNAME  ALREADY IN USE   TRY   LATER                          05790000
*                                                                       05800000
INUSE    EQU   *                                                        05810000
         MVC   RC,=F'28'                                                05820000
         BR   R9                                                        05830000
         SPACE 3                                                        05840000
*                                                                       05850000
***      IF  DYNAMIC  ALLOCATION  FAILED  THEN  SET  LASTLIB TO BLANKS  05860000
*                                                                       05870000
BADALLOC EQU   *                                                        05880000
         MVC   LASTLIB,=CL44' '                                         05890000
         B     RETRC                                                    05900000
         SPACE   3                                                      05910000
*                                                                       05920000
***     INIT  OF  LIB FAILED                                            05930000
*                                                                       05940000
INITDSN1 EQU   *                                                        05950000
         MVC   RC,=F'32'                                                05960000
         ICM   R15,B'1110',=C'IDS'                                      05970000
         ST    R15,SUBRC                                                05980000
         BR   R9                                                        05990000
         SPACE 3                                                        06000000
*                                                                       06010000
*** PARAMETR  MISSING                                                   06020000
*                                                                       06030000
MISSING   EQU   *                                                       06040000
         MVC   RC,=F'32'                                                06050000
         ICM   R15,B'1110',=C'MIS'                                      06060000
         ST    R15,SUBRC                                                06070000
         BR   R9                                                        06080000
         SPACE  3                                                       06090000
*                                                                       06100000
*** INVALID  PARM                                                       06110000
*                                                                       06120000
INVPARM   EQU   *                                                       06130000
         MVC   RC,=F'32'                                                06140000
         ICM   R15,B'1110',=C'PRM'                                      06150000
         ST    R15,SUBRC                                                06160000
         BR   R9                                                        06170000
*                                                                       06180000
*** INVALID  REQUEST   FROM  CTMLIB                                     06190000
*                                                                       06200000
INVCOD    EQU   *                                                       06210000
         MVC   RC,=F'32'                                                06220000
         ICM   R15,B'1110',=C'COD'                                      06230000
         ST    R15,SUBRC                                                06240000
         BR   R9                                                        06250000
         SPACE 3                                                        06260000
*                                                                       06270000
*** MORE  THEN  MAXLIB  LIBRARIES                                       06280000
*                                                                       06290000
TOOMANY   EQU   *                                                       06300000
         MVC   RC,=F'32'                                                06310000
         ICM   R15,B'1110',=C'MAX'                                      06320000
         ST    R15,SUBRC                                                06330000
         BR   R9                                                        06340000
         SPACE  3                                                       06350000
*                                                                       06360000
***       DSNAME CANNOT BE ALLOCATED : NOT CATALOGED                    06370000
*                                                                       06380000
NOTCATLG  EQU  *                                                        06390000
         MVC   RC,=F'36'                                                06400000
         BR   R9                                                        06410000
         SPACE 3                                                        06420000
*                                                                       06430000
**        SOME THING BAD HAPPANED  DURING DAYNAMIC ALLOCATION           06440000
*                                                                       06450000
UNEXPAL  EQU   *                                                        06460000
         MVC   RC,=F'40'                                                06470000
*        CVD  R15,DOUBLE                                        W0434   06480000
*        OI   DOUBLE+7,15                                       W0434   06490000
*        UNPK W+8+11(2),DOUBLE                                  W0434   06500000
*W       WTO  'CTMMEM: RC=.. FROM CTMLIB'                       W0434   06510000
         BR   R9                                                        06520000
*DOUBLE   DS   D W0434                                                  06530000
         SPACE   3                                                      06540000
*                                                                       06550000
**        SOME THING BAD HAPPANED  WHILE INIT A LIBRARY                 06560000
*                                                                       06570000
UNEXPDSN  EQU   *                                                       06580000
         MVC   RC,=F'32'                                                06590000
         ICM   R15,B'1110',=C'UXD'                                      06600000
         ST    R15,SUBRC                                                06610000
         BR   R9                                                        06620000
         SPACE   3                                                      06630000
*                                                                       06640000
**        SOME THING BAD HAPPANED  WHEN   OPENNING A LIBRARY            06650000
*                                                                       06660000
UNEXPOP   EQU   *                                                       06670000
         MVC   RC,=F'32'                                                06680000
         ICM   R15,B'1110',=C'UXO'                                      06690000
         ST    R15,SUBRC                                                06700000
         BR    R9                                                       06710000
          SPACE   3                                                     06720000
*                                                                       06730000
**        SOME THING BAD HAPPANED  WHILE  GETTING MEMBER'               06740000
*                                                                       06750000
UNEXPGET  EQU   *                                                       06760000
         MVC   RC,=F'32'                                                06770000
         ICM   R15,B'1110',=C'UXG'                                      06780000
         ST    R15,SUBRC                                                06790000
         BR    R9                                                       06800000
         SPACE   3                                                      06810000
*                                                                       06820000
*  DDNAME NOT FOUND IN TIOT TABLE                                       06830000
*                                                                       06840000
BADTIOT  EQU   *                                                        06850000
         MVC   RC,=F'32'                                                06860000
         ICM   R15,B'1110',=C'TIO'                                      06870000
         ST    R15,SUBRC                                                06880000
         B     RETRC                                                    06890000
         SPACE   3                                                      06900000
*                                                                       06910000
*  INTERNAL ERROR - WE ARE IN RESERVE                                   06920000
*                                                                       06930000
RESRVER1 EQU   *                                                        06940000
         MVC   RC,=F'32'                                                06950000
         ICM   R15,B'1110',=C'RS1'                                      06960000
         ST    R15,SUBRC                                                06970000
         B     RETRC                                                    06980000
         SPACE   3                                                      06990000
*                                                                       07000000
*  INTERNAL SYSTEM ERROR - RESERVE FAILED                               07010000
*                                                                       07020000
RESRVERR EQU   *                                                        07030000
         MVC   RC,=F'32'                                                07040000
         ICM   R15,B'1110',=C'RSV'                                      07050000
         ST    R15,SUBRC                                                07060000
         B     RETRC                                                    07070000
         SPACE   3                                                      07080000
*                                                                       07090000
*  RETURN WITH SUBCODE                                                  07100000
*                                                                       07110000
RETRC    EQU   *                                                        07120000
         L     R15,RC                                                   07130000
RETRC2   L     R1,PRMRC                                                 07140000
         ST    R15,0(R1)           RETURN RC IN FIELD                   07150000
         SPACE   3                                                      07160000
*                                                                       07170000
*  SEE IF WE ARE UNDER RESERVE - IF YES THEN DEQ IT                     07180000
*                                                                       07190000
         CLI   RESERVED,C'Y'       ARE WE UNDER RESEREVE                07200000
         BNE   NODEQ                                                    07210000
         L     R8,UCBADDR                                               07220000
         DEQ   (SPFEDIT,LASTRSV,44,SYSTEMS),UCB=(R8)                    07230000
         MVI   RESERVED,C'N'                                            07240000
NODEQ    L     R1,PRMRC                                                 07250000
         L     R15,0(R1)           RETURN RC IN FIELD                   07260000
         L     R0,SUBRC                                                 07270000
         L     13,4(0,13)                                               07280000
         L     14,12(13,0)                                              07290000
         LM    1,12,24(13)                                              07300000
         MVI   12(13),X'FF'                                             07310000
         BR    14                                                       07320000
RC0      SR    R15,R15                                                  07330000
         B     RETRC2                                                   07340000
RC4      LA    R15,4                                                    07350000
         B     RETRC2                                                   07360000
RC8      LA    R15,8                                                    07370000
         B     RETRC2                                                   07380000
RC28     LA    R15,28                                            WM1161 07390000
         B     RETRC2                                                   07400000
RC44     LA    R15,44                                                   07410000
         B     RETRC2                                                   07420000
RC48     LA    R15,48                                                   07430000
         B     RETRC2                                                   07440000
RC52     LA    R15,52                                                   07450000
         B     RETRC2                                                   07460000
RC56     LA    R15,56                                                   07470000
         B     RETRC2                                                   07480000
RC60     LA    R15,60                                                   07490000
         B     RETRC2                                                   07500000
RC64     LA    R15,64                                                   07510000
         B     RETRC2                                                   07520000
RC68     LA    R15,68                                                   07530000
         B     RETRC2                                                   07540000
         TITLE    'CHECK VALIDITY OF A DSN'                             07550000
*                                                                       07560000
***      CHECK IF A DSN IS LIBRARY                                      07570000
*                                                                       07580000
****  ASSUMED :  DDNAMW  HAS  VALUE OF DDNAME  ALLOCATED TO DSNAME      07590000
         SPACE   3                                                      07600000
CHECKLIB  EQU   *                                                       07610000
*    PRTDBG 'CALLING INFO DD _',(DDNAMEW,8)                             07620000
         XC     INFC,INFC                                               07630000
         CALLIB (INFO,0,0,INFC,DDNAMEW)                          WI0847 07640000
*        CHECK   DSORG                                                  07650000
         SPACE  3                                                       07660000
         MVC    DSNAMW,INFDSNAM       FOR  ERROR  MESSAGES              07670000
*                                                                       07680000
         CLC    =C'PO',INFDSORG   LIBRARY?                              07690000
         BNE    ERROR356                                                07700000
*        CHECK  RECFM                                                   07710000
         ICM    R14,15,PRMDESC                                    W434  07720000
         BNE    CHDESC                                            W434  07730000
         CLI    INFRECFM,C'F'     FIX ?                                 07740000
         BNE    ERROR357                                                07750000
*        CHECK  LRECL                                                   07760000
         CLC    INFLRECL,=H'80'     LRECL 80                            07770000
         BNE    ERROR358                                                07780000
*                                                                       07790000
***      ALL  VALIDITY  CHECK PASSED , RETURN TO CALLER                 07800000
*                                                                       07810000
         DROP   R1                                                      07820000
         BR     R10             RETURN  TO CALLER                       07830000
         USING PRMDESCF,R14                                       W434  07840000
CHDESC   MVC   PRMDRLR,INFLRECL                                   W434  07850000
         MVC   PRMDRRF,INFRECFM                                   W434  07860000
         CLI   PRMDURF,C' '                                       W434  07870000
         BER   R10                                                W434  07880000
         CLC   PRMDURF,PRMDRRF                                    W434  07890000
         BNE   ERROR359                                           W434  07900000
         BR    R10                                                W434  07910000
         SPACE 3                                                        07920000
         TITLE '  CONSTANTS  '                                          07930000
         SPACE 3                                                        07940000
         SPACE 3                                                        07950000
         DS    0F                                                       07960000
TIMESTMP DC    F'0'                                                     07970000
NOJOBS   DS    F                                                        07980000
*CARD     DS    CL80                                                    08010000
INFC     DS    CL80       USED  BY  INFO  ROUTINE                       08020000
BLANK    DC    CL32' '                                                  08030000
MEMBERW  DS    CL8        KEEPING MEMBER NAME FOR SOME TIME             08031000
DSNUM    DS    H          DSNAMES SO FAR                                08032000
VECDSN   DS    2A         LENGTH AND ADDR OF TABLES                     08033000
ENDTAB   DS    A          END OF TABLE                                  08034000
ADDRTIOT DS    A                                                        08035000
DALIBN   DC    CL8'DALIB' NAME OF GENERAL LIBRARY                       08036000
DALIB1   DC    CL8'DALIB1'                                              08037000
XMEMBER  DC    CL12' '                                                  08038000
ENTLN    DS    F          LENGTH OF A SINGLE DSNAME ENTRY               08039000
LASTW    DS    CL52                                                     08040000
         ORG   LASTW                                                    08050000
LASTDD   DC    CL8' '              LAST ALLOCATED DDNAME                08060000
LASTLIB  DC    CL44' '             LAST ALLOCATED DSNAME                08070000
         ORG                                                            08080000
SAVESEND DS    18F                                                      08090000
CODE     DS    CL8                                                      08100000
LASTRSV  DS    CL44                                                     08110000
SPFEDIT  DC    CL8'SPFEDIT'                                             08120000
PROCT1   DC    CL4' '                                                   08130000
RESERVED DC    C'N'                                                     08140000
STATFLAG DC    X'00'                                                    08150000
$INIT    EQU   X'01'                                                    08160000
$MEMOPEN EQU   X'02'                                                    08170000
$DSNOPEN EQU   X'04'                                                    08180000
$DSNALOC EQU   X'08'                                                    08190000
$DYDDNAM EQU   X'10'                                                    08200000
SAVER14  DS    F                                                        08210000
UCBADDR  DS    A                                                        08220000
RC       DS    F                                                        08230000
SUBRC    DS    F                                                        08240000
NAMEW    DS    CL52                                                     08250000
         ORG   NAMEW                                                    08260000
DDNAMEW  DC    CL8'DALIBSXX'                                            08270000
DSNAMW   DS    CL44           KEEPING DSNAME FOR SOME TIME              08280000
         ORG                                                            08290000
MAXCFLAG DS    X                                                 WM1643
ADDQD    DC    CL8'ADDQD'                                               08300000
         ACT   ALLOC                                                    08310000
         ACT   UNALLOC                                                  08320000
         ACT   INIT                                                     08330000
         ACT   INITDSN                                                  08340000
         ACT   GET                                                      08350000
         ACT   OPENMEM                                                  08360000
         ACT   CLOSEMEM                                                 08370000
         ACT   PUT                                                      08380000
         ACT   BLDLM                                                    08390000
         ACT   OMEMOUT                                                  08400000
         ACT   CMEMOUT                                                  08400100
         ACT   DMEMOUT                                           IM0384 08400200
         ACT   EMRCLOSE                                                 08400300
         ACT   ENDDSN                                                   08400400
         ACT   DIR                                                      08400500
         ACT   DIRF                                              WM1161 08400500
         ACT   INFO                                                     08400600
         ACT   FIN                                                      08400700
FUNCTAB  DS    0F                                                       08400800
         DC    CL8'GETMEM',A(GETMEM)                                    08400900
         DC    CL8'PUTMEM',A(PUTMEM)                                    08401000
         DC    CL8'DELMEM',A(DELMEM)                             IM0384 08402000
         DC    CL8'INITMEM',A(INITMEM)                                  08403000
         DC    CL8'GETLINE',A(GETLINE)                                  08404000
         DC    CL8'DIRECTOR',A(DIRECTOR)                                08405000
         DC    CL8'DIRFULL',A(DIRFULL)                           WM1161 08405000
         DC    CL8'ENDLIBDE',A(ENDLIBDE)                                08406000
         DC    CL8'FINISH',A(FINISH)                                    08407000
         DC    CL8'MEMSTAT',A(MEMSTAT)                                  08407000
FNCTBEND EQU *                                                          08408000
         WXTRN CTSALIB                                           WI0847
CTMLIBA  DC    V(CTSALIB)                                        WI0847
LOADFL   DC    X'0'           CTMLIB DYNAMIC LOAD FLAG           WI0847
LIBNAME  DC    CL8'CTSALIB'   NAME FOR LOAD/DELETE WITH SUFFIX   WI0847
PARMADDR DS    A                                                        08409000
         DC    C'ISPF STATISTICS=>'    EYE CATCHER               WM1161 08410000
ISPSTATY DC    C'Y'                    DEFAULT IS YES            WM1161 08420000
USERDATA DS    CL80                    STATISTICS OF ISPF        WM1161 08430000
USERDAT2 DS    CL80                    ENTRY AFTER STOW          WM1161 08440000
ZER2BLTB DC    256AL1(*-ZER2BLTB)      TRANSLATION TABLE TO ..   WM1161 08450000
         ORG   ZER2BLTB+X'00'          .. MAKE X'00' BLANK       WM1161 08460000
         DC    C' '                                              WM1161 08470000
         ORG   ,                                                 WM1161 08480000
         LTORG                                                    W434  08490000
         PRINT OFF                                                      08500000
         IHAPSA                                                         08510000
         CTSISPFD                                                       08520000
         END                                                            08530000

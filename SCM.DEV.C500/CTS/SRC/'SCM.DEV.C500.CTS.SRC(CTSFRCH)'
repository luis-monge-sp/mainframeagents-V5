         TITLE 'CHECK OBJECTS EXISTANCE IN THE RACF DATA BASE'          00010000
*        ALSO   CHECK FOR USER PROTECTED ATTRIBUTE /*PS0460*/           00020000
*        ALSO   CHECK FOR GROUP UNIVERSL ATTRIBUTE /*WS2427*/           00020100
         PRINT NOGEN                               /*PS0460*/           00020200
****************************************************************        00020300
****                                                        ****        00020400
****     CONTROL-SA  RELEASE 1.3.0                          ****        00020500
****                                                        ****        00020600
****     LICENCED MATERIAL - NEW DIMENSION SOFTWARE LTD.    ****        00020700
****                                                        ****        00020800
****************************************************************        00020900
*                                                                       00021000
****************************************************************        00022000
*                                                              *        00023000
* TITLE            : CTSFRCH                                   *        00024000
*                                                              *        00025000
* FILE NAME        : CTSFRCH                                   *        00026000
*                                                              *        00027000
* AUTHOR           : ALEX SHVARTSMAN                           *        00028000
*                                                              *        00029000
* CREATION DATE    : 01/04/94                                  *        00030000
*                                                              *        00040000
* DESCRIPTION      : CHECK RACF GROUP/USER EXISTANCE VIA       *        00050000
*                    RACF DATABASE ACCESS                      *        00060000
*                                                              *        00070000
* RETURN CODES     : VIA REG.15                                *        00080000
*                                                              *        00090000
*                    0   -  OBJECT EXISTS                      *        00100000
*                        -  IF USER ITS NOT PROTECTED   PS0460 *        00110000
*                        -  IF GROUP IS NOT UNIVERSAL   WS2427 *        00120000
*                    1   -  PROTECTED USER (NOPASSWORD) PS0460 *        00130000
*                        -  UNIVERSAL GROUP             WS2427 *        00140000
*                    4   -  OBJECT NOT EXISTS                  *        00150000
*                    8   -  OTHER ERRORS                       *        00160000
*                                                              *        00170000
*                                                              *        00180000
* ASSUMPTIONS AND                                              *        00190000
*   CONSIDERATIONS : CALLER MUST BE AUTHORIZED                 *        00200000
*                                                              *        00210000
****************************************************************        00220000
*                                                                       00230000
****************************************************************        00240000
* MOD.ID   WHO      WHEN     DESCRIPTION                       *        00250000
* -------- -------- -------- --------------------------------- *        00260000
* BSAR1005 ALEX     24/03/96 CORRECT RET CODE AFTER CHECK      *        00270000
*                            CONDITIONAL ACE                   *        00280000
* AZ0605   ALEX     06/05/96 CORRECT ACCESS TO PROFILES WITH   *        00290000
*                            VOLUME PARAMETERS                 *        00300000
* BSAR1010 ALEX     13/08/96 CORRECT ICHEINTY ACCESS, ADDED    *        00310000
*                            RELEASE PARAMETER, CORRECT ACCESS *        00320000
*                            PROFILES WITH VOLUME PARAMETERS   *        00330000
* PS0460 SHMUEL     25/04/01 CHECK FOR USER PROTECTED ATTRIBUTE*        00340000
* WS2427 SHMUEL     13/01/02 CHECK FOR GROUP UNIVERSL ATTRIBUTE*        00350000
*                   +CHECK CONNECTION EXISTENCE U2G INSTEAD G2U*        00351000
* BS2514 SHMUEL     13/01/02 AVOID FREEMAIN IF GROUP NOT FOUND *        00351100
* BS10043 AVNER     13/04/15 PREVENT S0C6.                     *        00351200
* IS10186  AVNERL   21/01/24 RECOMP WITH CTSFXPR               *        00351300
****************************************************************        00352000
*                                                                       00353000
****************************************************************        00354000
*        PARAMETER LIST DSECT                                           00355000
****************************************************************        00356000
*                                                                       00357000
PARMLIST DSECT                                                          00358000
PDEBUG   DS    A                       ADDR DEBUG LEVEL ( F )           00359000
PRACFRC  DS    A                       ADDR FOR RACF RET CODE           00360000
PRACFSC  DS    A                       ADDR FOR RACF REASON CODE        00370000
PEXTRC   DS    A                       ADDR FOR EXTRACTOR RET CODE      00380000
PTXT     DS    A                       TEXT = 'USER'/ 'GROUP'           00390000
*                                             'CONNECT' / 'RESOURCE'    00400000
*                                             'RESCONN1' -REG.CONN LST  00410000
*                                             'RESCONN2' -CND.CONN LST  00420000
*                                             'HILVLDS'                 00430000
*                                      PS0460 'PROTECT'- PROTECTED USR  00440000
*                                      WS2427 'UNIVERS'- PROTECTED USR  00450000
PENTRY   DS    A                       VALUE OF USER / GROUP            00460000
         ORG   PENTRY                  ENTRY CONNECT                    00470000
PUSER    DS    A                       USER NAME                        00480000
PGROUP   DS    A                       GROUP NAME                       00490000
         ORG   PENTRY                  ENTRY RESOURCE                   00500000
PCLASS1  DS    A                       CLASS NAME                       00510000
PPROF1   DS    A                       PROFILE NAME                     00520000
PGENRIC1 DS    A                       GENERIC FLAG                     00530000
PVOL1    DS    A                       VOLUME                           00540000
         ORG   PENTRY                  ENTRY RESCONN1                   00550000
PCLASS3  DS    A                       CLASS NAME                       00560000
PPROF3   DS    A                       PROFILE NAME                     00570000
PGENRIC3 DS    A                       GENERIC FLAG                     00580000
PUSGRP3  DS    A                       USER / GROUP                     00590000
PACCESS3 DS    A                       ACCESS                           00600000
PRETACC3 DS    A                       REAL ACCESS                      00610000
PVOL3    DS    A                       VOLUME                           00620000
         ORG   PENTRY                  ENTRY RESCONN2                   00630000
PCLASS4  DS    A                       CLASS NAME                       00640000
PPROF4   DS    A                       PROFILE NAME                     00650000
PGENRIC4 DS    A                       GENERIC FLAG                     00660000
PUSGRP4  DS    A                       USER / GROUP                     00670000
PACCESS4 DS    A                       ACCESS                           00680000
PWHENTP4 DS    A                       WHEN.TYPE (TERMINAL,PROGRAM)     00690000
PWHENNM4 DS    A                       WHEN NAME                        00700000
PRETACC4 DS    A                       REAL ACCESS                      00710000
PVOL4    DS    A                       VOLUME                           00720000
         ORG   ,                                                        00730000
*                                                                       00740000
NOEXISTS EQU  12              RACF RC OBJ DOES NOT EXISTS               00750000
*                                                                       00760000
****************************************************************        00770000
*        INITIALIZE                                                     00780000
****************************************************************        00790000
*                                                                       00800000
CTSFRCH  CSECT                                                          00810000
CTSFRCH  AMODE 31                                                       00820000
CTSFRCH  RMODE ANY                                                      00830000
         BEGIN *,R9,R11                                                 00840000
         CTSEQUR                                                        00850000
         CTSLEVEL                                                       00860000
         LR    R10,R1                                                   00870000
         USING PARMLIST,R10                                             00880000
*                                                                       00890000
*        SET DEBUG LEVEL                                                00900000
*                                                                       00910000
         L     R2,PDEBUG               R2 -> DEBUG LEVEL (4 BYTES)      00920000
         XC    DEBUGL,DEBUGL           CLEAR DEBUG LEVEL                00930000
         XC    DEBUGR,DEBUGR           CLEAR DEBUG LEVEL                00940000
         ICM   R2,15,0(R2)             DEBUG LEVEL                      00950000
         BNP   NODEBUG                 SKIP DEBUG LVL IF MINUS          00960000
         STC   R2,DEBUGL               STORE DEBUG LEVEL (1 BYTE)       00970000
         ST    R2,DEBUGR                                                00980000
NODEBUG  DS    0H                                                       00990000
*                                                                       01000000
         CTSADBG LEVEL=(DEBUGL,2,3,4,5,6,7),RAREA=RAREA,               X01010000
               'ENTERING'                                               01020000
*                                                                       01030000
*        INITIALIZE RETURN CODES                                        01040000
*                                                                       01050000
         SR    R5,R5                                                    01060000
         L     R2,PRACFRC              ADDR FOR RACF RET CODE           01070000
         ST    R5,0(R2)                                                 01080000
         L     R2,PRACFSC              ADDR FOR RACF REASON CODE        01090000
         ST    R5,0(R2)                                                 01100000
         L     R2,PEXTRC               ADDR FOR EXTRACTOR RET CODE      01110000
         ST    R5,0(R2)                                                 01120000
         ST    R5,RETCODE              CLEAR RETURN CODES               01130000
         ST    R5,RETCODE+4                                             01140000
         ST    R5,RETCODE+8                                             01150000
*                                                                       01160000
********************************************************************    01170000
*        GET OPERATION CODE AND ACT ACCORDINGLY                    *    01180000
********************************************************************    01190000
*                                                                       01200000
         L     R2,PTXT                                                  01210000
         MVC   TXTI,0(R2)                                               01220000
*                                                                       01230000
         CTSADBG LEVEL=(DEBUGL,2,3,4,5,6,7),RAREA=RAREA,               X01240000
               'REQUEST=_',(TXTI,8)                                     01250000
*                                                                       01260000
         CLC   =CL8'USER',TXTI                                          01270000
         BE    CHKUSER                  CHECK USER EXISTANCE            01280000
         CLC   =CL8'GROUP',TXTI                                         01290000
         BE    CHKGRP                   CHECK GROUP EXISTANCE           01300000
         CLC   =CL8'CONNECT',TXTI                                       01310000
         BE    CHKCNN                   CHECK CONNECT EXISTANCE         01320000
         CLC   =CL8'RESOURCE',TXTI                                      01330000
         BE    CHKRES                   CHECK RESOURCE EXISTANCE        01340000
         CLC   =CL8'HILVLDS',TXTI                                       01350000
         BE    CHKHQLF                  CHECK RESOURCE WITH HIGH QUAL   01360000
         CLC   =CL8'RESCONN1',TXTI                                      01370000
         BE    CHKRCNN1                 CHECK PERMIT EXISTANCE          01380000
         CLC   =CL8'RESCONN2',TXTI                                      01390000
         BE    CHKRCNN2                 CHECK PERMIT EXISTANCE          01400000
         CLC   =CL8'PROTECT',TXTI                               PS0460  01410000
         BE    CHKPROT                  CHECK PROTECT ATTRIBUTE PS0460  01420000
         CLC   =CL8'UNIVERS',TXTI                               PS0460  01430000
         BE    CHKUNIV                  CHECK PROTECT ATTRIBUTE PS0460  01440000
         B     EXIT8                    INVALID REQUEST                 01450000
*                                                                       01460000
********************************************************************    01470000
*                                                                  *    01480000
*  CHECK USER EXISTANCE                                            *    01490000
*                                                                  *    01500000
********************************************************************    01510000
*                                                                       01520000
CHKUSER  DS    0H                                                       01530000
*                                                                       01540000
**    FORMAT USERID TO UPPERCASE AND CALCULATE ITS LENGTH               01550000
*                                                                       01560000
         L     R5,PENTRY                                                01570000
         MVC   USER,0(R5)                                               01580000
         CTSCALL BUILDPRM,(F8,USER,ENTRY),LINK=INT                      01590000
         CTSCALL USROBJ,(ENTRY,RETCODE,DEBUGL),LINK=INT                 01600000
*                                                                       01610000
**    RETURN TO CALLER                                                  01620000
*                                                                       01630000
         B     USERRC(R15)                                              01640000
USERRC   B     EXIT0                   USER EXISTS                      01650000
         B     EXIT4                   USER DOES NOT EXISTS             01660000
         B     EXIT8                   RACF ERR                         01670000
*                                                                       01680000
*                                                                       01690000
********************************************************************    01700000
*  PS0460                                                          *    01710000
*  CHECK USER FOR PROTECTED (NO PASSWORD ATTRIBUTE)                *    01720000
*                                                                  *    01730000
********************************************************************    01740000
*                                                                       01750000
CHKPROT  DS    0H                                                       01760000
*                                                                       01770000
**    FORMAT USERID TO UPPERCASE AND CALCULATE ITS LENGTH               01780000
*                                                                       01790000
         L     R5,PENTRY                                                01800000
         MVC   USER,0(R5)                                               01810000
         CTSCALL BUILDPRM,(F8,USER,ENTITY),LINK=INT                     01820000
         CTSADBG 'BP R15=# ENTITYX=~ ENTITYNM=_',                      101821000
               (?R15,ENTITYX,ENTITYNM,8),                              201822000
               LEVEL=(DEBUGL,2,3,4,5,6,7),RAREA=RAREA                   01823000
         CTSCALL PROTECT,(ENTITYX,RETCODE,DEBUGL),LINK=INT              01824000
*                                                                       01825000
**    RETURN TO CALLER                                                  01826000
*                                                                       01827000
         B     PROTRC(R15)                                              01828000
PROTRC   B     EXIT0                   USER EXISTS, NOT PROTECTED       01829000
         B     EXIT4                   USER DOES NOT EXISTS             01829100
         B     EXIT8                   RACF ERR                         01829200
         B     EXIT1                   USER EXISTS, PROTECTED           01829300
*                                                                       01829400
*                                                                       01829500
********************************************************************    01829600
*  CKUNIV: CHECK GROUP FOR UNIVERSAL ATTRIBUTE  WS2427             *    01829700
********************************************************************    01829800
*                                                                       01829900
CHKUNIV  DS    0H                                                       01830000
*                                                                       01831000
**    FORMAT GROUP TO UPPERCASE AND CALCULATE ITS LENGTH                01831100
*                                                                       01831200
         L     R5,PENTRY                                                01831300
         MVC   GROUP,0(R5)                                              01831400
         CTSCALL BUILDPRM,(F8,GROUP,ENTITY),LINK=INT                    01831500
         CTSADBG 'BP R15=# ENTITYX=~ ENTITYNM=_',                      101831600
               (?R15,ENTITYX,ENTITYNM,8),                              201831700
               LEVEL=(DEBUGL,2,3,4,5,6,7),RAREA=RAREA                   01831800
         CTSCALL UNIVERS,(ENTITYX,RETCODE,DEBUGL),LINK=INT              01831900
*                                                                       01832000
**    RETURN TO CALLER                                                  01832100
*                                                                       01832200
         B     UNIVRC(R15)                                              01832300
UNIVRC   B     EXIT0                  GROUP EXISTS, NOT UNIVERSAL       01832400
         B     EXIT4                  GROUP DOES NOT EXISTS             01832500
         B     EXIT8                  RACF ERR                          01832600
         B     EXIT1                  GROUP EXISTS, UNIVERSAL           01832700
*                                                                       01832800
********************************************************************    01832900
*                                                                  *    01833000
*  CHECK GROUP EXISTANCE                                           *    01834000
*                                                                  *    01835000
********************************************************************    01836000
*                                                                       01837000
CHKGRP   DS    0H                                                       01838000
*                                                                       01839000
**    FORMAT GROUP NAME TO UPPERCASE AND CALCULATE ITS LENGTH           01840000
*                                                                       01850000
         L     R5,PENTRY                                                01860000
         MVC   GROUP,0(R5)                                              01870000
         CTSCALL BUILDPRM,(F8,GROUP,ENTRY),LINK=INT                     01880000
         CTSCALL GRPOBJ,(ENTRY,RETCODE,DEBUGL),LINK=INT                 01881000
*                                                                       01882000
**    RETURN TO CALLER                                                  01882100
*                                                                       01882200
         B     GRPRC(R15)                                               01882300
GRPRC    B     EXIT0                   GROUP EXISTS                     01882400
         B     EXIT4                   GROUP DOES NOT EXISTS            01882500
         B     EXIT8                   RACF ERR                         01882600
*                                                                       01882700
********************************************************************    01882800
*                                                                  *    01882900
*  CHECK USER TO GROUP CONNECTION EXISTANCE                        *    01883000
*  WS2427 EXTENSIVE CHANGE TO CHECK U2G INSTEAD G2U *                   01884000
*                                                                  *    01885000
********************************************************************    01886000
*                                                                       01887000
CHKCNN   DS    0H                                                       01888000
*                                                                       01888100
*        GET GROUP OF CONNECTION                                        01888200
*                                                                       01888300
         L     R5,PGROUP                                                01888400
         MVC   GROUP(8),0(R5)                                           01888500
         CTSCALL BUILDPRM,(F8,GROUP,ENTRY),LINK=INT                     01888600
         MVC   GROUP(8),ENTRYNM                                         01888700
                                                                        01888800
*        GET USER OF CONNECTION                                         01888900
*                                                                       01889000
         L     R5,PUSER                                                 01890000
         MVC   USER(8),0(R5)                                            01900000
         CTSCALL BUILDPRM,(F8,USER,ENTRY),LINK=INT                      01910000
         CTSCALL CHKU2G,(GROUP,ENTRY,RETCODE,DEBUGL),LINK=INT           01920000
*                                                                       01930000
**    RETURN TO CALLER                                                  01940000
*                                                                       01950000
         B     CNNRC(R15)                                               01960000
CNNRC    B     EXIT0                   CONNECTION EXISTS                01970000
         B     EXIT4                   CONNECTION DOES NOT EXISTS       01980000
         B     EXIT8                   RACF ERR                         01990000
*                                                                       02000000
*                                                                       02010000
********************************************************************    02020000
*                                                                  *    02030000
*  CHECK RESOURCE EXISTANCE                                        *    02040000
*                                                                  *    02050000
********************************************************************    02060000
*                                                                       02070000
CHKRES   DS    0H                                                       02080000
*                                                                       02090000
*        GET RESOURCE CLASS                                             02100000
*                                                                       02110000
         L     R5,PCLASS1                                               02120000
         MVC   CLASS,0(R5)                                              02130000
         CTSCALL BUILDPRM,(F8,CLASS,ENTRY),LINK=INT                     02140000
         MVC   CLASS(8),ENTRYNM                                         02150000
*                                                                       02160000
*        GET VOLUME INFORMATION                                         02170000
*                                                                       02180000
         L     R5,PVOL1                                                 02190000
         MVC   VOLUME(6),0(R5)                                          02200000
         CTSCALL BUILDPRM,(F6,VOLUME,ENTRY),LINK=INT                    02210000
         MVC   VOLUME(8),ENTRYNM                                        02220000
*                                                                       02230000
*        GET RESOURCE NAME                                              02240000
*                                                                       02250000
         L     R5,PPROF1                                                02260000
         MVC   PROFILE(256),0(R5)                                       02270000
         CTSCALL BUILDPRM,(F256,PROFILE,ENTRY),LINK=INT                 02280000
         L     R5,PGENRIC1                                              02290000
         MVC   GENFLAG(4),0(R5)                                         02300000
         CTSCALL GETRES,(CLASS,ENTRY,VOLUME,GENFLAG,                   X02310000
               RETCODE,DEBUGL),LINK=INT                                 02320000
*                                                                       02330000
**    RETURN TO CALLER                                                  02340000
*                                                                       02350000
         B     RESRC(R15)                                               02360000
RESRC    B     EXIT0                   RESOURC EXISTS                   02370000
         B     EXIT4                   RESOURCE DOES NOT EXISTS         02380000
         B     EXIT8                   RACF ERR                         02390000
*                                                                       02400000
********************************************************************    02410000
*                                                                  *    02420000
*  CHECK HILVL-Q EXISTANCE                                         *    02430000
*                                                                  *    02440000
********************************************************************    02450000
*                                                                       02460000
CHKHQLF  DS    0H                                                       02470000
*                                                                       02480000
*        GET HIGH LEVEL QUALIFIER                                       02490000
*                                                                       02500000
         L     R5,PENTRY                                                02510000
         MVC   USER(8),0(R5)                                            02520000
         CTSCALL BUILDPRM,(F8,USER,ENTRY),LINK=INT                      02530000
         MVC   USER(8),ENTRYNM                                          02540000
         CTSCALL GETQLF,(USER,ENTRY,RETCODE,DEBUGL),LINK=INT            02550000
*                                                                       02560000
**    RETURN TO CALLER                                                  02570000
*                                                                       02580000
         B     QLFRC(R15)                                               02590000
QLFRC    B     EXIT0                   RESOURC EXISTS                   02600000
         B     EXIT4                   RESOURCE DOES NOT EXISTS         02610000
         B     EXIT8                   RACF ERR                         02620000
*                                                                       02630000
********************************************************************    02640000
*                                                                  *    02650000
*       CHECK ACE EXISTANCE                                        *    02660000
*                                                                  *    02670000
********************************************************************    02680000
*                                                                       02690000
CHKRCNN1 DS    0H                                                       02700000
*                                                                       02710000
*        GET RESOURCE CLASS                                             02720000
*                                                                       02730000
         L     R5,PCLASS3              GET CLASS                        02740000
         MVC   CLASS(8),0(R5)                                           02750000
         CTSCALL BUILDPRM,(F8,CLASS,ENTRY),LINK=INT                     02760000
         MVC   CLASS(8),ENTRYNM                                         02770000
*                                                                       02780000
*        GET OBJECT ID (USER OR GROUP)                                  02790000
*                                                                       02800000
         L     R5,PUSGRP3              USER/GROUP                       02810000
         MVC   USER(8),0(R5)                                            02820000
         CTSCALL BUILDPRM,(F8,USER,ENTRY),LINK=INT                      02830000
         MVC   USER(8),ENTRYNM                                          02840000
*                                                                       02850000
*        GET ACCESS                                                     02860000
*                                                                       02870000
         MVC   ACCESS(8),=CL8' '                                        02880000
         L     R5,PACCESS3             ACCESS                           02890000
         LTR   R5,R5                                                    02900000
         BZ    CNN1V                   NO ACCESS ENTERED                02910000
         MVC   ACCESS(8),0(R5)                                          02920000
         CTSCALL BUILDPRM,(F8,ACCESS,ENTRY),LINK=INT                    02930000
         MVC   ACCESS(8),ENTRYNM                                        02940000
*                                                                       02950000
*        GET VOLUME INFORMATION                                         02960000
*                                                                       02970000
CNN1V    DS    0H                                                       02980000
         L     R5,PVOL3                                                 02990000
         MVC   VOLUME(6),0(R5)                                          03000000
         CTSCALL BUILDPRM,(F6,VOLUME,ENTRY),LINK=INT                    03010000
         MVC   VOLUME(6),ENTRYNM                                        03020000
*                                                                       03030000
*        GET PROFILE NAME                                               03040000
*                                                                       03050000
         L     R5,PPROF3               GET PROFILE                      03060000
         MVC   PROFILE(256),0(R5)                                       03070000
         CTSCALL BUILDPRM,(F256,PROFILE,ENTRY),LINK=INT                 03080000
         L     R5,PGENRIC3                                              03090000
         MVC   GENFLAG(4),0(R5)                                         03100000
         CTSCALL GETRS1,(USER,ACCESS,CLASS,ENTRY,VOLUME,GENFLAG,       X03110000
               ACCESSRT,RETCODE,DEBUGL),LINK=INT                        03120000
         L     R5,PRETACC3             REAL ACCESS                      03130000
         MVC   0(8,R5),ACCESSRT        RETURNED ACCESS                  03140000
*                                                                       03150000
**    RETURN TO CALLER                                                  03160000
*                                                                       03170000
         B     RS1RC(R15)                                               03180000
RS1RC    B     EXIT0                   ACE EXISTS                       03190000
         B     EXIT4                   ACE DOES NOT EXISTS              03200000
         B     EXIT8                   RACF ERR                         03210000
*                                                                       03220000
*                                                                       03230000
********************************************************************    03240000
*                                                                  *    03250000
*       CHECK CONDITIONAL ACE EXISTANCE                            *    03260000
*                                                                  *    03270000
********************************************************************    03280000
*                                                                       03290000
CHKRCNN2 DS    0H                                                       03300000
*                                                                       03310000
*        GET RESOURCE CLASS                                             03320000
*                                                                       03330000
         L     R5,PCLASS4              GET CLASS                        03340000
         MVC   CLASS(8),0(R5)                                           03350000
         CTSCALL BUILDPRM,(F8,CLASS,ENTRY),LINK=INT                     03360000
         MVC   CLASS(8),ENTRYNM                                         03370000
*                                                                       03380000
*        GET OBJECT ID (USER OR GROUP)                                  03390000
*                                                                       03400000
         L     R5,PUSGRP4              USER/GROUP                       03410000
         MVC   USER(8),0(R5)                                            03420000
         CTSCALL BUILDPRM,(F8,USER,ENTRY),LINK=INT                      03430000
         MVC   USER(8),ENTRYNM                                          03440000
*                                                                       03450000
*        GET ACCESS                                                     03460000
*                                                                       03470000
         L     R5,PACCESS4             ACCESS                           03480000
         LTR   R5,R5                                                    03490000
         BZ    CNN1W                   NO ACCESS ENTERED                03500000
         MVC   ACCESS(8),0(R5)                                          03510000
         CTSCALL BUILDPRM,(F8,ACCESS,ENTRY),LINK=INT                    03520000
         MVC   ACCESS(8),ENTRYNM                                        03530000
*                                                                       03540000
*        GET WHEN TYPE                                                  03550000
*                                                                       03560000
CNN1W    DS    0H                                                       03570000
         L     R5,PWHENTP4             WHEN.TYPE                        03580000
         MVC   WHENTP(8),0(R5)                                          03590000
         CTSCALL BUILDPRM,(F8,WHENTP,ENTRY),LINK=INT                    03600000
         MVC   WHENTP(8),ENTRYNM                                        03610000
*                                                                       03620000
*        GET WHEN NAME                                                  03630000
*                                                                       03640000
         L     R5,PWHENNM4             WHEN.NAME                        03650000
         MVC   WHENNM(256),0(R5)                                        03660000
         CTSCALL BUILDPRM,(F256,WHENNM,ENTRWN),LINK=INT                 03670000
         CLC   WHENTP(8),=CL8'PROGRAM'                                  03680000
         BNE   GETVOL                                                   03690000
         MVI   ENTRWLN,8               CONST. LEN OF PROGRAM            03700000
*                                                                       03710000
*        GET VOLUME INFORMATION                                         03720000
*                                                                       03730000
GETVOL   DS    0H                                                       03740000
         L     R5,PVOL4                                                 03750000
         MVC   VOLUME(6),0(R5)                                          03760000
         CTSCALL BUILDPRM,(F6,VOLUME,ENTRY),LINK=INT                    03770000
         MVC   VOLUME(6),ENTRYNM                                        03780000
*                                                                       03790000
*        GET PROFILE NAME                                               03800000
*                                                                       03810000
         L     R5,PPROF4               GET PROFILE                      03820000
         MVC   PROFILE(256),0(R5)                                       03830000
         CTSCALL BUILDPRM,(F256,PROFILE,ENTRY),LINK=INT                 03840000
         L     R5,PGENRIC4                                              03850000
         MVC   GENFLAG(4),0(R5)                                         03860000
         CTSCALL GETRS2,(USER,ACCESS,WHENTP,ENTRWN,                    X03870000
               CLASS,ENTRY,VOLUME,GENFLAG,                             X03880000
               ACCESSRT,RETCODE,DEBUGL),LINK=INT                        03890000
         L     R5,PRETACC4             REAL ACCESS                      03900000
         MVC   0(8,R5),ACCESSRT        RETURNED ACCESS                  03910000
*                                                                       03920000
**    RETURN TO CALLER                                                  03930000
*                                                                       03940000
         B     RS2RC(R15)                                               03950000
RS2RC    B     EXIT0                   ACE EXISTS                       03960000
         B     EXIT4                   ACE DOES NOT EXISTS              03970000
         B     EXIT8                   RACF ERR                         03980000
*                                                                       03990000
*                                    RACF RETURN AND REASON CODES       04000000
EXIT0    DS    0H                    OBJECT EXISTS                      04010000
         SR    R15,R15           (IF USER THEN NOT PROTECTED PS0460)    04020000
         B     RET                                                      04030000
EXIT1    DS    0H                    USER PROTECTED  PS0460             04040000
         LA    R15,1                                 PS0460             04050000
         B     RET                                   PS0460             04060000
EXIT4    DS    0H                    OBJECT NOT EXISTS                  04070000
         LA    R15,4                                                    04080000
         B     RET                                                      04090000
EXIT8    DS    0H                    RACF ERROR                         04100000
         LA    R15,8                                                    04110000
         B     RET                                                      04120000
RET      DS    0H                                                       04130000
         L     R2,PRACFRC             ADDR FOR RACF RET CODE            04140000
         MVC   0(4,R2),RETCODE                                          04150000
         L     R2,PRACFSC             ADDR FOR RACF REASON CODE         04160000
         MVC   0(4,R2),RETCODE+4                                        04170000
         L     R2,PEXTRC              ADDR FOR EXTRACTOR RET CODE       04180000
         MVC   0(4,R2),RETCODE+8                                        04190000
         CTSADBG 'RC=# RACF RC=~ RACF REASON=~ EXTRACTOR RC=~',        104200000
               (?R15,RETCODE,RETCODE+4,RETCODE+8),                     204210000
               LEVEL=(DEBUGL,1,2,3,4,5,6,7),RAREA=RAREA                 04220000
         BRTRN (15)                                                     04230000
         LTORG                                                          04240000
*                                                                       04250000
*******************************************************************     04260000
*                                                                       04270000
*  WORK AREA                                                            04280000
*                                                                       04290000
*******************************************************************     04300000
*                                                                       04310000
RETCODE  DS    3F                                                       04320000
DEBUGR   DS    F                       DEBUG LEVEL FOR EXTRACTOR        04330000
GENFLAG  DS    F                       GENERIC FLAG                     04340000
ACCESSRT DS    CL8                     RETURNED ACCESS                  04350000
F6       DC    F'6'                                                     04360000
F8       DC    F'8'                                                     04370000
F256     DC    F'256'                                                   04380000
RAREA    DS    CL256                                                    04390000
TXTI     DS    CL8                     KIND OF PROFILE (USER/GROUP)     04400000
USER     DS    CL8                     USER                             04410000
GROUP    DS    CL8                     GROUP                            04420000
CLASS    DS    CL8                     CLASS                            04430000
VOLUME   DS    CL8                     VOLUME                           04440000
ACCESS   DS    CL8                     ACCESS                           04450000
WHENTP   DS    CL8                     WHEN TYPE                        04460000
WHENNM   DS    CL256                   WHEN NAME                        04470000
PROFILE  DS    CL256                   PROFILE                          04480000
*                                                                       04490000
ENTRY    DS    0H                      DATA IN RACF DB ENTRY NAME FORM  04500000
ENTRYLN  DS    AL1                     LENGTH                           04510000
ENTRYNM  DS    CL256                   VALUE                            04520000
*                                                                       04530000
ENTITYX  DS    0F                      DATA IN RACROUTE ENTITYX FORM    04540000
         DC    AL3(0)                                                   04550000
ENTITY   DS    AL1                     LENGTH                           04560000
ENTITYNM DS    CL8                     VALUE                            04570000
*                                                                       04580000
ENTRWN   DS    0H                      WHEN NAME IN RACF DB FORM        04590000
ENTRWLN  DS    AL1                     LENGTH                           04600000
ENTRWNM  DS    CL256                   VALUE                            04610000
*                                                                       04620000
DEBUGL   DS    CL1                     DEBUG LEVEL                      04630000
         LTORG                                                          04640000
         DROP  ,                                                        04650000
*                                                                       04660000
*********************************************************************   04670000
*                                                                       04680000
*********************************************************************   04690000
*                                                                       04700000
*    PARAMETERS :                                                       04710000
*                                                                       04720000
*        1) MAX FIELD LENGTH (INPUT)                                    04730000
*        2) TEXT FROM  (INPUT)                                          04740000
*        3  TEXT TO  (OUTPUT)                                           04750000
*                                                                       04760000
*********************************************************************   04770000
*                                                                       04780000
BUILDPRM BEGIN                                                          04790000
         L     R8,0(R1)                R8 -> MAX FIELD LENGTH           04800000
         L     R8,0(R8)                R8 =  MAX FIELD LENGTH           04810000
         ST    R8,MAXLEN               SAVE IT                          04820000
*                                                                       04830000
         L     R2,4(R1)                R2 -> SOURCE TEXT                04840000
         L     R12,8(R1)               R12 -> TARGET TEXT               04850000
*                                                                       04860000
         MVI   0(R12),0                CLEAR ENTRY LENGTH               04870000
         LA    R12,1(R12)              BRANCH OVER THE LENGTH           04880000
BLD1     DS    0H                                                       04890000
         MVI   0(R12),C' '             CLEAR ENTRY WITH BLANKS          04900000
         LA    R12,1(R12)                                               04910000
         BCT   R8,BLD1                                                  04920000
         ST    R12,LASTADDR            LAST ADDR OF ENTRY NAME          04930000
         L     R8,MAXLEN               MAX ENTRY NAME LEN               04940000
         L     R12,8(R1)               R12 -> TARGET TEXT               04950000
         LA    R12,1(R12)              BRANCH OVER THE LENGTH           04960000
*                                                                       04970000
         BCTR  R8,0                    DECR FOR EX COMMAND              04980000
         EX    R8,MVCE1                COPY VALUE TO ENTRY              04990000
         EX    R8,TRE1                 TRANSLATE ENTRY TO UPPER         05000000
*                                                                       05010000
*        CALC REAL LENGTH OF VALUE                                      05020000
*                                                                       05030000
         L     R1,LASTADDR             LAST ADDR OF ENTRY NAME          05040000
         EX    R8,SRCHBLNK             SEARCH BLANK                     05050000
         SR    R1,R12                  R12 - START ADDR OF ENTRY NAME   05060000
         LA    R15,4                                                    05070000
         LTR   R6,R1                                                    05080000
         BZ    RETENTRY                                                 05090000
         BCTR  R12,0                   NOW R12 -> ENTRY NAME LEN        05100000
         STC   R6,0(R12)               COUNTER                          05110000
         SR    R15,R15                                                  05120000
*                                                                       05130000
*        FINISHE                                                        05140000
*                                                                       05150000
RETENTRY DS    0H                                                       05160000
         BRTRN (15)                                                     05170000
*                                                                       05180000
TRE1     TR    0(0,R12),TAB            CONVERT TO UPPERCASE             05190000
MVCE1    MVC   0(0,R12),0(R2)          ENTRY NAME                       05200000
SRCHBLNK TRT   0(0,R12),TABBLANK       SEARCH BLANK                     05210000
MAXLEN   DS    F                       MAX LEN OF ENTRY NAME            05220000
LASTADDR DS    F                       LAST ADDR OF ENTRY NAME          05230000
*                                                                       05240000
*        CONVERSION TABLE FROM UNPRINTABLES TO BLANKS                   05250000
*                   + LOWERCASE TO UPPERCASE                            05260000
*                                                                       05270000
TAB      DC    256AL1(*-TAB)           TRANSLATE TABLE TO UPPERCASE     05280000
         ORG   TAB                                                      05290000
         DC    40C' '                                                   05300000
         ORG   TAB+C'A'-X'40'                                           05310000
         DC    C'ABCDEFGHI'                                             05320000
         ORG   TAB+C'J'-X'40'                                           05330000
         DC    C'JKLMNOPQR'                                             05340000
         ORG   TAB+C'S'-X'40'                                           05350000
         DC    C'STUVWXYZ'                                              05360000
         ORG   ,                                                        05370000
*                                                                       05380000
*        TABLE TO LOCATE BLANK                                          05390000
*                                                                       05400000
TABBLANK DC    256X'00'                                                 05410000
         ORG   TABBLANK+C' '                                            05420000
         DC    C' '                                                     05430000
         ORG                                                            05440000
         LTORG                                                          05450000
         DROP  ,                                                        05460000
*                                                                       05470000
*********************************************************************   05480000
*                                                                   *   05490000
* CHECK USER   EXISTANCE                                            *   05500000
* R1 -  OFFSET :                                                    *   05510000
*              0 - ENTRY NAME ADDR                                  *   05520000
*              4 - RETCODE                                          *   05530000
*              8 - DEBUG LEVEL ADDR                                 *   05540000
*                                                                   *   05550000
*********************************************************************   05560000
*                                                                   *   05570000
USROBJ   BEGIN                                                          05580000
*                                                                       05590000
         LR    R10,R1                                                   05600000
         L     R4,0(R10)               ENTRY NAME ADDR                  05610000
         L     R8,8(R10)                                                05620000
         MVC   DBGLU(1),0(R8)          DEBUG LEVEL                      05630000
         SR    R5,R5                                                    05640000
         IC    R5,0(R4)                ENTRY NAME LENGTH                05650000
*                                                                       05660000
         CTSADBG LEVEL=(DBGLU,2,3,4,5,6,7),                            X05670000
               'USER=#/_',(?R5,1(R4),?R5)                               05680000
*                                                                       05690000
**    LOCATE USER PROFILE                                               05700000
*                                                                       05710000
         ICHEINTY ENTRY=(R4),RELEASE=1.8,MF=(E,USREINTY)                05720000
*                                                                       05730000
**    CHECK RACF MANAGER RETURN CODES                                   05740000
*                                                                       05750000
         L     R8,4(R10)             RETCODES ADDR                      05760000
         LA    R12,USREINTY                                             05770000
         L     R15,56(R12)           RACF REASON CODE                   05780000
         ST    R15,4(R8)                                                05790000
         L     R15,52(R12)           RACF RETURN CODE                   05800000
         ST    R15,0(R8)                                                05810000
         LA    R5,NOEXISTS           RACF RET CODE: ENTRY NOT EXISTS    05820000
         CR    R15,R5                NOT EXISTS                         05830000
         BE    USRR4                 SPECIFY ENTRY NOT EXISTS           05840000
         LTR   R15,R15                                                  05850000
         BNZ   USRR8                 OTHER ERROR. SEE RACF MANUAL       05860000
         B     USRR0                                                    05870000
*                                                                       05880000
**    RETURN CODES                                                      05890000
*                                                                       05900000
USRR8    DS    0H                    RACF MENAGER ERRORS                05910000
         LA    R15,8                                                    05920000
         B     USRRT                                                    05930000
USRR4    DS    0H                    OBJECT DOES NOT EXISTS             05940000
         LA    R15,4                                                    05950000
         B     USRRT                                                    05960000
USRR0    DS    0H                    OBJECT EXISTS                      05970000
*BS10043 SR    R15,0                                                    05980000
         SR    R15,R15                                    BS10043       05981000
         B     USRRT                                                    05990000
USRRT    DS    0H                                                       06000000
         BRTRN (15)                                                     06010000
*                                                                       06020000
         LTORG                                                          06030000
DBGLU    DS    CL1                   DEBUG LEVEL                        06040000
USREINTY ICHEINTY LOCATE,RELEASE=1.8,TYPE='USR',                       106050000
               DATAMAP=NEW,WKAREA=RETAREAU,WKSP=0,MF=L                  06060000
*                                                                       06070000
*    REACF  RETURN WORK AREA ( PREFIX )                                 06080000
*                                                                       06090000
RETAREAU DS    0F                                                       06100000
         DC    F'30'                   MINIMUM LENGTH OF AREA           06110000
         DS    0CL20                                                    06120000
         DS    XL6                     RBA RETURN AREA                  06130000
         DS    X                                                        06140000
         DS    X                       RESERVED                         06150000
         DS    F                       DUPLICATE DATASET NAME COUNT     06160000
         DS    XL8                     RESERVED                         06170000
         DS    XL10                                                     06180000
         DROP  ,                                                        06190000
*********************************************************************   06200000
*PS0460: EXTRACT CHECK PROTECTED FLAG OF RACF USER                  *   06210000
* PERMANENT REGISTERS                                                   06220000
*           R9  ADDRESSABILITY                                          06230000
*           R10 PARM ADDR                                               06240000
*           R11 RETCODE FROM THIS ROUTINE 0,1,4,8                       06250000
*           R12 RACROUTE MF=L AREA                                      06260000
*                                                                       06270000
PROTECT  BEGIN *,R9                                                     06280000
         LR    R10,R1                                                   06290000
         L     R4,0(R10)               ENTITYX STRUCT  ADDR             06300000
         L     R8,8(R10)                                                06310000
         MVC   DBGLP(1),0(R8)          DEBUG LEVEL                      06320000
         SR    R5,R5                                                    06330000
         IC    R5,3(R4)                ENTITY NAME LENGTH               06340000
*                                                                       06350000
         CTSADBG LEVEL=(DBGLP,2,3,4,5,6,7),                            X06360000
               'ROUTINE=PROTECT USER=#/_',(?R5,4(R4),?R5)               06370000
*                                                                       06380000
**    EXTRACT USER PROTECTED ATTRIBUTE                                  06390000
*                                                                       06400000
         RACROUTE REQUEST=EXTRACT,TYPE=EXTRACT,                        X06410000
               ENTITYX=(R4),RELEASE=1.9,MF=(E,PROTEXT)                  06420000
*                                                                       06430000
**    CHECK RACF MANAGER RETURN CODES                                   06440000
*                                                                       06450000
         L     R8,4(R10)             RETCODE BUFFER ADDRES              06460000
         LA    R12,PROTEXT           RACF CODES                         06470000
         USING SAFP,R12                                                 06480000
         MVC   0(4,R8),SAFPRRET      STORE RACF RC                      06490000
         MVC   4(4,R8),SAFPRREA      STORE RACF REASON CODE             06500000
         ST    R15,8(R8)             STORE SAF  RC                      06510000
         LR    R2,R1            SAVE RETURN AREA ADDRESS                06520000
         LA    R11,8                 INITIALIZE RC                      06530000
         LA    R5,4                                                     06540000
         CR    R15,R5                                                   06550000
         BE    SAF4P                                                    06560000
         BH    FREEMP                                                   06570000
SAF0P    EQU   *                SAVE RETURN AREA ADDRESS                06580000
         USING EXTWKEA,R2                                               06590000
         LH    R3,EXTWOFF                                               06600000
         LA    R3,4(R3,R2)                                              06610000
         LA    R11,0                      ASSUME NOT PROTECTED          06620000
         TM    0(R3),X'40'                TEST FLAG7 BIT1               06630000
         BZ    FREEMP                                                   06640000
         LA    R11,12                  12=PROTECTED, USED IN BRANCH TAB 06650000
FREEMP   EQU   *                                                        06660000
         XR    R4,R4                                                    06670000
         XR    R5,R5                                                    06680000
         ICM   R4,1,EXTWSP                                              06690000
         ICM   R5,7,EXTWLN                                              06700000
         FREEMAIN R,LV=(R5),A=(R2),SP=(R4)                              06710000
         B     PROTRET                                                  06720000
SAF4P    CLI   SAFPRRET+3,X'08'                                         06730000
         BNE   PROTRET                                                  06740000
         CLI   SAFPRREA+3,X'00'                                         06750000
         BNE   PROTRET                                                  06760000
         LA    R11,4    USER NOT FOUND                                  06770000
*                                                                       06780000
**    RETURN CODES                                                      06790000
*                                                                       06800000
PROTRET  LR    R15,R11                                                  06810000
         BRTRN (15)                                                     06820000
*                                                                       06830000
         LTORG                                                          06840000
DBGLP    DS    CL1                   DEBUG LEVEL                        06850000
PROTEXT  RACROUTE REQUEST=EXTRACT,TYPE=EXTRACT,CLASS='USER',           *06860000
               ENTITYX=*-*,FIELDS=FLAG7,WORKA=WORKA,                   *06870000
               RELEASE=1.9,SEGMENT='BASE',MF=L                          06880000
FLAG7    DC    A(1)                                                     06890000
         DC    CL8'FLAG7'                                               06900000
WORKA    DS    128F                                                     06910000
         DROP  ,                                                        06920000
*********************************************************************   06930000
*WS2427: EXTRACT GROUP UNIVERSAL FLAG                               *   06940000
* PERMANENT REGISTERS                                                   06950000
*           R9  ADDRESSABILITY                                          06960000
*           R10 PARM ADDR                                               06970000
*           R11 RETCODE FROM THIS ROUTINE 0,1,4,8                       06980000
*           R12 RACROUTE MF=L AREA                                      06990000
*                                                                       07000000
UNIVERS  BEGIN *,R9                                                     07010000
         LR    R10,R1                                                   07020000
         L     R4,0(R10)               ENTITYX STRUCT  ADDR             07030000
         L     R8,8(R10)                                                07040000
         MVC   DBGLUG(1),0(R8)         DEBUG LEVEL                      07050000
         SR    R5,R5                                                    07060000
         IC    R5,3(R4)                ENTITY NAME LENGTH               07070000
*                                                                       07080000
         CTSADBG LEVEL=(DBGLUG,2,3,4,5,6,7),                           X07090000
               'ROUTINE=UNIVERSAL GROUP=#/_',(?R5,4(R4),?R5)            07100000
*                                                                       07110000
**    EXTRACT GROUP UNIVERSAL ATTRIBUTE                                 07120000
*                                                                       07130000
         RACROUTE REQUEST=EXTRACT,TYPE=EXTRACT,                        X07140000
               ENTITYX=(R4),RELEASE=1.9,MF=(E,UNIVEXT)                  07150000
*                                                                       07160000
**    CHECK RACF MANAGER RETURN CODES                                   07170000
*                                                                       07180000
                                                                        07190000
                                                                        07200000
         L     R8,4(R10)             RETCODE BUFFER ADDRES              07210000
         LA    R12,UNIVEXT           RACF CODES                         07220000
         USING SAFP,R12                                                 07230000
         MVC   0(4,R8),SAFPRRET      STORE RACF RC                      07240000
         MVC   4(4,R8),SAFPRREA      STORE RACF REASON CODE             07250000
         ST    R15,8(R8)             STORE SAF  RC                      07260000
         LR    R2,R1            SAVE RETURN AREA ADDRESS                07270000
*BS2514  ADD DEBUG TRACE AND SIMPLIFY R15 RC HANDLING                   07271000
         CTSADBG LEVEL=(DBGLUG,2,3,4,5,6,7),                           X07271100
               'SAFRC R15=# ',(?R15)                                    07271200
         CTSADBG LEVEL=(DBGLUG,2,3,4,5,6,7),                           X07271300
               'RETURN AREA ADDRESS=#',(?R2)                            07271400
         CTSADBG LEVEL=(DBGLUG,2,3,4,5,6,7),                           X07271500
               'SAFPRRET=~',(SAFPRRET)                                  07271600
         CTSADBG LEVEL=(DBGLUG,2,3,4,5,6,7),                           X07271700
               'SAFPRREA=~',(SAFPRREA)                                  07271800
         LA    R11,8                 INITIALIZE RC                      07271900
         LA    R5,4                  LOAD REGISTER FOR CR               07272000
         LTR   R15,R15               SAF RC ZERO ?                      07273000
         BZ    SAF0U                 GO IF YES                          07275000
         CR    R15,R5                SAF RC 4 ?                         07278000
         BE    SAF4U                 GO IF YES                          07279000
         B     UNIVRET  BS2514       R15=X'64' OR X'08'                 07286000
SAF0U    EQU   *                SAVE RETURN AREA ADDRESS                07287000
         USING EXTWKEA,R2                                               07289000
         LH    R3,EXTWOFF                                               07290000
         LA    R3,4(R3,R2)                                              07300000
         LA    R11,0                      ASSUME NOT UNIVERSAL          07310000
         TM    0(R3),X'80'                TEST UNVFLG BIT 0             07320000
         BZ    FREEMU                                                   07330000
         LA    R11,12                  12=UNIVERSAL, USED IN BRANCH TAB 07340000
*                                                                       07350000
FREEMU   EQU   *                                                        07360000
         XR    R4,R4                                                    07370000
         XR    R5,R5                                                    07380000
         ICM   R4,1,EXTWSP                                              07390000
         ICM   R5,7,EXTWLN                                              07400000
*                                                                       07400100
         CTSADBG LEVEL=(DBGLUG,2,3,4,5,6,7),          BS2514           X07400200
               'FREEMAIN SP=# LV=# A=#',(?R4,?R5,?R2)                   07400300
*                                                                       07400400
         FREEMAIN R,LV=(R5),A=(R2),SP=(R4)                              07400500
         B     UNIVRET                                                  07400600
*                                                                       07400700
SAF4U    CLI   SAFPRRET+3,X'08'                                         07400800
         BNE   UNIVRET                                                  07400900
         CLI   SAFPRREA+3,X'00'                                         07401000
         BNE   UNIVRET                                                  07401100
         LA    R11,4   GROUP NOT FOUND                                  07402000
         B     UNIVRET BS2514                                           07403000
*                                                                       07404000
**    RETURN CODES                                                      07405000
*                                                                       07406000
UNIVRET  LR    R15,R11                                                  07407000
         BRTRN (15)                                                     07408000
*                                                                       07409000
         LTORG                                                          07410000
DBGLUG   DS    CL1                   DEBUG LEVEL                        07420000
UNIVEXT  RACROUTE REQUEST=EXTRACT,TYPE=EXTRACT,CLASS='GROUP',          *07430000
               ENTITYX=*-*,FIELDS=UNVFLG,WORKA=WORKU,                  *07440000
               RELEASE=1.9,SEGMENT='BASE',MF=L                          07450000
UNVFLG   DC    A(1)                                                     07460000
         DC    CL8'UNVFLG'                                              07470000
WORKU    DS    128F                                                     07480000
         DROP  ,                                                        07490000
         IRRPRXTW                                                       07500000
         ICHSAFP                                                        07510000
CTSFRCH  CSECT      RESUME CSECT AFTER TWO DSECTS                       07520000
*        END OF UNIVERS ROUTINE ADDED BY WS2427                         07530000
*********************************************************************   07540000
*                                                                   *   07550000
* CHECK GROUP  EXISTANCE                                            *   07560000
* R1 -  OFFSET :                                                    *   07570000
*              0 - ENTRY NAME ADDR                                  *   07580000
*              4 - RETCODE                                          *   07590000
*              8 - DEBUG LEVEL ADDR                                 *   07600000
*                                                                   *   07610000
*********************************************************************   07620000
*                                                                       07630000
GRPOBJ   BEGIN                                                          07640000
*                                                                       07650000
         LR    R10,R1                                                   07660000
         L     R4,0(R10)               ENTRY NAME ADDR                  07670000
         L     R8,8(R10)                                                07680000
         MVC   DBGLG(1),0(R8)          DEBUG LEVEL                      07690000
         SR    R5,R5                                                    07700000
         IC    R5,0(R4)                ENTRY NAME LENGTH                07710000
*                                                                       07720000
         CTSADBG LEVEL=(DBGLG,2,3,4,5,6,7),                            X07730000
               'GROUP=#/_',(?R5,1(R4),?R5)                              07740000
*                                                                       07750000
**    LOCATE GROUP PROFILE                                              07760000
*                                                                       07770000
         ICHEINTY ENTRY=(R4),RELEASE=1.8,MF=(E,GRPEINTY)                07780000
*                                                                       07790000
**    CHECK RACF MANAGER RETURN CODES                                   07800000
*                                                                       07810000
         L     R8,4(R10)             RETCODES ADDR                      07820000
         LA    R12,GRPEINTY                                             07830000
         L     R15,56(R12)           RACF REASON CODE                   07840000
         ST    R15,4(R8)                                                07850000
         L     R15,52(R12)           RACF RETURN CODE                   07860000
         ST    R15,0(R8)                                                07870000
         LA    R5,NOEXISTS           RACF RET CODE: ENTRY NOT EXISTS    07880000
         CR    R15,R5                NOT EXISTS                         07890000
         BE    GRPR4                 SPECIFY ENTRY NOT EXISTS           07900000
         LTR   R15,R15                                                  07910000
         BNZ   GRPR8                 OTHER ERROR. SEE RACF MANUAL       07920000
         B     GRPR0                                                    07930000
*                                                                       07940000
**    RETURN CODES                                                      07950000
*                                                                       07960000
GRPR8    DS    0H                    RACF MENAGER ERRORS                07970000
         LA    R15,8                                                    07980000
         B     GRPRT                                                    07990000
GRPR4    DS    0H                    OBJECT DOES NOT EXISTS             08000000
         LA    R15,4                                                    08010000
         B     GRPRT                                                    08020000
GRPR0    DS    0H                    OBJECT EXISTS                      08030000
*BS10043 SR    R15,0                                                    08040000
         SR    R15,R15                                        BS10043   08041000
         B     GRPRT                                                    08050000
GRPRT    DS    0H                                                       08060000
         BRTRN (15)                                                     08070000
*                                                                       08080000
         LTORG                                                          08090000
DBGLG    DS    CL1                   DEBUG LEVEL                        08100000
GRPEINTY ICHEINTY LOCATE,RELEASE=1.8,TYPE='GRP',                       108110000
               DATAMAP=NEW,WKAREA=RETAREAG,WKSP=0,MF=L                  08120000
*                                                                       08130000
*    RACF  RETURN WORK AREA ( PREFIX )                                  08140000
*                                                                       08150000
RETAREAG DS    0F                                                       08160000
         DC    F'30'                   MINIMUM LENGTH OF AREA           08170000
         DS    0CL20                                                    08180000
         DS    XL6                     RBA RETURN AREA                  08190000
         DS    X                                                        08200000
         DS    X                       RESERVED                         08210000
         DS    F                       DUPLICATE DATASET NAME COUNT     08220000
         DS    XL8                     RESERVED                         08230000
         DS    XL10                                                     08240000
         DROP  ,                                                        08250000
*                                                                       08260000
*********************************************************************   08270000
* WS2427 EXTENSIVE CHANGE FROM G2U TO U2G                           *   08280000
* CHECK CONNECTION EXISTANCE                                        *   08290000
* R1 -  OFFSET 0 - GROUP                                            *   08300000
*              4 - ENTRY NAME ADDR ( USER NAME )                    *   08310000
*              8 - ADDR OR RETCODES                                 *   08320000
*             12 - DEBUG LEVEL ADDR                                 *   08330000
*                                                                   *   08340000
*********************************************************************   08350000
*                                                                       08351000
*                                                                   *   08352000
*********************************************************************   08353000
*                                                                       08354000
CHKU2G   BEGIN                                                          08355000
*                                                                       08356000
         LR    R10,R1                                                   08357000
         L     R3,0(R10)               GROUP                            08358000
         MVC   USR2GRP(8),0(R3)        MOVE GROUP FOR TESTS             08359000
         L     R4,4(R10)               ENTRY NAME ADDR                  08360000
         L     R8,12(R10)                                               08370000
         MVC   DBGLU2G(1),0(R8)        DEBUG LEVEL                      08380000
         SR    R5,R5                                                    08390000
         IC    R5,0(R4)                ENTRY NAME LENGTH                08400000
*                                                                       08410000
         CTSADBG LEVEL=(DBGLU2G,2,3,4,5,6,7),                          X08420000
               'GROUP=_  USER=#/_',(0(R3),8,?R5,1(R4),?R5)              08430000
*                                                                       08440000
**    CHECK CONNECT EXISTANCE                                           08450000
*                                                                       08460000
         ICHEINTY ENTRY=(R4),RELEASE=1.8,MF=(E,U2GEINTY)                08470000
*                                                                       08480000
**    CHECK RACF MANAGER RETURN CODES                                   08490000
*                                                                       08500000
         L     R8,8(R10)             RETCODES ADDR                      08510000
         LA    R12,U2GEINTY                                             08520000
         L     R15,56(R12)           RACF REASON CODE                   08530000
         ST    R15,4(R8)                                                08540000
         L     R15,52(R12)           RACF RETURN CODE                   08550000
         ST    R15,0(R8)                                                08560000
         LA    R5,NOEXISTS           RACF RET CODE: ENTRY NOT EXISTS    08570000
         CR    R15,R5                NOT EXISTS                         08580000
         BE    U2GR4                 SPECIFY ENTRY NOT EXISTS           08590000
         LTR   R15,R15                                                  08600000
         BZ    U2GR0                 NO ERROR                           08610000
         CLI   U2GTST+1,X'00'        TEST OK ?                          08620000
         BNZ   U2GR4                 NO, TEST FAILS                     08630000
         B     U2GR8                                                    08640000
*                                                                       08650000
**    RETURN CODES                                                      08660000
*                                                                       08670000
U2GR8    DS    0H                    RACF MANAGER ERRORS                08680000
         LA    R15,8                                                    08690000
         B     U2GRT                                                    08700000
U2GR4    DS    0H                    OBJECT DOES NOT EXISTS             08710000
         LA    R15,4                                                    08720000
         B     U2GRT                                                    08730000
U2GR0    DS    0H                    OBJECT EXISTS                      08740000
*BS10043 SR    R15,0                                                    08750000
         SR    R15,R15                                     BS10043      08751000
         B     U2GRT                                                    08760000
U2GRT    DS    0H                                                       08770000
         BRTRN (15)                                                     08780000
*                                                                       08790000
         LTORG                                                          08800000
DBGLU2G  DS    CL1                   DEBUG LEVEL                        08810000
USR2GRP  DS    CL8                                                      08820000
U2GEINTY ICHEINTY LOCATE,TYPE='USR',RELEASE=1.8,TESTS=(U2GTST),        108830000
               DATAMAP=NEW,WKAREA=RETAREAC,WKSP=0,MF=L                  08840000
U2GTST   ICHETEST RELEASE=1.8,FIELD=CGGRPNM,COND=EQ,FLDATA=(8,USR2GRP)  08850000
*                                                                       08860000
*    RACF  RETURN WORK AREA ( PREFIX )                                  08870000
*                                                                       08880000
RETAREAC DS    0F                                                       08890000
         DC    F'30'                   MINIMUM LENGTH OF AREA           08900000
         DS    0CL20                                                    08910000
         DS    XL6                     RBA RETURN AREA                  08920000
         DS    X                                                        08930000
         DS    X                       RESERVED                         08940000
         DS    F                       DUPLICATE DATASET NAME COUNT     08950000
         DS    XL8                     RESERVED                         08960000
         DS    XL10                                                     08970000
         DROP  ,                                                        08980000
*                                                                       08990000
*********************************************************************   09000000
*                                                                   *   09010000
* CHECK RESOURCE EXISTANCE                                          *   09020000
* R1 -  OFFSET 0 - CLASS NAME                                       *   09030000
*              4 - ENTRY NAME ADDR                                  *   09040000
*              8 - VOLUME                                           *   09050000
*             12 - GENERIC FLAG                                     *   09060000
*             16 - RETCODE                                          *   09070000
*             20 - DEBUG LEVEL ADDR                                 *   09080000
*                                                                   *   09090000
*********************************************************************   09100000
*                                                                       09110000
GETRES   BEGIN                                                          09120000
*                                                                       09130000
         LR    R10,R1                                                   09140000
         L     R3,0(R10)               CLASS NAME                       09150000
         L     R4,4(R10)               ENTRY NAME ADDR                  09160000
         L     R6,8(R10)               VOLUME ADDR                      09170000
         L     R7,12(R10)              GENERIC FLAG ADDR                09180000
         L     R7,0(R7)                                                 09190000
         L     R8,20(R10)                                               09200000
         MVC   DBGLRS(1),0(R8)         DEBUG LEVEL                      09210000
         SR    R5,R5                                                    09220000
         IC    R5,0(R4)                ENTRY NAME LENGTH                09230000
*                                                                       09240000
         CTSADBG LEVEL=(DBGLRS,2,3,4,5,6,7),                           X09250000
               'CLASS=_ ENTRY=#/_ VOLUME=_ GENERIC=#',                 X09260000
               (0(R3),8,?R5,1(R4),?R5,0(R6),6,?R7)                      09270000
*                                                                       09280000
**    UPDATE ICHEINTY MACRO PARAMETER LIST                              09290000
*                                                                       09300000
         MVC   RSEINTY(RSEINTYL),RSEINTYW                               09310000
         CLC   0(7,R3),=CL7'DATASET'   CLASS  'DATASET' ?               09320000
         BE    GETDS                                                    09330000
         B     GETGENRS                                                 09340000
*                                                                       09350000
**    DATASET PROFILE                                                   09360000
*                                                                       09370000
GETDS    DS    0H                                                       09380000
         CLI   0(R6),C' '                            AS0605             09390000
         BNH   GETDSWV         WITHOUT VOLUME        AS0605             09400000
         ICHEINTY TYPE='DS',ENTRY=(R4),VOLUME=(6),OPTIONS=(NOEXEC),    X09410000
               RELEASE=1.8,MF=(E,RSEINTY)                               09420000
         B     GETGNF                                                   09430000
GETDSWV  DS    0H              WITHOUT VOLUME        AS0605             09440000
         ICHEINTY TYPE='DS',ENTRY=(R4),OPTIONS=(NOEXEC),               X09450000
               RELEASE=1.8,MF=(E,RSEINTY)            AS0605             09460000
         B     GETGNF                                AS0605             09470000
*                                                                       09480000
**    GENERAL RESOURCE PROFILE                                          09490000
*                                                                       09500000
GETGENRS DS    0H                                                       09510000
         ICHEINTY TYPE='GEN',ENTRY=(R4),VOLUME=(6),OPTIONS=(NOEXEC),   X09520000
               CLASS=(R3),RELEASE=1.8,MF=(E,RSEINTY)                    09530000
         B     GETGNF                                                   09540000
*                                                                       09550000
**    GENERIC FLAG PROCESSING                                           09560000
*                                                                       09570000
GETGNF   DS    0H                                                       09580000
         LTR   R7,R7                 GENERIC PROFILE ?                  09590000
         BNZ   GETGRG                Y,SKIP                             09600000
GETGRNG  DS    0H                    NO GENERIC PROFILE                 09610000
         ICHEINTY RELEASE=1.8,GENERIC=NO,MF=(E,RSEINTY)                 09620000
         B     GETRRC                                                   09630000
GETGRG   DS    0H                    GENERIC PROFILE                    09640000
         ICHEINTY RELEASE=1.8,GENERIC=UNCOND,MF=(E,RSEINTY)             09650000
         B     GETRRC                                                   09660000
*                                                                       09670000
**    CHECK RACF MANAGER RETURN CODES                                   09680000
*                                                                       09690000
GETRRC   DS    0H                                                       09700000
         L     R8,16(R10)            RETCODES ADDR                      09710000
         LA    R12,RSEINTY                                              09720000
         L     R15,56(R12)           RACF REASON CODE                   09730000
         ST    R15,4(R8)                                                09740000
         L     R15,52(R12)           RACF RETURN CODE                   09750000
         ST    R15,0(R8)                                                09760000
         LA    R5,NOEXISTS           RACF RET CODE: ENTRY NOT EXISTS    09770000
         CR    R15,R5                NOT EXISTS                         09780000
         BE    GETRRC4               SPECIFY ENTRY NOT EXISTS           09790000
         LTR   R15,R15                                                  09800000
         BNZ   GETRRC8               OTHER ERROR. SEE RACF MANUAL       09810000
         B     GETRRC0                                                  09820000
*                                                                       09830000
**    RETURN CODES                                                      09840000
*                                                                       09850000
GETRRC8  DS    0H                    RACF MENAGER ERRORS                09860000
         LA    R15,8                                                    09870000
         B     GETRRT                                                   09880000
GETRRC4  DS    0H                    OBJECT DOES NOT EXISTS             09890000
         LA    R15,4                                                    09900000
         B     GETRRT                                                   09910000
GETRRC0  DS    0H                    OBJECT EXISTS                      09920000
*BS10043 SR    R15,0                                                    09930000
         SR    R15,R15                                    BS10043       09931000
         B     GETRRT                                                   09940000
GETRRT   DS    0H                                                       09950000
         BRTRN (15)                                                     09960000
*                                                                       09970000
         LTORG                                                          09980000
DBGLRS   DS    CL1                   DEBUG LEVEL                        09990000
RSEINTY  ICHEINTY LOCATE,RELEASE=1.8,                                  110000000
               DATAMAP=NEW,WKAREA=RETAREAR,WKSP=0,MF=L                  10010000
RSEINTYW ICHEINTY LOCATE,RELEASE=1.8,                                  110020000
               DATAMAP=NEW,WKAREA=RETAREAR,WKSP=0,MF=L                  10030000
RSEINTYL EQU   *-RSEINTYW                                               10040000
*                                                                       10050000
*    REACF  RETURN WORK AREA ( PREFIX )                                 10060000
*                                                                       10070000
RETAREAR DS    0F                                                       10080000
         DC    F'30'                   MINIMUM LENGTH OF AREA           10090000
         DS    0CL20                                                    10100000
         DS    XL6                     RBA RETURN AREA                  10110000
         DS    X                                                        10120000
         DS    X                       RESERVED                         10130000
         DS    F                       DUPLICATE DATASET NAME COUNT     10140000
         DS    XL8                     RESERVED                         10150000
         DS    XL10                                                     10160000
         DROP  ,                                                        10170000
*                                                                       10180000
*********************************************************************   10190000
*                                                                   *   10200000
* CHECK DATASET PROFILE WITH REQUESTED HIGH QUALIFIER               *   10210000
* R1 -  OFFSET 0 - QUALIFIER                                        *   10220000
*              4 - ENTRY NAME ADDR      ( QUALIFIER )               *   10230000
*              8 - RETCODE                                          *   10240000
*             12 - DEBUG LEVEL ADDR                                 *   10250000
*                                                                   *   10260000
*********************************************************************   10270000
*                                                                       10280000
GETQLF   BEGIN                                                          10290000
*                                                                       10300000
         LR    R10,R1                                                   10310000
         L     R3,0(R10)               QUALIFIER                        10320000
         L     R4,4(R10)               ENTRY NAME ADDR ( QUALIFIER )    10330000
         L     R8,12(R10)                                               10340000
         MVC   DBGLQLF(1),0(R8)        DEBUG LEVEL                      10350000
         SR    R5,R5                                                    10360000
         IC    R5,0(R4)                ENTRY NAME LENGTH                10370000
*                                                                       10380000
**    BUILD QUALIFIER IN ORDER "OBJECTID."                              10390000
*                                                                       10400000
         LR    R6,R4                   ENTRY NAME ADDR                  10410000
         LA    R6,1(R6)                BRANCH OVER THE LENGTH           10420000
         AR    R6,R5                   ADDR OF LAST BYTE                10430000
         MVI   0(R6),C'.'              ADD DOT TO ENTRY NAME            10440000
         EX    R5,MOVQLF               MOVE QUALIFIER                   10450000
         LA    R5,1(R5)                ENTRY NAME LEN += 1              10460000
         STC   R5,0(R4)                UPDATE ENTRY NAME LENGTH         10470000
*                                                                       10480000
         CTSADBG LEVEL=(DBGLQLF,2,3,4,5,6,7),                          X10490000
               'QUALIFIER=#/_',(?R5,1(R4),?R5)                          10500000
*                                                                       10510000
**    LOCATE DATASET PROFILE                                            10520000
*                                                                       10530000
         ICHEINTY RELEASE=1.8,ENTRY=(R4),MF=(E,QLFEINTY)                10540000
*                                                                       10550000
**    CHECK RACF MANAGER RETURN CODES                                   10560000
*                                                                       10570000
         L     R8,8(R10)             RETCODES ADDR                      10580000
         LA    R12,QLFEINTY                                             10590000
         L     R15,56(R12)           RACF REASON CODE                   10600000
         ST    R15,4(R8)                                                10610000
         L     R15,52(R12)           RACF RETURN CODE                   10620000
         ST    R15,0(R8)                                                10630000
         LA    R6,NOEXISTS           RACF RET CODE: ENTRY NOT EXISTS    10640000
         CR    R15,R6                NOT EXISTS                         10650000
         BE    QLFR4                 SPECIFY ENTRY NOT EXISTS           10660000
         LTR   R15,R15                                                  10670000
         BNZ   QLFR8                 OTHER ERROR. SEE RACF MANUAL       10680000
*                                                                       10690000
**    CHECK QUALIFIER                                                   10700000
*                                                                       10710000
*                                                                       10720000
         SR    R6,R6                                                    10730000
         IC    R6,0(R4)                                                 10740000
         CTSADBG LEVEL=(DBGLQLF,2,3,4,5,6,7),                          X10750000
               'ENTRY NAME=#/_ QUALIFIER=#/_',                         X10760000
               (?R6,1(R4),?R6,?R5,0(R3),?R5)                            10770000
         BCTR  R5,0                                                     10780000
         EX    R5,CHKQLF                                                10790000
         BE    QLFR0                 DATASET WITH REQ QUALIFIER FOUND   10800000
         B     QLFR4                 DATASET WITH REQ QUALIF NOT FOUND  10810000
*                                                                       10820000
**    RETURN CODES                                                      10830000
*                                                                       10840000
QLFR8    DS    0H                    RACF MENAGER ERRORS                10850000
         LA    R15,8                                                    10860000
         B     QLFRT                                                    10870000
QLFR4    DS    0H                    OBJECT DOES NOT EXISTS             10880000
         LA    R15,4                                                    10890000
         B     QLFRT                                                    10900000
QLFR0    DS    0H                    OBJECT EXISTS                      10910000
*BS10043 SR    R15,0                                                    10920000
         SR    R15,R15                                     BS10043      10921000
         B     QLFRT                                                    10930000
QLFRT    DS    0H                                                       10940000
         BRTRN (15)                                                     10950000
*                                                                       10960000
         LTORG                                                          10970000
DBGLQLF  DS    CL1                   DEBUG LEVEL                        10980000
MOVQLF   MVC   0(0,R3),1(R4)         MOVE QUALIFIER                     10990000
CHKQLF   CLC   0(0,R3),1(R4)         CHECK QUALIFIER                    11000000
QLFEINTY ICHEINTY NEXTC,RELEASE=1.8,TYPE='DS',GENERIC=UNCOND,          111010000
               DATAMAP=NEW,WKAREA=RETAREAQ,WKSP=0,MF=L                  11020000
*                                                                       11030000
*    REACF  RETURN WORK AREA ( PREFIX )                                 11040000
*                                                                       11050000
RETAREAQ DS    0F                                                       11060000
         DC    F'30'                   MINIMUM LENGTH OF AREA           11070000
         DS    0CL20                                                    11080000
         DS    XL6                     RBA RETURN AREA                  11090000
         DS    X                                                        11100000
         DS    X                       RESERVED                         11110000
         DS    F                       DUPLICATE DATASET NAME COUNT     11120000
         DS    XL8                     RESERVED                         11130000
         DS    XL10                                                     11140000
         DROP  ,                                                        11150000
*                                                                       11160000
*********************************************************************   11170000
*                                                                   *   11180000
* CHECK ACE RESOURCE'S EXISTANCE                                    *   11181000
* R1 -  OFFSET 0 - USER/GROUP                                       *   11182000
*              4 - ACCESS                                           *   11183000
*              8 - RESOURCE CLASS                                   *   11184000
*             12 - PROFILE NAME                                     *   11185000
*             16 - VOLUME                                           *   11185100
*             20 - GENERIC FLAG                                     *   11185200
*             24 - RETURNED ACCESS                                  *   11185300
*             28 - RETCODE                                          *   11185400
*             32 - DEBUG LEVEL ADDR                                 *   11185500
*                                                                   *   11185600
*********************************************************************   11185700
*                                                                       11185800
GETRS1   BEGIN                                                          11185900
*                                                                       11186000
         LR    R10,R1                                                   11186100
*                                                                       11186200
**    BUILD PARAMETERS FOR ICHEINTY ACCESS                              11186300
*                                                                       11186400
         L     R8,=A(R1RTEND)          END ADDR OF RET AREA             11186500
         S     R8,=A(R1RTAREA)         START ADDR OF RET AREA           11186600
         ST    R8,R1ALEN               SAVE AREA LENGTH                 11186700
*                                                                       11186800
         L     R3,0(R10)               OBJECT ID                        11186900
         MVC   ACCP1U(8),0(R3)                                          11187000
         L     R3,4(R10)               ACCESS                           11187100
         MVC   ACCRS1(8),0(R3)                                          11187200
         CTSCALL ACC2FLAG,(ACCRS1,ACCP1A),LINK=INT                      11187300
         L     R3,24(R10)              RETURNED ACCESS                  11187400
         MVC   0(8,R3),=CL8' '                                          11187500
         L     R3,8(R10)               CLASS NAME                       11187600
         L     R4,12(R10)              ENTRY NAME ADDR                  11187700
         L     R6,16(R10)              VOLUME ADDR                      11187800
         L     R7,20(R10)              GENERIC FLAG ADDR                11187900
         L     R7,0(R7)                                                 11188000
         L     R8,32(R10)                                               11188100
         MVC   DBGLRS1(1),0(R8)        DEBUG LEVEL                      11188200
         SR    R5,R5                                                    11188300
         IC    R5,0(R4)                ENTRY NAME LENGTH                11188400
*                                                                       11188500
         CTSADBG LEVEL=(DBGLRS1,2,3,4,5,6,7),                          X11188600
               'OBJ=_ ACCESS=$/_ CLASS=_ ENTRY=#/_ VOLUME=_ GENERIC=#',X11188700
               (ACCP1U,8,ACCP1A,1,ACCRS1,8,0(R3),8,?R5,1(R4),?R5,      X11188800
               0(R6),8,?R7)                                             11188900
*                                                                       11189000
**    UPDATE ICHEINTY MACRO PARAMETER LIST                              11189100
*                                                                       11189200
         MVC   AR1EINTY(AR1EINTL),AR1EINTW                              11189300
         ICHEINTY RELEASE=1.8,OPTIONS=(FLDEF,NOEXEC),                  X11189400
               MF=(E,AR1EINTY)                       BSAR1010           11189500
         CLC   0(7,R3),=CL7'DATASET'   CLASS  'DATASET' ?               11189600
         BE    GETDSR1                                                  11189700
         B     GETGNR1                                                  11189800
*                                                                       11189900
**    DATASET PROFILE                                                   11190000
*                                                                       11190100
GETDSR1  DS    0H                                                       11190200
         CLI   0(R6),C' '                            AS0605             11190300
         BNH   GETDSWV1        WITHOUT VOLUME        AS0605             11190400
         ICHEINTY TYPE='DS',ENTRY=(R4),VOLUME=(R6),RELEASE=1.8,        X11190500
               OPTIONS=(NOEXEC),MF=(E,AR1EINTY)                         11190600
         B     GTGNFR1                                                  11190700
GETDSWV1 DS    0H              WITHOUT VOLUME        AS0605             11190800
         ICHEINTY TYPE='DS',ENTRY=(R4),RELEASE=1.8,                    X11190900
               OPTIONS=(NOEXEC),MF=(E,AR1EINTY)                         11191000
         B     GTGNFR1                                                  11191100
*                                                                       11191200
**    GENERAL RESOURCE PROFILE                                          11191300
*                                                                       11191400
GETGNR1  DS    0H                                                       11191500
         CLI   0(R6),C' '                            BSAR1010           11191600
         BNH   GETGNWV1        WITHOUT VOLUME        BSAR1010           11191700
         ICHEINTY TYPE='GEN',ENTRY=(R4),VOLUME=(R6),RELEASE=1.8,       X11191800
               OPTIONS=(NOEXEC),CLASS=(R3),MF=(E,AR1EINTY)              11191900
         B     GTGNFR1                                                  11192000
GETGNWV1 DS    0H              WITHOUT VOLUME        BSAR1010           11192100
         ICHEINTY TYPE='GEN',ENTRY=(R4),RELEASE=1.8,                   X11192200
               OPTIONS=(NOEXEC),CLASS=(R3),MF=(E,AR1EINTY)              11192300
         B     GTGNFR1                                                  11192400
*                                                                       11192500
**    GENERIC FLAG PROCESSING                                           11192600
*                                                                       11192700
GTGNFR1  DS    0H                                                       11192800
         LTR   R7,R7                   GENERIC PROFILE ?                11192900
         BNZ   GETGR1                  Y,SKIP                           11193000
GETNGR1  DS    0H                      NO GENERIC PROFILE               11193100
         ICHEINTY GENERIC=NO,OPTIONS=(NOEXEC),RELEASE=1.8,             X11193200
               MF=(E,AR1EINTY)                                          11193300
         B     GTR1GT1                                                  11193400
GETGR1   DS    0H                      GENERIC PROFILE                  11193500
         ICHEINTY GENERIC=UNCOND,OPTIONS=(NOEXEC),RELEASE=1.8,         X11193600
               MF=(E,AR1EINTY)                                          11193700
         B     GTR1GT1                                                  11193800
*                                                                       11193900
**    ACCESS TO RACF DB, CHECK RACF MANAGER RETURN CODES                11194000
**    AND CHECK RETRIEVED ACCESS                                        11194100
*                                                                       11194200
GTR1GT1  DS    0H                                                       11194300
         CTSADBG LEVEL=(DBGLRS1,2,3,4,5,6,7),                          X11194400
               'BEFORE SVC AR1EINTY=$',(AR1EINTY,30)                    11194500
         ICHEINTY MF=(E,AR1EINTY)      INVOKE ICHEINTY WITH TESTS       11194600
         CTSADBG LEVEL=(DBGLRS1,2,3,4,5,6,7),                          X11194700
               'AFTER  SVC AR1EINTY=$',(AR1EINTY,30)                    11194800
         L     R8,28(R10)              RETCODES ADDR                    11194900
         LA    R12,AR1EINTY                                             11195000
         L     R15,56(R12)             RACF REASON CODE                 11195100
         ST    R15,4(R8)                                                11195200
         L     R15,52(R12)             RACF RETURN CODE                 11195300
         ST    R15,0(R8)                                                11195400
*                                                                       11195500
         CTSADBG LEVEL=(DBGLRS1,2,3,4,5,6,7),                          X11195600
               '1.RC=~ REASON=~ OBJ=_ ACC(ENTER/RACF)=$/$ T/FLAG=$',   X11195700
               (0(R8),4(R8),ACCP1U,8,ACCP1A,1,R1ACC,1,USRTEST+1,1)      11195800
         CTSADBG LEVEL=(DBGLRS1,2,3,4,5,6,7),                          X11195900
               '2.R1DATA=$',(R1DATA,30)                                 11196000
*                                                                       11196100
         LA    R5,NOEXISTS             RACF RET CODE: ENTRY NOT EXISTS  11196200
         CR    R15,R5                  NOT EXISTS                       11196300
         BE    GTR1RC4                 SPECIFY ENTRY NOT EXISTS         11196400
         LTR   R15,R15                 RACF RC NE 0.                    11196500
         BNZ   GTR1RC8                                                  11196600
*                                                                       11196700
*    RACF MANAGER RC EQ 0                                               11196800
*                                                                       11196900
         CLI   USRTEST+1,X'00'       USER TEST OK ?                     11197000
         BNE   GTR1RC4               N,SKIP ( USER NOT FOUND )          11197100
*                                                                       11197200
**   RETURN OBTAINED RACF ACCESS TO CALLER                              11197300
*                                                                       11197400
         CTSCALL FLAG2ACC,(ACCRS1,R1ACC),LINK=INT                       11197500
         L     R3,24(R10)            RETURN ACCESS ADDRESS              11197600
         MVC   0(8,R3),ACCRS1                                           11197700
*                                                                       11197800
**   CHECK MATCHING OF RETRIEVED ACCESS AND ENTERED ACCESS              11197900
*                                                                       11198000
         CLI   ACCP1A,X'00'          ACCESS WAS ENTERED ?               11198100
         BE    GTR1RC0               NO,EXIT                            11198200
         SR    R8,R8                                                    11198300
         IC    R8,ACCP1A             ENTERED MASK                       11198400
         EX    R8,CHKAMSK            CHECK ENTERED ACCESS MASK          11198500
         BO    GTR1RC0                                                  11198600
         B     GTR1RC4                                                  11198700
*                                                                       11198800
**    RETURN CODES                                                      11198900
*                                                                       11199000
GTR1RC8  DS    0H                    RACF MENAGER ERRORS                11199100
         LA    R15,8                                                    11199200
         B     GTR1RT                                                   11199300
GTR1RC4  DS    0H                    OBJECT DOES NOT EXISTS             11199400
         LA    R15,4                                                    11199500
         B     GTR1RT                                                   11199600
GTR1RC0  DS    0H                    OBJECT EXISTS                      11199700
*BS10043 SR    R15,0                                                    11199800
         SR    R15,R15                                     BS10043      11199900
         L     R3,24(R10)              RETURNED ACCESS                  11200000
         MVC   0(8,R3),ACCRS1                                           11200100
         B     GTR1RT                                                   11200200
GTR1RT   DS    0H                                                       11200300
         BRTRN (15)                                                     11200400
*                                                                       11200500
         LTORG                                                          11200600
CHKAMSK  TM    R1ACC,0               CHECK ACCESS MASK                  11200700
DBGLRS1  DS    CL1                   DEBUG LEVEL                        11200800
ACCRS1   DS    CL8                   ACCESS TEXT                        11200900
ACCP1RS1 DS    0CL11                 ACCESS LIST ENTRY                  11201000
ACCP1U   DS    CL8                   OBJECT ID                          11201100
ACCP1A   DS    XL1                   ACCESS FLAG                        11201200
         DS    XL2                   ACCESS COUNT                       11201300
*                                                                       11201400
*   ICHEINTY PARAMETER LIST FOR CHECK USER,ACCESS EXICTANCE             11201500
*                                                                       11201600
AR1EINTY ICHEINTY LOCATE,RELEASE=1.8,                                  X11201700
               ACTIONS=(GETACC),                                       X11201800
               DATAMAP=NEW,WKAREA=R1RTAREA,WKSP=0,MF=L                  11201900
AR1EINTW ICHEINTY LOCATE,RELEASE=1.8,                                  X11202000
               ACTIONS=(GETACC),                                       X11202100
               DATAMAP=NEW,WKAREA=R1RTAREA,WKSP=0,MF=L                  11202200
AR1EINTL EQU   *-AR1EINTW                                               11202300
GETACC   ICHEACTN MF=L,FIELD=ACL,RELEASE=1.8,                          X11202400
               TESTS=(USRTEST)                                          11202500
*                                                                       11202600
USRTEST  ICHETEST FIELD=USERID,COND=EQ,FLDATA=(8,ACCP1U),RELEASE=1.8    11202700
*                                                                       11202800
*  RACF RETURN AREA                                                     11202900
*                                                                       11203000
R1RTAREA DS    0F                                                       11203100
R1ALEN   DS    F                       LENGTH OF AREA                   11203200
         DS    0CL20                                                    11203300
R1RBA    DS    XL6                     RBA                              11203400
R1FLAGS  DS    X                                                        11203500
         DS    X                       RESERVED                         11203600
         DS    F                       DUPLICATE DATASET NAME COUNT     11203700
         DS    XL8                     RESERVED                         11203800
R1DLEN   DS    F                       RETDATA LEN                      11203900
R1DATA   DS    CL256                                                    11204000
         ORG   R1DATA                                                   11204100
         DS    AL4                     TOTAL DATA LEN                   11204200
         DS    AL4                     USERID LEN                       11204300
         DS    CL8                     USERID VALUE                     11204400
         DS    AL4                     ACCESS LEN                       11204500
R1ACC    DS    XL1                     ACCESS VALUE                     11204600
         ORG                                                            11204700
R1RTEND  DS    CL1                                                      11204800
         DROP  ,                                                        11204900
*                                                                       11205000
*********************************************************************   11205100
*                                                                   *   11205200
* CHECK CONDITIONAL ACE RESOURCE'S EXISTANCE                        *   11205300
* R1 -  OFFSET 0 - USER/GROUP                                       *   11205400
*              4 - ACCESS                                           *   11205500
*              8 - WHEN TYPE                                        *   11205600
*             12 - WHEN NAME                                        *   11205700
*             16 - RESOURCE CLASS                                   *   11205800
*             20 - PROFILE NAME                                     *   11205900
*             24 - VOLUME                                           *   11206000
*             28 - GENERIC FLAG                                     *   11206100
*             32 - RETURNED ACCESS                                  *   11206200
*             36 - RETCODE                                          *   11206300
*             40 - DEBUG LEVEL ADDR                                 *   11206400
*                                                                   *   11206500
*********************************************************************   11206600
*                                                                       11206700
GETRS2   BEGIN *,R12                                                    11206800
*                                                                       11206900
         LR    R10,R1                                                   11207000
         XC    AAREA,AAREA             ADDRESS OF EXTRACTOR AREA        11207100
*                                                                       11207200
**    BUILD PARAMETERS FOR ICHEINTY ACCESS                              11207300
*                                                                       11207400
         L     R3,0(R10)               OBJECT ID                        11207500
         MVC   ACCP2U(8),0(R3)                                          11207600
         L     R3,4(R10)               ACCESS                           11207700
         MVC   ACCRS2(8),0(R3)                                          11207800
         CTSCALL ACC2FLAG,(ACCRS2,ACCP2A),LINK=INT                      11207900
         L     R3,32(R10)              RETURN ACCESS ADDRESS            11208000
         MVC   0(8,R3),=CL8' '                                          11208100
         L     R3,16(R10)              CLASS NAME                       11208200
         MVC   CLS(8),0(R3)                                             11208300
         L     R4,20(R10)              ENTRY NAME ADDR                  11208400
         L     R3,24(R10)              VOLUME ADDR                      11208500
         MVC   VOL(6),0(R3)                                             11208600
         L     R3,28(R10)              GENERIC FLAG ADDR                11208700
         L     R3,0(R3)                                                 11208800
         LTR   R3,R3                                                    11208900
         BZ    NOGENERC                NOGENERIC PROFILE                11209000
         MVC   GENERIC(8),=CL8'UNCOND' GENERIC PROFILE                  11209100
         B     R21                                                      11209200
NOGENERC DS    0H                      NOGENERIC PROFILE                11209300
         MVC   GENERIC(8),=CL8'NO'                                      11209400
R21      DS    0H                                                       11209500
         L     R8,40(R10)                                               11209600
         MVC   DBGLRS2(1),0(R8)        DEBUG LEVEL                      11209700
         XC    DBGLRS2X,DBGLRS2X       DEBUG LEVEL FOR EXTRACTOR        11209800
         MVC   DBGLRS2X+3(1),0(R8)     DEBUG LEVEL FOR EXTRACTOR        11209900
         SR    R5,R5                                                    11210000
         IC    R5,0(R4)                ENTRY NAME LENGTH                11210100
         STC   R5,ENTRYR2                                               11210200
         BCTR  R5,0                    DECR FOR EX COMMAND              11210300
         EX    R5,MVENTRY              MOVE ENTRY NAME                  11210400
         LA    R5,1(R5)                RESTORE ENTRY NAME LEN           11210500
         L     R8,8(R10)               WHEN TYPE ADDR                   11210600
         L     R9,12(R10)              WHEN NAME ADDR                   11210700
         SR    R11,R11                                                  11210800
         IC    R11,0(R9)               WHEN NAME LEN                    11210900
*                                                                       11211000
         CTSADBG LEVEL=(DBGLRS2,2,3,4,5,6,7),                          X11211100
               'OBJ=_ ACC=$/_ W=_/#/_ CLS=_ ENTRY=#/_ VOL=_ GEN=_',    X11211200
               (ACCP2U,8,ACCP2A,1,ACCRS2,8,0(R8),8,?R11,1(R9),?R11,    X11211300
               CLS,8,?R5,1(R4),?R5,                                    X11211400
               VOL,6,GENERIC,8)                                         11211500
         SR    R6,R6                                                    11211600
         IC    R6,ENTRYR2                                               11211700
*                                                                       11211800
**    GET MEMORY FOR EXTRACTOR                                          11211900
*                                                                       11212000
         L     R0,LAREA                EXTRACTOR OUTPUT LEN             11212100
         GETMAIN RC,LV=(0)                                              11212200
         LTR   R15,R15                                                  11212300
         BNZ   GTR2RC8                 ALLOCATE ERR                     11212400
         ST    R1,AAREA                ADDRESS OF EXTRACTOR AREA        11212500
         SR    R2,R2                                                    11212600
         MVC   0(4,R1),0(R9)           STORE MAX LENGTH                 11212700
         ST    R2,4(R1)                CLEAR USE LENGTH                 11212800
*                                                                       11212900
**    BUILD PARAMETER LIST                                              11213000
*                                                                       11213100
         MVC   ACCP2WT(8),0(R8)        WHEN TYPE (PROGRAM,TERMINAL,..)  11213200
         STCM  R11,X'7',ACCP2WL        WHEN NAME LENGTH                 11213300
         LTR   R11,R11                                                  11213400
         BZ    GTR2RC8                 WHEN NAME LEN ERR                11213500
         BCTR  R11,0                   DECR FOR EX COMMAND              11213600
         EX    R11,MVWNNM              MOVE WHEN NAME                   11213700
         LA    R11,1(R11)              RESTORE WHEN NAME LENGTH         11213800
         LA    R11,3(R11)              ADD FIELD LEN                    11213900
         LA    R11,8(R11)              ADD WHEN TYPE LEN                11214000
         STCM  R11,X'F',ACCP2W0        TOTAL LEN                        11214100
*                                                                       11214200
**    CHECK REQUESTED CLASS                                             11214300
*                                                                       11214400
         CLC   CLS(7),=CL7'DATASET'   CLASS  'DATASET' ?                11214500
         BNE   GETGNR2                GOTO GENERAL RESOURCE             11214600
*                                                                       11214700
**    DATASET PROFILE . INVOKE EXTRACTOR                                11214800
*                                                                       11214900
GETDSR2  DS    0H                                                       11215000
         XC    PRMOUT,PRMOUT         OUTPT PARAMETER FOR TEST ROUTINE   11215100
         L     R8,DSACCTST           TEST ROUTINE DATASET PROFILE       11215200
         USING TSTDSACC,R8           TEST ROUTINE DATASET PROFILE       11215300
         MVC   DSINP(4),=A(PRMINP)   INPUT PARAMETER FOR TEST ROUTINE   11215400
         MVC   DSOUT(4),=A(PRMOUT)   OUTPT PARAMETER FOR TEST ROUTINE   11215500
         MVC   DBGR2T,DBGLRS2        DEBUG LEVEL                        11215600
         DROP  R8                                                       11215700
         CLI   VOL,C' '                              AS0605             11215800
         BNH   GETDSWV2        WITHOUT VOLUME        AS0605             11215900
         CTSFAGR LOCATE,                                               111216000
               TYPE='DS',OUTEP=OUTP,OUTAREA=AAREA,GENERIC=GENERIC,     211216100
               DATAMAP=NEW,ENTRY=ENTRYR2,RC=RETCODE2,TEST=DSACCTST,    311216200
               EOE=NO,GETPRG=CTSFRXT,DEBUG=DBGLRS2X,VOLUME=VOL,        411216300
               (TXTL='PROFILE'),                                       *11216400
               (USER2ACS,L,C,TXTL='USER2ACS',EOL=NO),                  *11216500
               (PROGRAM,L,C,TXTL='PROGRAM',EOL=NO),                    *11216600
               (ACL2VAR,L,C,TXTL='ACL2VAR',EOL=NO),                    *11216700
               (PROGACS,L,X,TXTL='PROGACS',NL=YES)                      11216800
         B     GTR2RC                                                   11216900
GETDSWV2 DS    0H              WITHOUT VOLUME        AS0605             11217000
         CTSFAGR LOCATE,                                               111217100
               TYPE='DS',OUTEP=OUTP,OUTAREA=AAREA,GENERIC=GENERIC,     211217200
               DATAMAP=NEW,ENTRY=ENTRYR2,RC=RETCODE2,TEST=DSACCTST,    311217300
               EOE=NO,GETPRG=CTSFRXT,DEBUG=DBGLRS2X,                   411217400
               (TXTL='PROFILE'),                                       *11217500
               (USER2ACS,L,C,TXTL='USER2ACS',EOL=NO),                  *11217600
               (PROGRAM,L,C,TXTL='PROGRAM',EOL=NO),                    *11217700
               (ACL2VAR,L,C,TXTL='ACL2VAR',EOL=NO),                    *11217800
               (PROGACS,L,X,TXTL='PROGACS',NL=YES)                      11217900
         B     GTR2RC                                                   11218000
*                                                                       11218100
**    GENERAL RESOURCE PROFILE . INVOKE EXTRACTOR                       11218200
*                                                                       11218300
GETGNR2  DS    0H                                                       11218400
         XC    PRMOUT,PRMOUT         OUTPT PARAMETER FOR TEST ROUTINE   11218500
         L     R8,GRACCTST           TEST ROUTINE GENERAL RES PROFILE   11218600
         USING TSTGRACC,R8           TEST ROUTINE GENERAL RES PROFILE   11218700
         MVC   GRPINP(4),=A(PRMINP)  INPUT PARAMETER FOR TEST ROUTINE   11218800
         MVC   GRPOUT(4),=A(PRMOUT)  OUTPT PARAMETER FOR TEST ROUTINE   11218900
         MVC   DBGR2TG,DBGLRS2       DEBUG LEVEL                        11219000
         DROP  R8                                                       11219100
         CLI   VOL,C' '                              BSAR1010           11219200
         BNH   GETGNWV2        WITHOUT VOLUME        BSAR1010           11219300
         CTSFAGR LOCATE,                                               111219400
               TYPE='GEN',OUTEP=OUTP,OUTAREA=AAREA,GENERIC=GENERIC,    211219500
               DATAMAP=NEW,ENTRY=ENTRYR2,RC=RETCODE2,TEST=GRACCTST,    311219600
               EOE=NO,GETPRG=CTSFRXT,CLASS=CLS,DEBUG=DBGLRS2X,         411219700
               VOLUME=VOL,                                             511219800
               (TXTL='PROFILE'),                                       *11219900
               (ACL2UID,L,C,TXTL='ACL2UID',EOL=NO),                    *11220000
               (ACL2RSVD,L,C,TXTL='ACL2RSVD',EOL=NO),                  *11220100
               (ACL2ACC,L,X,TXTL='ACL2ACC',NL=YES)                      11220200
         B     GTR2RC                                                   11220300
*                                                                       11220400
GETGNWV2 DS    0H              WITHOUT VOLUME        BSAR1010           11220500
         CTSFAGR LOCATE,                                               111220600
               TYPE='GEN',OUTEP=OUTP,OUTAREA=AAREA,GENERIC=GENERIC,    211220700
               DATAMAP=NEW,ENTRY=ENTRYR2,RC=RETCODE2,TEST=GRACCTST,    311220800
               EOE=NO,GETPRG=CTSFRXT,CLASS=CLS,DEBUG=DBGLRS2X,         411220900
               (TXTL='PROFILE'),                                       *11221000
               (ACL2UID,L,C,TXTL='ACL2UID',EOL=NO),                    *11221100
               (ACL2RSVD,L,C,TXTL='ACL2RSVD',EOL=NO),                  *11221200
               (ACL2ACC,L,X,TXTL='ACL2ACC',NL=YES)                      11221300
         B     GTR2RC                                                   11221400
*                                                                       11221500
**    CHECK RACF MANAGER RETURN CODES                                   11221600
*                                                                       11221700
GTR2RC   DS    0H                                                       11221800
         CTSADBG LEVEL=(DBGLRS2,2,3,4,5,6,7),                          X11221900
               'RC=#/#/# TESTS FLAGS U/W=$/$ RET ACCESS=$',            X11222000
               (RETCODE2,RETCODE2+4,RETCODE2+8,                        X11222100
               PRMOUT,1,PRMOUT+2,1,PRMOUT+3,1)                          11222200
*                                                                       11222300
         L     R8,36(R10)              RETCODES ADDR                    11222400
         MVC   0(4,R8),RETCODE2        RACF RC                          11222500
         MVC   4(4,R8),RETCODE2+4      RACF REASON CODE                 11222600
         L     R15,RETCODE2+8          EXTRACTOR RC                     11222700
         LTR   R15,R15                                                  11222800
         BNZ   GTR2RC8                                                  11222900
         LA    R5,NOEXISTS             RACF RET CODE: ENTRY NOT EXISTS  11223000
         C     R5,RETCODE2             PROFILE DOES NOT EXISTS          11223100
         BE    GTR2RC4                 SPECIFY ENTRY DOES NOT EXISTS    11223200
         L     R5,RETCODE2             RACF RC                          11223300
         LTR   R5,R5                   RACF RC NE 0                     11223400
         BNZ   GTR2RC8                                                  11223500
         CLI   PRMOUT,1                USER FOUND ?                     11223600
         BNE   GTR2RC4                 N, RETURN                        11223700
         CLI   PRMOUT+2,1              WHEN INFO FOUND ?                11223800
         BNE   GTR2RC4                 N, RETURN                        11223900
         CTSCALL FLAG2ACC,(ACCRS2,PRMOUT+3),LINK=INT                    11224000
         L     R3,32(R10)              RETURNED ACCESS                  11224100
         MVC   0(8,R3),ACCRS2                                           11224200
         SR    R5,R5                                                    11224300
         IC    R5,ACCP2A               RETRIEVED ACCESS BYTE MASK       11224400
         LTR   R5,R5                                                    11224500
         BZ    GTR2RC0                 ACCESS WAS NOT ENTERED,RETURN    11224600
         EX    R5,CHKAMSK2             CHECK ENTERED ACCESS MASK        11224700
         BO    GTR2RC0                 ACCESS MATCHED                   11224800
         B     GTR2RC4                 ACCESS NOT MATCHED               11224900
*                                                                       11225000
*                                                                       11225100
**    RETURN CODES                                                      11225200
*                                                                       11225300
GTR2RC8  DS    0H                    RACF MENAGER ERRORS                11225400
         LA    R15,8                                                    11225500
         B     GTR2RT                                                   11225600
GTR2RC4  DS    0H                    OBJECT DOES NOT EXISTS             11225700
         LA    R15,4                                                    11225800
         B     GTR2RT                                                   11225900
GTR2RC0  DS    0H                    OBJECT EXISTS                      11226000
         SR    R15,R15                                                  11226100
         L     R3,32(R10)            RETURNED ACCESS                    11226200
         MVC   0(8,R3),ACCRS2                                           11226300
         B     GTR2RT                                                   11226400
GTR2RT   DS    0H                                                       11226500
         LR    R3,R15                SAVE RET CODE.   BSAR1005          11226600
*                                                                       11226700
*  FREE EXTRACTOR OUTPUT AREA                                           11226800
*                                                                       11226900
         L     R0,LAREA              EXTRACTOR OUTPUT AREA              11227000
         L     R1,AAREA              ADDR EXTRACTOR AREA                11227100
         LTR   R1,R1                 MEMORE WAS NOT ALLOCATED           11227200
         BZ    GTR2RT1                                                  11227300
         FREEMAIN RC,A=(1),LV=(0)                                       11227400
         LTR   R15,R15                                                  11227500
         BZ    GTR2RT1                                                  11227600
*DEL*    LA    R15,8                 FREE MEMORY ERR  BSAR1005          11227700
         LA    R3,8                  FREE MEMORY ERR  BSAR1005          11227800
GTR2RT1  DS    0H                                                       11227900
         LR    R15,R3                RESTORE RET.CODE BSAR1005          11228000
         BRTRN (15)                                                     11228100
*                                                                       11228200
         LTORG                                                          11228300
CHKAMSK2 TM    PRMOUT+3,0            CHECK ACCESS MASK                  11228400
LAREA    DC    F'4096'               LENGTH OF EXTRACTOR OUTPUT AREA    11228500
AAREA    DS    F                     ADDRESS OF EXTRACTOR OUTPUT AREA   11228600
OUTP     DC    A(DUMMY)              DUMMY OUTPUT ROUTINE               11228700
CTSFRXT  DC    V(CTSFRXT)            EXTRACTOR ROUTINE                  11228800
DSACCTST DC    A(TSTDSACC)           TEST ROUTINE DATASET PROFILE       11228900
GRACCTST DC    A(TSTGRACC)           TEST ROUTINE GENERAL RES PROFILE   11229000
RETCODE2 DS    3F                    1-RACF RC,2-RACF RESON,3-EXTR RC   11229100
ENTRYR2  DS    0F                    ENTRY NAME                         11229200
         DS    CL1                   ENTRY NAME LEN                     11229300
         DS    CL256                 ENTRY NAME VAL                     11229400
CLS      DS    CL8                   CLASS                              11229500
VOL      DS    CL8                   VOLUME                             11229600
GENERIC  DS    CL8                   GENERIC PARAMETER                  11229700
MVWNNM   MVC   ACCP2WN(0),1(R9)      MOVE WHEN NAME                     11229800
MVENTRY  MVC   ENTRYR2+1(0),1(R4)    MOVE ENTRY NAME                    11229900
DBGLRS2  DS    CL1                   DEBUG LEVEL                        11230000
DBGLRS2X DS    F                     DEBUG LEVEL FOR EXTRACTOR          11230100
ACCRS2   DS    CL8                   ACCESS TEXT                        11230200
PRMOUT   DS    CL4                   OUTPT PARAMETER FOR TEST ROUTINE   11230300
*                                    1 - X'00' USER FOUND, X'01'-NO     11230400
*                                    2 - X'00' ACC  FOUND, X'01'-NO     11230500
*                                    3 - X'00' WHEN FOUND, X'01'-NO     11230600
*                                    4 - ACCESS BYTE MASK(RETRIEVE)     11230700
PRMINP   DS    0CL280                INPUT PARAMETER FOR TEST ROUTINE   11230800
ACCP2U   DS    CL8                   OBJECT ID                          11230900
ACCP2A   DS    XL1                   ACCESS FLAG                        11231000
ACCP2W   DS    0CL270                                                   11231100
ACCP2W0  DS    AL4                   TOTAL LEN                          11231200
ACCP2WT  DS    CL8                   WHEN TYPE                          11231300
ACCP2WL  DS    XL3                   WHEN NAME LEN                      11231400
ACCP2WN  DS    CL256                 WHEN NAME                          11231500
*                                                                       11231600
         DROP  ,                                                        11231700
*                                                                       11231800
*********************************************************************   11231900
*                                                                   *   11232000
* DUMMY OUTPUT EXIT ROUTINE FOR EXTRACTOR                           *   11232100
*                                                                   *   11233000
*********************************************************************   11234000
*                                                                       11235000
DUMMY    DS   0H                     DUMMY OUTPUT SECTION               11236000
         BR   R14                                                       11237000
         DROP  ,                                                        11238000
********************************************************************    11239000
*                                                                       11240000
* DATASET PROFILE.                                                      11241000
* RACF EXTRACTOR TEST EXIT FOR  CONDITIONAL ACL CHECKS                  11241100
*                                                                       11241200
********************************************************************    11241300
*                                                                       11241400
TSTDSACC BEGIN                                                          11241500
*                                                                       11241600
********************************************************************    11241700
*        CHECK ENTRY REASON                                             11241800
********************************************************************    11241900
*                                                                       11242000
         USING PARMM,R1                                                 11243000
         L     R2,XPROPCD                                               11243100
         CLI   0(R2),XPRSTRT          START  -  BEFORE READ RECORD FROM 11243200
         BE    LSTARTD                          RACF DATABASE           11243300
         CLI   0(R2),XPRENTY          ENTRY  -  AFTER  READ RECORD FROM 11243400
         BE    LENTRYD                          RACF DATABASE           11243500
         CLI   0(R2),XPRELMN          ELEMN  -  ELEMENTARY DATA         11243600
         BE    LELEMND                                                  11243700
         CLI   0(R2),XPRLIST          LIST   -  LIST DATA               11243800
         BE    LLISTD                                                   11243900
         CLI   0(R2),XPREND           END    -  BEFORE RETURN FROM      11244000
         BE    LENDD                            EXTRACTOR               11244100
         B     RET0D                                                    11244200
*                                                                       11244300
********************************************************************    11244400
*        START                                                          11244500
********************************************************************    11244600
*                                                                       11244700
LSTARTD  DS    0H                                                       11244800
         B     RET0D                                                    11244900
*                                                                       11245000
********************************************************************    11245100
*        ENTRY                                                          11245200
********************************************************************    11245300
*                                                                       11245400
LENTRYD  DS    0H                                                       11245500
         L     R3,XPRENTRY                                              11245600
         L     R5,0(R3)                ENTRY NAME LENGTH                11245700
         L     R4,XPRPRFXY                                              11245800
         L     R4,0(R4)                                                 11245900
         USING RETAREA,R4                                               11246000
         CTSADBG 'ENTRY=#/_ FLAG=$',                                   X11247000
               (?R5,4(R3),?R5,XPFFLGS,1),                              X11248000
               LEVEL=(DBGR2T,4,5,6,7)                                   11248100
         DROP  R4                                                       11248200
         XC    SLCTFD,SLCTFD           SELECT FLAG                      11248300
         XC    PRCCFD,PRCCFD           PROCESS FLAG                     11248400
         B     RET0D                                                    11248500
*                                                                       11248600
********************************************************************    11248700
*        ELEMNTRY FIELD                                                 11248800
********************************************************************    11248900
*                                                                       11249000
LELEMND  DS    0H                                                       11249100
         L     R3,XPRFNME                                               11249200
         L     R4,XPRFADRE                                              11249300
         L     R5,0(R4)                FIELD LENGTH                     11249400
         CTSADBG 'ELEMN FIELD=_ VALUE=#/_/$',                          *11249500
               (0(R3),8,?R5,4(R4),?R5,4(R4),?R5),                      *11249600
               LEVEL=(DBGR2T,4,5,6,7)                                   11249700
         B     RET0D                                                    11249800
*                                                                       11249900
********************************************************************    11250000
*        LIST FIELD                                                     11250100
********************************************************************    11250200
*                                                                       11250300
LLISTD   DS    0H                                                       11250400
         L     R3,XPRFNML                                               11250500
         L     R4,XPRFADRL                                              11250600
         L     R5,0(R4)                FIELD LENGTH                     11250700
         CLI   PRCCFD,1                NEED PROCESS FLAG                11250800
         BE    RET4D                   N, RETURN                        11250900
         CLC   =CL8'USER2ACS',0(R3)                                     11251000
         BE    LUSERD                                                   11252000
         CLI   SLCTFD,1                SELECT INFO ?                    11252100
         BNE   RET4D                   N, RETURN                        11252200
*                                                                       11252300
         CTSADBG 'LIST  FIELD=_ VALUE=#/_/$',                          *11252400
               (0(R3),8,?R5,4(R4),?R5,4(R4),?R5),                      *11252500
               LEVEL=(DBGR2T,4,5,6,7)                                   11252600
*                                                                       11252700
         CLC   =CL8'PROGRAM',0(R3)                                      11252800
         BE    LPROGD                                                   11252900
         CLC   =CL8'ACL2VAR',0(R3)                                      11253000
         BE    L2VARD                                                   11254000
         CLC   =CL8'PROGACS',0(R3)                                      11254100
         BE    LPACSD                                                   11254200
         B     RET4D                                                    11254300
*                                                                       11254400
LUSERD   DS    0H                                                       11254500
         L     R6,DSINP                INPUT PARAMETER                  11254600
         L     R7,DSOUT                OUTPT PARAMETER                  11254700
*                                                                       11254800
         CTSADBG 'USERID(REQUESTED/FROM RACF DB)=_/_',                 *11254900
               (4(R4),8,0(R6),8),                                      *11255000
               LEVEL=(DBGR2T,4,5,6,7)                                   11256000
*                                                                       11257000
         CLC   4(8,R4),0(R6)           CHECK USERID                     11258000
         BE    USERDF                  USER FOUND                       11259000
         B     USERDNF                 USER NOT FOUND                   11259100
USERDF   DS    0H                      USER FOUND                       11259200
         MVI   0(R7),1                 USER FOUND FLAG                  11259300
         MVI   SLCTFD,1                SELECT INFO                      11259400
         B     RET4D                                                    11259500
USERDNF  DS    0H                      USER NOT FOUND                   11259600
         MVI   SLCTFD,0                DON'T SELECT INFO                11259700
         B     RET4D                                                    11259800
*                                                                       11259900
LPROGD   DS    0H                                                       11260000
         L     R6,DSINP                INPUT PARAMETER                  11261000
         L     R7,DSOUT                OUTPT PARAMETER                  11261100
         CLC   13(8,R6),=CL8'PROGRAM'  I AM LOOKING FOR 'PROGRAM' ?     11261200
         BNE   RET4D                   N, RETURN                        11261300
         CLC   24(8,R6),4(R4)          CHECK PROGRAM                    11261400
         BE    LPROGDF                 PROGRAM FOUND                    11261500
         MVI   SLCTFD,0                DON'T SELECT INFO                11261600
         XC    0(4,R7),0(R7)           CLEAR FLAGS                      11261700
         B     RET4D                                                    11261800
LPROGDF  DS    0H                      PROGRAM FOUND                    11261900
         MVI   2(R7),1                 WHEN INFO FOUND FLAG             11262000
         B     RET4D                                                    11262100
*                                                                       11262200
L2VARD   DS    0H                                                       11262300
         L     R6,DSINP                INPUT PARAMETER                  11262400
         L     R7,DSOUT                OUTPT PARAMETER                  11262500
         CLC   13(8,R6),=CL8'PROGRAM'  I AM LOOKING FOR 'PROGRAM' ?     11262600
         BE    RET4D                   Y, RETURN                        11262700
         LA    R5,3(R5)                R5 - FIELD LEN, + PRFX LEN -1    11262800
         EX    R5,CHKWND               CHECK WHEN INFORMATION           11262900
         BE    L2VARDF                 WHEN TYPE FOUND                  11263000
         MVI   SLCTFD,0                DON'T SELECT INFO                11263100
         XC    0(4,R7),0(R7)           CLEAR FLAGS                      11263200
         B     RET4D                                                    11263300
L2VARDF  DS    0H                      PROGRAM FOUND                    11263400
         MVI   2(R7),1                 WHEN INFO FOUND FLAG             11263500
         B     RET4D                                                    11263600
*                                                                       11263700
LPACSD   DS    0H                                                       11263800
         L     R6,DSINP                INPUT PARAMETER                  11263900
         L     R7,DSOUT                OUTPT PARAMETER                  11264000
         SR    R9,R9                                                    11264100
         IC    R9,4(R4)                ACCESS FROM RACF DATA BASE       11264200
         STC   R9,3(R7)                SAVE ACCESS                      11264300
         MVI   PRCCFD,1                NO NEED FURTHER PROCESS          11264400
         B     RET4D                                                    11264500
LENDD    DS    0H                                                       11264600
         B     RET0D                                                    11264700
RET0D    DS    0H                                                       11264800
         SR    R15,R15                                                  11264900
         B     RETTD                                                    11265000
RET4D    DS    0H                                                       11266000
         LA    R15,4                                                    11267000
         B     RETTD                                                    11268000
RET8D    DS    0H                                                       11269000
         LA    R15,8                                                    11270000
         B     RETTD                                                    11271000
RETTD    DS    0H                                                       11272000
         BRTRN (15)                                                     11273000
*                                                                       11273100
********************************************************************    11273200
*       W O R K  A R E A  A N D   C O N S T A N T S                     11273300
********************************************************************    11273400
*                                                                       11273500
         LTORG                                                          11273600
DSINP    DS    A                       INPUT PARAMETER                  11273700
DSOUT    DS    A                       OUTPT PARAMETER                  11273800
DBGR2T   DS    CL1                     DEBUG LEVEL                      11273900
SLCTFD   DS    CL1                     SELECT FLAG                      11274000
PRCCFD   DS    CL1                     PROCESS FLAG                     11274100
CHKWND   CLC   0(0,R4),9(R6)           CHECK WHEN INFORMATION           11274200
         DROP  ,                                                        11274300
*                                                                       11274400
********************************************************************    11274500
*                                                                       11274600
* GENERAL RESOURCE PROFILE.                                             11274700
* RACF EXTRACTOR TEST EXIT FOR  CONDITIONAL ACL CHECKS                  11274800
*                                                                       11274900
********************************************************************    11275000
*                                                                       11276000
TSTGRACC BEGIN                                                          11276100
*                                                                       11276200
********************************************************************    11276300
*        CHECK ENTRY REASON                                             11276400
********************************************************************    11276500
*                                                                       11276600
         USING PARMM,R1                                                 11276700
         L     R2,XPROPCD                                               11276800
         CLI   0(R2),XPRSTRT          START  -  BEFORE READ RECORD FROM 11276900
         BE    LSTARTG                          RACF DATABASE           11277000
         CLI   0(R2),XPRENTY          ENTRY  -  AFTER  READ RECORD FROM 11278000
         BE    LENTRYG                          RACF DATABASE           11278100
         CLI   0(R2),XPRELMN          ELEMN  -  ELEMENTARY DATA         11278200
         BE    LELEMNG                                                  11278300
         CLI   0(R2),XPRLIST          LIST   -  LIST DATA               11278400
         BE    LLISTG                                                   11278500
         CLI   0(R2),XPREND           END    -  BEFORE RETURN FROM      11278600
         BE    LENDG                            EXTRACTOR               11278700
         B     RET0G                                                    11278800
*                                                                       11278900
********************************************************************    11279000
*        START                                                          11279100
********************************************************************    11279200
*                                                                       11279300
LSTARTG  DS    0H                                                       11279400
         B     RET0G                                                    11279500
*                                                                       11279600
********************************************************************    11279700
*        ENTRY                                                          11279800
********************************************************************    11279900
*                                                                       11280000
LENTRYG  DS    0H                                                       11280100
         L     R3,XPRENTRY                                              11280200
         L     R5,0(R3)                ENTRY NAME LENGTH                11280300
         L     R4,XPRPRFXY                                              11280400
         L     R4,0(R4)                                                 11280500
         USING RETAREA,R4                                               11280600
         CTSADBG 'ENTRY=#/_ FLAG=$',                                   X11280700
               (?R5,4(R3),?R5,XPFFLGS,1),                              X11280800
               LEVEL=(DBGR2TG,4,5,6,7)                                  11280900
         DROP  R4                                                       11281000
         XC    SLCTFG,SLCTFG           SELECT FLAG                      11281100
         XC    PRCCFG,PRCCFG           PROCESS FLAG                     11281200
         B     RET0G                                                    11281300
*                                                                       11281400
********************************************************************    11281500
*        ELEMNTRY FIELD                                                 11281600
********************************************************************    11281700
*                                                                       11281800
LELEMNG  DS    0H                                                       11281900
         L     R3,XPRFNME                                               11282000
         L     R4,XPRFADRE                                              11282100
         L     R5,0(R4)                FIELD LENGTH                     11282200
         CTSADBG 'ELEMN FIELD=_ VALUE=#/_/$',                          *11282300
               (0(R3),8,?R5,4(R4),?R5,4(R4),?R5),                      *11282400
               LEVEL=(DBGR2TG,4,5,6,7)                                  11282500
         B     RET0G                                                    11282600
*                                                                       11282700
********************************************************************    11282800
*        LIST FIELD                                                     11282900
********************************************************************    11283000
*                                                                       11283100
LLISTG   DS    0H                                                       11283200
         L     R3,XPRFNML                                               11283300
         L     R4,XPRFADRL                                              11283400
         L     R5,0(R4)                FIELD LENGTH                     11283500
         CLI   PRCCFG,1                NEED PROCESS FLAG                11283600
         BE    RET4G                   N, RETURN                        11283700
         CLC   =CL8'ACL2UID',0(R3)                                      11283800
         BE    LUSERG                                                   11283900
         CLI   SLCTFG,1                SELECT INFO ?                    11284000
         BNE   RET4G                   N, RETURN                        11284100
*                                                                       11284200
         CTSADBG 'LIST  FIELD=_ VALUE=#/_/$',                          *11284300
               (0(R3),8,?R5,4(R4),?R5,4(R4),?R5),                      *11284400
               LEVEL=(DBGR2TG,4,5,6,7)                                  11284500
*                                                                       11284600
         CLC   =CL8'ACL2RSVD',0(R3)                                     11284700
         BE    L2VARG                                                   11284800
         CLC   =CL8'ACL2ACC',0(R3)                                      11284900
         BE    LPACSG                                                   11285000
         B     RET4G                                                    11285100
*                                                                       11285200
LUSERG   DS    0H                                                       11285300
         L     R6,GRPINP               INPUT PARAMETER                  11285400
         L     R7,GRPOUT               OUTPT PARAMETER                  11285500
*                                                                       11285600
         CTSADBG 'USERID(REQUESTED/FROM RACF DB)=_/_',                 *11285700
               (4(R4),8,0(R6),8),                                      *11285800
               LEVEL=(DBGR2TG,4,5,6,7)                                  11285900
*                                                                       11286000
         CLC   4(8,R4),0(R6)           CHECK USERID                     11286100
         BE    USERGF                  USER FOUND                       11286200
         B     USERGNF                 USER NOT FOUND                   11286300
USERGF   DS    0H                      USER FOUND                       11286400
         MVI   0(R7),1                 USER FOUND FLAG                  11286500
         MVI   SLCTFG,1                SELECT INFO                      11286600
         B     RET4G                                                    11286700
USERGNF  DS    0H                      USER NOT FOUND                   11286800
         MVI   SLCTFG,0                DON'T SELECT INFO                11286900
         B     RET4G                                                    11287000
*                                                                       11287100
L2VARG   DS    0H                                                       11287200
         L     R6,GRPINP               INPUT PARAMETER                  11287300
         L     R7,GRPOUT               OUTPT PARAMETER                  11287400
         CLC   13(8,R6),=CL8'PROGRAM'  I AM LOOKING FOR 'PROGRAM' ?     11287500
         BE    RET4G                   Y, RETURN                        11287600
         LA    R5,3(R5)                R5 - FIELD LEN, + PRFX LEN -1    11287700
         EX    R5,CHKWNG               CHECK WHEN INFORMATION           11287800
         BE    L2VARGF                 WHEN TYPE FOUND                  11287900
         MVI   SLCTFG,0                DON'T SELECT INFO                11288000
         XC    0(4,R7),0(R7)           CLEAR FLAGS                      11289000
         B     RET4G                                                    11290000
L2VARGF  DS    0H                      PROGRAM FOUND                    11290100
         MVI   2(R7),1                 WHEN INFO FOUND FLAG             11290200
         B     RET4G                                                    11290300
*                                                                       11290400
LPACSG   DS    0H                                                       11290500
         L     R6,GRPINP               INPUT PARAMETER                  11290600
         L     R7,GRPOUT               OUTPT PARAMETER                  11290700
         SR    R9,R9                                                    11290800
         IC    R9,4(R4)                ACCESS FROM RACF DATA BASE       11290900
         STC   R9,3(R7)                SAVE ACCESS                      11291000
         MVI   PRCCFG,1                NO NEED FURTHER PROCESS          11291100
         B     RET4G                                                    11291200
LENDG    DS    0H                                                       11291300
         B     RET0G                                                    11291400
RET0G    DS    0H                                                       11291500
         SR    R15,R15                                                  11291600
         B     RETTG                                                    11291700
RET4G    DS    0H                                                       11291800
         LA    R15,4                                                    11291900
         B     RETTG                                                    11292000
RET8G    DS    0H                                                       11292100
         LA    R15,8                                                    11292200
         B     RETTG                                                    11292300
RETTG    DS    0H                                                       11292400
         BRTRN (15)                                                     11292500
*                                                                       11292600
********************************************************************    11292700
*       W O R K  A R E A  A N D   C O N S T A N T S                     11292800
********************************************************************    11292900
*                                                                       11293000
         LTORG                                                          11293100
GRPINP   DS   A                        INOUT PARAM                      11293200
GRPOUT   DS   A                        OUTPUT PARAM                     11293300
DBGR2TG  DS   CL1                      DEBUG LEVEL                      11293400
SLCTFG   DS    CL1                     SELECT FLAG                      11293500
PRCCFG   DS    CL1                     PROCESS FLAG                     11293600
CHKWNG   CLC   0(0,R4),9(R6)           CHECK WHEN INFORMATION           11293700
         DROP  ,                                                        11293800
*                                                                       11293900
*********************************************************************   11294000
*                                                                   *   11294100
* CONVERT ACCESS TEXT TO CORRESPONDING ACCESS BYTE MASK             *   11294200
* R1 -  OFFSET 0 - ACCESS TEXT          INPUT                       *   11294300
*              4 - ACCESS FLAG          OUTPUT                      *   11294400
*                                                                   *   11294500
*********************************************************************   11294600
*                                                                       11294700
ACC2FLAG BEGIN                                                          11294800
*                                                                       11294900
         LR    R10,R1                                                   11295000
         L     R3,0(R10)               ACCESS TEXT      - INPUT         11296000
         L     R4,4(R10)               ACCESS BYTE MASK - OUTPUT        11296100
         MVI   0(R4),X'80'             'ALTER' FLAG                     11296200
         CLC   =CL8'ALTER',0(R3)                                        11296300
         BE    ACC2FLGR                                                 11296400
         MVI   0(R4),X'40'             'CONTROL' FLAG                   11296500
         CLC   =CL8'CONTROL',0(R3)                                      11296600
         BE    ACC2FLGR                                                 11296700
         MVI   0(R4),X'20'             'UPDATE'  FLAG                   11296800
         CLC   =CL8'UPDATE',0(R3)                                       11296900
         BE    ACC2FLGR                                                 11297000
         MVI   0(R4),X'10'             'READ'    FLAG                   11297100
         CLC   =CL8'READ',0(R3)                                         11297200
         BE    ACC2FLGR                                                 11297300
         MVI   0(R4),X'08'             'EXECUTE' FLAG                   11297400
         CLC   =CL8'EXECUTE',0(R3)                                      11297500
         BE    ACC2FLGR                                                 11297600
         MVI   0(R4),X'01'                                              11297700
         CLC   =CL8'NONE',0(R3)                                         11297800
         BE    ACC2FLGR                                                 11297900
         MVI   0(R4),X'00'                                              11298000
ACC2FLGR BRTRN 0                                                        11298100
         LTORG                                                          11298200
         DROP  ,                                                        11298300
*                                                                       11298400
*********************************************************************   11298500
*                                                                   *   11298600
* CONVERT ACCESS BYTE MASK TO CORRESPONDING ACCESS TEXT             *   11298700
* R1 -  OFFSET 0 - ACCESS TEXT        OUTPUT                        *   11298800
*              4 - ACCESS FLAG        INPUT                         *   11298900
*                                                                   *   11299000
*********************************************************************   11299100
*                                                                       11299200
FLAG2ACC BEGIN                                                          11299300
*                                                                       11299400
         LR    R10,R1                                                   11299500
         L     R3,0(R10)               ACCESS TEXT      - OUTPUT        11299600
         L     R4,4(R10)               ACCESS BYTE MASK - INPUT         11299700
         MVC   0(8,R3),=CL8' '                                          11299800
         CLI   0(R4),X'00'                                              11299900
         BE    FLAG2ACR                                                 11300000
         MVC   0(8,R3),=CL8'ALTER'                                      11300100
         TM    0(R4),X'80'             'ALTER' FLAG                     11300200
         BO    FLAG2ACR                                                 11300300
         MVC   0(8,R3),=CL8'CONTROL'                                    11300400
         TM    0(R4),X'40'             'CONTROL' FLAG                   11300500
         BO    FLAG2ACR                                                 11300600
         MVC   0(8,R3),=CL8'UPDATE'                                     11300700
         TM    0(R4),X'20'             'UPDATE'  FLAG                   11300800
         BO    FLAG2ACR                                                 11300900
         MVC   0(8,R3),=CL8'READ'                                       11301000
         TM    0(R4),X'10'             'READ'    FLAG                   11301100
         BO    FLAG2ACR                                                 11301200
         MVC   0(8,R3),=CL8'EXECUTE'                                    11301300
         TM    0(R4),X'08'             'EXECUTE' FLAG                   11301400
         BO    FLAG2ACR                                                 11301500
         MVC   0(8,R3),=CL8'NONE'                                       11301600
         TM    0(R4),X'01'                                              11301700
         BO    FLAG2ACR                                                 11301800
         MVC   0(8,R3),=CL8' '                                          11301900
FLAG2ACR BRTRN 0                                                        11302000
         LTORG                                                          11302100
         DROP  ,                                                        11302200
*                                                                       11302300
********************************************************************    11302400
*    MAIN PARAMETERS LIST FOR TEST ROUTINES                             11302500
*******************************************************************     11302600
*                                                                       11302700
PARMM    DSECT                                                          11302800
         COPY  CTSFXPR                                                  11302900
*                                                                       11303000
******************************************************************      11303100
*       RETURN AREA FROM RACF                                           11303200
******************************************************************      11303300
*                                                                       11303400
RETAREA  DSECT                                                          11303500
         COPY  CTSFXPF                                                  11303600
         END                                                            11303700

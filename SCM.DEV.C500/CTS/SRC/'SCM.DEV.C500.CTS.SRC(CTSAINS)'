CTSAINS TITLE ' '                                                       00010000
**********************************************************************  00020000
*                                                                    *  00030000
*                                                                    *  00040000
*                             CTSAINS                                *  00050000
*                             -------                                *  00060000
*                                                                    *  00070000
*                       WRITTEN BY ARIEL GORDON                      *  00080000
*                                                                    *  00090000
*                                                                    *  00100000
*   FUNCTION:  THIS PROGRAM IS USED  TO SET  INS  PARAMETRS IN       *  00110000
*              VARIOUS MEMBERS.                                      *  00120000
*                                                                    *  00130000
*                                                                    *  00140000
*   INPUT:                                                           *  00150000
*       1.  DD-CARD DALIBS DEFINING THE LIBRARIES AND MEMBERS WHERE  *  00160000
*           THE REPLACEMENT WILL TAKE PLACE.                         *  00170000
*       2.  CTMPARM AND CTDPARM VALUES.                              *  00180000
*       3.  DD-CARD 'DAREP' DEFINES THE PARM VALUES TO REPLACE       *  00190000
*       4.  R1 -> EXEC CARD PARM POINTING TO 'CTS'                   *  00200000
*                                                                    *  00210000
*   OUTPUT:                                                          *  00220000
*       1.  THE SET OF 'DAINSXXX' DDCARDS DEFINING MEMBERS IN        *  00230000
*           WHICH REPLACEMENT TOOK PLACE.                            *  00240000
*---------------------------- V 1.4.0 -------------------------------*  00250000
* *CTSA  14.10.96 DC  CREATED FROM OLD VERSION                       *  00260000
*---------------------------- V 3.1.0 -------------------------------*  00261000
* WS2384 19.04.01 YB  SUPPORT SMS ALLOCATION IN SA-AGENT INSTALLATION*  00262000
* WS2393 19.04.01 YB  SPLIT THE OS/390 INSTALLATION TO USAAPI'S      *  00263000
*---------------------------- V 4.0.0 -------------------------------*  00264000
*SAS2IBMN 12.01.17 NY  REMOVE DB2 SUPPORT - CODE WAS DELETED.        *  00265000
* STCJOB  03.04.17 NY  SUPPORT STCJOBS                               *  00266000
*                      SEVERAL INTERNAL VARIABLES WERE ADDED TO HELP *  00266100
*                      TAILOR THE JCLS ACCORDING TO A COMBINATION    *  00266200
*                      OF VALUES SET FOR OTHER VARIABLES.            *  00266300
*IS10148A 21.06.17 NY  SET AN INTERNAL VOLSER(*) VARIABLE TO BE USED *  00266400
*                      WHEN ALLOCATING OPERATION SMS-MANAGED VSAM    *  00266500
*                      FILES.                                        *  00266600
*IS10148B 11.07.17 NY  WHEN UNIT AND VOL WERE NOT SPECIFIED, REPLACE *  00266700
*                      THEM WITH A NULL STRING.                      *  00266800
*                      A SPECIAL 'NO-VALUE' STRING IS USED TO        *  00266900
*                      INDICATE THAT THE REPLACEMENT VALUE SHOULD BE *  00267000
*                      EMPTY FOR THE UNIT AND VOL FIELDS.            *  00267100
*                      THIS WAY, THE NORMAL PROCESS OF LEAVING THE   *  00267200
*                      ORIGINAL TEXT WHEN NO REPLACEMENT VALUE IS    *  00267300
*                      SPECIFIED REMAINS.                            *  00267400
*IS10188  06.10.24     MOVE OUR MODULES ABOVE 16M LINE               *  00267500
**********************************************************************  00267600
*                                                                    *  00267700
*   INTERNAL %% VARIABLES ADDED WITH THE STCJOB CHANGE:              *  00267800
*   ===================================================              *  00267900
*                                                                    *  00268000
*   %JCLLIB%   - DEFAULT VALUE IS '*'. SET TO ' ' WHEN               *  00268100
*                PROCLIB=LOCALCOPY AND STCJOB=LIB-NAME.  THIS        *  00268200
*                VARIABE IS SET AFTER THE // IN JCLLIB STATEMENTS    *  00268300
*                TO AUTOMATICALLY DECIDE WHETHER JCLLIB WILL BE      *  00268400
*                USED OR NOT.  THE JCLLIB STATEMENTS IN JOBS AND     *  00268500
*                STCJOBS ARE NEEDED WHEN THE PROCEDURES ARE COPIED   *  00268600
*                TO OUR PROCLIB AND STCJOBS ARE USED.                *  00268700
*                THIS VARIABLES CAN ALSO BE USED WHEREVER WE NEED    *  00268800
*                TO DECIDE UPON PROCLIB=LOCALCOPYM, BECAUSE          *  00268900
*                PROCLIB=LOCALCOPY IS ALLOWED ONLY WHEN JCLLIB IS    *  00269000
*                NEEDED.                                             *  00269100
*                                                                    *  00269200
*   %STCJOBIND% - DEFAULT VALUE IS '*'. SET TO ' ' WHEN STCJOBS ARE  *  00269300
*                 USED.  THIS VARIABLE IS NEEDED TO TAILOR JCL       *  00269400
*                 LIBRARY MEMBERS CORRECTLY.                         *  00269500
*                                                                    *  00269600
*   %PRCREN%   - SET TO 'N' WHEN PROCPREFS=CTS. OTHERWISE, SET       *  00269700
*                TO 'R'. THIS VARIABLE IS USED IN THE INSTALLATION   *  00269800
*                JOBS FOR SELECTING THE APPROPRIATE MEMBERS          *  00269900
*                CONTAINING THE COPY STATEMENTS.                     *  00270000
*                                                                    *  00270100
*                                                                    *  00270200
*                                                                    *  00270300
*   INTERNAL %% VARIABLES ADDED WITH THE IS10148A CHANGE:            *  00270400
*   ===================================================              *  00270500
*                                                                    *  00270600
*   %OLVOLSVS% - DEFAULT VALUE IS SAME AS %OLVOLS%. IF %OLVOLS%      *  00270700
*                IS EMPTY, IT WILL BE SET TO *.                      *  00270800
*                                                                    *  00270900
**********************************************************************  00271000
         MACRO                                                          00271100
         DEFVAR     &VAR=,&MODE=R                            W605       00271200
         GBLC &VARN(100),&VARNLEN(100),&REPL(100),&REPLLEN(100),&F(100) 00271300
         GBLA       &MONE,&LV(100)                                      00271400
         GBLA       &ENTLEN                                             00271500
         ACTR      10000                                                00271600
&MONE    SETA       &MONE+1                                             00271700
&VARN(&MONE)    SETC   '&VAR'                                           00271800
&F(&MONE)   SETC     '&MODE'                                      W605  00271900
&LV(&MONE)  SETA      K'&VAR                                            00272000
         MEND                                                           00272100
         MACRO                                                          00273000
         REPLACE    &VAR=,&ACT=R,&MCTFLD=,&FLD=,&TYPE=NUM,&LEN=,       *00274000
               &ADDTO=,&TPSZ=F,&MODE=R                           W605   00275000
         GBLC &VARN(100),&VARNLEN(100),&REPL(100),&REPLLEN(100),&F(100) 00276000
         GBLA       &MONE,&LV(100)                                      00277000
         GBLA       &ENTLEN                                             00278000
         LCLC       &MONEC                                              00279000
         LCLC       &CHAR                                               00280000
         LCLA       &LENVAR,&I                                          00290000
         ACTR      10000                                                00300000
         AIF        ('&ACT' EQ    'GEN').GEN                            00310000
&MONE    SETA       &MONE+1                                             00320000
&VARN(&MONE)    SETC   '&VAR'                                           00330000
&F(&MONE)   SETC     '&MODE'                                      W605  00340000
&LV(&MONE) SETA      K'&VAR                                             00350000
&MONEC   SETC       '&MONE'                                             00360000
         LA        R1,&MONEC                                            00370000
         BCTR      R1,0                                                 00380000
         MH        R1,=Y(FLDLEN)                                        00390000
         A         R1,=A(TABLE)      UPON  ENTRY                        00400000
         USING     FLD,R1                                               00410000
         LA        R15,&LEN                                             00420000
         ST        R15,FLDREPLL                                         00430000
         BCTR      R15,0                                                00440000
&LENVAR  SETA      K'&VAR                                               00450000
&CHAR    SETC      'L'.''''.'&VAR'                                      00460000
         MVC       FLDVARL,=A(&LENVAR)                                  00470000
         AIF       ('&TYPE' EQ   'NUM').NUM                             00480000
.*    ASSUME  CHAR                                                      00490000
         AIF     (T'&MCTFLD  NE    'O').MCT1                            00500000
         MVC       FLDREPL,=100C' '                                     00510000
         EX        R15,MOV&SYSNDX.1     MVC    FLDREPL(*-*),&FLD        00520000
*   COMPRESS  BLANKS                                                    00530000
         LA        R14,FLDREPL(R15)                                     00540000
         LA        R15,1(R15)                                           00550000
L&SYSNDX.LEN   EQU  *                                                   00560000
         CLI       0(R14),C' '                                          00570000
         BNE       S&SYSNDX.LEN                                         00580000
         C         R15,=F'1'                                            00590000
         BE        S&SYSNDX.LEN                                         00600000
         BCTR      R14,0                                                00610000
         BCTR      R15,0                                                00620000
         B         L&SYSNDX.LEN                                         00630000
S&SYSNDX.LEN   EQU  *                                                   00640000
         ST        R15,FLDREPLL                                         00650000
         B         END&SYSNDX                                           00660000
MOV&SYSNDX.1    MVC    FLDREPL(*-*),&FLD                                00670000
         AGO      .END                                                  00680000
.MCT1    ANOP                                                           00690000
         MVC       FLDREPL,=100C' '                                     00700000
         EX        R15,MOV&SYSNDX.2     MVC    FLDREPL(*-*),&MCTFLD     00710000
         MVC       FLDREPL,&FLD                                         00720000
         B         END&SYSNDX                                           00730000
MOV&SYSNDX.2    MVC    FLDREPL(*-*),&MCTFLD                             00740000
         AGO      .END                                                  00750000
.NUM     ANOP                                                           00760000
         AIF       (T'&MCTFLD   NE   'O').MCT2                          00770000
         MVC       FLDREPL,=100C' '                                     00780000
         MVC       FLDREPLL,=A(&LEN)                                    00790000
         AIF       ('&TPSZ' EQ   'H').HALF                              00800000
.*WD0910 L         R14,&FLD                                             00810000
         ICM       R14,15,&FLD                                   WD0910 00820000
         AGO       .CONTHLF                                             00830000
.HALF    ANOP                                                           00840000
         SR        R14,R14                                       WD0910 00850000
.*WD0910 LH        R14,&FLD                                             00860000
         ICM       R14,3,&FLD                                    WD0910 00870000
.CONTHLF ANOP                                                           00880000
         AIF       (T'&ADDTO    EQ   'O').NOADD                         00890000
         A         R14,&ADDTO                                           00900000
.NOADD   ANOP                                                           00910000
         CVD       R14,CVD&SYSNDX.1                                     00920000
         L         R15,FLDREPLL                                         00930000
         BCTR      R15,0                                                00940000
         SLL       R15,4                                                00950000
         EX        R15,UNPK&SYSNDX                                      00960000
         SRL       R15,4                                                00970000
         LA        R14,FLDREPL(R15)                                     00980000
         OI        0(R14),X'F0'                                         00990000
         B         END&SYSNDX                                           01000000
         DS        0D                                                   01010000
CVD&SYSNDX.1      DS   D                                                01020000
UNPK&SYSNDX   UNPK  FLDREPL(*-*),CVD&SYSNDX.1                           01030000
         AGO       .END                                                 01040000
.MCT2    ANOP                                                           01050000
         MVC       FLDREPL,=100C' '                                     01060000
         MVC       FLDREPLL,=A(&LEN)                                    01070000
         AIF       ('&TPSZ' EQ   'H').HALF1                             01080000
.*WD0910 L         R14,&MCTFLD                                          01090000
         ICM       R14,15,&MCTFLD                             WD0910    01100000
         AGO       .CONTHL1                                             01110000
.HALF1   ANOP                                                           01120000
.*WD0910 LH        R14,&MCTFLD                                          01130000
         SR        R14,R14                                       WD0910 01140000
         ICM       R14,3,&MCTFLD                                 WD0910 01150000
.CONTHL1 ANOP                                                           01160000
         AIF       (T'&ADDTO    EQ   'O').NOADD1                        01170000
         A         R14,&ADDTO                                           01180000
.NOADD1  ANOP                                                           01190000
         CVD       R14,CVD&SYSNDX.2                                     01200000
         L         R15,FLDREPLL                                         01210000
         BCTR      R15,0                                                01220000
         SLL       R15,4                                                01230000
         EX        R15,UNPK&SYSNDX                                      01240000
         SRL       R15,4                                                01250000
         LA        R14,FLDREPL(R15)                                     01260000
         OI        0(R14),X'F0'                                         01270000
         B         END&SYSNDX                                           01280000
         DS        0D                                                   01290000
CVD&SYSNDX.2   DS   D                                                   01300000
UNPK&SYSNDX   UNPK  FLDREPL(*-*),CVD&SYSNDX.2                           01310000
         AGO       .END                                                 01320000
.END     ANOP                                                           01330000
END&SYSNDX   EQU   *                                                    01340000
         AGO       .END1                                                01350000
.GEN    ANOP                                                            01360000
         DS        0F                                                   01370000
TABLE    EQU        *                                                   01380000
.LOOPI   ANOP                                                           01390000
&I       SETA      &I+1                                                 01400000
         AIF      (&I   GT    &MONE).END2                               01410000
         DC   CL44'&VARN(&I)',A(&LV(&I)),CL44' ',A(0),C'&F(&I)',CL3' '  01420000
         AGO      .LOOPI                                                01430000
.END2    ANOP                                                           01440000
TABEND   EQU       *                                                    01450000
.END1    ANOP                                                           01460000
         MEND                                                           01470000
         DCBD                                                    IOAI   01480000
*                                                                       01490000
FLD      DSECT                                                          01500000
FLDVAR   DC    CL44' '                                                  01510000
FLDVARL  DC    A(0)                                                     01520000
FLDREPL  DC    CL44' '                                                  01530000
FLDREPLL DC    A(0)                                                     01540000
FLDFLAG  DC    CL1' '                                            W605   01550000
FLDFREG  EQU   C'R'           REGULAR REPLACEMNT                        01560000
FLDFSPC  EQU   C'S'           SPECIAL REPLACEMNT-KEEP POSITIONS IN CARD 01570000
FLDFPOS  EQU   C'A'           SPECIAL REPLACEMNT-NO POSITION LIMIT      01580000
FLDUMMY  DC    CL3' '         FOR FUTURE USE                     W605   01590000
FLDLEN   EQU   *-FLD                                                    01600000
FLDEND   EQU   *                                               STCJOB   01610000
*                                                                       01620000
CTSAINS  START                                                          01630000
CTSAINS  AMODE 24           MUST BE BELOW THE 16M LINE          IS10188 01631001
CTSAINS  RMODE 24           MUST BE BELOW THE 16M LINE          IS10188 01632001
         CTSEQUR                                                        01640000
         BEGIN    *,R12,R10                                      WM0910 01650000
         CTSLEVEL CTSAINS                                               01660000
**********************************************************************  01670000
****                                                              ****  01680000
****       SA-AGENT      RELEASE 1.4.0                            ****  01690000
****                                                              ****  01700000
****       LICENSED MATERIAL - NEW DIMENSION SOFTWARE LTD.        ****  01710000
****                                                              ****  01720000
**********************************************************************  01730000
         LR       R3,R1        SAVE  PARAMETERS                         01740000
*                                                                       01750000
***    OPEN  SYSPRINT  FILE                                             01760000
*                                                                       01770000
         OPEN   (DCBOUT,OUTPUT)                                         01780000
         LTR    R15,R15                                                 01790000
         BNZ    ERROR913                                                01800000
*                                                                       01810000
***    OPEN  DALIBS FILE (LIBS AND MEMBERS TO BE PROCESSED)     IOAI    01820000
*                                                                       01830000
         OPEN   (DALIBS,INPUT)                                  IOAI    01840000
         MVC    DDMSG(8),=CL8'DALIBS'   KEEP DDNAME FOR MSG     IOAI    01850000
         LTR    R15,R15                                         IOAI    01860000
         BNZ    ERR1007                                         IOAI    01870000
*                                                                       01880000
***    DECIDE WHETHER ONE OF 4D PRODUCTS                                01890000
*                                                                       01900000
         L        R1,0(R3)     EXEC PARM                        IOAI    01910000
         LH       R0,0(R1)     EXEC PARM LENGTH                 IOAI    01920000
         CH       R0,=H'3'     ANY PARM   ?                     IOAI    01930000
         BL       ERR1001         NO, ERROR                     IOAI    01940000
         MVC      INSTYPE(3),2(R1)                              IOAI    01950000
         CLC      INSTYPE(3),=CL3'CTS'                         *CTSA    01960000
         BE       PARMOK                                       *CTSA    01970000
         CLC      INSTYPE(3),=CL3'DBG'                                  01980000
         BNE      ERR1001                                               01990000
         MVI      DEBUGL,1                                              02000000
PARMOK   EQU      *                                                     02010000
*                                                                       02020000
***    OPEN  DAREP FILE (SET OF VARIABLES AND VALUES TO UPDATE) IOAI    02030000
*                                                                       02040000
         MVC    DDMSG(8),=CL8'DAREP'    KEEP DDNAME FOR MSG     IOAI    02050000
         OPEN   (DAREP,INPUT)                                           02060000
         LTR    R15,R15                                                 02070000
         BNZ    ERR1007                                                 02080000
*                                                                       02090000
***    SET VARS FROM DAREP                                              02100000
*                                                                       02110000
LOOPREP  EQU    *                                                       02120000
         GET    DAREP,TMPCARD                                           02130000
*                                                                       02140000
***     SEARCH   FOR  VARIABLE IN CARD                                  02150000
*                                                                       02160000
         LM     R5,R7,=A(TABLE,FLDLEN,TABEND)                           02170000
         USING  FLD,R5                                                  02180000
LOOPREP1 EQU    *                                                       02190000
         L      R15,FLDVARL                                             02200000
         BCTR   R15,0                                                   02210000
* PRTDBG ' CHKING _ WITH _',(FLDVAR,10,TMPCARD,10)                      02220000
         EX     R15,REPCNG       CLC     FLDVAR(*-*),TMPCARD            02230000
         BE     SETVAR                                                  02240000
         BXLE   R5,R6,LOOPREP1                                          02250000
         B      ERR1009                                                 02260000
SETVAR   EQU    *                                                       02270000
         LA     R1,TMPCARD      POINT TO CARD                           02280000
         A      R1,FLDVARL      SKIP LENGTH                             02290000
         LA     R1,1(R1)        SKIP '='                                02300000
         LR     R15,R1                                                  02310000
SETLOOP  EQU    *                                                       02320000
         CLI    0(R1),C' '       IS IT A BLANK                          02330000
         BE     SETEND                                                  02340000
         LA     R1,1(R1)        SKIP '='                                02350000
         B      SETLOOP                                                 02360000
SETEND   EQU    *                                                       02370000
         CR     R1,R15                                                  02380000
         BE     ERR1009                                                 02390000
         SR     R1,R15                                                  02400000
         C      R1,=F'44'                   LESS THAN 44 ?       BM1270 02410000
         BNH    REPLOK                      ..YES, OK            BM1270 02420000
         B      ERR1015                     ..OTHERWISE TERMINATEBM1270 02430000
REPLOK   DS     0H                                                      02440000
         ST     R1,FLDREPLL                                             02450000
         BCTR   R1,0                                                    02460000
         EX     R1,MVCREP      MVC   FLDREPL(*-*),0(R15)                02470000
*                                                                       02480000
**  VOL=SER=(BLANK) IS ALLOWED FOR SMS MANAGED DATASETS          WS2384 02490000
*                                                                       02500000
         CLC    FLDREPL(10),=CL10'##ILVOLS##'                    WS2384 02510000
         BE     MOVEBLNK                                         WS2384 02520000
         CLC    FLDREPL(10),=CL10'##OLVOLS##'                    WS2384 02530000
         BE     MOVEBLNK                                         WS2384 02540000
         CLC    FLDREPL(10),=CL10'##SPDVOL##'                    WS2384 02550000
         BE     MOVEBLNK                                         WS2384 02560000
         CLC    FLDREPL(10),=CL10'##SPAVOL##'                    WS2384 02570000
         BE     MOVEBLNK                                         WS2384 02580000
         CLC    FLDREPL(10),=CL11'##ILUNITS##'                 IS10148B 02590000
         BE     MOVEBLNK                                       IS10148B 02600000
         CLC    FLDREPL(10),=CL11'##OLUNITS##'                 IS10148B 02610000
         BE     MOVEBLNK                                       IS10148B 02620000
         CLC    FLDREPL(10),=CL11'##SPCUNIT##'                 IS10148B 02630000
         BE     MOVEBLNK                                       IS10148B 02640000
         CLC    FLDREPL(10),=CL11'##SPDUNIT##'                 IS10148B 02650000
         BE     MOVEBLNK                                       IS10148B 02660000
         CLC    FLDREPL(10),=CL11'##SPAUNIT##'                 IS10148B 02670000
         BE     MOVEBLNK                                       IS10148B 02680000
         B      TYPECHCK                                         WS2384 02690000
MOVEBLNK DS     0H                                               WS2384 02700000
*IS10148B LA    R1,2                                             WS2384 02710000
*IS10148B ST    R1,FLDREPLL                                      WS2384 02720000
*IS10148A MVC   FLDREPL,=CL2''''''                               WS2384 02730000
*IS10148B MVC   FLDREPL,NOVOL       CL2''''''                  IS10148A 02740000
         LHI    R1,L'NOVAL                                     IS10148B 02750000
         ST     R1,FLDREPLL                                    IS10148B 02760000
         MVC    FLDREPL(L'NOVAL),NOVAL                         IS10148B 02770000
*                                                                       02780000
TYPECHCK DS     0H                                               WS2384 02790000
         CLC    FLDVAR(10),=CL10'%RSSGTYPE%' WAS IT GTYPE VAR?   WS2393 02800000
         BNE    LOOPREP             NO, KEEP ON GOING            WS2393 02810000
*        WTO    'CTSAINS: SETTING THE FTYPE...'                  WS2393 02820000
         MVC    GTYPEVAL,FLDREPL    GET THE GTYPE VALUE          WS2393 02830000
         B      LOOPREP                                                 02840000
ENDPRM   EQU    *                                                       02850000
         CLOSE  DAREP                                                   02860000
*                                                                WS2393 02870000
* CHECK IF THE RSSGTYPE MATCHES THE INSTALLATION MEDIA           WS2393 02880000
*                                                                WS2393 02890000
         MVC    DDMSG(8),=CL8'DAREP'    KEEP DDNAME FOR MSG      WS2393 02900000
         OPEN   (DATYPE,INPUT)                                   WS2393 02910000
         LTR    R15,R15                                          WS2393 02920000
         BNZ    ERR1007                                          WS2393 02930000
         GET    DATYPE,TMPCARD                                   WS2393 02940000
         CLC    TMPCARD(3),=CL3'ALL'     ALL USAAPI - SKIP CHECK WS2393 02950000
         BE     NOGCHECK                                         WS2393 02960000
         CLC    GTYPEVAL,TMPCARD                                 WS2393 02970000
         BNE    ERR1016                                          WS2393 02980000
NOGCHECK DS     0H                                               WS2393 02990000
*        WTO    'CTSAINS: BEFORE CLOSE DATYPE'                   WS2393 03000000
         CLOSE  DATYPE                                           WS2393 03010000
*STCJOB  B      GETLIBS                                          WS2393 03020000
*IS10148A B     SETJCLIB                                         STCJOB 03030000
         B      SETOVSAM                                       IS10148A 03040000
ENDTYPE  DS     0H                       EOF? ERROR.             WS2393 03050000
*        WTO    'CTSAINS: REACHED TYPE EODAD'                    WS2393 03060000
         B      ERR1016                                          WS2393 03070000
*                                                              IS10148A 03080000
**   SET THE VALUE FOR %OLVOLSVS%                              IS10148A 03090000
*                                                              IS10148A 03100000
SETOVSAM DS    0H                                              IS10148A 03110000
         LHI   R8,0                                            IS10148A 03120000
         LHI   R4,0                                            IS10148A 03130000
         LM    R5,R7,=A(TABLE,FLDLEN,TABEND)                   IS10148A 03140000
         USING FLD,R5                                          IS10148A 03150000
OVLOOP   DS    0H                     LOOK FOR BOTH FIELDS.    IS10148A 03160000
         CLC   =C'%OLVOLS%',FLDVAR                             IS10148A 03170000
         BE    OVVOLS                                          IS10148A 03180000
         CLC   =C'%OLVOLSVS%',FLDVAR                           IS10148A 03190000
         BNE   OVNEXT                                          IS10148A 03200000
         LR    R8,R5                   R8 -> OLVOLSVS ENTRY.   IS10148A 03210000
         B     OVNEXT                                          IS10148A 03220000
OVVOLS   DS    0H                                              IS10148A 03230000
         LR    R4,R5                   R4 -> OLVOLS ENTRY.     IS10148A 03240000
         B     OVNEXT                                          IS10148A 03250000
OVNEXT   DS    0H                                              IS10148A 03260000
         BXLE  R5,R6,OVLOOP                                    IS10148A 03270000
*                                                              IS10148A 03280000
UOVL     USING (FLD,FLDEND),R4                                 IS10148A 03290000
UOVS     USING (FLD,FLDEND),R8                                 IS10148A 03300000
*                                                              IS10148A 03310000
**   SET OVOLSVS ACCORDING TO OVOLS                            IS10148A 03320000
**   IF OVOLS IS EMPTY                                         IS10148A 03330000
**      OVOLSVS = *                                            IS10148A 03340000
**   OTHERWISE                                                 IS10148A 03350000
**      OVOLSVS = OVOLS                                        IS10148A 03360000
*                                                              IS10148A 03370000
         CHI   R4,0                    OLVOLS EXISTS ?         IS10148A 03380000
         BE    ER919OVL                ..NO - INTERNAL ERROR.  IS10148A 03390000
         CHI   R8,0                    OLVOLSVS EXISTS ?       IS10148A 03391000
         BE    ER919OVS                ..NO - INTERNAL ERROR.  IS10148A 03391100
         L     R1,UOVL.FLDREPLL        R1 = OVOLS VALUE LENGTH.IS10148A 03391200
*IS10148B CHI  R1,0                    OLVOLS IS EMPTY ?       IS10148A 03391300
*IS10148B BE   OVSETSMS                ..YES - SET SMS.        IS10148A 03391400
*IS10148B CHI  R1,2                    OLVOLS IS EMPTY ?       IS10148A 03391500
         CHI   R1,L'NOVAL              OLVOLS IS "EMPTY" ?     IS10148B 03391600
         BNE   OVCPYVOL                ..NO - COPY TO OLVOLSVS IS10148A 03391700
*IS10148B CLC  UOVL.FLDREPL,NOVOL      OVOLS IS CL2'''''' ?    IS10148A 03391800
         CLC   UOVL.FLDREPL(L'NOVAL),NOVAL NO-VALUE STRING ?   IS10148A 03391900
         BNE   OVCPYVOL                ..NO - COPY TO OLVOLSVS IS10148A 03392000
*                                      OLVOLS IS EMPTY (SMS)   IS10148A 03392100
OVSETSMS DS    0H                                              IS10148A 03392200
         LHI   R2,1                                            IS10148A 03392300
         ST    R2,UOVS.FLDREPLL                                IS10148A 03392400
         MVI   UOVS.FLDREPL,C'*'       SET OLVOLSVS = *        IS10148A 03392500
         B     SETOVSME                                        IS10148A 03392600
OVCPYVOL DS    0H                      OLVOLSVS = OLVOLS       IS10148A 03392700
         MVC   UOVS.FLDREPLL,UOVL.FLDREPLL                     IS10148A 03392800
         MVC   UOVS.FLDREPL,UOVL.FLDREPL                       IS10148A 03392900
SETOVSME DS    0H                                              IS10148A 03393000
*                                                                STCJOB 03393100
**   SET THE VALUE FOR %JCLLIB% AND %STCJOBIND% ACCORDING        STCJOB 03393200
**   TO %PROCLIB% AND %STCJOB%                                   STCJOB 03393300
*                                                                STCJOB 03393400
*IS10148A SETJCLIB DS   0H                                       STCJOB 03393500
         LHI   R8,0                                              STCJOB 03393600
         LHI   R9,0                                              STCJOB 03393700
         LHI   R11,0                                             STCJOB 03393800
         LHI   R4,0                                              STCJOB 03393900
         LM    R5,R7,=A(TABLE,FLDLEN,TABEND)                     STCJOB 03394000
         USING FLD,R5                                            STCJOB 03395000
JLLOOP   DS    0H                     LOOK FOR ALL 3 FIELDS.     STCJOB 03396000
         CLC   =C'%PROCLIB%',FLDVAR                              STCJOB 03397000
         BE    JLFPROC                                           STCJOB 03398000
         CLC   =C'%STCJOBS%',FLDVAR                              STCJOB 03399000
         BE    JLFSJ                                             STCJOB 03399100
         CLC   =C'%STCJOBSIND%',FLDVAR                           STCJOB 03399200
         BE    JLFSJI                                            STCJOB 03399300
         CLC   =C'%JCLLIB%',FLDVAR                               STCJOB 03399400
         BE    JLFJL                                             STCJOB 03399500
         CLC   =C'%PROCPREFS%',FLDVAR  PROCPREFS ?               STCJOB 03399600
         BE    JLFPP                                             STCJOB 03399700
         CLC   =C'%PRCREN%',FLDVAR     PRCREN ?                  STCJOB 03399800
         BNE   JLNEXT                                            STCJOB 03399900
         ST    R5,PRCRENP              SAVE PRCREN ENTRY ADDR    STCJOB 03400000
         B     JLNEXT                                            STCJOB 03400100
JLFPP    DS    0H                                                STCJOB 03400200
         MVC   PROCPREF,FLDREPL        SAVE PROFPREFS VALUE.     STCJOB 03400300
         B     JLNEXT                                            STCJOB 03400400
JLFJL    DS    0H                                                STCJOB 03400500
         LR    R11,R5                  R11 -> JCLLIB ENTRY.      STCJOB 03400600
         B     JLNEXT                                            STCJOB 03400700
JLFPROC  DS    0H                                                STCJOB 03400800
         LR    R8,R5                   R8 -> PROCLIB ENTRY.      STCJOB 03400900
         B     JLNEXT                                            STCJOB 03401000
JLFSJ    DS    0H                                                STCJOB 03401100
         LR    R9,R5                   R9 -> STCJOBS ENTRY.      STCJOB 03401200
         B     JLNEXT                                            STCJOB 03401300
JLFSJI   DS    0H                                                STCJOB 03401400
         LR    R4,R5                   R4 -> STCJOBSIND ENTRY.   STCJOB 03401500
JLNEXT   DS    0H                                                STCJOB 03401600
         BXLE  R5,R6,JLLOOP                                      STCJOB 03401700
*                                                                STCJOB 03401800
UJL      USING (FLD,FLDEND),R11                                  STCJOB 03401900
UPRC     USING (FLD,FLDEND),R8                                   STCJOB 03402000
USJ      USING (FLD,FLDEND),R9                                   STCJOB 03403000
USJI     USING (FLD,FLDEND),R4                                   STCJOB 03404000
*                                                                STCJOB 03405000
**   SET PRCREN ACCORDING TO PROCPREFS:                          STCJOB 03406000
**   IF PROCPREFS = CTS (NO RENAME):                             STCJOB 03407000
**      PRCREN='N'.                                              STCJOB 03408000
**   OTHERWISE (RENAME)                                          STCJOB 03409000
**      PRCREN='R'.                                              STCJOB 03410000
*                                                                STCJOB 03420000
         L     R5,PRCRENP                                        STCJOB 03430000
         CHI   R5,0                    PRCREN EXISTS ?           STCJOB 03440000
         BE    ER919PR                 ..NO - INTERNAL ERROR.    STCJOB 03440100
UPR      USING (FLD,FLDEND),R5                                   STCJOB 03440200
         LHI   R2,1                                              STCJOB 03440300
         ST    R2,UPR.FLDREPLL                                   STCJOB 03440400
         CLC   PRFXCTS,PROCPREF       PROCPREFS=CTS ?            STCJOB 03440500
         BE    SETPRCNR                ..YES - NO RENAME.        STCJOB 03440600
         MVI   UPR.FLDREPL,C'R'       PRCREN = 'R'               STCJOB 03440700
         B     JLDEFJL                                           STCJOB 03440800
SETPRCNR DS    0H                                                STCJOB 03440900
         MVI   UPR.FLDREPL,C'N'       PRCREN = 'N'               STCJOB 03441000
         DROP  UPR                                               STCJOB 03442000
*                                                                STCJOB 03442100
**   SET JCCLIB = '*' (DEFAULT VALUE)                            STCJOB 03442200
*                                                                STCJOB 03442300
JLDEFJL  DS    0H                                                STCJOB 03442400
         CHI   R11,0                   JCLLIB ENTRY EXISTS ?     STCJOB 03442500
         BE    ER919JCL                ..NO - INTERNAL ERROR.    STCJOB 03442600
         LHI   R2,1                                              STCJOB 03442700
         ST    R2,UJL.FLDREPLL                                   STCJOB 03442800
         MVI   UJL.FLDREPL,C'*'        JCLLIB DEFAULT IS *       STCJOB 03442900
*                                                                STCJOB 03443000
**   IF STCJOBS = DONTCOPY, SET STCJOBSIND = '*'.                STCJOB 03443100
**   OTHERWISE, SET STCJOBSIND = ' '.                            STCJOB 03443200
*                                                                STCJOB 03443300
JLSTCJ   DS    0H                                                STCJOB 03443400
         CHI   R4,0                    STCJOBIND ENTRY EXISTS ?  STCJOB 03443500
         BE    ER919STI                ..NO - INTERNAL ERROR.    STCJOB 03443600
         LHI   R2,1                                              STCJOB 03443700
         ST    R2,USJI.FLDREPLL                                  STCJOB 03443800
         MVI   USJI.FLDREPL,C'*'       STCJOBIND DEFAULT IS *    STCJOB 03443900
*                                                                STCJOB 03444000
         CHI   R9,0                    STCJOBS ENTRY EXISTS ?    STCJOB 03445000
         BE    ER919STC                ..NO - INTERNAL ERROR.    STCJOB 03446000
         L     R2,USJ.FLDREPLL                                   STCJOB 03447000
         CTSADBG 'STCJOBS = # / _',(?R4,USJ.FLDREPL,?R4),        STCJOBX03448000
               LEVEL=(DEBUGL,1)                                  STCJOB 03449000
         CHI   R2,0                    STCJOBS IS EMPTY ?        STCJOB 03450000
         BE    JLLCLCPY                ..YES - CHECK JCLLIB      STCJOB 03460000
         CHI   R2,L'DONTCOPY           STCJOBS = DONTCOPY ?      STCJOB 03470000
         BE    JLLCLCPY                ..YES - CHECK JCLLIB      STCJOB 03480000
         CLC   DONTCOPY,USJ.FLDREPL    STCJOBS = DONTCOPY ?      STCJOB 03481000
         BE    JLLCLCPY                ..YES - SET DEFAULTB      STCJOB 03481100
         LHI   R2,1                                              STCJOB 03481200
         ST    R2,USJI.FLDREPLL                                  STCJOB 03481300
         MVI   USJI.FLDREPL,C' '       STCJOBIND = ' '           STCJOB 03481400
*                                                                STCJOB 03481500
**   IF PROCLIB = LOCALCOPY:                                     STCJOB 03481600
**   1. LOCALCOPY IS ALLOWED ONLY WHEN STCJOBS IS NOT DONTCOPY   STCJOB 03481700
**   2. VERIFY PROCPREFS IS NOT CTS/ACF/RCF/TSS                  STCJOB 03481800
**      WE WILL COPY THE PROCEDURES TO OUR OWN PROCLIB SO        STCJOB 03481900
**      PROCPREFS SHOULD NOT MATCH ANY EXISTING PREFIX.          STCJOB 03482000
**   3. SET JCLLIB TO ' ' (WE ALREADY VERIFIED THAT STCJOBS      STCJOB 03483000
**      IS NOT DONTCOPY).                                        STCJOB 03484000
*                                                                STCJOB 03485000
JLLCLCPY DS    0H                                                STCJOB 03486000
         CTSADBG 'CHECK PROCLIB (~), STCJOBS (~) AND JCLLIB (~)', TCJOBX03487000
               (?R8,?R9,?R11),                                   STCJOBX03488000
               LEVEL=(DEBUGL,1)                                  STCJOB 03489000
         CHI   R8,0                    PROCLIB ENTRY EXISTS ?    STCJOB 03490000
         BE    ER919PRC                ..NO - INTERNAL ERROR.    STCJOB 03500000
*                                                                STCJOB 03510000
         L     R2,UPRC.FLDREPLL        R2 = PROCLIB VALUE LENGTH.STCJOB 03520000
         CTSADBG 'PROCLIB = # / _',(?R2,UPRC.FLDREPL,?R2),       STCJOBX03530000
               LEVEL=(DEBUGL,1)                                  STCJOB 03540000
         CHI   R2,L'LOCALCPY           PROCLIB = LOCALCOPY ?     STCJOB 03550000
         BNE   GETLIBS                 ..NO - DEFAULT JCLLIB     STCJOB 03560000
         CLC   LOCALCPY,UPRC.FLDREPL   PROCLIB = LOCALCOPY ?     STCJOB 03570000
         BNE   GETLIBS                 ..NO - DEFAULT JCLLIB     STCJOB 03580000
*                                                                STCJOB 03590000
*  1. VERIFY STCJOBS LIBRARY WAS SPECIFIED (STCJOBIND IS NOT *)  STCJOB 03600000
*                                                                STCJOB 03610000
         CLI   USJI.FLDREPL,C'*'       STCJOBIND IS * (NO        STCJOB 03620000
*                                      STCJOBS LIBRARY) ?        STCJOB 03630000
         BE    ERROR918                ..YES - ERROR (LOCALCOPY  STCJOB 03640000
*                                              W/O STCJOBS IS    STCJOB 03650000
*                                              MEANINGLESS.      STCJOB 03660000
*                                                                STCJOB 03670000
*  2. VERIFY PROCPREFS AGAINST RESERVED NAMES.                   STCJOB 03680000
*                                                                STCJOB 03690000
         LM    R5,R7,=A(PRFXRSV,PRFXRSVL,PRFXRSVE)               STCJOB 03700000
JLPFXLP  DS    0H                                                STCJOB 03710000
         CLC   0(3,R5),PROCPREF                                  STCJOB 03720000
         BE    ERROR917                                          STCJOB 03730000
         BXLE  R5,R6,JLPFXLP                                     STCJOB 03740000
*                                                                STCJOB 03750000
*  3. SET JCLLIB TO ' ' (JCLLIB IS NEEDED).                      STCJOB 03760000
*                                                                       03770000
         LHI   R2,1                                              STCJOB 03780000
         ST    R2,UJL.FLDREPLL                                   STCJOB 03790000
         MVI   UJL.FLDREPL,C' '        SET JCLLIB VALUE TO ' '   STCJOB 03800000
         B     GETLIBS                                                  03810000
         DROP  UJL,UPRC,USJ,USJI                                 STCJOB 03820000
*                                                                IOAI   03830000
*  FROM THIS POINT ON, WE PROCEED WITH REPLACING VALUES IN THE   IOAI   03840000
*  LIBS/MEMBERS POINTED BY DALIBS DDNAME.                        IOAI   03850000
*                                                                IOAI   03860000
*  LOOP OVER ALL LIBRARIES AND MEMBERS                           IOAI   03870000
*                                                                IOAI   03880000
GETLIBS  EQU   *                                                 IOAI   03890000
         GET   DALIBS,TMPCARD                                    IOAI   03900000
         CLI   TMPCARD,C'*'            COMMENT ?                 IOAI   03910000
         BE    GETLIBS                    YES, SKIP              IOAI   03920000
         CLC   TMPCARD(8),=CL8' '      MEMBER NOT SPECIFIED ?    IOAI   03930000
         BE    NOMEM                   IF SO, CONSIDER WHOLE LIB IOAI   03940000
         L     R2,=A(INRECS)                                     IOAI   03950000
         MVC   0(8,R2),TMPCARD         MOVE THIS MEMBER ONLY     IOAI   03960000
         LA    R1,1                                              IOAI   03970000
         ST    R1,MAXLINES             ONLY ONE MEM IN THIS LIB  IOAI   03980000
         B     MEMREADY                GO PROCESS MEMBER LIST    IOAI   03990000
NOMEM    EQU   *                                                 IOAI   04000000
*                                                                IOAI   04010000
*  GET LIB'S DIRECTORY                                           IOAI   04020000
*                                                                IOAI   04030000
         MVC   MEMLIB(44),TMPCARD+9    GIVE LIBRARY NAME         IOAI   04040000
*                                                                       04050000
         CTSADBG 'NOMEM: MEMLIB=_',(MEMLIB,44),                        X04060000
               LEVEL=(DEBUGL,1)                                         04070000
*                                                                       04080000
         LA    R1,INRECSL              NUMBER OF MEMBERS         IOAI   04090000
         ST    R1,MAXLINES                TO READ INTO INRECS    IOAI   04100000
         L     R2,=A(INRECS)                                     IOAI   04110000
         CALL  CTSAMEM,(DIRECTOR,      1  GET DIRECTORY          IOAI  X04120000
               MEMLIB,                 2  CL44' '                IOAI  X04130000
               DDNAME,                 3  CL6'DAINS '            IOAI  X04140000
               MEMNAME,                4  CL8' '                 IOAI  X04150000
               (R2),                   5  A(INRECS               IOAI  X04160000
               VEC,                    6  C'V'  (SEQUENTIAL)     IOAI  X04170000
               MAXLINES,               7  MAX NO. OF LINES       IOAI  X04180000
               USERID,                 8  USERID                 IOAI  X04190000
               FROMLINE,               9  FROMLINE = 1           IOAI  X04200000
               MULTDD,                10  CL2'  '                IOAI  X04210000
               PUTOPT,                11  CL1' '                 IOAI  X04220000
               ABEND,                 12  ABEND CODE             IOAI  X04230000
               0,                     13  RESERVED               IOAI  X04240000
               0,                     14  RESERVED               IOAI  X04250000
               RCC),VL                15  RETURN CODE            IOAI   04260000
         ST    R15,SAVER15            KEEP CTMMEM RETURN CODE    IOAI   04270000
*                                                                       04280000
         CTSADBG 'NOMEM: R15=~ MAXLINES=#',(SAVER15,MAXLINES),         X04290000
               LEVEL=(DEBUGL,1)                                         04300000
*                                                                       04310000
         CALL  CTSAMEM,(FINISH,        1  RELEASE AREAS          IOAI  X04320000
               MEMLIB,                 2  CL44' '                IOAI  X04330000
               DDNAME,                 3  CL6'DAINS '            IOAI  X04340000
               MEMNAME,                4  CL8' '                 IOAI  X04350000
               (R2),                   5  A(INRECS               IOAI  X04360000
               VEC,                    6  C'V'  (SEQUENTIAL)     IOAI  X04370000
               MAXLINES,               7  NO. OF LINES READ      IOAI  X04380000
               USERID,                 8  USERID                 IOAI  X04390000
               FROMLINE,               9  FROMLINE = 1           IOAI  X04400000
               MULTDD,                10  CL2'  '                IOAI  X04410000
               PUTOPT,                11  CL1' '                 IOAI  X04420000
               ABEND,                 12  ABEND CODE             IOAI  X04430000
               0,                     13  RESERVED               IOAI  X04440000
               0,                     14  RESERVED               IOAI  X04450000
               RCC),VL                15  RETURN CODE            IOAI   04460000
         L     R15,SAVER15                                       IOAI   04470000
         LTR   R15,R15                CTMMEM ENDED OK ?          IOAI   04480000
         BZ    MEMREADY                  YES, CONTINUE           IOAI   04490000
         MVC   0(8,R2),=CL8' '        CLEAR MEMBER NAME FOR MSG  IOAI   04500000
         CTSMSG1  CODE=CTS910E,PLANT=(44,TMPCARD+9,8,0(R2)),     IOAI  X04510000
               ROUT=(OUT,WTO),WTOCON=CTS                         IOAI   04520000
         B     GETLIBS                CONTINUE WITH NEXT LIBRARY IOAI   04530000
MEMREADY EQU   *                                                 IOAI   04540000
*                                                                       04550000
*  MEMBERS LIST IS READY, LETS CHECK HOW MANY ?                         04560000
*                                                                       04570000
         CLC   MAXLINES,=F'0'         SOMETHING HAD READ ?              04580000
         BE    GETLIBS                CONTINUE WITH NEXT LIBRARY        04590000
*                                                                       04600000
*  MEMBERS LIST IS READY, LETS ALLOCATE THEM ONE BY ONE (EXCEPT  IOAI   04610000
*  THE DEFPARMX MEMBER). BEFORE ALLOC, CHECK IF MEMBER EXISTS.   IOAI   04620000
*                                                                IOAI   04630000
         L     R2,=A(INRECS)          START OF MEMBER NAMES AREA IOAI   04640000
MEMSLOOP EQU   *                                                 IOAI   04650000
*                                                                       04660000
         CTSADBG 'MEMSLOOP: MEM=_',(0(R2),8),                          X04670000
               LEVEL=(DEBUGL,1)                                         04680000
*                                                                       04690000
         CLC   =CL7'DEFPARM',0(R2)      IF IT IS DEFPARMX MEMBER WS2393 04700000
         BE    SKIPDFPX                    THEN DONT MODIFY IT   WS2393 04710000
         CLC   =CL4'TYPE',0(R2)         IF IT IS TYPE MEMBER     WS2393 04720000
         BE    SKIPDFPX                    THEN DONT MODIFY IT   WS2393 04730000
         MVC   S99DSN+6(44),TMPCARD+9   SUPPLY LIB NAME          IOAI   04740000
         MVC   S99MMBR+6(8),0(R2)       SUPPLY MEM NAME          IOAI   04750000
         OI    S99DDNMA,X'80'           DONT ALLOC MEMBER        IOAI   04760000
         LA    R1,S99RBPTR                                       IOAI   04770000
         SVC   99                       ALLOCATE LIB ONLY        IOAI   04780000
         LTR   R15,R15                  OK ?                     IOAI   04790000
         BNZ   ALLOCER                    NO, ERROR              IOAI   04800000
         LH    R1,S99ERROR                                       IOAI   04810000
         LTR   R1,R1                    OK ?                     IOAI   04820000
         BNZ   ALLOCER                    NO, ERROR              IOAI   04830000
         LH    R1,S99INFO                                        IOAI   04840000
         LTR   R1,R1                    OK ?                     IOAI   04850000
         BNZ   ALLOCER                    NO, ERROR              IOAI   04860000
         MVC   DAINS+DCBDDNAM-IHADCB(8),S99DDNM+6                IOAI   04870000
         OPEN  (DAINS,INPUT)            PREPARE FOR              IOAI   04880000
         MVC   BLDLNAME(8),0(R2)          BLDL                   IOAI   04890000
         BLDL  DAINS,BLDL                                        IOAI   04900000
         LTR   R15,R15                  MEMBER EXISTS ?          IOAI   04910000
         BNZ   ALLOCER                    NO, ERROR              IOAI   04920000
         CLOSE DAINS                    CLOSE AND FREE           IOAI   04930000
         NI    S99DDNMA,X'7F'           THIS TIME ALLOC MEMBER   IOAI   04940000
         LA    R1,S99RBPTR                                       IOAI   04950000
         SVC   99                       ALLOCATE LIB(MEMBER)     IOAI   04960000
         LTR   R15,R15                  OK ?                     IOAI   04970000
         BNZ   ALLOCER                    NO, ERROR              IOAI   04980000
         LH    R1,S99ERROR                                       IOAI   04990000
         LTR   R1,R1                    OK ?                     IOAI   05000000
         BNZ   ALLOCER                    NO, ERROR              IOAI   05010000
         LH    R1,S99INFO                                        IOAI   05020000
         LTR   R1,R1                    OK ?                     IOAI   05030000
         BNZ   ALLOCER                    NO, ERROR              IOAI   05040000
         B     ALLOCOK                  EVERYTHING OK            IOAI   05050000
*                                                                IOAI   05060000
*** LIBRARY OR MEMBER NOT ALLOCATED                              IOAI   05070000
*                                                                IOAI   05080000
ALLOCER  DS    0H                                                IOAI   05090000
         CTSMSG1 CODEMSG=CTS910E,PLANT=(44,TMPCARD+9,8,0(R2)),   IOAI  X05100000
               ROUT=(OUT,WTO),WTOCON=CTS                         IOAI   05110000
*                                                                IOAI   05120000
*** NEXT MEMBER DUE TO ALLOC FAIL OR 'DEFPARMX' MEMBER SKIP      IOAI   05130000
*                                                                IOAI   05140000
SKIPDFPX DS    0H                       WAS OPENED BEFORE BLDL   IOAI   05150000
         CLOSE DAINS                    WAS OPENED BEFORE BLDL   IOAI   05160000
         LA    R2,11(R2)                NEXT MEMBER              IOAI   05170000
         L     R1,MAXLINES              NUMBER OF REMAINING MEMS IOAI   05180000
         BCTR  R1,0                     UPDATE THEM              IOAI   05190000
         ST    R1,MAXLINES                 AND KEEP              IOAI   05200000
         LTR   R1,R1                    ANY REMAINING MEM ?      IOAI   05210000
         BNZ   MEMSLOOP                    YES, CONTINUE         IOAI   05220000
         B     GETLIBS                  LOOP TO NEXT LIRARY      IOAI   05230000
*                                                                IOAI   05240000
***    OPEN LIBRARY AND MEMBER TO BE UPDATED                     IOAI   05250000
*                                                                IOAI   05260000
ALLOCOK  MVC   DAINS+DCBDDNAM-IHADCB(8),S99DDNM+6                IOAI   05270000
         OPEN    (DAINS,UPDAT)                                   IOAI   05280000
         MVI   UPDFLAG,X'00'       CLEAR FOR NEW MEMBER          WM0910 05290000
*                                                                       05300000
***      GET   NEXT  RECORD  FROM  MEMBER                               05310000
*                                                                       05320000
GET      EQU    *                                                       05330000
         GET    DAINS                                                   05340000
         NI     FLAG,255-$WORK-$A                                       05350000
         MVC    CARD,0(R1)                                              05360000
         MVC    NEWCARD,=80C' '                                         05370000
         MVC    NEWCARD1,=80C' '                                        05380000
         LR     R3,R1                                                   05390000
         LA     R8,CARD                                                 05400000
         LA     R4,80                                                   05410000
         MVC    POS,=A(CARD+70)                                 W605    05420000
         MVC    NEWPOS,=A(NEWCARD+70)                           W605    05430000
*        PRTDBG ' WORKING ON _',(CARD,80)                               05440000
         LA     R9,NEWCARD                                              05450000
         STM    R1,R2,SAVER12             SAVE REGS FOR TRT    WM0910   05460000
         L      R15,PERCTABA                                   WM0910   05470000
         TRT    0(70,R8),0(R15)           ANY % ON THIS CARD ? WM0910   05480000
         LM     R1,R2,SAVER12                                  WM0910   05490000
         BZ     PUTX                      ..IF NOT, SKIP       WM0910   05500000
*                                                                       05510000
LOOPCARD EQU    *                                                       05520000
*                                                                       05530000
***     SEARCH   FOR  VARIABLE IN CARD                                  05540000
         LM     R5,R7,=A(TABLE,FLDLEN,TABEND)                           05550000
         USING  FLD,R5                                                  05560000
LOOPVAR  EQU    *                                                       05570000
         L      R15,FLDVARL                                             05580000
         BCTR   R15,0                                                   05590000
         EX     R15,SEARCH       CLC     FLDVAR(*-*),0(R8)              05600000
         BE     REPLIT                                                  05610000
         BXLE   R5,R6,LOOPVAR                                           05620000
SKIPVAR  EQU    *                NO REPLACEMENT VALUE         BM1403    05630000
         MVC    0(1,R9),0(R8)                                           05640000
         LA     R8,1(R8)                                                05650000
         C      R8,POS                                          W605    05660000
         BH     PUTX                                                    05670000
         LA     R9,1(R9)                                                05680000
         C      R9,NEWPOS                                       W605    05690000
         BH     PUTX                                                    05700000
         BCT    R4,LOOPCARD                                             05710000
         B      PUTX                                                    05720000
*                                                                       05730000
***       IF   STRING   FOUND  THEN  REPLACE IT                         05740000
*                                                                       05750000
REPLIT   EQU    *                                                       05760000
         ICM    R14,B'1111',FLDREPLL                                    05770000
         BZ     SKIPVAR          NO REPLACEMENT VALUE         BM1403    05780000
         OI     FLAG,$WORK       MARK: WE  CHANGED  SOMETHING           05790000
         CLI    FLDFLAG,FLDFPOS                                 W605    05800000
         BNE    REP02                                           W605    05810000
         MVC    NEWPOS,=A(NEWCARD+80)                           W605    05820000
         MVC    POS,=A(CARD+80)                                 W605    05830000
         OI     FLAG,$A                                         W605    05840000
*IS10148B REP02 L      R14,FLDREPLL                                     05850000
*IS10148B BCTR  R14,0                                                   05860000
REP02    DS     0H                                             IS10148B 05870000
         L      R14,FLDREPLL                                   IS10148B 05880000
         CHI    R14,L'NOVAL         IS IT 'NO-VALUE' STIRNG ?  IS10148B 05890000
         BNE    DOMOVE                                         IS10148B 05900000
         CLC    FLDREPL(L'NOVAL),NOVAL IS IT 'NO-VALUE' STIRG? IS10148B 05910000
         BNE    DOMOVE                                         IS10148B 05920000
         LHI    R14,0            NO VALUE - SET LENGTH 0.      IS10148B 05930000
DOMOVE   DS     0H                                             IS10148B 05940000
         AHI    R14,-1                                         IS10148B 05950000
         BM     AFTMOVE          NO VALUE - NO MOVE.           IS10148B 05960000
         EX     R14,MOVEREPL     MVC     0(*-*,R9),FLDREPL              05970000
AFTMOVE  DS     0H                                             IS10148B 05980000
         LA     R9,1(R14,R9)                                            05990000
         C      R9,NEWPOS                                        W605   06000000
         BH     PUTX                                                    06010000
         LA     R8,1(R15,R8)                                            06020000
         C      R8,POS                                           W605   06030000
         BH     PUTX                                                    06040000
         CLI    FLDFLAG,FLDFSPC  SPECIAL FORMATTING?                    06050000
         BNE    LOOPCARD         NO                                     06060000
SMALLOOP CLI    0(R8),C' '       END OF SUFFIX                    W854  06070000
         BE     ENDSMALL         YES                              W854  06080000
         MVC    0(1,R9),0(R8)    APPEND SUFFIX                    W854  06090000
         LA     R8,1(R8)         BUMP POSITION                    W854  06100000
         LA     R9,1(R9)         BUMP POSITION                    W854  06110000
         B      SMALLOOP                                          W854  06120000
ENDSMALL SR     R15,R14          R15 = DIFFERENCE BETWEEN THE STRINGS   06130000
         AR     R9,R15           ADJUST POSITION ACCORDINGLY      W854  06140000
         B      LOOPCARD         ANOTHER   VARIBLE  CAN BE IN CARD      06150000
PUTX     EQU    *                                                       06160000
         TM     FLAG,$WORK       ANYTHING  DONE                         06170000
         BZ     GET              NO                                     06180000
*                                                                       06190000
***      OPTIONALLY GIVE 'START OF MODIFICATION' MESSAGE         WM0910 06200000
*                                                                       06210000
         CLI   UPDFLAG,X'FF'       IOA1004 GIVEN ONCE ?          WM0910 06220000
         BE    NO1004A             ..IF SO, SKIP IOA1004         WM0910 06230000
         MVC    STRTEND(5),=CL5'START'                           IOAI   06240000
         CTSMSG1 CODE=CTS904I,ROUT=(OUT),WTOCON=CTS,             IOAI  X06250000
               PLANT=(5,STRTEND,8,0(R2),44,TMPCARD+9)            IOAI   06260000
NO1004A  DS    0H                                                WM0910 06270000
*                                                                       06280000
***      SHOW   CARD   BEFORE  CHANGE                                   06290000
*                                                                       06300000
         CTSMSG1 CODE=CTS905I,PLANT=(80,0(R3)),ROUT=OUT                 06310000
*                                                                       06320000
***      SHOW   CARD   AFTER   CHANGE                                   06330000
*                                                                       06340000
         CTSMSG1 CODE=CTS906I,PLANT=(80,NEWCARD),ROUT=OUT               06350000
         MVI   UPDFLAG,X'FF'       MARK: AT LEAST ONCE CHANGE    WM0910 06360000
         TM     FLAG,$A                                         W605    06370000
         BNO    PUT02                                           W605    06380000
         MVC    0(80,R3),NEWCARD                                W605    06390000
         B      POSTPUT                                         W605    06400000
PUT02    MVC    0(70,R3),NEWCARD                                        06410000
POSTPUT  LR     R1,R3                                                   06420000
         PUTX   DAINS                                                   06430000
         B      GET                                                     06440000
EODAD    CLOSE  DAINS                    CLOSE MEMBER AND FREE          06450000
*                                                                       06460000
***      INFORM   ENDED WITH MEMBER UPDATING                            06470000
*                                                                       06480000
         CLI   UPDFLAG,X'FF'       AT LEAST ONE CHANGE ?         WM0910 06490000
         BNE   NO1004B             ..IF NO, SKIP IOA1004         WM0910 06500000
         MVC    STRTEND(5),=CL5'END  '                           IOAI   06510000
         CTSMSG1 CODEMSG=CTS904I,ROUT=(OUT),WTOCON=CTS,          IOAI  X06520000
               PLANT=(5,STRTEND,8,0(R2),44,TMPCARD+9)            IOAI   06530000
NO1004B  DS    0H                                                WM0910 06540000
*                                                                IOAI   06550000
***     ADVANCE TO NEXT LIBRARY/MEMBER                           IOAI   06560000
*                                                                IOAI   06570000
         LA     R2,11(R2)                SKIP TO NEXT MEMBER     IOAI   06580000
         L      R1,MAXLINES              NO OF REMAINING MEMBERS IOAI   06590000
         BCTR   R1,0                     UPDATE THEM             IOAI   06600000
         ST     R1,MAXLINES                 AND KEEP             IOAI   06610000
         LTR    R1,R1                    ANY MORE MEMBERS ?      IOAI   06620000
         BNZ    MEMSLOOP                    YES, GET NEXT MEMBER IOAI   06630000
         B      GETLIBS                  GET NEXT LIBRARY        IOAI   06640000
ENDLIBS  EQU    *                                                       06650000
*        WTO     'CTSAINS: BEFORE CLOSE DCBOUT'                  WS2393 06660000
         CLOSE   DCBOUT                                                 06670000
*        WTO     'CTSAINS: BEFORE CLOSE DALIBS'                  WS2393 06680000
         CLOSE   DALIBS                                                 06690000
         SR      R15,R15                                                06700000
RETURN   EQU    *                                                       06710000
*        WTO     'CTSAINS: EXIT'                                 WS2393 06720000
         BRTRN   (15)                                                   06730000
*                                                                IOAI   06740000
***  MISSING/INVALID  PARAMETR IN PARM FIELD                     IOAI   06750000
*                                                                IOAI   06760000
ERR1001  CTSMSG1  CODE=CTS901E,ROUT=(OUT,WTO),WTOCON=CTS         IOAI   06770000
         CLOSE   DCBOUT                                                 06780000
         LA      R15,8                                                  06790000
         B       RETURN                                                 06800000
*                                                                       06810000
*  INVALD PARM NAME     WAS GIVEN                                       06820000
*                                                                       06830000
ERR1009  EQU    *                                                       06840000
         CTSMSG1 CODE=CTS909E,PLANT=(80,TMPCARD),ROUT=OUT               06850000
         LA     R15,8                                                   06860000
         B      RETURN                                                  06870000
*                                                                       06880000
***  OPEN OF DDNAME FAILED                                              06890000
*                                                                       06900000
ERR1007  CTSMSG1  CODE=CTS907E,ROUT=(OUT,WTO),                         X06910000
               PLANT=(8,DDMSG),WTOCON=CTS                        IOAI   06920000
         CLOSE   DCBOUT                                                 06930000
         LA      R15,8                                                  06940000
         B       RETURN                                                 06950000
*                                                                       06960000
***  VALUE OF %VAR% EXCEEDS 44 CHARACTERS                               06970000
*                                                                       06980000
ERR1015  DS     0H                                               BM1270 06990000
         CTSMSG1 CODE=CTS915E,PLANT=(8,TMPCARD),                 BM1270X07000000
               ROUT=(OUT,WTO),WTOCON=CTS                         BM1270 07010000
         CLOSE   (DCBOUT,,DALIBS,,DAREP)                         BM1270 07020000
         LA      R15,8                                           BM1270 07030000
         B       RETURN                                          BM1270 07040000
*                                                                       07050000
***  VALUE OF GTYPE DOES NOT MATCH INSTALLATION MEDIA                   07060000
*                                                                       07070000
ERR1016  DS     0H                                               WS2393 07080000
         CTSMSG1 CODE=CTS916E,PLANT=(8,GTYPEVAL,8,TMPCARD),      WS2393X07090000
               ROUT=(OUT,WTO),WTOCON=CTS                         WS2393 07100000
         CLOSE   (DCBOUT,,DATYPE)                                WS2393 07110000
         LA      R15,8                                           WS2393 07120000
         B       RETURN                                          WS2393 07130000
*                                                                STCJOB 07140000
***  PROCPREF COLLIDES WITH PREFIXES IN PROCLIB                  STCJOB 07150000
*                                                                STCJOB 07160000
ERROR917 DS     0H                                               STCJOB 07170000
         CTSMSG1 CODE=CTS917E,                                   STCJOBX07180000
               ROUT=(OUT,WTO),WTOCON=CTS                         STCJOB 07190000
         CLOSE   (DCBOUT,,DATYPE)                                STCJOB 07200000
         LA      R15,8                                           STCJOB 07210000
         B       RETURN                                          STCJOB 07220000
*                                                                STCJOB 07230000
***  STCJOBS=DONOTCOPY WITH PROCLIB=LOCALCOPY                    STCJOB 07240000
*                                                                STCJOB 07250000
ERROR918 DS     0H                                               STCJOB 07260000
         CTSMSG1 CODE=CTS918E,                                   STCJOBX07261000
               ROUT=(OUT,WTO),WTOCON=CTS                         STCJOB 07262000
         CLOSE   (DCBOUT,,DATYPE)                                STCJOB 07263000
         LA      R15,8                                           STCJOB 07264000
         B       RETURN                                          STCJOB 07265000
*                                                                STCJOB 07266000
***  INTERNAL VARIABLE IS MISSING FROM TABLE.                    STCJOB 07267000
*                                                                STCJOB 07268000
ER919OVL DS    0H                                              IS10148A 07269000
         MVI   VARNAME,C' '                                    IS10148A 07269100
         MVC   VARNAME+1(L'VARNAME-1),VARNAME                  IS10148A 07269200
         MVC   VARNAME,=C'%OLVOLS%'                            IS10148A 07269300
         B     ERROR919                                        IS10148A 07269400
ER919OVS DS    0H                                              IS10148A 07269500
         MVI   VARNAME,C' '                                    IS10148A 07269600
         MVC   VARNAME+1(L'VARNAME-1),VARNAME                  IS10148A 07269700
         MVC   VARNAME,=C'%OLVOLSVS%'                          IS10148A 07269800
         B     ERROR919                                        IS10148A 07269900
ER919PR  DS    0H                                                STCJOB 07270000
         MVI   VARNAME,C' '                                      STCJOB 07271000
         MVC   VARNAME+1(L'VARNAME-1),VARNAME                    STCJOB 07271100
         MVC   VARNAME,=C'%PRCREN%'                              STCJOB 07271200
         B     ERROR919                                          STCJOB 07271300
ER919JCL DS    0H                                                STCJOB 07271400
         MVI   VARNAME,C' '                                      STCJOB 07271500
         MVC   VARNAME+1(L'VARNAME-1),VARNAME                    STCJOB 07271600
         MVC   VARNAME,=C'%JCLLIB%'                              STCJOB 07271700
         B     ERROR919                                          STCJOB 07271800
ER919STC DS    0H                                                STCJOB 07271900
         MVI   VARNAME,C' '                                      STCJOB 07272000
         MVC   VARNAME+1(L'VARNAME-1),VARNAME                    STCJOB 07272100
         MVC   VARNAME,=C'%STCJOBS%'                             STCJOB 07272200
         B     ERROR919                                          STCJOB 07272300
ER919STI DS    0H                                                STCJOB 07272400
         MVI   VARNAME,C' '                                      STCJOB 07272500
         MVC   VARNAME+1(L'VARNAME-1),VARNAME                    STCJOB 07272600
         MVC   VARNAME,=C'%STCJOBSIND%'                          STCJOB 07272700
         B     ERROR919                                          STCJOB 07272800
ER919PRP DS    0H                                                STCJOB 07272900
         MVI   VARNAME,C' '                                      STCJOB 07273000
         MVC   VARNAME+1(L'VARNAME-1),VARNAME                    STCJOB 07273100
         MVC   VARNAME,=C'%PROCPREFS%'                           STCJOB 07273200
         B     ERROR919                                          STCJOB 07273300
ER919PRC DS    0H                                                STCJOB 07273400
         MVI   VARNAME,C' '                                      STCJOB 07273500
         MVC   VARNAME+1(L'VARNAME-1),VARNAME                    STCJOB 07273600
         MVC   VARNAME,=C'%PROCLIB%'                             STCJOB 07273700
         B     ERROR919                                          STCJOB 07273800
ERROR919 DS     0H                                               STCJOB 07273900
         CTSMSG1 CODE=CTS919E,                                   STCJOBX07274000
               PLANT=(16,VARNAME),                               STCJOBX07274100
               ROUT=(OUT,WTO),WTOCON=CTS                         STCJOB 07274200
         CLOSE   (DCBOUT,,DATYPE)                                STCJOB 07274300
         LA    R15,8                                             STCJOB 07274400
         B     RETURN                                            STCJOB 07274500
*                                                                       07274600
***   OPEN  OF  SYSPRINT  DD  FAILED                                    07274700
*                                                                       07274800
ERROR913 CTSMSG1   CODE=CTS913S,ROUT=WTO,WTOCON=CTS                     07274900
         BRTRN  8                                                       07275000
*                                                                       07276000
MVCREP   MVC   FLDREPL(*-*),0(R15)                                      07277000
*                                                                       07278000
***  CONSTANTS                                                          07279000
*                                                                       07280000
MCTADDR  DS    A                                                 WM0910 07290000
CURTIME  DS    F                                                        07300000
SAVERTN  DS    F                                                        07310000
FLAG     DS    X                                                        07320000
$WORK    EQU   X'80'                                                    07330000
$A       EQU   X'40'                                                    07340000
CARD     DC    CL80' '                                                  07350000
NEWCARD  DC    CL80' '                                                  07360000
NEWCARD1 DC    CL80' '                                                  07370000
ONE      DC    F'1'                                                     07380000
TWO      DC    F'2'                                           *CTB4     07390000
*IS10148B NOVOL DC    CL2''''''                                IS10148A 07400000
NOVAL    DC    C'@#SP-@#SP-@#SP'     NO VALUE INDICAITON.     IS10148B  07410000
REPCNG   CLC   FLDVAR(*-*),TMPCARD                                      07420000
         DS    0F                                                       07430000
MOVEREPL MVC   0(*-*,R9),FLDREPL                                        07440000
SEARCH   CLC   FLDVAR(*-*),0(R8)                                        07450000
MOVEVAR  MVC   0(*-*,R7),0(R6)                                          07460000
YESNO    DC    CL3' '                                                   07470000
DATEFMT  DC    CL3' '                                           WM1286  07480000
DUMMY    DC    CL8' '                                                   07490000
HSPRG    DC    CL8' '                                                   07500000
BKPTYPE  DC    CL8' '                                       W602        07510000
DONTCOPY DC    C'DONTCOPY'                                      STCJOB  07520000
LOCALCPY DC    C'LOCALCOPY'                                     STCJOB  07530000
*                                                               STCJOB  07540000
**   RESERVED NAMES WHEN JCLLIB IS USED (THE PROCEDURES ARE     STCJOB  07550000
**   COPIED IN A DIFFERENT NAME TO OUR PROCLIB SO THE PREFIX    STCJOB  07560000
**   SHOULD NOT COLIDE WITH EXISTING NAMES.                     STCJOB  07570000
*                                                               STCJOB  07580000
PRFXRSV  DS    0C                                               STCJOB  07590000
*                                                               STCJOB  07600000
         DC    CL3'ACF'                                         STCJOB  07610000
PRFXRSVL EQU   *-PRFXRSV                                        STCJOB  07620000
         DC    CL3'RCF'                                         STCJOB  07630000
         DC    CL3'TSS'                                         STCJOB  07640000
PRFXCTS  DC    CL3'CTS'                                         STCJOB  07650000
PRFXRSVE EQU   *                                                STCJOB  07660000
*                                                                       07670000
         LTORG                                                          07680000
DEBUGL   DC    X'00'              DEBUG LEVEL                           07690000
GENM     DC    C'1'               GENERIC MONITOR              WD1567   07700000
GENCL    DC    CL8' '             GENERIC CLASSES              WD1567   07710000
TMPCARD  DC    CL80' '                                                  07720000
TMPLOGSZ DS    F                                                        07730000
DOUBLE   DS    D                                                W603    07740000
MINUS1   DC    PL2'-1'                                                  07750000
PLUS1    DC    PL2'1'                                                   07760000
WTOLCK   DS    CL6                                              WM1286  07770000
WTOLCKA  DC    XL6'020300010405'                                WM1286  07780000
WTOLCKW  DC    XL6'000102030405'                                WM1286  07790000
WTOLCKJ  DC    XL6'040502030001'                                WM1286  07800000
POS      DS    A                                                W605    07810000
NEWPOS   DS    A                                                W605    07820000
CONTRPRC DS    CL8                                              IOAI    07830000
INSTYPE  DS    CL3                                              IOAI    07840000
DDMSG    DS    CL8              FOR CTD1007 MESSAGE             IOAI    07850000
STRTEND  DS    CL5              FOR CTD1004 MESSAGE             IOAI    07860000
SAVER15  DS    F                SAVE RC FROM CTMMEM             IOAI    07870000
YES      DC    CL3'YES'                                         IOAI    07880000
NO       DC    CL3'NO '                                         IOAI    07890000
LANG     DC    CL3' '                                           IOAI    07900000
BLDL     DS    0H                                               IOAI    07910000
         DC    H'1'                                             IOAI    07920000
         DC    H'60'                                            IOAI    07930000
BLDLNAME DS    CL8                                              IOAI    07940000
         DS    CL50                                             IOAI    07950000
         DS    CL2                                              IOAI    07960000
PERCTABA DC    A(PERCTAB)                                      WM0910   07970000
SAVER12  DS    2F                                              WM0910   07980000
UPDFLAG  DS    X                   FLAG FOR IOA1004 MESSAGE    WM0910   07990000
GTYPEVAL DS    CL8                 TYPE OF RSS                  WS2393  08000000
PROCPREF DS    CL3                 PROCPREFS VALUE              STCJOB  08010000
PRCRENP  DC    A(0)                    -> PRCREN ENTRY.         STCJOB  08020000
VARNAME  DC    CL16' '             VARIABLE NAME FOR CTS918E    STCJOB  08030000
*                                                               IOAI    08040000
*** CTMMEM VARIABLES                                            IOAI    08050000
*                                                               IOAI    08060000
FINISH   DC    CL8'FINISH  '       1   CLEAN CTMMEM AREAS       IOAI    08070000
DIRECTOR DC    CL8'DIRECTOR'       1   GET MEMBER               IOAI    08080000
MEMLIB   DC    CL44' '             2   LIBRARY NAME             IOAI    08090000
DDNAME   DC    CL6'DAINS '         3   1-ST 6 CHARS OF DDNAME   IOAI    08100000
MULTDD   DC    CL2'  '            10   LAST 2 CHARS OF DDNAME   IOAI    08110000
MEMNAME  DC    CL8'        '       4   MEMBER NAME              IOAI    08120000
VEC      DC    CL1'V'              6   SEQUENTIAL AREA (REC AFTER REC)  08130000
MAXLINES DC    F'0'                7   MAX NO. OF MEMBERS       IOAI    08140000
USERID   DC    CL8'   '            8                            IOAI    08150000
FROMLINE DC    F'0'                9   START LINE               IOAI    08160000
PUTOPT   DC    CL1' '             11                            IOAI    08170000
ABEND    DS    F                  12                            IOAI    08180000
RCC      DS    F                  15                            IOAI    08190000
         DS    0F                                                       08200000
DAINS    DCB   DDNAME=XXXXXXXX,RECFM=FB,DSORG=PS,MACRF=(GL,PM),        *08210000
               EODAD=EODAD,BUFNO=255                             WM0910 08220000
DAREP    DCB   DDNAME=DAREP,RECFM=FB,DSORG=PS,MACRF=(GM),              *08230000
               EODAD=ENDPRM                                             08240000
DCBOUT   DCB   DDNAME=SYSPRINT,LRECL=121,RECFM=FBA,                    *08250000
               BLKSIZE=121*8,DSORG=PS,MACRF=PM                          08260000
DALIBS   DCB   DDNAME=DALIBS,RECFM=FB,DSORG=PS,MACRF=GM,        IOAI   *08270000
               EODAD=ENDLIBS                                     IOAI   08280000
DATYPE   DCB   DDNAME=DATYPE,RECFM=FB,DSORG=PS,MACRF=(GM),             *08290000
               EODAD=ENDTYPE                                   WS2393   08300000
*                                                                IOAI   08310000
*** SVC 99 TEXT UNITS                                            IOAI   08320000
*                                                                IOAI   08330000
         CNOP  0,4                                               IOAI   08340000
S99RBPTR DC    X'80',AL3(S99RB)                                  IOAI   08350000
*                                                                IOAI   08360000
S99RB    DC    AL1(20)               LENGTH OF RB                IOAI   08370000
         DC    X'01'                 ALLOCATION REQUESTED        IOAI   08380000
         DC    B'00100000'           DO NOT MOUNT VOLUMES        IOAI   08390000
         DC    B'00000000'           RESERVED                    IOAI   08400000
S99ERROR DC    H'0'                  ERROR FLAGS                 IOAI   08410000
S99INFO  DC    H'0'                  INFO CODE                   IOAI   08420000
         DC    A(S99TUPL)            PTR TO TEXT-POINTERS        IOAI   08430000
         DC    F'0'                  RESERVED                    IOAI   08440000
         DC    F'0'                  FLAGS2                      IOAI   08450000
S99TUPL  DS    0F                                                IOAI   08460000
S99DSNA  DC    A(S99DSN)                                         IOAI   08470000
S99DISPA DC    A(S99DISP)                                        IOAI   08480000
S99CLSA  DC    A(S99CLOSE)                                       IOAI   08490000
S99DDNMA DC    A(S99DDNM)                ONE BEFORE LAST ADDRESS IOAI   08500000
S99MMBRA DC    X'80',AL3(S99MMBR)        LAST ADDRESS            IOAI   08510000
         CNOP  0,4                                               IOAI   08520000
S99DSN   DC    X'0002',X'0001',Y(0044),CL44' '   DSNAME          IOAI   08530000
         CNOP  0,4                                               IOAI   08540000
S99DISP  DC    X'0004',X'0001',Y(0001),X'08'     DISP1=SHR       IOAI   08550000
         CNOP  0,4                                               IOAI   08560000
S99CLOSE DC    X'001C',X'0000'                   UNALLOC AT CLOSEIOAI   08570000
         CNOP  0,4                                               IOAI   08580000
S99DDNM  DC    X'0055',X'0001',Y(0008),CL8' '    RETURN DDNAME   IOAI   08590000
         CNOP  0,4                                               IOAI   08600000
S99MMBR  DC    X'0003',X'0001',Y(0008),CL8' '    MEMBER NAME     IOAI   08610000
*                                                                       08620000
RAREA    DS    XL384                   CTSMSG1 WORK AREA                08630000
*                                                                       08640000
* VARIABLES FOR IOA                                                     08650000
*                                                                       08660000
         DEFVAR    VAR=%OS%                                             08670000
         DEFVAR    VAR=%ASSEM%                                          08680000
         DEFVAR    VAR=%LKED%                                           08690000
         DEFVAR    VAR=%IEBCOPY%                                        08700000
         DEFVAR    VAR=%IKJEFT01%                                       08710000
         DEFVAR    VAR=%IDCAMS%                                         08720000
         DEFVAR    VAR=%IEFBR14%                                        08730000
         DEFVAR    VAR=%STEPLIB%                                 IOAI   08740000
         DEFVAR    VAR=%JOBNAME%                                 IOAI   08750000
         DEFVAR    VAR=%JOBCARD%                                 IOAI   08760000
         DEFVAR    VAR=%PROCLIB%                                 IOAI   08770000
         DEFVAR    VAR=%CLIST%                                   IOAI   08780000
         DEFVAR    VAR=%HOLDCLASS%                               IOAI   08790000
         DEFVAR    VAR=%DUMPCLASS%                               IOAI   08800000
         DEFVAR    VAR=%LINKLIB%                                 IOAI   08810000
         DEFVAR    VAR=%WORKUNIT%       ADDED BY JEHUDA 2.4.91   IOAI   08820000
         DEFVAR    VAR=%SMPENV%                                  SMP/E  08830000
         DEFVAR    VAR=%SPAPREF%                                 SMP/E  08840000
         DEFVAR    VAR=%SPAVER%                                  SMP/E  08850000
         DEFVAR    VAR=%SPAUNIT%                                 SMP/E  08860000
         DEFVAR    VAR=%SPAVOL%                                  SMP/E  08870000
         DEFVAR    VAR=%SPCPREF%                                 SMP/E  08880000
         DEFVAR    VAR=%SPCVER%                                  SMP/E  08890000
         DEFVAR    VAR=%SPCUNIT%                                 SMP/E  08900000
         DEFVAR    VAR=%SPCVOL%                                  SMP/E  08910000
         DEFVAR    VAR=%SPDPREF%                                 SMP/E  08920000
         DEFVAR    VAR=%SPDVER%                                  SMP/E  08930000
         DEFVAR    VAR=%SPDUNIT%                                 SMP/E  08940000
         DEFVAR    VAR=%SPDVOL%                                  SMP/E  08950000
         DEFVAR    VAR=%ILPREFS%                                 CTSA   08960000
         DEFVAR    VAR=%ILVERS%                                  CTSA   08970000
         DEFVAR    VAR=%ILVOLS%                                  CTSA   08980000
         DEFVAR    VAR=%ILUNITS%                                 CTSA   08990000
         DEFVAR    VAR=%OLPREFS%                                 CTSA   09000000
         DEFVAR    VAR=%OLVERS%                                  CTSA   09010000
         DEFVAR    VAR=%OLVOLS%                                  CTSA   09020000
         DEFVAR    VAR=%OLUNITS%                                 CTSA   09030000
         DEFVAR    VAR=%SPCPREF%                                 CTSA   09040000
         DEFVAR    VAR=%SPCVER%                                  CTSA   09050000
         DEFVAR    VAR=%SPCVOL%                                  CTSA   09060000
         DEFVAR    VAR=%SPCUNIT%                                 CTSA   09070000
         DEFVAR    VAR=%SPDPREF%                                 CTSA   09080000
         DEFVAR    VAR=%SPDVER%                                  CTSA   09090000
         DEFVAR    VAR=%SPDVOL%                                  CTSA   09100000
         DEFVAR    VAR=%SPDUNIT%                                 CTSA   09110000
         DEFVAR    VAR=%SPAPREF%                                 CTSA   09120000
         DEFVAR    VAR=%SPAVER%                                  CTSA   09130000
         DEFVAR    VAR=%SPAVOL%                                  CTSA   09140000
         DEFVAR    VAR=%SPAUNIT%                                 CTSA   09150000
         DEFVAR    VAR=%PROCPREFS%                               CTSA   09160000
         DEFVAR    VAR=%BRODCAST%                                CTSA   09170000
         DEFVAR    VAR=%LPALIB%                                  CTSA   09180000
         DEFVAR    VAR=%RSSNAME%                                 CTSA   09190000
         DEFVAR    VAR=%RSSGTYPE%                                CTSA   09200000
         DEFVAR    VAR=%STCJOBS%                                STCJOB  09210000
         DEFVAR    VAR=%JCLLIB%           INTERNAL              STCJOB  09220000
         DEFVAR    VAR=%STCJOBSIND%       INTERNAL              STCJOB  09230000
         DEFVAR    VAR=%PRCREN%           INTERNAL              STCJOB  09240000
         DEFVAR    VAR=%OLVOLSVS%         INTERNAL             IS10148A 09250000
*                                                                       09260000
         REPLACE   ACT=GEN                                              09270000
*                                                                       09280000
PERCTAB  DC    XL256'00'                                        WM0910  09290000
         ORG   PERCTAB+C'%'                                     WM0910  09300000
         DC    C'%'                                             WM0910  09310000
         ORG   ,                                                WM0910  09320000
*                                                                       09330000
INRECSL  EQU   500                     NUMBER OF MEMS FOR CTMMEM IOAI   09340000
INRECS   DS    (INRECSL)CL11           MEMBER NAMES LISTING      IOAI   09350000
         END                                                            09360000

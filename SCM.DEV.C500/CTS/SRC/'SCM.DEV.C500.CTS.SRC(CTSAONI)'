         START                                                          00010000
*                                                                       00020000
****************************************************************        00030000
****                                                        ****        00040000
****     CONTROL-SA  RELEASE 1.3.0                          ****        00050000
****                                                        ****        00060000
****     LICENCED MATERIAL - NEW DIMENSION SOFTWARE LTD.    ****        00070000
****                                                        ****        00080000
****************************************************************        00090000
*                                                                       00100000
****************************************************************        00110000
*                                                              *        00120000
* TITLE            : ONLINE INTERCEPTOR XMS FUNCTIONS          *        00130000
*                                                              *        00140000
* FILE NAME        : CTSAONI                                   *        00150000
*                                                              *        00160000
* AUTHOR           : DORON COHEN                               *        00170000
*                                                              *        00180000
* CREATION DATE    : 18/8/94                                   *        00190000
*                                                              *        00200000
* DESCRIPTION      : INITIALIZE/GETREQ/TERM OF REQUEST CHAINS  *        00210000
*                    AND XMS ENVIRONEMNT OF CONTROL-SA         *        00220000
*                    INTERCEPTOR                               *        00230000
*                                                              *        00240000
* ASSUMPTIONS AND                                              *        00250000
*   CONSIDERATIONS : 1. CALLER IS APF AUTHORIZED               *        00260000
*                                                              *        00270000
****************************************************************        00280000
*--------V.1.3.0-----------------------------------------------*        00290000
* NEW     DC 18/08/94                                          *        00300000
*--------V.2.1.0-----------------------------------------------*        00301000
* PS0244  DC 25/02/98 LONG RQC SUPPORT                         *        00302000
* BS2389  DC 02/06/99 CORRECT RETURN CODES                     *        00303000
* PS0506  SK 14/06/02 INCREASE REQUEST CHAIN TO SIZE=99999     *        00303100
* IS0121  MC 02/10/03 DECREASE REQUEST CHAIN TO SIZE=20000     *        00303200
*              TO AVOID MEMORY PROBLEMS SINCE RQC WAS ENLARGED)*        00303300
*--------V.3.2.01 SP1 -----------------------------------------*        00303400
* BS2699  EM 31/10/05 CLEARING RC DROPPED, AT ERRICHF LABEL    *        00303500
* WS2555  EM 25/12/05 NEW PARMS & OPCODE FOR RQC MANAGEMENT    *        00303600
*--------------------------------------------------------------*        00303700
*WS10013  AL 14/11/07 ADD DEBUG TO CTSAXMS CALL.               *        00303800
*SAS2IBMN NY 11/01/17 REMOVE ALL REFERENCE TO SSCT AND SSVT.   *        00303900
*IS10183  TS 09/05/21 DON'T PRINT PASSWORD                     *        00304000
*IS10188  NY 06/10/24 MOVE OUR MODULES ABOVE 16M LINE          *        00304100
****************************************************************        00304200
*IS10188          GBLC   &AMODUSE                                       00304300
*IS10188 &AMODUSE SETC   'CVT'                                          00304400
*                                                                       00304500
****************************************************************        00305000
*        PARAMETERS BLOCK                                      *        00306000
****************************************************************        00307000
*                                                                       00308000
PARM     DSECT                                                          00309000
PARMOP   DS    A                       OPCODE  (INIT/TERM)              00310000
PARMSSN  DS    A                       SUBSYS                           00320000
PARMJBN  DS    A                       XMM JOBNAME                      00330000
PARMDBG  DS    A                       DBG LEVEL                        00340000
PARMRC   DS    A                       RETURN CODE                      00350000
PARMRS   DS    A                       REASON CODE                      00360000
PARMRQC  DS    A                       RQC SIZE (I)              WS2555 00370000
PARMEVT  DS    A                       EVT TO BE RETURNED               00380000
PARMTIME DS    A                       MAX SECS TO WAIT FOR RQC         00390000
PARMMOD  DS    A                       MODIFY BUFFER                    00400000
PARMMODL DS    A                       MODIFY LENGTH                    00410000
         ORG   PARMEVT                                           WS2555 00420000
PARMRQCT DS    A                       FREE RQC TRESHOLD ALARM(I)WS2555 00430000
PARMFRQC DS    A                       CURRENT FREE RQC (O)      WS2555 00431000
         ORG   ,                                                 WS2555 00432000
*                                                                       00433000
****************************************************************        00434000
****                                                        ****        00435000
****     MAIN ROUTINE                                       ****        00436000
****                                                        ****        00437000
****************************************************************        00438000
*                                                                       00439000
CTSAONI  CSECT                                                          00440000
CTSAONI  AMODE ANY                                                      00450000
*IS10188 CTSAONI  RMODE 24                                              00460000
CTSAONI  RMODE ANY                                             IS10188  00461000
         CTSEQUR                                                        00470000
*                                                                       00480000
****************************************************************        00490000
*        INITIALIZE                                            *        00500000
****************************************************************        00510000
*                                                                       00520000
         BEGIN *                                                        00530000
         CTSLEVEL CTSAONI                                               00540000
         LR    R11,R1                                                   00550000
         USING PARM,R11                                                 00560000
         L     R10,=A(CTSAONIV)                                         00570000
         USING CTSAONIV,R10                                             00580000
*                                                                       00590000
*IS10188 CTSAMOD 31,R=R2                                                00600000
*IS10188 ST    R2,AMODE                                                 00610000
         CTSAAMD 31,AMODSAV=AMODE                              IS10188  00611001
         ST    R11,PARMADDR                                             00620000
*                                                                       00630000
         XC    RC,RC                                                    00640000
         XC    REASON,REASON                                            00650000
         XC    RCREG,RCREG                                              00660000
*                                                                       00670000
         L     R15,PARMDBG             R15 -> DEBUG LEVEL (4 BYTES)     00680000
         XC    DBGLEVEL,DBGLEVEL       STORE DEBUG LEVEL                00690000
         ICM   R15,15,0(R15)           DEBUG LEVEL                      00700000
         BNP   NODEBUG                 SKIP DEBUG LVL IF MINUS          00710000
         STC   R15,DBGLEVEL            STORE DEBUG LEVEL (1 BYTE)       00720000
NODEBUG  DS    0H                                                       00730000
*                                                                       00740000
         L     R15,PARMSSN                                              00750000
         MVC   XMSSSNAM,0(R15)                                          00760000
*                                                                       00770000
         L     R15,PARMJBN                                              00780000
         MVC   XMSJBN,0(R15)                                            00790000
*                                                                       00800000
         L     R15,PARMRQC             -> RQC ENTRIES #          WS2555 00810000
         MVC   RQCCHN#,0(R15)          KEEP RQC# TO BE ALLOCATED WS2555 00820000
*                                                                       00830000
****************************************************************        00840000
*        BRANCH ACCORDING TO OPCODE                            *        00850000
****************************************************************        00860000
*                                                                       00870000
         L     R15,PARMOP                                               00880000
         CLC   =CL8'INIT',0(R15)                                        00890000
         BE    OPISINIT                                                 00900000
         CLC   =CL8'GETRQC',0(R15)                                      00910000
         BE    OPISGETR                                                 00920000
         CLC   =CL8'TSTRQC',0(R15)     TEST RQC STATUS REQUEST?  WS2555 00930000
         BE    OPISTSTR                YES, HANDLE IT            WS2555 00940000
         CLC   =CL8'TERM',0(R15)                                        00950000
         BE    OPISTERM                                                 00960000
         CLC   =CL8'SNAP',0(R15)                                        00970000
         BE    OPISSNAP                                                 00980000
*                                                                       00990000
****************************************************************        01000000
*        ERROR CODES                                           *        01010000
****************************************************************        01020000
*                                                                       01030000
*                                                                       01040000
*        INVALID OPCODE ERROR                                           01050000
*                                                                       01060000
         MVC   RCREG,=F'20'                                             01070000
         B     EXIT                                                     01080000
*                                                                       01090000
*        NOT INITIALIZED ERROR                                          01100000
*                                                                       01110000
ERRNINIT DS    0H                                                       01120000
         MVC   RCREG,=F'24'                                             01130000
         B     EXIT                                                     01140000
*                                                                       01150000
*        ALREADY INITIALIZED ERROR                                      01160000
*                                                                       01170000
ERRAINIT DS    0H                                                       01180000
         MVC   RCREG,=F'28'                                             01190000
         B     EXIT                                                     01200000
*                                                                       01210000
****************************************************************        01220000
*        CALL HANDLING ROUTINE ACCORDING TO OPCODE             *        01230000
****************************************************************        01240000
*                                                                       01250000
OPISINIT DS    0H                                                       01260000
         OC    FLAGINIT,FLAGINIT                                        01270000
         BNZ   ERRAINIT                                                 01280000
         CTSCALL INITIAL,LINK=INT                                       01290000
         B     EXIT                                                     01300000
OPISGETR DS    0H                                                       01310000
         OC    FLAGINIT,FLAGINIT                                        01320000
         BZ    ERRNINIT                                                 01330000
         CTSCALL GETRQC,LINK=INT                                        01340000
         B     EXIT                                                     01350000
OPISTSTR DS    0H                                                       01360000
         OC    FLAGINIT,FLAGINIT                                        01370000
         BZ    ERRNINIT                                                 01371000
         CTSCALL TSTRQC,LINK=INT                                        01371100
         B     EXIT                                                     01371200
OPISTERM DS    0H                                                       01371300
         OC    FLAGINIT,FLAGINIT                                        01371400
         BZ    ERRNINIT                                                 01371500
         CTSCALL TERMIN,LINK=INT                                        01371600
         B     EXIT                                                     01371700
OPISSNAP DS    0H                                                       01371800
         OC    FLAGINIT,FLAGINIT                                        01371900
         BZ    ERRNINIT                                                 01372000
         CTSCALL SNAP,(SNAPID),LINK=INT                                 01373000
         L     R1,SNAPID                                                01374000
         LA    R1,1(R1)                                                 01375000
         ST    R1,SNAPID                                                01376000
         B     EXIT                                                     01377000
*                                                                       01378000
****************************************************************        01379000
*        SET RETURN CODE AND EXIT                              *        01380000
****************************************************************        01390000
*                                                                       01400000
EXIT     DS    0H                                                       01410000
         L     R15,RCREG                                                01420000
         L     R1,PARMRC                                                01430000
         MVC   0(4,R1),RC                                               01440000
         L     R1,PARMRS                                                01450000
         MVC   0(4,R1),REASON                                           01460000
*                                                                       01470000
*IS10188 L     R2,AMODE                                                 01480000
*IS10188 CTSAMOD RESTORE,R=R2                                           01490000
         CTSAAMD RESTORE,AMODSAV=AMODE                         IS10188  01491000
*                                                                       01500000
         L     R15,RCREG                                                01510000
         BRTRN (15)                                                     01520000
         LTORG ,                                                        01530000
         DROP  ,                                                        01540000
*                                                                       01550000
****************************************************************        01560000
****                                                        ****        01570000
****     'INIT' CALL                                        ****        01580000
****                                                        ****        01590000
****************************************************************        01600000
*                                                                       01610000
INITIAL  DS    0F                                                       01620000
         BEGIN                                                          01630000
         L     R10,=A(CTSAONIV)                                         01640000
         USING CTSAONIV,R10                                             01650000
         L     R11,PARMADDR                                             01660000
         USING PARM,R11                                                 01670000
*                                                                       01680000
*        CHECK IF MONITOR IS APF-AUTHORIZED                             01690000
*                                                                       01700000
         TESTAUTH FCTN=1               APF AUTHORIZED ?                 01710000
         LTR   R15,R15                 CHECK IT OUT                     01720000
         BNZ   ERRAUTH                 NOT - GO ISSUE ERROR MESSAGE     01730000
*                                                                       01740000
*        GET STC NAME                                                   01750000
*                                                                       01760000
         EXTRACT ADDRTIOT,FIELDS=TIOT  GET THE TIOT ADDRESS             01770000
         L     R15,ADDRTIOT                                             01780000
         MVC   PROCNAME,0(R15)         MOVE THE NAME OF OUR TASK        01790000
*                                                                       01800000
*        FIND SMFID FOR THIS CPU                                        01810000
*                                                                       01820000
         L     R1,CVTPTR               POINT TO CVT                     01830000
         L     R1,CVTSMCA-CVT(R1)      POINT TO SMCA                    01840000
         USING SMCABASE,R1                                              01850000
         MVC   SMFID,SMCASID           GET SMFID                        01860000
         DROP  R1                                                       01870000
*                                                                       01880000
****************************************************************        01890000
*        CREATE CTS PARAMETERS BUFFER AREA                              01900000
****************************************************************        01910000
*                                                                       01920000
         OC    CCTADDR,CCTADDR         SAVE ADDRESS OF AREA             01930000
         BNZ   SKIPCCT                                                  01940000
*                                                                       01950000
*        GET AREA FOR CTSCCT (BELOW)                                    01960000
*                                                                       01970000
         LA    R7,CCTLEN              LEN OF CCT (INTERCPTOR TABLE)     01980000
         ST    R7,LENOFCCT                                              01990000
*IS10188 GETMAIN RC,LV=(R7)            GET STORAGE FOR CCT (BELOW)      02000000
         GETMAIN RC,LV=(R7),LOC=RES    GET STORAGE FOR CCT     IS10188  02001000
         LTR   R15,R15                 ..NO STORAGE, EXIT               02010000
         BNZ   ERRSTOR                                                  02020000
         ST    R1,CCTADDR              SAVE ADDRESS OF AREA             02030000
         LR    R12,R1                  POINT TO GETMAINED STORAGE       02040000
         USING CCT,R12                 ESTABLISH CCT ADDRESSABILITY     02050000
*                                                                       02060000
*        CLEAR THE AREA                                                 02070000
*                                                                       02080000
         LR    R0,R1                   CLEAR THE AREA                   02090000
         LR    R1,R7                   SET LENGTH                       02100000
         XR    R15,R15                 PADD WITH X'00'                  02110000
         MVCL  R0,R14                  CLEAR                            02120000
*                                                                       02130000
*        CREATE CCT                                                     02140000
*                                                                       02150000
         MVC   CCTCCT,=CL4'CCT'                                         02160000
         MVC   CCTECBNT,=A(ECB4NOT)                                     02170000
SKIPCCT  DS    0H                                                       02180000
*                                                                       02190000
****************************************************************        02200000
*        AQUIRE REQUEST CHAINS                                          02210000
****************************************************************        02220000
*                                                                       02230000
*        AQUIRE  FREE CHAIN                                             02240000
*                                                                       02250000
         MVI   CHAINID#,RQHID0                                          02260000
         MVI   CHAINTYP,RQHFIFO                                         02270000
         CTSCALL CTSAREQ,(RINIT,CCTRQFRE,RQCCHN#,ZERO,REQWORK,         X02280000
               CHAINID#,CHAINTYP),RAREA=CALLPARM                        02290000
         CTSADBG LEVEL=(DBGLEVEL,1),                                   X02300000
               'INIT CTSAREQ FREE CHAIN RC = #',(?R15)                  02310000
         LTR   R15,R15                                                  02320000
         BNZ   ERRICHF                                                  02330000
*                                                                       02340000
*        AQUIRE NOTIFY CHAIN                                            02350000
*                                                                       02360000
         MVI   CHAINID#,RQHIDN                                          02370000
         MVI   CHAINTYP,RQHFIFO                                         02380000
         CTSCALL CTSAREQ,(RINIT,CCTRQNOT,ZERO,ZERO,REQWORK,            X02390000
               CHAINID#,CHAINTYP),RAREA=CALLPARM                        02400000
         CTSADBG LEVEL=(DBGLEVEL,1),                                   X02410000
               'INIT CTSAREQ NOTIFY CHAIN RC = #',(?R15)                02420000
         LTR   R15,R15                                                  02430000
         BNZ   ERRICHN                                                  02440000
*                                                                       02450000
****************************************************************        02460000
*        ENABLE PROGRAM TO RECEIVE MODIFY/STOP VIA CONSOLE              02470000
****************************************************************        02480000
*                                                                       02490000
         EXTRACT COMMFLD,FIELDS=COMM   GET ECB FOR MODIFY/STOP          02500000
         L     R1,COMMFLD                                               02510000
         LA    R3,4(,R1)                                                02520000
         ICM   R2,B'1111',0(R3)                                         02530000
         BZ    NOSTART                                                  02540000
         QEDIT ORIGIN=(R3),BLOCK=(R2)  FREE CIB                         02550000
NOSTART  DS    0H                                                       02560000
         QEDIT ORIGIN=(R3),CIBCTR=10   ALLOW 10 CIB BLOCKS              02570000
*                                                                       02580000
         L     R1,COMMFLD              GET POINTER TO COMMAND ECB       02590000
         L     R1,0(,R1)               POINT TO COMMAND ECB             02600000
         LA    R1,0(,R1)               POINT TO COMMAND ECB             02610000
         ST    R1,ADDRECBM                                              02620000
*                                                                       02630000
****************************************************************        02640000
*        INITIALIZE THE CROSS MEMORY ENVIRONMENT                        02650000
****************************************************************        02660000
*                                                                       02670000
*        MAKE OURSELVES NONSWAPPABLE                                    02680000
*                                                                       02690000
         MODESET MODE=SUP,KEY=ZERO                                      02700000
         XC    ECB,ECB                                                  02710000
         LA    R1,ECB                  ON ECB                           02720000
         SYSEVENT TRANSWAP             MAKE US NON=SWAPABLE             02730000
         CLM   R1,1,=X'04'             ALREADY NON-SWAPPABLE ?          02740000
         BE    NOWAIT                  YES - DONT WAIT                  02750000
         WAIT  ECB=ECB                  WAIT FOR SWAP OUT               02760000
NOWAIT   DS    0H                                                       02770000
         MODESET MODE=PROB,KEY=NZERO                                    02780000
*                                                                       02790000
*        CALL CROSS MEMORY INITIALIZATION ROUTINE                       02800000
*                                                                       02810000
         MVC   XMSFUNC,=CL8'INIT'                                       02820000
         CALL  CTSAXMS,(XMSFUNC,XMSSSNAM,XMSDYNM,XMSSTEP,              X02830000
               CCTADDR,XMSRC,XMSJBN,DBGLEVEL)                   WS10013 02840000
*WS10013       CCTADDR,XMSRC,XMSJBN)                                    02841000
         CTSADBG LEVEL=(DBGLEVEL,1),                                   X02850000
               'INIT XMS RC = #',(?R15)                                 02860000
         LTR   R15,R15                                                  02870000
         BNZ   ERRXMS                                                   02880000
         MVC   FLAGINIT,=F'1'                                           02890000
         B     EXITINIT                                                 02900000
*                                                                       02910000
*        INIT ERRORS                                                    02920000
*                                                                       02930000
ERRLOAD  DS    0H                                                       02940000
         MVC   RCREG,=F'4'                                              02950000
         MVC   RC,=F'4'                                                 02960000
         XC    REASON,REASON                                            02970000
         B     EXITINIT                                                 02980000
ERRSTOR  DS    0H                                                       02990000
         MVC   RCREG,=F'4'                                              03000000
         MVC   RC,=F'8'                                                 03010000
         XC    REASON,REASON                                            03020000
         B     EXITINIT                                                 03030000
ERRICHF  DS    0H                                                       03040000
         MVC   RCREG,=F'8'                                              03050000
         MVC   RC,=F'4'                                                 03060000
         ST    R15,REASON                                               03070000
*                                                                       03080000
* BS2699 XC    REASON,REASON           KEEP RC FOR CALLER               03090000
         B     EXITINIT                                                 03100000
ERRICHN  DS    0H                                                       03110000
         MVC   RCREG,=F'8'                                              03120000
         MVC   RC,=F'8'                                                 03130000
         ST    R15,REASON                                               03140000
         B     EXITINIT                                                 03150000
ERRXMS   DS    0H                                                       03160000
         MVC   RC,XMSRC                                                 03170000
         MVC   RCREG,=F'12'                                             03180000
         B     EXITINIT                                                 03190000
ERRAUTH  DS    0H                                                       03200000
         MVC   RCREG,=F'16'                                             03210000
         B     EXITINIT                                                 03220000
*                                                                       03230000
*        EXIT INIT                                                      03240000
*                                                                       03250000
EXITINIT DS    0H                                                       03260000
         L     R15,RCREG                                                03270000
         BRTRN (15)                                                     03280000
         LTORG ,                                                        03290000
         DROP  ,                                                        03300000
*                                                                       03310000
****************************************************************        03320000
****                                                        ****        03330000
****     'TERM' CALL                                        ****        03340000
****                                                        ****        03350000
****************************************************************        03360000
*                                                                       03370000
*                                                                       03380000
*        INITIALIZE                                                     03390000
*                                                                       03400000
TERMIN   DS    0F                                                       03410000
         BEGIN                                                          03420000
         L     R10,=A(CTSAONIV)                                         03430000
         USING CTSAONIV,R10                                             03440000
         L     R11,PARMADDR                                             03450000
         USING PARM,R11                                                 03460000
         L     R12,CCTADDR                                              03470000
         USING CCT,R12                                                  03480000
*                                                                       03490000
*        CALL TERMINATION ROUTINE                                       03500000
*                                                                       03510000
         MVC   XMSFUNC,=CL8'TERM'                                       03520000
         CALL  CTSAXMS,(XMSFUNC,XMSSSNAM,XMSDYNM,XMSSTEP,              X03530000
               CCTADDR,XMSRC,XMSJBN,DBGLEVEL)                   WS10013 03540000
*WS10013       CCTADDR,XMSRC,XMSJBN)                                    03541000
         CTSADBG LEVEL=(DBGLEVEL,1),                                   X03550000
               'TERM XMS RC = #',(?R15)                                 03560000
         LTR   R15,R15                                                  03570000
         BNZ   ERRXMST                                                  03580000
*                                                                       03590000
*        FREE REQUEST CHAINS                                            03600000
*                                                                       03610000
         CTSCALL CTSAREQ,(REND,CCTRQNOT,ZERO,ZERO,REQWORK),            X03620000
               RAREA=CALLPARM                                           03630000
         CTSADBG LEVEL=(DBGLEVEL,1),                                   X03640000
               'END CTSAREQ NOTIFY CHAIN RC = #',(?R15)                 03650000
         LTR   R15,R15                                                  03660000
         BNZ   ERRTCHN                                                  03670000
         CTSCALL CTSAREQ,(REND,CCTRQFRE,RQCCHN#,ZERO,REQWORK),         X03680000
               RAREA=CALLPARM                                           03690000
         CTSADBG LEVEL=(DBGLEVEL,1),                                   X03700000
               'END CTSAREQ FREE CHAIN RC = #',(?R15)                   03710000
         LTR   R15,R15                                                  03720000
         BNZ   ERRTCHF                                                  03730000
*                                                                       03740000
*        FREE AREA OF CCT                                               03750000
*                                                                       03760000
         L     R7,LENOFCCT                                              03770000
         L     R6,CCTADDR                                               03780000
         FREEMAIN RU,LV=(R7),A=(R6)     FREE STORAGE OF CCT             03790000
         XC    CCTADDR,CCTADDR                                          03800000
         XC    LENOFCCT,LENOFCCT                                        03810000
         XC    FLAGINIT,FLAGINIT                                        03820000
         B     EXITTERM                                                 03830000
ERRXMST  DS    0H                                                       03840000
         MVC   RC,XMSRC                                                 03850000
         MVC   RCREG,=F'12'                                             03860000
         B     EXITTERM                                                 03870000
ERRTCHF  DS    0H                                                       03880000
         MVC   RCREG,=F'8'                                              03890000
         MVC   RC,=F'4'                                                 03900000
         ST    R15,REASON                                               03910000
         B     EXITTERM                                                 03920000
ERRTCHN  DS    0H                                                       03930000
         MVC   RCREG,=F'8'                                              03940000
         MVC   RC,=F'8'                                                 03950000
         ST    R15,REASON                                               03960000
         B     EXITTERM                                                 03970000
*                                                                       03980000
*        FINISH                                                         03990000
*                                                                       04000000
EXITTERM DS    0H                                                       04010000
         L     R15,RCREG                                                04020000
         BRTRN (15)                                                     04030000
         LTORG ,                                                        04040000
         DROP  ,                                                        04050000
*                                                                       04060000
****************************************************************        04070000
****                                                        ****        04080000
****     'GETRQC' CALL                                      ****        04090000
****                                                        ****        04100000
****************************************************************        04110000
*                                                                       04120000
*                                                                       04130000
*        INITIALIZE                                                     04140000
*                                                                       04150000
GETRQC   DS    0F                                                       04160000
         BEGIN                                                          04170000
         L     R10,=A(CTSAONIV)                                         04180000
         USING CTSAONIV,R10                                             04190000
         L     R11,PARMADDR                                             04200000
         USING PARM,R11                                                 04210000
         L     R12,CCTADDR                                              04220000
         USING CCT,R12                                                  04230000
*                                                                       04240000
****************************************************************        04250000
*        GET ELEMENT FROM NOTIFY CHAIN                                  04260000
****************************************************************        04270000
*                                                                       04280000
         XC    ECB4NOT,ECB4NOT         CLEAR ECB NOW, NOT TO MISS       04290000
*                                      A POST DURING GET OPERATION      04300000
         XC    REQADDR,REQADDR                                          04310000
         MVC   REQFUNC,=A(RQCGET)                                       04320000
*                                                                       04330000
         CTSCALL CTSAREQ,(REQFUNC,CCTRQNOT,REQADDR),RAREA=CALLPARM      04340000
         CTSADBG LEVEL=(DBGLEVEL,1),                                   X04350000
               'GET RQC AT ~ FROM NOTIFY CHAIN RC = #',(REQADDR,?R15)   04360000
         LTR   R15,R15                                                  04370000
         BZ    COPYREQ                                                  04380000
         CH    R15,=H'4'                                                04390000
*BS2389  BNE   ERRRETRY                                                 04400000
         BNE   ERRGETR                                           BS2389 04410000
*                                                                       04420000
****************************************************************        04430000
*        CHECK IF MODIFY COMMAND WAS ISSUE (BEFORE WAITING)             04440000
****************************************************************        04450000
*                                                                       04460000
         L     R2,0(,R1)               POINT TO ECB                     04470000
         TM    0(R2),X'40'             COMMAND ECB WAS POSTED ?         04480000
         BO    MODIFY                  YES, HANDLE IT                   04490000
*                                                                       04500000
****************************************************************        04510000
*        WAIT FOR A NEW ELEMENT, TIMER OR MODIFY COMMAND                04520000
****************************************************************        04530000
*                                                                       04540000
*                                                                       04550000
*        TRIGER TIMER FOR                                               04560000
*                                                                       04570000
         L     R2,PARMTIME                                              04580000
         L     R2,0(R2)                                                 04590000
         LTR   R2,R2                                                    04600000
         BNP   SKIPWAIT                                                 04610000
         CTSADBG LEVEL=(DBGLEVEL,1),                                   X04620000
               'MAX RQC WAIT IS # SECS',(?R2)                           04630000
         MH    R2,=H'100'                                               04640000
         ST    R2,TIMERLN                                               04650000
         STIMER REAL,TIMERXIT,BINTVL=TIMERLN                            04660000
*                                                                       04670000
*        WAIT FOR TIMER/POST                                            04680000
*                                                                       04690000
         XC    ECB4TIM,ECB4TIM                                          04700000
         WAIT  1,ECBLIST=WAITLIST                                       04710000
*                                                                       04720000
*        CANCEL TIMER EXIT                                              04730000
*                                                                       04740000
         TTIMER CANCEL,TU                                               04750000
SKIPWAIT DS    0H                                                       04760000
*                                                                       04770000
****************************************************************        04780000
*        CHECK INVOCATION REASON                                        04790000
****************************************************************        04800000
*                                                                       04810000
         L     R1,COMMFLD              POINT TO POINTER TO ECB          04820000
         L     R2,0(,R1)               POINT TO ECB                     04830000
         CTSADBG LEVEL=(DBGLEVEL,1),                                   X04840000
               'INVOKED FROM WAIT. TIME ECB=~,RQC ECB=~ MODIFY ECB=~', X04850000
               (ECB4TIM,ECB4NOT,0(R2))                                  04860000
         TM    ECB4TIM,X'40'                                            04870000
         BO    SKIPTCAN                                                 04880000
SKIPTCAN DS    0H                                                       04890000
*                                                                       04900000
****************************************************************        04910000
*        IF INVOKED BY STOP/MODIFY COMMAND , SET RC AND EXIT            04920000
****************************************************************        04930000
*                                                                       04940000
         L     R1,COMMFLD              POINT TO POINTER TO ECB          04950000
         L     R2,0(,R1)               POINT TO ECB                     04960000
         TM    0(R2),X'40'             COMMAND ECB WAS POSTED ?         04970000
         BZ    SKIPMOD                 IF NOT - SKIP                    04980000
MODIFY   DS    0H                                                       04990000
         LA    R2,4(,R1)               POINT TO POINTER TO CIB          05000000
         L     R3,0(,R2)               POINT TO CIB                     05010000
         CLI   4(R3),X'40'             STOP COMMAND ISSUED ?            05020000
         BNE   CHKMODFY                NO, MUST BE MODIFY               05030000
         L     R1,PARMMOD              R1 -> MODIFY BUFFER              05040000
         MVC   0(4,R1),=C'STOP'        COPY STOP CONSTANT               05050000
         L     R1,PARMMODL             R1 -> MODIFY LEN BUFFER          05060000
         MVC   0(4,R1),=F'4'           COPY THE STOP CONSTANT LEN       05070000
         B     FINMODFY                                                 05080000
*                                                                       05090000
*        MODIFY WAS ISSUED                                              05100000
*                                                                       05110000
CHKMODFY DS   0H                                                        05120000
         LH   R15,14(R3)               LOAD LENGTH OF DATA              05130000
         CH   R15,=H'80'               LEN > 80 ?                       05140000
         BNH  CPYMODFY                 NO, USE REAL LEN                 05150000
         LA   R15,80                   YES, USE 80 AS LEN               05160000
CPYMODFY DS   0H                                                        05170000
         L    R1,PARMMODL              R1 -> MODIFY LEN BUFFER          05180000
         ST   R15,0(R1)                SET LEN                          05190000
         L    R1,PARMMOD               R1 -> MODIFY BUFFER              05200000
         BCTR R15,0                    ADJUST LEN FOR EXECUTE           05210000
         MVC  0(*-*,R1),16(R3)         MOVE THE MODIFY DATA             05220000
         EX   R15,*-6                                                   05230000
         TR   0(*-*,R1),LWR2UPR        TRANSLATE LOWER CASE TO UPPER    05240000
         EX   R15,*-6                                                   05250000
*                                                                       05260000
*        FREE CIB AND SET RC                                            05270000
*                                                                       05280000
FINMODFY DS   0H                                                        05290000
         QEDIT ORIGIN=(R2),BLOCK=(R3)  FREE THE CIB                     05300000
         B     ERRMODFY                RETURN APPROPRIATE RC            05310000
*                                                                       05320000
SKIPMOD  DS    0H                                                       05330000
*                                                                       05340000
****************************************************************        05350000
*        IF INVOKED BY TIMER , SET RC AND EXIT                          05360000
****************************************************************        05370000
*                                                                       05380000
         TM    ECB4NOT,X'40'                                            05390000
         BZ    ERRTIME                                                  05400000
*                                                                       05410000
****************************************************************        05420000
*        RETRY TO -GET ELEMENT FROM NOTIFY CHAIN                        05430000
****************************************************************        05440000
*                                                                       05450000
*        TRY TO GET ELELMT FROM NOTIFY CHAIN                            05460000
*                                                                       05470000
         MVC   REQFUNC,=A(RQCGET)                                       05480000
         CTSCALL CTSAREQ,(REQFUNC,CCTRQNOT,REQADDR),RAREA=CALLPARM      05490000
         CTSADBG LEVEL=(DBGLEVEL,1),                                   X05500000
               'RETRY TO GET RQC AT ~ FROM NOTIFY CHAIN RC = #',       X05510000
               (REQADDR,?R15)                                           05520000
         LTR   R15,R15                                                  05530000
         BZ    RETRYOK                             OK - KEEP ON  BS2389 05540000
         CH    R15,=H'4'                           NO RQC        BS2389 05550000
         BNZ   ERRRETRY                                                 05560000
*                                                                BS2389 05570000
*        WE CAN GET RC=4 EVEN IF THE CHAIN IS NOT EMPTY          BS2389 05580000
*        JUST BECAUSE A CHANING OPERATION IS PERFORMED           BS2389 05590000
*        (CTSAREQ). THEREFORE, IN SUCH A CASE WE IGNORE THE      BS2389 05600000
*        ERROR RETURN TO THE CALLER TO RETRY LATER               BS2389 05610000
*                                                  DORON         BS2389 05620000
*                                                                BS2389 05630000
         B     ERRTIME                             IGNORE THIS   BS2389 05640000
RETRYOK  DS    0H                                  WE R OK       BS2389 05650000
*                                                                       05660000
****************************************************************        05670000
*        COPY EVT TO CALLER                                             05680000
****************************************************************        05690000
*                                                                       05700000
COPYREQ  DS    0H                                                       05710000
*PS0244  L     R1,REQADDR                                               05720000
*PS0244  L     R2,PARMEVT                                               05730000
*PS0244  CTSADBG LEVEL=(DBGLEVEL,1),                                   X05740000
               'COPING REQUEST TO ~',(?R2)                              05750000
*PS0244  MVC   0(EVTLEN,R2),RQCEVT-RQCSTART(R1)                         05760000
         L     R0,PARMEVT              R0 -> TARGET AREA        PS0244  05770000
         L     R14,REQADDR             R14 -> RQC               PS0244  05780000
         LA    R14,RQCEVT-RQCSTART(R14) R14 -> SOURCE AREA      PS0244  05790000
         LA    R1,EVTLEN               R1 =  TARGET LENGTH      PS0244  05800000
         LR    R15,R1                  R15 = SOURCE LENGTH      PS0244  05810000
         MVCL  R0,R14                  COPY !                   PS0244  05820000
         L     R2,PARMEVT              FOR DEBUG PRINT          PS0244  05830000
*IS10183 CTSADBG LEVEL=(DBGLEVEL,1),                                   X05840000
               'EVT=_',(0(R2),42)                                       05850000
*                                                                       05860000
****************************************************************        05870000
*        PUT ELEMENT BACK TO FREE CHAIN                                 05880000
****************************************************************        05890000
*                                                                       05900000
         MVC   REQFUNC,=A(RQCPUT)                                       05910000
         CTSCALL CTSAREQ,(REQFUNC,CCTRQFRE,REQADDR),RAREA=CALLPARM      05920000
         CTSADBG LEVEL=(DBGLEVEL,1),                                   X05930000
               'PUT RQC AT ~ TO FREE CHAIN RC = #',(REQADDR,?R15)       05940000
         LTR   R15,R15                                                  05950000
         BNZ   ERRPUTR                                                  05960000
         B     EXITGETR                                                 05970000
*                                                                       05980000
*        TIMER EXPIRED WITH NO ACTION                                   05990000
*                                                                       06000000
ERRTIME  DS    0H                                                       06010000
         MVC   RCREG,=F'4'                                              06020000
         B     EXITGETR                                                 06030000
*                                                                       06040000
*        MODIFY/STOP COMMAND                                            06050000
*                                                                       06060000
ERRMODFY DS    0H                                                       06070000
         MVC   RCREG,=F'8'                                              06080000
         B     EXITGETR                                                 06090000
*                                                                       06100000
*        CHAINING ERRORS                                                06110000
*                                                                       06120000
ERRGETR  DS    0H                                                       06130000
         MVC   RCREG,=F'12'                                             06140000
         ST    R15,RC                                                   06150000
         B     EXITGETR                                                 06160000
*                                                                       06170000
ERRPUTR  DS    0H                                                       06180000
         MVC   RCREG,=F'16'                                             06190000
         ST    R15,RC                                                   06200000
         B     EXITGETR                                                 06210000
*                                                                       06220000
*        RETRY ERROR                                                    06230000
*                                                                       06240000
ERRRETRY DS    0H                                                       06250000
         MVC   RCREG,=F'20'                                             06260000
         ST    R15,RC                                                   06270000
         B     EXITGETR                                                 06280000
*                                                                       06290000
****************************************************************        06300000
*        FINISH                                                         06310000
****************************************************************        06320000
*                                                                       06330000
EXITGETR DS    0H                                                       06340000
         L     R15,RCREG                                                06350000
         BRTRN (15)                                                     06360000
*                                                                       06370000
****************************************************************        06380000
*        TIMER EXIT - POST THE WAIT TIME ECB                            06390000
****************************************************************        06400000
*                                                                       06410000
TIMERXIT DS    0F                                                       06420000
         BEGIN                                                          06430000
         L     R10,=A(CTSAONIV)                                         06440000
         USING CTSAONIV,R10                                             06450000
         POST  ECB4TIM                                                  06460000
         BRTRN 0                                                        06470000
         LTORG ,                                                        06480000
         DROP  ,                                                        06490000
*                                                                       06500000
****************************************************************        06510000
****            WS2555 - PART 1 START                       ****        06520000
*                                                           ****        06530000
* PARMRQC NEW PARM IS ADDED TO DETEMINE EVENTS NUMBER (RQC#)   *        06540000
*   RESIDING IN MEMORY INSTEAD OF HARDCODED NUMBER OF 20,000.  *        06550000
* PARMRQCT NEW PARM IS ADDED TO DETERMINE THE THRESHOLD NUMBER *        06560000
*   IN FREE RQC NOTIFY CHAIN, WHICH BELOW THIS NUMBER A WARNING*        06570000
*   MESSAGE IS SENT.(CTS4509W).                                *        06580000
* PARMFRQC NEW PARM IS ADDED TO RETURN THE CURRENT FREE        *        06590000
*   ELEMENTS NUMBER IN FREE CHAIN.                             *        06600000
* 'TSTRQC' NEW OPCODE IS ADDED TO TEST WHETHER MODIFY/STOP CMD *        06610000
*   OCCURED AND TO EXAMINE THE SIZE OF FREE MEMORY CHAIN.      *        06620000
****************************************************************        06630000
****************************************************************        06631000
****               TSTRQC SUBROUTINE                        ****        06632000
****               *****************                        ****        06633000
****  IF MODIFY/STOP COMMAND WAS ISSUED, THEN HANDLE IT.    ****        06634000
****    IF NO, COMPARE CURRENT FREE RQC CHAIN STATUS TO     ****        06634100
****    THRESHOLD AND RETRUN RC=4 IF IT'S BELOW THE         ****        06634200
****    THRESHOLD.                                          ****        06634300
****************************************************************        06634400
TSTRQC   DS    0F                                                       06634500
         BEGIN                                                          06634600
         L     R10,=A(CTSAONIV)                                         06634700
         USING CTSAONIV,R10                                             06634800
         L     R11,PARMADDR                                             06634900
         USING PARM,R11                                                 06635000
         L     R1,COMMFLD             POINT TO POINTER TO ECB           06636000
         L     R2,0(R1)               POINT TO ECB                      06636100
         TM    0(R2),X'40'            COMMAND ECB WAS POSTED ?          06636200
         BZ    GOTSTRQC               IF NOT - SKIP                     06636300
*    MODIFY / STOP ISSUED                                               06636400
         LA    R2,4(,R1)              POINT TO POINTER TO ECB           06636500
         L     R3,0(R2)               POINT TO CIB                      06636600
         CLI   4(R3),X'40'            STOP COMMAND ISSUED ?             06636700
         BNE   MODTSTR                NO, MUST BE MODIFY                06636800
*    STOP CMD WAS ISSUED, SIMULATE A MODIFY WITH STOP                   06636900
         L     R1,PARMMOD             R1 -> MODIFY BUFFER               06637000
         MVC   0(4,R1),=C'STOP'       COPY STOP CONSTANT                06637100
         L     R1,PARMMODL            R1 -> MODIFY LEN BUFFER           06637200
         MVC   0(4,R1),=F'4'          COPY THE STOP CONSTANT LEN        06637300
         B     FMODTST                                                  06637400
*                                                                       06637500
*        MODIFY WAS ISSUED                                              06637600
*                                                                       06637700
MODTSTR  DS   0H                                                        06637800
         LH   R15,14(R3)               LOAD LENGTH OF DATA              06637900
         CH   R15,=H'80'               LEN > 80 ?                       06638000
         BNH  CPYMODTS                 NO, USE REAL LEN                 06638100
         LA   R15,80                   YES, USE 80 AS LEN               06638200
CPYMODTS DS   0H                                                        06638300
         L    R1,PARMMODL              R1 -> MODIFY LEN BUFFER          06638400
         ST   R15,0(R1)                SET LEN                          06638500
         L    R1,PARMMOD               R1 -> MODIFY BUFFER              06638600
         BCTR R15,0                    ADJUST LEN FOR EXECUTE           06638700
         MVC  0(*-*,R1),16(R3)         MOVE THE MODIFY DATA             06638800
         EX   R15,*-6                                                   06638900
         TR   0(*-*,R1),LWR2UPR        TRANSLATE LOWER CASE TO UPPER    06639000
         EX   R15,*-6                                                   06639100
*                                                                       06639200
*        FREE CIB AND SET RC                                            06639300
*                                                                       06639400
FMODTST  DS    0H                                                       06639500
         QEDIT ORIGIN=(R2),BLOCK=(R3) FREE THE CIB                      06639600
         B     ERRMODR                RETURN APPROPRIATE RC             06639700
**********************************************************************  06639800
* TEST WHETHER RQC FREE CHAIN NUMBER (RQHCURR#) IS BELOW RQC NOTIFY     06639900
* THRESHOLD (PARMRQCT).                                                 06640000
* IF YES, THEN RCREG=4, IF NOT RCREG=0.                                 06640100
* CURRENT FREE RQC NUMBER ALWAYS SENT TO CALLER (BY PARMFRQC)           06640200
**********************************************************************  06640300
GOTSTRQC DS    0H                                                       06640400
         L     R12,CCTADDR       -> CCT                                 06640500
         USING CCT,R12           SET ADDRESSABILTY                      06640600
         L     R12,CCTRQFRE      -> FREE CHAIN RQC                      06640700
         USING RQHSTART,R12      SET ADDRESSABILTY                      06640800
         L     R1,PARMFRQC       -> CALLER'S PARM ADDRESS               06640900
         MVC   0(4,R1),RQHCURR#  KEEP CURRENT FREE RQC NUMBER           06641000
         L     R1,PARMRQCT       -> THRESHOLD IN FREE CHAIN             06641100
         L     R2,RQHCURR#       CURRENT FREE ELEMENTS                  06641200
         C     R2,0(,R1)         CURRENT FREE RQC BELOW TRESHOLD?       06641300
         BH    OKTSTRQC          NO, ABOVE THRESHOLD (RC=0)             06641400
         MVC   RCREG,=F'4'       YES,BELOW TRESHOLD (RC=4)              06641500
*                                  RQC FREE ANCHOR FULL                 06641600
         B     EXITTSTR                                                 06641700
OKTSTRQC DS    0H                                                       06641800
         MVC   RCREG,=F'0'       FREE RQC ABOVE TRESHOLD                06641900
*                                RQC FREE ANCHOR NOT FULL               06642000
         B     EXITTSTR                                                 06642100
*                                                                       06642200
*        MODIFY/STOP COMMAND                                            06642300
*                                                                       06642400
ERRMODR  DS    0H                                                       06642500
         MVC   RCREG,=F'8'                                              06642600
         B     EXITTSTR                                                 06642700
*                                                                       06642800
*        EXIT TSTRQC                                                    06642900
*                                                                       06643000
EXITTSTR DS    0H                                                       06643100
         L     R15,RCREG                                                06643200
         BRTRN (15)                                                     06643300
         LTORG ,                                                        06643400
         DROP  ,                                                        06643500
*                                                                       06643600
****************************************************************        06643700
****            WS2555 - PART 1 END                         ****        06643800
****************************************************************        06643900
*                                                                       06644000
*                                                                       06645000
****************************************************************        06646000
****                                                        ****        06647000
****     SUBROUTINE SNAP: SNAP THE MAIN CONTROL BLOCKS      ****        06648000
****                                                        ****        06649000
****************************************************************        06650000
*                                                                       06660000
*        INITIALIZE                                                     06670000
*                                                                       06680000
SNAP     DS    0F                                                       06690000
         BEGIN                                                          06700000
         L     R1,0(R1)                R1 -> SNAPID                     06710000
         L     R3,0(R1)                R3 = SNAPID                      06720000
*                                                                       06730000
         L     R10,=A(CTSAONI)                                          06740000
         USING CTSAONI,R10                                              06750000
*                                                                       06760000
****************************************************************        06770000
*        PARAMETERS BUFFER                                              06780000
****************************************************************        06790000
*                                                                       06800000
         L     R12,CCTADDR                                              06810000
         LTR   R12,R12                                                  06820000
         BZ    NOCCT                                                    06830000
         USING CCT,R12                                                  06840000
         CTSADBG RAREA=DBGAREA,TYPE=SNAP,                              X06850000
               ID=(R3),HDR=' ** CCT **',                               X06860000
               ADDR=(0(R12),CCTLEN(R12))                                06870000
NOCCT    DS    0H                                                       06880000
*                                                                       06890000
****************************************************************        06900000
*        REQUEST CHAINS ANCHORS                                         06910000
****************************************************************        06920000
*                                                                       06930000
         L     R2,CCTRQFRE                                              06940000
         LTR   R2,R2                                                    06950000
         BZ    NOFREE                                                   06960000
         CTSADBG TYPE=SNAP,ID=(R3),HDR=' ** RQC FREE ANCHOR **',       *06970000
               ADDR=(0(R2),RQHLEN-1(R2))                                06980000
NOFREE   DS    0H                                                       06990000
         L     R2,CCTRQNOT                                              07000000
         LTR   R2,R2                                                    07010000
         BZ    NONOT                                                    07020000
         CTSADBG TYPE=SNAP,ID=(R3),HDR=' ** RQC NOTIFY ANCHOR **',     *07030000
               ADDR=(0(R2),RQHLEN-1(R2))                                07040000
NONOT    DS    0H                                                       07050000
*                                                                       07060000
****************************************************************        07070000
*        RQC POOL                                                       07080000
****************************************************************        07090000
*                                                                       07100000
         L     R2,CCTRQFRE                                              07110000
         L     R8,RQCCHN#                                               07120000
         MH    R8,=Y(RQCLEN)                                            07130000
         LA    R8,12-1(R8)                                              07140000
         AR    R8,R2                                                    07150000
         CTSADBG RAREA=DBGAREA,TYPE=SNAP,                              X07160000
               ID=(R3),HDR=' ** ONI: CHAIN POOL **',                   X07170000
               ADDR=(0(R2),0(R8))                                       07180000
*                                                                       07190000
****************************************************************        07200000
*        FINISH                                                         07210000
****************************************************************        07220000
*                                                                       07230000
         BRTRN 0                                                        07240000
         LTORG ,                                                        07250000
         DROP  ,                                                        07260000
*                                                                       07270000
*********************************************************************** 07280000
*        COMMON WORKAREA                                                07290000
*********************************************************************** 07300000
*                                                                       07310000
CTSAONIV DS    0F                                                       07320000
ECB      DC    F'0'                                                     07330000
RC       DS    F                                                        07340000
REASON   DS    F                                                        07350000
RCREG    DS    F                                                        07360000
AMODE    DS    F                                                        07370000
CCTADDR  DC    A(0)                                                     07380000
LENOFCCT DC    F'0'                                                     07390000
FLAGINIT DC    F'0'                                                     07400000
PARMADDR DC    F'0'                                                     07410000
PROCNAME DC    CL8' '                                                   07420000
SMFID    DC    CL4' '                                                   07430000
CALLPARM CALL  ,(,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,),MF=L            07440000
ZERO     DC    F'0'                                                     07450000
*                                                                       07460000
DBGAREA  DS    CL256                                                    07470000
DBGLEVEL DC    XL1'0'                                                   07480000
SNAPID   DC    F'1'                                                     07490000
LWR2UPR  DC    256AL1(*-LWR2UPR)                                        07500000
         ORG   LWR2UPR                                                  07510000
         DC    64C' '                                                   07520000
         ORG   LWR2UPR+C'A'-X'40'                                       07530000
         DC    C'ABCDEFGHI'                                             07540000
         ORG   LWR2UPR+C'J'-X'40'                                       07550000
         DC    C'JKLMNOPQR'                                             07560000
         ORG   LWR2UPR+C'S'-X'40'                                       07570000
         DC    C'STUVWXYZ'                                              07580000
         ORG   ,                                                        07590000
*                                                                       07600000
*********************************************************************** 07610000
*        WAIT FOR TIMER/POST WAIT PARAMETERS                            07620000
*********************************************************************** 07630000
*                                                                       07640000
COMMFLD  DC    A(0)                                                     07650000
TIMERLN  DC    A(0)                                                     07660000
ECB4NOT  DC    A(0)                                                     07670000
ECB4TIM  DC    A(0)                                                     07680000
*                                                                       07690000
WAITLIST DS    0F                                                       07700000
ADDRECBM DC    A(0)                                                     07710000
ADDRECBN DC    A(ECB4NOT)                                               07720000
ADDRECBT DC    A(ECB4TIM+X'80000000')                                   07730000
*                                                                       07740000
*********************************************************************** 07750000
*        PARAMETERS FOR THE CTSAREQ CHAIN PACKAGE                       07760000
*********************************************************************** 07770000
*                                                                       07780000
RINIT    DC    A(RQCINIT)                                               07790000
REND     DC    A(RQCEND)                                                07800000
RGET     DC    A(RQCGET)                                                07810000
RPUT     DC    A(RQCPUT)                                                07820000
REQWORK  DS    18A                                                      07830000
*                                                                       07840000
CHAINID# DS    XL1                 ID FOR THE CHAIN                     07850000
CHAINTYP DS    XL1                 TYPE OF CHAIN                        07860000
*RQCCHN#  DC    F'5000'    PS0506                                       07870000
*RQCCHN#  DC    F'99999'    PS0506                                      07880000
RQCCHN#  DC    F'20000'    IS0121                                       07890000
RQCCHNLN DS    F                                                        07900000
RQCCHNAD DC    A(0)                                                     07910000
RQCCHAIN DC    A(0)                                                     07920000
*                                                                       07930000
*********************************************************************** 07940000
*        CROSS MEMORY ROUTINE PARAMETERS                                07950000
*********************************************************************** 07960000
*                                                                       07970000
XMSFUNC  DC    CL8' '                                                   07980000
XMSSSNAM DC    CL4' '                                                   07990000
XMSJBN   DC    CL8' '                                                   08000000
XMSDYNM  DC    CL1'Y'                                                   08010000
XMSSTEP  DC    F'0'                                                     08020000
XMSRC    DC    F'0'                                                     08030000
*                                                                       08040000
*********************************************************************** 08050000
*                                                                       08060000
*********************************************************************** 08070000
*                                                                       08080000
REQADDR  DC    A(0)                                                     08090000
REQFUNC  DC    A(0)                                                     08100000
*                                                                       08110000
ADDRTIOT DS    A                                                        08120000
PARMMADR DS    A                                                        08130000
PARMMLEN DS    A                                                        08140000
PARMDADR DS    A                                                        08150000
PARMDLEN DS    A                                                        08160000
PARMOADR DS    A                                                        08170000
PARMOLEN DS    A                                                        08180000
*                                                                       08190000
****************************************************************        08200000
*        IOA CONTROL BLOCKS                                    *        08210000
****************************************************************        08220000
*                                                                       08230000
RQH      DSECT                                                          08240000
         COPY  CTSARQH                                                  08250000
EVT      DSECT                                                          08260000
         COPY  CTSEVT                                                   08270000
RQC      DSECT                                                          08280000
         COPY  CTSRQC                                                   08290000
CCT      DSECT                                                          08300000
         COPY  CTSACCT                                                  08310000
*SAS2IBMN COPY  CTSSSVT                                                 08320000
*                                                                       08330000
****************************************************************        08340000
*        MVS CONTROL BLOCKS                                    *        08350000
****************************************************************        08360000
*                                                                       08370000
         PRINT  NOGEN                                                   08380000
*SAS2IBMN IHAPSA                                                        08390000
         IEESMCA                                                        08400000
*SAS2IBMN IHASDWA                                                       08410000
CVT      CVT   DSECT=YES,PREFIX=YES,LIST=YES                            08420000
TIOT     DSECT                                                          08430000
         IEFTIOT1                                                       08440000
*SAS2IBMN IEFJSCVT                                                      08450000
*SAS2IBMN IHAASCB ,                                                     08460000
*SAS2IBMN IHAASVT ,                                                     08470000
         END                                                            08480000

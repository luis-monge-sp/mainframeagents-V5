         TITLE 'LIST RESOURCE INFORMATION FROM RACF DATA BASE'          00010000
****************************************************************        00020000
****                                                        ****        00030000
****     CONTROL-SA  RELEASE 3.0.0                          ****        00040000
****                                                        ****        00050000
****     LICENCED MATERIAL - NEW DIMENSION SOFTWARE LTD.    ****        00060000
****                                                        ****        00070000
****************************************************************        00080000
*                                                                       00090000
****************************************************************        00100000
*                                                              *        00110000
* TITLE            : CTSFGRS                                   *        00120000
*                                                              *        00130000
* FILE NAME        : CTSFGRS                                   *        00140000
*                                                              *        00150000
* AUTHOR           : ALEXANDER SHVARTSMAN                      *        00160000
*                                                              *        00170000
* CREATION DATE    : 24/12/97                                  *        00180000
*                                                              *        00190000
* DESCRIPTION      : LIST RESOURCE INFO FROM RACF DATA BASE    *        00200000
*                                                              *        00210000
* ASSUMPTIONS AND                                              *        00220000
*   CONSIDERATIONS : CALLER MUST BE APF AUTHORIZED             *        00230000
*                                                              *        00240000
****************************************************************        00250000
****************************************************************        00260000
* MOD.ID   WHO      WHEN     DESCRIPTION                       *        00270000
* -------- -------- -------- --------------------------------- *        00280000
* BS2364   ALEX     24/09/98 STDATA:PRIVILEGED, TRACE, TRUSTED *        00290000
*                            RETURN YES/NO                     *        00291000
* PS0391   ALEXS    11/11/99 RACF 2.8 SUPPORT                  *        00292000
* PS0440   MC       19/11/00 UPDATE WARNING KEYWORD. X'01'='Y' *        00293000
* WS10031  AVNERL   31/01/12 SUPPORT LDAP RESOURCES            *        00293101
* BS10130  NURITY   11.01.24 SUPPORT DYNAMIC CDT.              *        00293201
* IS10188  AVNERL   06/10/24 MOVE OUR MODULES ABOVE 16M LINE   *        00293505
****************************************************************        00294000
*        PARAMETER LIST DSECT                                           00295000
****************************************************************        00296000
*                                                                       00297000
PARMLIST DSECT                                                          00298000
AOPTION  DS    A                       OPTION CODE ( LOCATE )           00299000
AENTYP   DS    A                       ENTRY TYPE = 'DATASET',          00300000
*                                      OR GENERAL RESOURCE CLASS        00310000
AENTRY   DS    A                       ENTRY NAME                       00320000
AFGEN    DS    A                       GENERIC FLAG                     00330000
AVOLUME  DS    A                       VOLUME                           00340000
AUNIT    DS    A                       UNIT                             00350000
AOUT     DS    A                       OUTPUT LINE                      00360000
ADEBUG   DS    A                       DEBUG LEVEL                      00370000
ARCFRET  DS    A                       RACF RETURN CODE                 00380000
AREASON  DS    A                       RACF REASON CODE                 00390000
ASEP     DS    A                       SEPARATOR                        00400000
*                                                                       00410000
****************************************************************        00420000
*        INITIALIZE                                                     00430000
****************************************************************        00440000
*                                                                       00450000
CTSFGRS  CSECT                                                          00460000
CTSFGRS  AMODE 31                                                       00470000
*IS10188 CTSFGRS  RMODE 24       (FOR CTSADBG)                          00480005
CTSFGRS  RMODE ANY                                              IS10188 00481006
*        PRINT NOGEN                                                    00490000
         BEGIN *,R12,R11                                                00500000
         CTSEQUR                                                        00510000
         CTSLEVEL                                                       00520000
         LR    R10,R1                                                   00530000
         USING PARMLIST,R10            ADDRESABILITY PARAMETERS         00540000
*                                                                       00550000
*        SET DEBUG LEVEL                                                00560000
*                                                                       00570000
         L     R2,ADEBUG               R2 -> DEBUG LEVEL (4 BYTES)      00580000
         XC    DEBUGL,DEBUGL           STORE DEBUG LEVEL                00590000
         XC    DEBUG,DEBUG             STORE DEBUG LEVEL                00600000
         ICM   R2,15,0(R2)             DEBUG LEVEL                      00610000
         BNP   NODEBUG                 SKIP DEBUG LVL IF MINUS          00620000
         STC   R2,DEBUGL               STORE DEBUG LEVEL (1 BYTE)       00630000
         ST    R2,DEBUG                STORE DEBUG LEVEL (1 BYTE)       00640000
NODEBUG  DS    0H                                                       00650000
         CTSADBG 'ENTERING',LEVEL=(DEBUGL,3,4,5,6,7),RAREA=SDDAREA      00660000
*                                                                       00670000
****************************************************************        00680000
*        PREPARE FOR EXTRACTOR CALL                                     00690000
****************************************************************        00700000
*                                                                       00710000
         L     R2,ASEP                 SEPARATOR                        00720000
         MVC   SEP(1),0(R2)            SAVE SEPARATOR                   00730000
         L     R2,AOUT                 EXTRACT AREA                     00740000
         ST    R2,AAREA                SAVE EXTRACT AREA ADDR           00750000
         NI    AAREA,X'7F'             CLEAR 0 - BYTE ( C-CONVENTIONS)  00760000
****************************************************************        00770000
*        ENTRY NAME HANDLING                                            00780000
****************************************************************        00790000
         MVI   ENTRY11,0               CLEAR LENGTH OF ENTRY FIELD      00800000
         L     R2,AENTRY                                                00810000
         MVC   ENTRY12(L'ENTRY12),0(R2)                                 00820000
         TR    ENTRY12(L'ENTRY12),TAB  CONVERT TO UPPERCASE             00830000
         LA    R1,ENTRY12+L'ENTRY12    MAX ENTRY NAME ADDR              00840000
         TRT   ENTRY12(L'ENTRY12),BLANKTAB                              00850000
         S     R1,=A(ENTRY12)                                           00860000
         LTR   R6,R1                   LENGTH = 0 ?                     00870000
         BNZ   LDSRLNZ                 NO,SKIP                          00880000
*-----------------------------------------------------------------      00890000
*        LENGTH=0 . VALID FOR 'NEXT' OPCODE                             00900000
*        IT MEANS SCAN DATABASE FROM THE BEGINING                       00910000
*-----------------------------------------------------------------      00920000
LDSRLZ   DS    0H                      LENGTH = 0                       00930000
         LA    R6,1                    LENGTH = 1                       00940000
         MVI   ENTRY11,1               INITIAL LENGTH = 1               00950000
         XC    ENTRY12,ENTRY12         CLEAR ENTRY NAME                 00960000
         B     LDSGCLS                                                  00970000
LDSRLNZ  DS    0H                                                       00980000
         STC   R6,ENTRY11              STORE REAL LENGTH OF ENTRY       00990000
LDSGCLS  DS    0H                                                       01000000
* -------------------------------------------------------               01010000
*        GET RESOURCE CLASS NAME                                        01020000
* -------------------------------------------------------               01030000
         MVC   CLASSR(8),=CL8' '                                        01040000
         MVC   GRPCLSR(8),=CL8' '      GROUP CLASS RESOURCE             01050000
         L     R2,AENTYP               ADDR. CLASS-NAME                 01060000
         MVC   CLASSR(8),0(R2)                                          01070000
         TR    CLASSR(8),TAB           CONVERT CLASS  TO UPPERCASE      01080000
*                                                                       01090000
*        GET GROUP CLASSS/MEMBER CLASS RESOURCE                         01091000
*                                                                       01092000
         CTSCALL GETGRPCL,(DEBUGL,CLASSR,GRPCLSR,MEMCLSR),LINK=INT      01093000
*                                                                       01094000
*                                                                       01095000
         CTSADBG 'CLASS=_/_/_ RESOURCE=#/_',LEVEL=(DEBUGL,3,4,5,6,7),  101096000
               (CLASSR,8,GRPCLSR,8,MEMCLSR,8,?R6,ENTRY12,?R6),         201097000
               RAREA=SDDAREA                                            01098000
*                                                                       01099000
* -------------------------------------------------------               01100000
LDSRPP   DS    0H                      PREPARE PARAMETERS               01110000
         L     R2,AOPTION              OPTION CODE / LOCATE / NEXTC /   01120000
         MVC   OPTCDE(8),0(R2)         MOVE OPTION CODE                 01130000
         TR    OPTCDE(8),TAB           CONVERT OPTION TO UPPERCASE      01140000
*                                                                       01150000
         CTSADBG 'OPTION=_',LEVEL=(DEBUGL,3,4,5,6,7),RAREA=SDDAREA,    101160000
               (OPTCDE,8)                                               01170000
*                                                                       01180000
*        MOVE PARAMETERS TO TEST PROGRAM                                01181000
*                                                                       01182000
         XC    PLCATEG,PLCATEG         CLEAR POINTER CATEG. AREA        01183000
         L     R5,TSTGRES              EXIT-TEST ROUTINE                01184000
         LR    R6,R5                                                    01185000
         LA    R6,4095(R6)                                              01186000
         LA    R6,1(R6)                                                 01187000
         USING TESTGRES,R5,R6                                           01188000
         MVC   PTRCTGAS(4),=A(LCATEG)  STATIC PTR  TO CATEG.AREA        01189000
         MVC   PTRCTGAD(4),=A(PLCATEG) DYNAMIC PTR TO CATEG.AREA        01190000
         MVC   DBGRES(1),DEBUGL        DEBUG LEVEL                      01200000
         MVC   TCLASS(8),CLASSR        RESOURCE CLASS                   01210000
         MVC   GRPCLSG(8),GRPCLSR      GROUP RESOURCE CLASS             01220000
         MVC   MBRCLSG(8),MEMCLSR      MEMBER RESOURCE CLASS            01230000
         DROP  R5                                                       01240000
         DROP  R6                                                       01250000
*                                                                       01251000
****************************************************************        01251100
*        VOLUME PARAMETER HANDLING                                      01251200
****************************************************************        01251300
*                                                                       01251400
         MVC   VOLUME(6),=CL6' '                                        01251500
         L     R2,AVOLUME              VOLUME                           01251600
         MVC   VOLUME(6),0(R2)                                          01251700
         TR    VOLUME(6),TAB           CONVERT VOLUME TO UPPERCASE      01251800
*                                                                       01251900
         CTSADBG 'VOLUME=_/$',LEVEL=(DEBUGL,3,4,5,6,7),                101252000
               (VOLUME,6,VOLUME,6),RAREA=SDDAREA                        01252100
*                                                                       01252200
*****************************************************************       01252300
*        LIST RESOURCE PROCESS. GET ICHENTRY ADDR                       01252400
*****************************************************************       01252500
         CLC   CLASSR(8),=CL8'DATASET' DATASET RESCOURCE CLASS ?        01252600
         BE    LDTSET                                                   01252700
         B     LGRSET                                                   01252800
LDTSET   DS    0H                                                       01252900
         CTSCALL GETLDPRM,,LINK=INT                                     01253000
         LR    R3,R15                  ICHEINTY ADDR OF PARM LIST       01254000
         B     LDSROPCD                                                 01255000
LGRSET   DS    0H                                                       01256000
         CTSCALL GETLGPRM,,LINK=INT                                     01257000
         LR    R3,R15                  ICHEINTY ADDR OF PARM LIST       01258000
         B     LDSROPCD                                                 01259000
*                                                                       01260000
****************************************************************        01270000
*        GENERIC, VOLUME PARAMETER HANDLING                             01280000
****************************************************************        01290000
*                                                                       01300000
LDSROPCD DS    0H                                                       01310000
         SR    R7,R7                   VOLUME ADDR DEFAULT (NO VOLUME)  01320000
         CLI   VOLUME,C' '             OBTAINED VOLUME ?                01330000
         BE    LDSRV0                  Y, SKIP                          01340000
         LA    R7,VOLUME               VOLUME ADDR                      01350000
LDSRV0   DS    0H                                                       01360000
         USING RXTPRM,R3               ADDRESSABILITY EXTRACTOR PARAMS  01370000
         L     R4,RXTRSGLT             SEGMENT'S LIST ADDR              01380000
         LA    R4,4(R4)                SKIP THE CONTROL WORD            01390000
LDSRV1   DS    0H                                                       01400000
         L     R5,8(R4)                ADDRESS ICHEINTY MACRO           01410000
         LTR   R5,R5                   END-OF-LIST ?                    01420000
         BZ    LDSRV2                  Y, SKIP                          01430000
*                                                                       01440000
         CTSADBG 'ICHEINTY=~ SET VOLUME=_ VOL.ADDR=~',                 101450000
               LEVEL=(DEBUGL,3,4,5,6,7),                               201451000
               (?R5,VOLUME,6,?R7),RAREA=SDDAREA                         01451100
*                                                                       01451200
         ICHEINTY VOLUME=(R7),OPTIONS=(NOEXEC),                        X01451300
               RELEASE=1.8,MF=(E,(R5))                                  01451400
*                                                                       01451500
         LA    R4,16(R4)               GET NEXT ENTRY FROM TABLE        01451600
         B     LDSRV1                  LOOP                             01451700
*                                                                       01451800
LDSRV2   DS    0H                                                       01451900
         MVC   GENERIC(6),=CL6'UNCOND'                                  01452000
         L     R5,AFGEN                                                 01453000
         L     R6,0(R5)                                                 01454000
         LTR   R6,R6                                                    01455000
         BNZ   LDSRLCOP                                                 01456000
         MVC   GENERIC(6),=CL6'NO'                                      01457000
*                                                                       01458000
****************************************************************        01459000
*        LOCATE EXTRACTOR OPERATION                                     01460000
****************************************************************        01470000
*                                                                       01480000
LDSRLCOP DS    0H                                                       01490000
         XC    RETCODE(12),RETCODE     CLEAR RET CODES                  01500000
*                                                                       01510000
         CTSADBG 'OPCODE=_ GENERIC=_ RESET=_',RAREA=SDDAREA,           X01520000
               (OPTCDE,6,GENERIC,6,RESET,3),LEVEL=(DEBUGL,3,4,5,6,7)    01530000
*                                                                       01540000
*        LOCATE OPCODE                                                  01550000
*                                                                       01560000
         CTSFAGR LOCATE,RC=RETCODE,MF=(E,(R3))                          01570000
*                                                                       01580000
*        DIAG TRACE                                                     01590000
*                                                                       01600000
         L     R4,0(R3)                ICHEINTY MACRO PARAM LIST        01610000
         L     R5,20(R4)               RACF PREFIX AREA                 01620000
         SR    R6,R6                                                    01630000
         IC    R6,ENTRY11                                               01640000
         USING RETAREA,R5                                               01650000
*                                                                       01660000
         CTSADBG 'RC=#/#/# ENTRY=#/_ GENERIC=$ DUPCNT=# RBA=$',        *01670000
               (RETCODE,RETCODE+4,RETCODE+8,?R6,ENTRY12,?R6,           *01680000
               XPFFLGS,1,XPFDDSC,XPFRBA,6),RAREA=SDDAREA,              *01690000
               LEVEL=(DEBUGL,5,6,7)                                     01700000
*                                                                       01710000
         DROP  R5                                                       01711000
*                                                                       01712000
         LTR   R15,R15                 WAS EXTRACTOR/RACF ERROR ?       01713000
         BNZ   LDSRRET                 Y, RETURN                        01714000
*------------------------------------------------------------           01715000
*        FOR GENERAL RESOURCE CLASS                                     01716000
*        GET "GROUP CLASS NAME", AND "RESOURCE GROUPS"                  01717000
*------------------------------------------------------------           01718000
         CLC   CLASSR(8),=CL8'DATASET' DATASET RESOURCE CLASS ?         01719000
         BE    LDSRCNT2                Y, SKIP                          01720000
         CLC   CLASSR(8),=CL8'SECDATA' 'SECDATA' GEN.RES CLASS ?        01730000
         BE    LDSRCNT2                Y, SKIP                          01740000
         CLC   GRPCLSR(8),=CL8' '      FIELD HAS THE VALUE ?            01750000
         BE    LDSRCNT2                N, SKIP                          01751000
         CTSCALL LDSGRP,(DEBUGL,GRPCLSR,ENTRY1,AAREA),LINK=INT          01752000
*                                                                       01753000
*------------------------------------------------------------           01754000
*        DATASET, GENERAL RESOURCE PROFILES                             01755000
*        HAS ONLY CODES OF CATEGORIES AND CODE OF SECURITY LEVEL        01756000
*        NOW - SEARCH TEXT EQUVIVALENTS                                 01757000
*------------------------------------------------------------           01758000
LDSRCNT2 DS    0H                                                       01759000
         CLC   CLASSR(8),=CL8'SECDATA' 'SECDATA' GEN.RES CLASS ?        01760000
         BE    LDSRGENF                Y,NOT NEED ACCESS TO GENERAL     01770000
         L     R5,PLCATEG              DYNAMIC AREA PTR                 01780000
         LTR   R5,R5                   DYNAMIC AREA WAS USED ?          01790000
         BNZ   LDSRCTG0                                                 01800000
         LA    R5,LCATEG               STATIC AREA                      01810000
LDSRCTG0 DS    0H                                                       01820000
         L     R9,TSTGRES              TEST ROUTINE                     01830000
         LR    R4,R9                                                    01840000
         LA    R4,4095(R4)                                              01850000
         LA    R4,1(R4)                                                 01860000
         USING TESTGRES,R9,R4                                           01870000
*                                                                       01880000
         CTSADBG '-->INVOKE SEC LEVEL AND CATEGORIES SEARCH<--',       *01890000
               LEVEL=(DEBUGL,5,6,7)                                     01891000
         CTSADBG '-->SECLEVEL=$ CATEGORIES NUMBER=$<--',               *01892000
               (SECLVL,1,4(R5),4),                                     *01893000
               LEVEL=(DEBUGL,5,6,7)                                     01894000
*                                                                       01895000
         CLI   SECLVL,X'FF'            DEFAULT SECURITY LEVEL ?         01896000
         BNE   LDSRCTG1                NO . NEED ACCESS TO              01897000
*                                      GENERAL RESOURCE PROFILE         01898000
*                                      ABOUT SEC. LEVEL                 01899000
         CLC   4(4,R5),=F'0'           COUNT OF CATEGORIES = 0 ?        01900000
         BE    LDSRGENF                NOT NEED ACCESS TO GENERAL       01910000
*                                      RESOURCE  PROFILE                01920000
LDSRCTG1 DS    0H                                                       01930000
         SR    R7,R7                                                    01940000
         IC    R7,SECLVL               SEC.LEVEL FROM CONNECT TEST/R    01950000
         DROP  R9                                                       01960000
         DROP  R4                                                       01970000
         L     R6,TSTSCDT              TEST ROUTINE                     01980000
         USING TESTSCDT,R6                                              01990000
         MVC   DBGGRS(1),DEBUGL        DEBUG LEVEL                      02000000
         ST    R5,AREAPTR              CURRENT PTR OF CATEG. LIST       02010000
         STC   R7,SCLV                 SEC.LEVEL TO GEN.RES TEST/R      02020000
         DROP  R6                                                       02030000
         MVI   ENTRY1R,1               | CLEAR ENTRY NAME               02040000
         XC    ENTRY2R,ENTRY2R         | FOR ACCESS                     02050000
*----------------------------------------------------------------       02060000
*        GET 'GENERAL' RESOURCE 'SECDATA' CLASS                         02070000
*        FOR TRANSLATING CODES OF SECLEVEL AND CATEGORIES TO NAMES      02071000
*----------------------------------------------------------------       02072000
LDSRGENR CTSFAGR NEXT,                                                 102073000
               TYPE='GEN',OUTEP=OUTP,OUTAREA=AAREA,                    202074000
               DATAMAP=NEW,ENTRY=ENTRYR,RC=RETCODF,TEST=TSTSCDT,       302075000
               EOE=NO,GETPRG=CTSFRXT,CLASS=CLASS,DEBUG=DEBUG,          402076000
               (TXTL='RESOURCE-NAME=',REPEAT=YES,IGNORE=YES),          *02077000
               (MEMCNT,E,X,TXTL='MEMCNT',IGNORE=YES),                  *02078000
               (MEMLST,L,C,TXTL='CATEGORY'),                           *02079000
               (CLASTYPE,E,X,TXTL='INFO.UNKNOWNCAT'),                  *02080000
               (LEVEL,E,C,TXTL='SECLEVEL')                              02090000
         LTR   R15,R15                                                  02100000
         BZ    LDSRGENR                                                 02110000
LDSRGENF DS    0H                                                       02120000
         L     R5,PLCATEG              DYNAMIC AREA PTR                 02130000
         LTR   R5,R5                   DYNAMIC AREA WAS USED ?          02140000
         BZ    LDSRNDN                 NO                               02150000
         L     R6,PLCATEG+4            DYNAMIC AREA LENGTH              02160000
         FREEMAIN RC,LV=(R6),A=(R5)                                     02170000
         LTR   R15,R15                                                  02180000
         BZ    LDSRRET                                                  02190000
         ST    R15,RETCODE+4                                            02200000
         LA    R15,32                  INVALID FREEMAIN                 02210000
         ST    R15,RETCODE+8                                            02220000
LDSRNDN  DS    0H                                                       02230000
*------------------------------------------------------------           02240000
*        RETURN CURRENT ENTRY NAME TO CALLER                            02250000
*------------------------------------------------------------           02260000
LDSRRET  DS    0H                                                       02270000
         L     R2,AENTRY                                                02280000
         MVC   0(256,R2),=CL256' '                                      02290000
         SR    R6,R6                                                    02300000
         IC    R6,ENTRY11              LENGTH OF ENTRY NAME             02310000
*                                                                       02320000
         CTSADBG 'RETURNED ENTRY=#/_',RAREA=SDDAREA,                   *02330000
               (?R6,ENTRY12,?R6),                                      *02340000
               LEVEL=(DEBUGL,3,4,5,6,7)                                 02350000
         BCTR  R6,0                                                     02360000
         EX    R6,MVCENTRY                                              02370000
* --------------------     1  - RACF RETURN CODE                        02380000
* --------------------     2  - RACF REASON CODE                        02390000
* --------------------     3  - EXTRACTOR RETURN CODE                   02400000
*------------------------------------------------------------           02410000
*        MOVE RETURN CODES TO CALLER                                    02420000
*------------------------------------------------------------           02430000
         L     R2,ARCFRET                                               02440000
         MVC   0(4,R2),RETCODE                                          02450000
         L     R2,AREASON                                               02460000
         MVC   0(4,R2),RETCODE+4                                        02470000
         L     R15,RETCODE+8                                            02480000
EXIT     DS    0H                                                       02490000
         CTSADBG 'EXITING WITH RC=~',(?R15),RAREA=SDDAREA,             102500000
               LEVEL=(DEBUGL,3,4,5,6,7)                                 02510000
         BRTRN (15)                                                     02520000
*                                                                       02530000
         LTORG                                                          02540000
*                                                                       02550000
SDDAREA  DS   32D                      DEBUG WORK AREA                  02560000
SEP      DS   CL1                      SEPARATOR                        02570000
AAREA    DS   F                        ADDRESS OF EXTRACT AREA          02580000
DEBUG    DS   F                        DEBUG LEVEL                      02590000
DEBUGL   DS   CL1                      DEBUG LEVEL                      02600000
*                                                                       02610000
ENTRY1   DS   0H                       | ENTRY NAME                     02620000
ENTRY11  DS   AL1                      |    FOR                         02630000
ENTRY12  DS   CL256                    | RESOURCE PROFILE               02640000
*                                                                       02650000
ENTRYR   DS   0H                       | ENTRY NAME FOR GENERAL         02660000
ENTRY1R  DS   AL1                      | RESOURCE                       02670000
ENTRY2R  DS   CL256                    | PROFILE  (CLASS=SECDATA)       02680000
*                                                                       02690000
OPTCDE   DS   CL8                      OPCODE:   LOCATE / NEXTC         02700000
CLASSR   DS   CL8                      RESOURCE CLASS FOR GET           02710000
CLASS    DC   CL8'SECDATA'                                              02720000
GRPCLSR  DS   CL8                      GROUP CLASS RESOURCE             02730000
MEMCLSR  DS   CL8                      MEMBER CLASS RESOURCE            02740000
OUTP     DC   A(DUMMYR)                EXTERNAL OUTPUT ROUTINE          02750000
CTSFRXT  DC   V(CTSFRXT)               EXTRACTOR PROGRAM NAME           02760000
TSTGRES  DC   A(TESTGRES)              TEST ROUTINE FOR LIST RESOURCES  02770000
TSTSCDT  DC   A(TESTSCDT)              TEST ROUTINE GENERAL RESOURCE    02780000
*                                      CLASS=SECDATA                    02790000
RETCODE  DS   3F                                                        02800000
* --------------------     1  - RACF RETURN CODE                        02810000
* --------------------     2  - RACF REASON CODE                        02820000
* --------------------     3  - EXTRACTOR RETURN CODE                   02830000
RETCODF  DS   3F                                                        02840000
LCATEG   DC   F'512'                   MAX LENGTH OF AREA               02850000
         DS   F                        COUNT OF CATEGORIES              02860000
         DS   512CL1                   LIST OF CATEGORIES INDEXES       02870000
PLCATEG  DS   D                        PTR TO AREA FOR LIST OF CATEG    02880000
*                                      1-ST WORD - ADDRESS              02890000
*                                      2-ND WORD - LENGTH               02900000
*                                      IN CASE GETMAIN                  02910000
BLANKTAB DC    256AL1(00)                                               02920000
         ORG   BLANKTAB+X'40'                                           02930000
         DC    X'FF'                                                    02940000
         ORG   ,                                                        02950000
*                                                                       02960000
MVCENTRY MVC   0(0,R2),ENTRY12         MOVE ENTRY NAME                  02970000
*                                                                       02980000
TAB      DC    256AL1(*-TAB)           TRANSLATE TABLE TO UPPERCASE     02990000
         ORG   TAB                                                      03000000
         DC    40C' '                                                   03010000
         ORG   TAB+C'A'-X'40'                                           03020000
         DC    C'ABCDEFGHI'                                             03030000
         ORG   TAB+C'J'-X'40'                                           03040000
         DC    C'JKLMNOPQR'                                             03050000
         ORG   TAB+C'S'-X'40'                                           03060000
         DC    C'STUVWXYZ'                                              03070000
         ORG   ,                                                        03080000
*                                                                       03090000
* -------------------------------------------------------               03100000
*        ADDITIONAL PARAMETERS FOR DATASET PROCESSING                   03110000
* -------------------------------------------------------               03120000
*                                                                       03121000
RESET    DC   CL8'NO'                  RESET PREFIX PART RETURN         03122000
GENERIC  DC   CL8'UNCOND'              GENERIC PARAMETER                03123000
VOLUME   DS   CL6                      VOLUME PARAMETER                 03124000
         DROP  ,                                                        03125000
****************************************************************        03126000
*                                                              *        03127000
* FUNCTION    : SET PARAMETER LIST ADDR                        *        03128000
* -------------                                                *        03129000
* RETURN CODES: NONE                                           *        03130000
* -------------                                                *        03140000
* RETURN VALUE: R15 - ADDR ICHEINTY TABLE                      *        03150000
* -------------                                                *        03160000
*                                                              *        03170000
****************************************************************        03180000
*                                                                       03190000
GETLDPRM BEGIN                                                          03200000
         L     R15,=A(GETDSPRM)                                         03210000
         BRTRN (15)                                                     03220000
         LTORG                                                          03230000
*                                                                       03240000
****************************************************************        03250000
*        EXTRACTOR DEFINITION TABLES                                    03260000
****************************************************************        03270000
*                                                                       03280000
GETDSPRM CTSFAGR LOCATE,MF=L,CHAIN=GETDSET1,DELAY=DELAYD,              103290000
               TYPE='DS',OUTEP=OUTP,OUTAREA=AAREA,TEST=TSTGRES,        203300000
               DATAMAP=NEW,ENTRY=ENTRY1,RC=RETCODE,RESET=RESET,        303310000
               EOE=NO,GETPRG=CTSFRXT,GENERIC=GENERIC,DEBUG=DEBUG,      403320000
               (TXTL='RESNAME',REPEAT=YES),                            *03330000
               (VERSION,E,C,TXTL='GENERIC'),                           *03340000
               (ENTYPE,E,C,TXTL='RESTYPE'),                            *03350000
               (CREADATE,E,C,TXTL='INFO.CREATE_DATE'),                 *03360000
               (AUTHOR,E,C,TXTL='OWNER'),                              *03370000
               (LREFDAT,E,C,TXTL='INFO.LASTREF_DATE'),                 *03380000
               (LCHGDAT,E,C,TXTL='INFO.LASTCHG_DATE'),                 *03390000
               (ACSALTR,E,X,TXTL='INFO.ALTER_COUNT'),                  *03400000
               (ACSCNTL,E,X,TXTL='INFO.CONTROL_COUNT'),                *03410000
               (ACSUPDT,E,X,TXTL='INFO.UPDATE_COUNT'),                 *03411000
               (ACSREAD,E,X,TXTL='INFO.READ_COUNT'),                   *03412000
               (UNIVACS,E,X,TXTL='UACC',TRN=UACS1),                    *03413000
               (FLAG1,E,X,TXTL='INFO.GROUP_DATASET',TRN=TFLG1),        *03414000
               (GROUPNM,E,C,TXTL='INFO.CREATGRP'),                     *03415000
               (DSTYPE,E,X,TXTL='INFO.DATASET_TYPE',TRN=TDT1),         *03416000
               (LEVEL,E,X,TXTL='LEVEL'),                               *03417000
               (DEVTYP,E,C,TXTL='INFO.UNIT_TYP',TRN=TDEV),             *03418000
               (DEVTYPX,E,C,TXTL='UNIT',TRN=TDEV),                     *03419000
               (INSTDATA,E,C,TXTL='DATA'),                             *03420000
               (WARNING,E,X,TXTL='WARNING',TRN=T11),                   *03430000
               (SECLEVEL,E,X,TXTL='SECLEVEL'),                         *03440000
               (NUMCTGY,E,X,TXTL='NUMCTGY'),                           *03450000
               (CATEGORY,L,X,TXTL='CATEGORY'),                         *03460000
               (NOTIFY,E,C,TXTL='NOTIFY'),                             *03470000
               (RETPD,E,X,TXTL='RETPD'),                               *03480000
               (VOLCNT,E,X,TXTL='VOLCNT',IGNORE=YES),                  *03490000
               (VOLSER,L,C,TXTL='VOLUME_LIST'),                        *03500000
               ($VOLSER,E,C,TXTL='VOLUME',DELAY=YES),                  *03510000
               (SECLABEL,E,C,TXTL='SECLABEL')                           03520000
*                                                                       03530000
GETDSET1 CTSFAGR LOCATE,MF=L,CHAIN=GETDSET2,                           103540000
               (TXTL='RESNAME',IGNORE=YES),                            203550000
               (AUDITQS,E,X,TXTL='AUDITQS',IGNORE=YES),                *03560000
               (AUDITQF,E,X,TXTL='AUDITQF',IGNORE=YES),                *03570000
               (AUDIT,E,X,TXTL='AUDIT.ALL',TRN=TAU11),                 *03580000
               (AUDIT,E,X,TXTL='AUDIT.SUCCESS',TRN=TAU21),             *03590000
               (AUDIT,E,X,TXTL='AUDIT.FAILURES',TRN=TAU31),            *03600000
               (AUDIT,E,X,TXTL='AUDIT.NONE',TRN=TAU41),                *03610000
               (GAUDITQS,E,X,TXTL='GAUDITQS',IGNORE=YES),              *03620000
               (GAUDITQF,E,X,TXTL='GAUDITQF',IGNORE=YES),              *03630000
               (GAUDIT,E,X,TXTL='GLOBALAUDIT.ALL',TRN=TAU11),          *03640000
               (GAUDIT,E,X,TXTL='GLOBALAUDIT.SUCCESS',TRN=TAU21),      *03650000
               (GAUDIT,E,X,TXTL='GLOBALAUDIT.FAILURES',TRN=TAU31),     *03660000
               (GAUDIT,E,X,TXTL='GLOBALAUDIT.NONE',TRN=TAU41)           03670001
*                                                                       03680000
GETDSET2 CTSFAGR LOCATE,MF=L,CHAIN=GETDSET3,                           103681000
               (TXTL='RESNAME',IGNORE=YES),                            203682000
               (FLDCNT,E,X,TXTL='FLDCNT',IGNORE=YES),                  *03683000
               (FLDNAME,L,C,TXTL='FLDNAME',EOL=NO),                    *03684000
               (FLDVALUE,L,C,TXTL='FLDVALUE',EOL=NO),                  *03685000
               (FLDFLAG,L,X,TXTL='FLDFLAG',EOL=YES),                   *03686000
               ($DERASE,E,X,TXTL='ERASE',TRN=TERS,DELAY=YES),          *03687000
               (USRCNT,E,X,TXTL='USRCNT',IGNORE=YES),                  *03688000
               (USRNM,L,C,TXTL='USRNM',EOL=NO),                        *03689000
               (USRDATA,L,C,TXTL='USRDATA',EOL=NO),                    *03689100
               (USRFLG,L,X,TXTL='USRFLG',EOL=YES)                       03689200
*                                                                       03689300
* PS0391 GETDSET3 CTSFAGR LOCATE,MF=L,                                  03689400
GETDSET3 CTSFAGR LOCATE,CHAIN=GETDSTME,MF=L,                    PS0391 103689500
               SEGMENT=DFP,                                            203689600
               (TXTL='RESNAME',IGNORE=YES),                            303689700
               (RESOWNER,E,C,TXTL='DFP.RESOWNER')                       03689800
GETDSTME CTSFAGR LOCATE,MF=L,                                   PS0391 103690101
               SEGMENT=TME,                                     PS0391 203690200
               (TXTL='RESNAME',IGNORE=YES),                     PS0391 303690300
               (ROLEN,E,X,TXTL='TME.ROLEN'),                    PS0391 403690400
               (ROLES,L,C,TXTL='TME.ROLES')                     PS0391  03690500
*                                                                       03691100
*                                       DUMMY DELAY PARAMETER           03691200
DELAYD   CTSFAGR LOCATE,MF=L,TYPE='DS',ENTRY=ENTRY1,DELAY=YES           03691300
*                                                                       03691400
* -------------------------------------------------------               03691500
*        TRANSLATE TABLE                                                03691600
* -------------------------------------------------------               03691700
UACS1    DC    XL1'FF'                 ACCESS TRANSLATE TABLE           03692000
         DC    B'10000000',AL1(5),CL5'ALTER'                            03693000
         DC    B'01000000',AL1(7),CL7'CONTROL'                          03694000
         DC    B'00100000',AL1(6),CL6'UPDATE'                           03695000
         DC    B'00010000',AL1(4),CL4'READ'                             03696000
         DC    B'00001000',AL1(7),CL7'EXECUTE'                          03697000
         DC    B'00000100',AL1(8),CL8'RESERVED'                         03698000
         DC    B'00000010',AL1(8),CL8'RESERVED'                         03699000
         DC    B'00000001',AL1(4),CL4'NONE'                             03700000
         DC    B'00000000'             END OF TABLE                     03710000
* ------------------------------------ AUDIT.ALL                        03720000
TAU11    DC    AL1(2),X'8000'                                           03730000
         DC    AL1(4),CL4'READ'                                         03740000
         DC    AL1(2),X'8001'                                           03750000
         DC    AL1(6),CL6'UPDATE'                                       03760000
         DC    AL1(2),X'8002'                                           03770000
         DC    AL1(7),CL7'CONTROL'                                      03780000
         DC    AL1(2),X'8003'                                           03790000
         DC    AL1(5),CL5'ALTER'                                        03800000
         DC    AL1(0)                                                   03810000
* ------------------------------------ AUDIT.SUCCESS                    03820000
TAU21    DC    AL1(2),X'4000'                                           03830000
         DC    AL1(4),CL4'READ'                                         03840000
         DC    AL1(2),X'4001'                                           03850000
         DC    AL1(6),CL6'UPDATE'                                       03860000
         DC    AL1(2),X'4002'                                           03870000
         DC    AL1(7),CL7'CONTROL'                                      03880000
         DC    AL1(2),X'4003'                                           03890000
         DC    AL1(5),CL5'ALTER'                                        03900000
         DC    AL1(0)                                                   03910000
* ------------------------------------ AUDIT.FAILURES                   03920000
TAU31    DC    AL1(2),X'2000'                                           03930000
         DC    AL1(4),CL4'READ'                                         03940000
         DC    AL1(2),X'2001'                                           03950000
         DC    AL1(6),CL6'UPDATE'                                       03960000
         DC    AL1(2),X'2002'                                           03970000
         DC    AL1(7),CL7'CONTROL'                                      03980000
         DC    AL1(2),X'2003'                                           03990000
         DC    AL1(5),CL5'ALTER'                                        04000000
         DC    AL1(0)                                                   04010000
* ------------------------------------ AUDIT.NONE                       04020000
TAU41    DC    AL1(1),X'10'                                             04030000
         DC    AL1(1),CL1'Y'                                            04040000
         DC    AL1(1),X'00'                                             04050000
         DC    AL1(1),CL1'N'                                            04060000
         DC    AL1(0)                                                   04070000
* -------------------------------------------------------               04080000
TDT1     DC    AL1(1),X'80'                 DSTYPE                      04090000
         DC    AL1(4),CL4'VSAM'                                         04100000
         DC    AL1(1),X'40'                                             04110000
         DC    AL1(5),CL5'MODEL'                                        04120000
         DC    AL1(1),X'20'                                             04130000
         DC    AL1(4),CL4'TAPE'                                         04140000
         DC    AL1(1),X'00'                                             04150000
         DC    AL1(8),CL8'NON-VSAM'                                     04160000
         DC    AL1(0)                                                   04170000
* -------------------------------------------------------               04180000
T11      DC    AL1(1),X'01'                 WARNING        PS0440       04190000
         DC    AL1(1),CL1'Y'                                            04200000
         DC    AL1(1),X'80'                                             04210000
         DC    AL1(1),CL1'Y'                                            04220000
         DC    AL1(1),X'00'                                             04230000
         DC    AL1(1),CL1'N'                                            04240000
         DC    AL1(0)                                                   04250000
* -------------------------------------------------------               04260000
*                           ($DERASE = ERASE ) (FROM FLDNAME=EOSFLAG)   04270000
TERS     DC    AL1(1),X'80'                                             04280000
         DC    AL1(1),CL1'Y'                                            04290000
         DC    AL1(1),X'00'                                             04300000
         DC    AL1(1),CL1'N'                                            04310000
         DC    AL1(0)                                                   04320000
* -------------------------------------------------------               04330000
TFLG1    DC    AL1(1),X'80'                 FLAG1                       04340000
         DC    AL1(1),CL1'Y'                                            04350000
         DC    AL1(1),X'00'                                             04360000
         DC    AL1(1),CL1'N'                                            04370000
         DC    AL1(0)                                                   04380000
* -------------------------------------------------------               04390000
*                                           DEVTYP                      04400000
*                                           DEVTYPX                     04410000
TDEV     DC    AL1(4),4X'FF'                                            04420000
         DC    AL1(0)                                                   04430000
         DC    AL1(8),8X'FF'                                            04440000
         DC    AL1(0)                                                   04450000
         DC    AL1(0)                                                   04460000
* -------------------------------------------------------               04470000
         DROP  ,                                                        04480000
****************************************************************        04490000
*                                                              *        04500000
* FUNCTION    : SET PARAMETER LIST ADDR                        *        04510000
* -------------                                                *        04520000
* RETURN CODES: NONE                                           *        04530000
* -------------                                                *        04540000
* RETURN VALUE: R15 - ADDR ICHEINTY TABLE                      *        04550000
* -------------                                                *        04560000
*                                                              *        04570000
****************************************************************        04580000
*                                                                       04590000
GETLGPRM BEGIN                                                          04600000
         L     R15,=A(GETGRPRM)                                         04610000
         BRTRN (15)                                                     04620000
         LTORG                                                          04630000
*                                                                       04640000
****************************************************************        04650000
*        EXTRACTOR DEFINITION TABLES                                    04660000
****************************************************************        04670000
*                                                                       04680000
GETGRPRM CTSFAGR LOCATE,CLASS=CLASSR,CHAIN=GETGRS1,MF=L,DELAY=DELAYG,  104690000
               TYPE='GEN',OUTEP=OUTP,OUTAREA=AAREA,TEST=TSTGRES,       204700000
               ENTRY=ENTRY1,RC=RETCODE,RESET=RESET,DEBUG=DEBUG,        304710000
               EOE=NO,GETPRG=CTSFRXT,GENERIC=GENERIC,                  404720000
               (TXTL='RESNAME',REPEAT=YES),                            *04730000
               (CLASTYPE,E,C,TXTL='RESTYPE'),                          *04740000
               ($GRPCLS,E,C,TXTL='INFO.GROUP_CLASS',DELAY=YES),        *04750000
               ($MEMCLS,E,C,TXTL='INFO.MEMBER_CLASS',DELAY=YES),       *04760000
               (VERSION,E,C,TXTL='GENERIC'),                           *04770000
               (DEFDATE,E,C,TXTL='INFO.CREATE_DATE'),                  *04780000
               (OWNER,E,C,TXTL='OWNER'),                               *04790000
               (LREFDAT,E,C,TXTL='INFO.LASTREF_DATE'),                 *04800000
               (LCHGDAT,E,C,TXTL='INFO.LASTCHG_DATE'),                 *04810000
               (ACSALTR,E,X,TXTL='INFO.ALTER_COUNT'),                  *04820000
               (ACSCNTL,E,X,TXTL='INFO.CONTROL_COUNT'),                *04830000
               (ACSUPDT,E,X,TXTL='INFO.UPDATE_COUNT'),                 *04840000
               (ACSREAD,E,X,TXTL='INFO.READ_COUNT'),                   *04850000
               (UACC,E,X,TXTL='UACC',TRN=UACS2),                       *04860000
               (INSTDATA,E,C,TXTL='DATA'),                             *04870000
               (APPLDATA,E,C,TXTL='APPLDATA'),                         *04880000
               (WARNING,E,X,TXTL='WARNING',TRN=T12W),                  *04890000
               (NOTIFY,E,C,TXTL='NOTIFY'),                             *04900000
               (SECLEVEL,E,X,TXTL='SECLEVEL'),                         *04910000
               (SECLABEL,E,C,TXTL='SECLABEL',TRN=TRN0),                *04920000
               (LEVEL,E,X,TXTL='LEVEL')                                 04930000
*                                                                       04940000
GETGRS1  CTSFAGR LOCATE,MF=L,CHAIN=GETGRS2,CLASS=CLASSR,               104950000
               (TXTL='RESNAME',IGNORE=YES),                            204960000
               (AUDITQS,E,X,TXTL='AUDITQS',IGNORE=YES),                *04970000
               (AUDITQF,E,X,TXTL='AUDITQF',IGNORE=YES),                *04980000
               (AUDIT,E,X,TXTL='AUDIT.ALL',TRN=TAU12),                 *04990000
               (AUDIT,E,X,TXTL='AUDIT.SUCCESS',TRN=TAU22),             *04991000
               (AUDIT,E,X,TXTL='AUDIT.FAILURES',TRN=TAU32),            *04992000
               (AUDIT,E,X,TXTL='AUDIT.NONE',TRN=TAU42),                *04993000
               (GAUDITQS,E,X,TXTL='GAUDITQS',IGNORE=YES),              *04994000
               (GAUDITQF,E,X,TXTL='GAUDITQF',IGNORE=YES),              *04995000
               (GAUDIT,E,X,TXTL='GLOBALAUDIT.ALL',TRN=TAU12),          *04996000
               (GAUDIT,E,X,TXTL='GLOBALAUDIT.SUCCESS',TRN=TAU22),      *04997000
               (GAUDIT,E,X,TXTL='GLOBALAUDIT.FAILURES',TRN=TAU32),     *04998000
               (GAUDIT,E,X,TXTL='GLOBALAUDIT.NONE',TRN=TAU42),         *04999000
               (NUMCTGY,E,X,TXTL='NUMCTGY'),                           *05000000
               (CATEGORY,L,X,TXTL='CATEGORY'),                         *05010000
               (MEMCNT,E,X,TXTL='MEMCNT',IGNORE=YES),                  *05020000
               (MEMLST,L,C,TXTL='MEMBER'),                             *05030000
               (LOGZONE,E,C,TXTL='TIMEZONE'),                          *05040000
               (LOGDAYS,E,X,TXTL='WHEN.DAYS',TRN=TD00),                *05050000
               (LOGDAYS,E,X,TXTL='WHEN.DAYS',TRN=TD01),                *05060000
               (LOGTIME,E,C,TXTL='WHEN.TIME'),                         *05070000
               (RESFLG,E,C,TXTL='SINGLEDSN'),                          *05080000
               (RESFLG,E,C,TXTL='INFO.AUTOMATIC'),                     *05090000
               (RESFLG,E,C,TXTL='TVTOC'),                              *05100000
               (VOLCNT,E,X,TXTL='VOLCNT',IGNORE=YES),                  *05110000
               (VOLSER,L,C,TXTL='VOLUME_LIST'),                        *05120000
               ($VOLSER,E,C,TXTL='VOLUME',DELAY=YES)                    05130000
*                                                                       05140000
GETGRS2  CTSFAGR LOCATE,MF=L,CHAIN=GETGRS3,CLASS=CLASSR,               105150000
               (TXTL='RESNAME',IGNORE=YES),                            205160000
               (FLDCNT,E,X,TXTL='FLDCNT',IGNORE=YES),                  *05170000
               (FLDNAME,L,C,TXTL='FLDNAME',EOL=NO),                    *05180000
               (FLDVALUE,L,C,TXTL='FLDVALUE',EOL=NO),                  *05190000
               (FLDFLAG,L,X,TXTL='FLDFLAG',EOL=YES),                   *05200000
               (USRCNT,E,X,TXTL='USRCNT',IGNORE=YES),                  *05210000
               (USRNM,L,C,TXTL='USRNM',EOL=NO),                        *05220000
               (USRDATA,L,C,TXTL='USRDATA',EOL=NO),                    *05230000
               (USRFLG,L,X,TXTL='USRFLG',EOL=YES)                       05240000
*                                                                       05250000
GETGRS3  CTSFAGR LOCATE,MF=L,CHAIN=GETGRSS,CLASS=CLASSR,               105260000
               (TXTL='RESNAME',IGNORE=YES),                            205270000
               (TVTOCCNT,E,X,TXTL='TVTOCCNT',IGNORE=YES),              *05280000
               (TVTOCSEQ,L,X,TXTL='TVTOCSEQ',TXTR='0',EOL=NO),         *05290000
               (TVTOCCRD,L,C,TXTL='TVTOCCRD',TXTR='1',EOL=NO),         *05300000
               (TVTOCIND,L,X,TXTL='TVTOCIND',TXTR='2',EOL=NO),         *05310000
               (TVTOCDSN,L,C,TXTL='TVTOCDSN',TXTR='3',EOL=NO),         *05320000
               (TVTOCVOL,L,C,TXTL='TVTOCVOL',TXTR='4',EOL=NO),         *05321000
               (TVTOCRDS,L,C,TXTL='TVTOCRDS',TXTR='5',EOL=YES)          05321100
*                                                                       05321200
GETGRSS  CTSFAGR LOCATE,CLASS=CLASSR,CHAIN=GETGRSD,MF=L,               105321300
               SEGMENT=SESSION,                                        205321400
               (TXTL='RESNAME',IGNORE=YES),                            *05321500
               (SESSKEY,E,C,TXTL='SESSION.SESSKEY'),                   *05321600
               (SLSFLAGS,E,X,TXTL='SESSION.LOCK',TRN=T12S),            *05321700
               (KEYDATE,E,C,TXTL='SESSION.INFO.KEY_DATE_CHANGE',       *05321800
               TRN=TDCHS),                                             *05321900
               (KEYINTVL,E,C,TXTL='SESSION.INTERVAL'),                 *05322000
               (KEYINTVL,E,X,TXTL='SESSION.INTERVAL'),                 *05322100
               (SLSFAIL,E,X,TXTL='SESSION.INFO.INVALID_ATTMPTS'),      *05322200
               (MAXFAIL,E,X,TXTL='SESSION.INFO.MAX_INVALID_ATTMPTS'),  *05322300
               (SENTCNT,E,X,TXTL='SESSION.INFO.SENTCNT',IGNORE=YES),   *05322400
               (SENTITY,L,C,TXTL='SESSION.INFO.ENTITY',EOL=NO),        *05322500
               (SENTFLCT,L,X,TXTL='SESSION.INFO.ENTITY_FAIL',EOL=YES), *05322600
               (CONVSEC,E,X,TXTL='SESSION.CONVSEC',TRN=TRNS2)           05322700
*                                                                       05322800
GETGRSD  CTSFAGR LOCATE,CLASS=CLASSR,CHAIN=GETGRSK,MF=L,               105322900
               SEGMENT=DLFDATA,                                        205323000
               (TXTL='RESNAME',IGNORE=YES),                            *05323100
               (RETAIN,E,X,TXTL='DLFDATA.RETAIN',TRN=T12R),            *05323200
               (JOBNMCNT,E,X,TXTL='DLFDATA.INFO.JOBNMCNT',IGNORE=YES), *05323300
               (JOBNAMES,L,C,TXTL='DLFDATA.JOBNAMES')                   05323400
*                                                                       05323500
GETGRSK  CTSFAGR LOCATE,CLASS=CLASSR,CHAIN=GETGRST,MF=L,               105323600
               SEGMENT=SSIGNON,                                        205323700
               (TXTL='RESNAME',IGNORE=YES),                            *05323800
               (SSKEY,E,C,TXTL='SSIGNON.KEYENCRYPT')                    05323900
*                                                                       05324000
GETGRST  CTSFAGR LOCATE,CLASS=CLASSR,CHAIN=GETGRSV,MF=L,               105324100
               SEGMENT=STDATA,                                         205324200
               (TXTL='RESNAME',IGNORE=YES),                            *05324300
               (STUSER,E,C,TXTL='STDATA.USER'),                        *05324400
               (STGROUP,E,C,TXTL='STDATA.GROUP'),                      *05324500
               (FLAGTRUS,E,C,TXTL='STDATA.TRUSTED',TRN=STDTR),         *05324600
               (FLAGPRIV,E,C,TXTL='STDATA.PRIVILEGED',TRN=STDTR),      *05324700
               (FLAGTRAC,E,C,TXTL='STDATA.TRACE',TRN=STDTR)             05324800
*                                                                       05324900
* PS0391 GETGRSV  CTSFAGR LOCATE,CLASS=CLASSR,MF=L,                     05325000
GETGRSV  CTSFAGR LOCATE,CLASS=CLASSR,CHAIN=GETGRTME,MF=L,              105326000
               SEGMENT=SVFMR,                                          205327000
               (TXTL='RESNAME',IGNORE=YES),                            *05328000
               (SCRIPTN,E,C,TXTL='SVFMR.SCRIPTNAME',TRN=TSVFMR),       *05328100
               (PARMN,E,C,TXTL='SVFMR.PARMNAME',TRN=TSVFMR)             05328201
*WS10031 GETGRTME CTSFAGR LOCATE,CLASS=CLASSR,MF=L,            PS0391 1 05328601
GETGRTME CTSFAGR LOCATE,CLASS=CLASSR,MF=L,CHAIN=GETGRTMP, WS10031PS0391105328701
               SEGMENT=TME,                                     PS0391 205328801
               (TXTL='RESNAME',IGNORE=YES),                     PS0391 305328901
               (PARENT,E,C,TXTL='TME.PARENT'),                  PS0391 405329001
               (CHILDN,E,X,TXTL='TME.CHILDN'),                  PS0391 505329101
               (CHILDREN,L,C,TXTL='TME.CHILDREN'),              PS0391 605329201
               (RESN,E,X,TXTL='TME.RESN'),                      PS0391 705329301
               (RESOURCE,L,C,TXTL='TME.RESOURCE'),              PS0391 805329401
               (GROUPN,E,X,TXTL='TME.GROUPN'),                  PS0391 905329501
               (GROUPS,L,C,TXTL='TME.GROUPS'),                  PS0391 A05329601
               (ROLEN,E,X,TXTL='TME.ROLEN'),                    PS0391 B05329701
               (ROLES,L,C,TXTL='TME.ROLES')                     PS0391  05329801
GETGRTMP CTSFAGR LOCATE,MF=L,CLASS=CLASSR,                      WS10031105329901
               SEGMENT=PROXY,                                   WS10031205330001
               (TXTL='RESNAME',IGNORE=YES),                     WS10031305330101
               (BINDDN,E,C,TXTL='BINDDN'),                      WS10031*05330301
               (BINDPW,E,C,TXTL='BINDPW')                       WS10031 05330401
*                                                                       05330701
*                                       DUMMY DELAY PARAMETER           05330801
DELAYG   CTSFAGR LOCATE,MF=L,TYPE='GEN',ENTRY=ENTRY1,DELAY=YES          05330901
*                                                                       05331001
* -------------------------------------------------------               05331101
         LTORG                                                          05332000
* -------------------------------------------------------               05340000
*     TRANSLATE TABLE                                                   05350000
* -------------------------------------------------------               05360000
UACS2    DC    XL1'FF'                 ACCESS TRANSLATE TABLE           05370000
         DC    B'10000000',AL1(5),CL5'ALTER'                            05380000
         DC    B'01000000',AL1(7),CL7'CONTROL'                          05390000
         DC    B'00100000',AL1(6),CL6'UPDATE'                           05400000
         DC    B'00010000',AL1(4),CL4'READ'                             05410000
         DC    B'00001000',AL1(7),CL7'EXECUTE'                          05420000
         DC    B'00000100',AL1(8),CL8'RESERVED'                         05430000
         DC    B'00000010',AL1(8),CL8'RESERVED'                         05440000
         DC    B'00000001',AL1(4),CL4'NONE'                             05450000
         DC    B'00000000'             END OF TABLE                     05460000
* ------------------------------------ AUDIT.ALL                        05561001
TAU12    DC    AL1(2),X'8000'                                           05562001
         DC    AL1(4),CL4'READ'                                         05563001
         DC    AL1(2),X'8001'                                           05564001
         DC    AL1(6),CL6'UPDATE'                                       05565001
         DC    AL1(2),X'8002'                                           05566001
         DC    AL1(7),CL7'CONTROL'                                      05567001
         DC    AL1(2),X'8003'                                           05568001
         DC    AL1(5),CL5'ALTER'                                        05569001
         DC    AL1(0)                                                   05569101
* ------------------------------------ AUDIT.SUCCESS                    05570000
TAU22    DC    AL1(2),X'4000'                                           05580000
         DC    AL1(4),CL4'READ'                                         05590000
         DC    AL1(2),X'4001'                                           05600000
         DC    AL1(6),CL6'UPDATE'                                       05610000
         DC    AL1(2),X'4002'                                           05620000
         DC    AL1(7),CL7'CONTROL'                                      05630000
         DC    AL1(2),X'4003'                                           05640000
         DC    AL1(5),CL5'ALTER'                                        05650000
         DC    AL1(0)                                                   05660000
* ------------------------------------ AUDIT.FAILURES                   05670000
TAU32    DC    AL1(2),X'2000'                                           05680000
         DC    AL1(4),CL4'READ'                                         05690000
         DC    AL1(2),X'2001'                                           05700000
         DC    AL1(6),CL6'UPDATE'                                       05710000
         DC    AL1(2),X'2002'                                           05720000
         DC    AL1(7),CL7'CONTROL'                                      05730000
         DC    AL1(2),X'2003'                                           05740000
         DC    AL1(5),CL5'ALTER'                                        05750000
         DC    AL1(0)                                                   05760000
* ------------------------------------ AUDIT.NONE                       05770000
TAU42    DC    AL1(1),X'10'                                             05780000
         DC    AL1(1),CL1'Y'           YES                              05790000
         DC    AL1(1),X'00'                                             05800000
         DC    AL1(1),CL1'N'           YES                              05810000
         DC    AL1(0)                                                   05820000
* -------------------------------------------------------               05830000
T12W     DC    AL1(1),X'01'              WARNING           PS0440       05840000
         DC    AL1(1),CL1'Y'                                            05850000
         DC    AL1(1),X'80'                                             05860000
         DC    AL1(1),CL1'Y'                                            05870000
         DC    AL1(1),X'00'                                             05880000
         DC    AL1(1),CL1'N'                                            05890000
         DC    AL1(0)                                                   05900000
*                                                                       05910000
T12S     DC    AL1(1),X'80'              SESSION.LOCK                   05920000
         DC    AL1(1),CL1'Y'                                            05930000
         DC    AL1(1),X'00'                                             05940000
         DC    AL1(1),CL1'N'                                            05950000
         DC    AL1(0)                                                   05960000
*                                                                       05970000
T12R     DC    AL1(1),X'80'              DLFDATA.REATIN                 05980000
         DC    AL1(3),CL3'YES'                                          05990000
         DC    AL1(1),X'00'                                             06000000
         DC    AL1(2),CL2'NO'                                           06010000
         DC    AL1(0)                                                   06020000
* -------------------------------------------------------               06030000
*                                        SVFMR.SCRIPTNAME               06040000
TSVFMR   DC    AL1(8),XL8'00'            SVFMR.PARMNAME                 06050000
         DC    AL1(0)                                                   06060000
         DC    AL1(0)                                                   06070000
* -------------------------------------------------------               06080000
TDCHS    DC    AL1(4),XL4'00'            SESSION.INFO.KEY_DATE_CHANGE   06090000
         DC    AL1(0)                                                   06100000
         DC    AL1(0)                                                   06101000
* -------------------------------------------------------               06102000
TRN0     DC    AL1(8),XL8'00'            SECLABEL                       06103000
         DC    AL1(0)                                                   06104000
         DC    AL1(0)                                                   06105000
* -------------------------------------------------------               06106000
TD00     DC    AL1(1),X'82'              LOGDAYS                        06107000
         DC    AL1(8),CL8'WEEKDAYS'                                     06108000
         DC    AL1(1),X'00'                                             06109000
         DC    AL1(6),CL6'ANYDAY'                                       06110000
         DC    AL1(0)                                                   06120000
* -------------------------------------------------------               06130000
TD01     DC    XL1'FF'                   LOGDAYS, FLAGS TABLE           06140000
         DC    B'10000000',AL1(6),CL6'SUNDAY'                           06150000
         DC    B'01000000',AL1(6),CL6'MONDAY'                           06160000
         DC    B'00100000',AL1(7),CL7'TUESDAY'                          06170000
         DC    B'00010000',AL1(9),CL9'WEDNESDAY'                        06180000
         DC    B'00001000',AL1(8),CL8'THURSDAY'                         06190000
         DC    B'00000100',AL1(6),CL6'FRIDAY'                           06200000
         DC    B'00000010',AL1(8),CL8'SATURDAY'                         06210000
         DC    B'00000000'               END OF TABLE                   06220000
* -------------------------------------------------------               06230000
TRNS2    DC    AL1(1),X'80'                                             06240000
         DC    AL1(4),CL4'NONE'                                         06250000
         DC    AL1(1),X'70'                                             06260000
         DC    AL1(4),CL4'AVPV'                                         06270000
         DC    AL1(1),X'60'                                             06280000
         DC    AL1(8),CL8'ALREADYV'                                     06290000
         DC    AL1(1),X'50'                                             06300000
         DC    AL1(8),CL8'PERSISTV'                                     06310000
         DC    AL1(1),X'40'                                             06320000
         DC    AL1(4),CL4'CONV'                                         06330000
         DC    AL1(0)                    END OF TABLE                   06340000
* -------------------------------------------------------               06350000
*                                        STDATA.TRUSTED                 06360000
*                                        STDATA.PRIVELED                06370000
*                                        STDATA.TRACE                   06380000
STDTR    DC    AL1(1),X'80'                                             06390000
*BS2364  DC    AL1(1),CL1'Y'                                            06400000
         DC    AL1(3),CL3'YES'                                   BS2364 06410000
         DC    AL1(1),X'00'                                             06420000
*BS2364  DC    AL1(1),CL1'N'                                            06430000
         DC    AL1(2),CL2'NO'                                    BS2364 06440000
         DC    AL1(0)                                                   06450000
* -------------------------------------------------------               06460000
         DROP  ,                                                        06470000
****************************************************************        06480000
*                                                              *        06490000
* FUNCTION    : TEST ROUTINE FOR LIST RESOURCES                *        06500000
*                                                              *        06510000
****************************************************************        06520000
*                                                                       06530000
TESTGRES BEGIN *,R12                                                    06540000
*                                                                       06550000
*        ADDRESSABILITY MAIN PARAMETERS                                 06560000
*                                                                       06570000
         USING PARMM,R1                                                 06580000
         L     R2,XPROPCD                                               06590000
         CLI   0(R2),XPRSTRT          START  -  BEFORE READ RECORD FROM 06600000
         BE    LSTART                           RACF DATA BASE          06610000
         CLI   0(R2),XPRENTY          ENTRY  -  AFTER  READ RECORD FROM 06620000
         BE    LENTRY                           RACF DATA BASE          06630000
         CLI   0(R2),XPRELMN          ELEMN  -  ELEMENTARY DATA         06640000
         BE    LELEMN                                                   06650000
         CLI   0(R2),XPRLIST          LIST   -  LIST DATA               06660000
         BE    LLIST                                                    06670000
         CLI   0(R2),XPREND           END    -  BEFORE RETURN FROM      06680000
         BE    LEND                             EXTRACTOR               06690000
         B     RET0                                                     06700000
*                                                                       06710000
********************************************************************    06720000
*        START                                                     *    06730000
********************************************************************    06740000
*                                                                       06750000
LSTART   DS    0H                                                       06760000
         XC    WORKPTR,WORKPTR         CLEAR WORK PTR FOR STORE         06770000
         B     RET0                                                     06780000
*                                      CATEGORIES CODES                 06790000
********************************************************************    06800000
*        ENTRY                                                     *    06810000
********************************************************************    06820000
*                                                                       06830000
LENTRY   DS    0H                                                       06840000
         L     R3,XPRENTRY                                              06850000
         L     R5,0(R3)                ENTRY NAME LENGTH                06860000
         L     R4,XPRPRFXY                                              06870000
         L     R4,0(R4)                                                 06880000
         USING RETAREA,R4                                               06890000
*                                                                       06900000
         CTSADBG 'ENTRY=#/_ FLAG=$',                                   X06910000
               (?R5,4(R3),?R5,XPFFLGS,1),                              X06920000
               LEVEL=(DBGRES,5,6,7),RAREA=RAREA                         06930000
*                                                                       06940000
         MVC   RSENTRY(8),=CL8' '      ENTRY NAME FIRST 8 BYTES         06950000
         C     R5,=F'8'                ENTRY NAME LENGTH = 8 ?          06960000
         BNE   LENTRY1                                                  06970000
         MVC   RSENTRY(8),4(R3)        ENTRY NAME                       06980000
LENTRY1  DS    0H                                                       06990000
         MVC   GENFLAG(1),XPFFLGS                                       07000000
         XC    FAUDITS,FAUDITS         AUDIT SUCCESS  QUALIFIER         07010000
         XC    FAUDITF,FAUDITF         AUDIT FAILURES QUALIFIER         07020000
         XC    FGAUDITS,FGAUDITS       GLOBAL AUDIT SUCCESS  QUALIFIER  07030000
         XC    FGAUDITF,FGAUDITF       GLOBAL AUDIT FAILURES QUALIFIER  07040000
         XC    FLGDT,FLGDT             FLAG LOGDAYS FIELD               07050000
         MVI   ERASEF,0                ERASE FLAG                       07060000
         MVI   FRASEF,0                ERASE FLAG FIELD NAME            07070000
         MVI   RESFLGC,0               RESFLG FIELD COUNTER             07080000
         MVI   KEYINTC,0               SESSION.KEY_INTERVAL COUNTER     07090000
         MVI   SECLVL,X'FF'            DEFAULT SECURITY LEVEL           07100000
         XC    VOL1(6),VOL1            FIRST VOLUME FROM LIST           07110000
         DROP  R4                                                       07120000
         B     RET0                    Y, RETURN (ACCEPT)               07130000
*                                                                       07140000
********************************************************************    07150000
*        ELEMNTRY FIELD                                            *    07160000
********************************************************************    07170000
*                                                                       07180000
LELEMN   DS    0H                                                       07190000
         L     R3,XPRFNME              RACF FIELD NAME                  07200000
         L     R4,XPRFADRE             RACF FIELD VALUE                 07210000
         L     R5,0(R4)                FIELD LENGTH                     07220000
*                                                                       07230000
         CTSADBG 'ELEMN FIELD=_ VALUE=#/_/$',                          X07240000
               (0(R3),8,?R5,4(R4),?R5,4(R4),?R5),                      X07250000
               LEVEL=(DBGRES,5,6,7),RAREA=RAREA                         07260000
*----------------------------------------------------------------       07270000
*        DATASET, GENERAL RESOURCE FIELDS ROUTER                        07280000
*-----------------------------------------------                        07290000
*        FIX THE COUNTERS                                               07291000
*----------------------------------------------------------------       07292000
         CLC   =CL8'ACSALTR',0(R3)     INFO.ALTER_COUNT                 07293000
         BE    LCNTR                                                    07294000
         CLC   =CL8'ACSCNTL',0(R3)     INFO.CONTROL_COUNT               07294100
         BE    LCNTR                                                    07294200
         CLC   =CL8'ACSUPDT',0(R3)     INFO.UPDATE_COUNT                07294300
         BE    LCNTR                                                    07294400
         CLC   =CL8'ACSREAD',0(R3)     INFO.READ_COUNT                  07294500
         BE    LCNTR                                                    07294600
*-----------------------------------------------                        07294700
*        FIX THE UNIVACS, UACC FIELDS                                   07294800
*----------------------------------------------------------------       07294900
         CLC   =CL8'UNIVACS',0(R3)     UACC                             07295000
         BE    LACCS                                                    07296000
         CLC   =CL8'UACC',0(R3)        UACC                             07297000
         BE    LACCS                                                    07298000
*----------------------------------------------------------------       07299000
         CLC   =CL8'LREFDAT',0(R3)     LAST REFERENCE DATE              07300000
         BE    LREFD                                                    07310000
         CLC   =CL8'LCHGDAT',0(R3)     LAST CHANGE DATE                 07310100
         BE    LCHGD                                                    07310200
         CLC   =CL8'NUMCTGY',0(R3)     COUNT OF CATEGORIES              07310300
         BE    LNUMCTGY                                                 07310400
         CLC   =CL8'SECLEVEL',0(R3)    SEC LEVEL                        07310500
         BE    LSECL                                                    07310600
         CLC   =CL8'SECLABEL',0(R3)    SEC LABEL                        07310700
         BE    LSCLB                                                    07310800
         CLC   =CL8'VERSION',0(R3)     FOR RETURN GENERIC FIELD         07310900
         BE    LVERSION                                                 07311000
         CLC   =CL8'AUDITQS',0(R3)                                      07312000
         BE    LAUDITQS                                                 07313000
         CLC   =CL8'AUDITQF',0(R3)                                      07314000
         BE    LAUDITQF                                                 07315000
         CLC   =CL8'GAUDITQS',0(R3)                                     07316000
         BE    GAUDITQS                                                 07317000
         CLC   =CL8'GAUDITQF',0(R3)                                     07318000
         BE    GAUDITQF                                                 07319000
         CLC   =CL8'AUDIT',0(R3)                                        07320000
         BE    LAUDIT                                                   07330000
         CLC   =CL8'GAUDIT',0(R3)                                       07340000
         BE    LGAUDIT                                                  07350000
         CLC   =CL8'$VOLSER',0(R3)     'VOLUME'                         07360000
         BE    LVOLSD                                                   07370000
*                                                                       07380000
*----------------------------------------------------------------       07390000
*        GENERAL RESOURCE FIELDS ROUTER                                 07400000
*----------------------------------------------------------------       07410000
*                                                                       07420000
         CLC   =CL8'DEFDATE',0(R3)     CREATED DATE                     07430000
         BE    LDEFD                                                    07440000
         CLC   =CL8'CLASTYPE',0(R3)                                     07450000
         BE    LCLASS                                                   07460000
         CLC   =CL8'LOGDAYS',0(R3)                                      07470000
         BE    LLOGDAYS                                                 07471000
         CLC   =CL8'LOGTIME',0(R3)                                      07472000
         BE    LLOGTIME                                                 07473000
         CLC   =CL8'LOGZONE',0(R3)                                      07474000
         BE    LLOGZONE                                                 07475000
         CLC   =CL8'RESFLG',0(R3)                                       07476000
         BE    LRESFLG                                                  07476100
         CLC   =CL8'$GRPCLS',0(R3)     DELAY 'INFO.GROUP_CLASS' FIELD   07476200
         BE    LGRPCLS                                                  07476300
         CLC   =CL8'$MEMCLS',0(R3)     DELAY 'INFO.MEMBER_CLASS' FIELD  07476400
         BE    LMEMCLS                                                  07476500
         CLC   =CL8'KEYINTVL',0(R3)    SESSION.INTERVAL                 07476600
         BE    LSKEYINT                                                 07476700
         CLC   =CL8'KEYDATE',0(R3)     SESSION.INFO.KEY_DATE_CHANGE     07476800
         BE    LKEYDT                                                   07476900
         CLC   =CL8'SSKEY',0(R3)       SSIGNON.KEYENCRYPT               07477000
         BE    LSSKEY                                                   07477100
*                                                                       07477200
*----------------------------------------------------------------       07477300
*        DATASET RESOURCE FIELDS ROUTER                                 07477400
*----------------------------------------------------------------       07477500
*                                                                       07477600
         CLC   =CL8'ENTYPE',0(R3)                                       07477700
         BE    LCLASS                                                   07477800
         CLC   =CL8'CREADATE',0(R3)    CREATED DATE                     07477900
         BE    LDEFD                                                    07478000
         CLC   =CL8'$DERASE',0(R3)     DELAY 'ERASE' FIELD              07479000
         BE    LERASE                                                   07479100
*----------------------------------------------------------------       07479201
*        LDAPBIND BINDPW                               WS10031          07479301
*----------------------------------------------------------------       07479401
         CLC   =CL6'BINDPW',0(R3)                      WS10031          07479601
         BE    LBINDPW                                 WS10031          07479701
         B     RET0                                                     07479801
* --------------------------------------------------------------        07480000
*        WHEN FIRST FOUR BYTES OF SSKEY IS 'MASK'                       07480100
*        THE  RETURNED VALUE OF 'SSIGNON.KEYENCRYPT' = 'N'              07480200
*        ELSE RETURNED VALUE OF 'SSIGNON.KEYENCRYPT' = 'Y'              07480300
* --------------------------------------------------------------        07480400
LSSKEY   DS    0H                                                       07480500
         CLC   4(4,R4),=CL4'MASK'                                       07480600
         BE    LSSKEYM                                                  07480700
         MVC   0(4,R4),=F'1'                                            07481000
         MVI   4(R4),C'Y'                                               07481100
         B     RET0                                                     07481200
LSSKEYM  DS    0H                                                       07481300
         MVC   0(4,R4),=F'1'                                            07481400
         MVI   4(R4),C'N'                                               07481500
         B     RET0                                                     07481600
* --------------------------------------------------------------        07481700
*        THE KEYWORD VALUE OF KEYINTVL RETURNED                         07481800
*        WITH NAME : 'SESSION.INTERVAL' . ALLOWED VALUES : 'NO',        07481900
*        NUMBER IS IN THE RANGE 1-32767. THE FIELD APPEARS TWICE        07482000
*        FIRST TIME FOR RETURNING 'NO', SECOND ONE FOR RETURNING        07482100
*        NUMBERS                                                        07482200
* --------------------------------------------------------------        07482300
LSKEYINT DS    0H                                                       07482400
         SR    R8,R8                                                    07482500
         IC    R8,KEYINTC              SESSION.KEY_INTERVAL COUNTER     07482600
         LA    R8,1(R8)                                                 07482700
         STC   R8,KEYINTC              SESSION.KEY_INTERVAL COUNTER     07482800
         CLI   KEYINTC,1               SESSION.KEY_INTERVAL COUNTER     07482900
         BE    KEYINTCH                KEY_INTERVAL = NO                07483000
*                                                                       07483100
*        KEY_INTERVAL NUMERIC                                           07483200
*                                                                       07483300
         MVC   LCNTRW(2),4(R4)         GET FIELD VALUE                  07483400
         LH    R8,LCNTRW               LOAD FIELD VALUE                 07483500
         LTR   R8,R8                   KEY_INTERVAL = 0 ?               07483600
         BNZ   RET0                    PUT NUMERIC VALUE                07483700
         B     RET4                    DO NOT PUT NUMERIC VALUE         07483800
KEYINTCH DS    0H                      KEY_INTERVAL = NO                07483900
         MVC   LCNTRW(2),4(R4)         GET FIELD VALUE                  07484000
         LH    R8,LCNTRW               LOAD FIELD VALUE                 07484100
         LTR   R8,R8                   KEY_INTERVAL = 0 ?               07484200
         BNZ   RET4                    N, DO NOT PUT TEXT VALUE         07484300
         MVC   0(4,R4),=F'2'           UPDATE FIELD VALUE               07484400
         MVC   4(2,R4),=CL2'NO'        SET FIELD VALUE                  07484500
         B     RET0                                                     07484600
* --------------------------------------------------------------        07484700
*        FIX 'UNIVACS', 'UACC' FIELDS                                   07484800
*        THE ACCESS='NONE' MAY BE IS 'ON' IN SPITE OF                   07484900
*        HIGHER FLAG IS 'ON' TOO. SEE TRANSLATE TABLE UACS1, UACS2      07485000
* --------------------------------------------------------------        07485100
LACCS    DS    0H                                                       07485200
         TM    4(R4),B'00000001'       FLAG 'NONE' IS 'ON' ?            07485300
         BZ    RET0                    N,PUT DATA TO EXTRACT AREA       07485400
         TM    4(R4),B'11111110'       HOW ABOUT OTHER FLAGS ?          07485500
         BZ    RET0                    ALL OTHERS IS 'OFF'.NO PROBLEM   07485600
         NI    4(R4),B'11111000'       SET 'NONE' FLAF TO 'OFF'         07485700
         B     RET0                    PUT DATA TO EXTRACT AREA         07485800
*----------------------------------------------------------------       07485900
*        $VOLSER DELAY FIELD (RETURN FIRST VOLUME FROM LIST)            07486000
*----------------------------------------------------------------       07486100
LVOLSD   DS    0H                                                       07486200
         CLI   VOL1,0                                                   07486300
         BE    RET4                    DO NOT PUT DATA TO EXTRACT AREA  07486400
         MVC   0(4,R4),=F'6'           FIELD LENGTH                     07486500
         MVC   4(6,R4),VOL1            FIELD VALUE                      07486600
         B     RET0                                                     07486700
*----------------------------------------------------------------       07486800
*        FIX THE COUNTERS                                               07486900
*----------------------------------------------------------------       07487000
LCNTR    DS    0H                                                       07487100
         C     R5,=F'2'                LENGTH OF FIELD IS CORRECT ?     07487200
         BNE   RET4                    N, DO NOT PUT DATA               07487300
         MVC   LCNTRW(2),4(R4)         GET FIELD VALUE                  07487400
         LH    R8,LCNTRW               LOAD FIELD VALUE                 07487500
         LPR   R8,R8                                                    07487600
         STH   R8,LCNTRW                                                07487700
*                                                                       07487800
         CTSADBG 'FIX THE COUNTER:#/$/~/$',                            X07487900
               (?R5,4(R4),2,?R8,LCNTRW,2),                             X07488000
               LEVEL=(DBGRES,5,6,7),RAREA=RAREA                         07488100
*                                                                       07488200
         MVC   4(2,R4),LCNTRW          RETURN FIELD VALUE               07488300
         B     RET0                    PUT DATA TO EXTRACT AREA         07488400
*----------------------------------------------------------------       07488500
*        RESFLG                                                         07488600
*        CAN APPEARS THREE TIMES (SEE EXTRACTOR TABLE),                 07488700
*  1 -   FOR EXTRACT FIELD VALUE  'SINGLEDSN'                           07488800
*  2 -   FOR EXTRACT FIELD VALUE  'INFO.AUTOMATIC'                      07488900
*  3 -   FOR EXTRACT FIELD VALUE  'TVTOC'                               07489000
*----------------------------------------------------------------       07489100
LRESFLG  DS    0H                                                       07489200
         C     R5,=F'1'                LENGTH OF FIELD IS CORRECT ?     07489300
         BNE   RET4                    N, DO NOT PUT DATA               07489400
         SR    R8,R8                                                    07489500
         IC    R8,RESFLGC              RESFLG FIELD COUNTER             07489600
         LA    R8,1(R8)                RESFLG = +1                      07489700
         STC   R8,RESFLGC              UPDATE RESFLG FIELD COUNTER      07489800
*                                                                       07489900
         CTSADBG 'RESFLG:$/#/$',                                       X07490000
               (RESFLGC,1,?R5,4(R4),1),                                X07490100
               LEVEL=(DBGRES,5,6,7),RAREA=RAREA                         07490200
*                                                                       07490300
         CLI   RESFLGC,1               'SINGLEDSN'                      07490400
         BE    LRESFLG1                                                 07490500
         CLI   RESFLGC,2               'INFO.AUTOMATIC'                 07490600
         BE    LRESFLG2                                                 07490700
         CLI   RESFLGC,3               'TVTOC'                          07490800
         BE    LRESFLG3                                                 07490900
         B     RET4                    REDANDANT DATA.DO NOT PUT DATA   07491000
*                                                                       07491100
LRESFLG1 DS    0H                      'SINGLEDSN'                      07491200
         TM    4(R4),X'80'                                              07491300
         BO    LRESFLGY                PUT 'YES'                        07491400
         B     LRESFLGN                PUT 'NO'                         07491500
*                                                                       07491600
LRESFLG2 DS    0H                      'INFO.AUTOMATIC'                 07491700
         TM    4(R4),X'40'                                              07491800
         BO    LRESFLGY                PUT 'YES'                        07491900
         B     LRESFLGN                PUT 'NO'                         07492000
*                                                                       07492100
LRESFLG3 DS    0H                      'TVTOC'                          07492200
         TM    4(R4),X'20'                                              07492300
         BO    LRESFLGY                PUT 'YES'                        07492400
         B     LRESFLGN                PUT 'NO'                         07492500
*                                                                       07492600
LRESFLGY DS    0H                      PUT 'YES'                        07492700
         MVC   0(4,R4),=F'1'                                            07492800
         MVI   4(R4),C'Y'                                               07492900
         B     RET0                                                     07493000
*                                                                       07493100
LRESFLGN DS    0H                      PUT 'NO'                         07493200
         MVC   0(4,R4),=F'1'                                            07493300
         MVI   4(R4),C'N'                                               07493400
         B     RET0                                                     07493500
*----------------------------------------------------------------       07493600
*        ERASE                         (DELAYED FIELD)                  07493700
*----------------------------------------------------------------       07493800
LERASE   DS    0H                                                       07493900
         MVC   0(4,R4),=F'1'                                            07494000
         MVC   4(1,R4),ERASEF          ERASE FLAG                       07494100
         B     RET0                                                     07494200
*----------------------------------------------------------------       07494300
*        INFO.GROUP_CLASS              (DELAYED FIELD)                  07494400
*----------------------------------------------------------------       07494500
LGRPCLS  DS    0H                      'INFO.GROUP_CLASS'               07494600
*                                                                       07494700
         CTSADBG 'INFO.GROUP CLASS=_/$',(GRPCLSG,8,GRPCLSG,8),         X07494800
               LEVEL=(DBGRES,5,6,7),RAREA=RAREA                         07494900
*                                                                       07495000
         CLI   GRPCLSG,C' '            FIELD HAS THE VALUE ?            07495100
         BE    RET4                    DO NOT PUT TO EXTRACT AREA       07495200
         MVC   0(4,R4),=F'8'                                            07495300
         MVC   4(8,R4),GRPCLSG         RESOURCE CLASS                   07495400
         B     RET0                                                     07495500
*----------------------------------------------------------------       07495600
*        INFO.MEMBER_CLASS             (DELAYED FIELD)                  07495700
*----------------------------------------------------------------       07495800
LMEMCLS  DS    0H                                                       07495900
*                                                                       07496000
         CTSADBG 'INFO.MEMBER CLASS=_/$',(MBRCLSG,8,MBRCLSG,8),        X07496100
               LEVEL=(DBGRES,5,6,7),RAREA=RAREA                         07496200
*                                                                       07496300
         CLI   MBRCLSG,C' '            FIELD HAS THE VALUE ?            07496400
         BE    RET4                    DO NOT PUT TO EXTRACT AREA       07496500
         MVC   0(4,R4),=F'8'                                            07496600
         MVC   4(8,R4),MBRCLSG         RESOURCE CLASS                   07496700
         B     RET0                                                     07496800
*----------------------------------------------------------------       07496900
*        KEYDATE FIELD RETURNED                                         07497000
*        WITH FIELD NAME 'SESSION.INFO.KEY_DATE_CHANGE'                 07497100
*----------------------------------------------------------------       07497200
LKEYDT   DS    0H                                                       07497300
         CLC   0(4,R4),=F'4'                                            07497400
         BNE   RET4                                                     07497500
         MVC   SKEYDTL(4),=F'3'        FIELD LENGTH                     07497600
         MVC   SKEYDTV(3),5(R4)        FIELD VALUE                      07497700
*                                                                       07497800
         CTSADBG 'ENTERED:  SESSION.KEYDATE=$/$',                      X07497900
               (SKEYDTL,4,SKEYDTV,3),                                  X07498000
               LEVEL=(DBGRES,5,6,7),RAREA=RAREA                         07498100
*                                                                       07498200
         CALL  CTSADTE,(SKDT4)         SESSION.KEY_DATE_CHANGE          07498300
*                                                                       07498400
         CTSADBG 'CONVERTED:SESSION.KEYDATE=$/$/_',                    X07498500
               (SKEYDTL,4,SKEYDTV,8,SKEYDTV,8),                        X07498600
               LEVEL=(DBGRES,5,6,7),RAREA=RAREA                         07498700
*                                                                       07498800
         MVC   0(4,R4),SKEYDTL         NEW FIELD LENGTH (LENGTH=8)      07498900
         MVC   4(8,R4),SKEYDTV         NEW FIELD VALUE                  07499000
         B     RET0                                                     07499100
*----------------------------------------------------------------       07499200
*        DEFDATE                                                        07499300
*----------------------------------------------------------------       07499400
LDEFD    DS    0H                                                       07499500
         CLC   0(4,R4),=F'3'                                            07499600
         BNE   RET4                                                     07499700
         ST    R4,RDT4                                                  07499800
         CALL  CTSADTE,(RDT4)          CREATE DATE                      07499900
         B     RET0                                                     07500000
*----------------------------------------------------------------       07500100
*        LREFDAT                                                        07500200
*----------------------------------------------------------------       07500300
LREFD    DS    0H                                                       07500400
         CLC   0(4,R4),=F'3'                                            07500500
         BNE   RET4                                                     07500600
         ST    R4,RDT4                                                  07500700
         CALL  CTSADTE,(RDT4)          LAST REFERENCE DATE              07500800
         B     RET0                                                     07500900
*----------------------------------------------------------------       07501000
*        LCHGDAT                                                        07501100
*----------------------------------------------------------------       07501200
LCHGD    DS    0H                                                       07501300
         CLC   0(4,R4),=F'3'                                            07501400
         BNE   RET4                                                     07501500
         ST    R4,RDT4                                                  07501600
         CALL  CTSADTE,(RDT4)          LAST CHANGE DATE                 07501700
         B     RET0                                                     07501800
*                                                                       07501900
*----------------------------------------------------------------       07502000
*        AUDIT, GLOBALAUDIT FIELDS                                      07503000
*----------------------------------------------------------------       07504000
*                                                                       07505000
LAUDITQS DS    0H                      AUDIT SUCCESS  QUALIFIER         07506000
         MVI   CAUDIT,0                AUDIT COUNTER                    07507000
         MVC   FAUDITS(1),4(R4)        AUDIT SUCCESS  QUALIFIER         07508000
         B     RET4                                                     07509000
LAUDITQF DS    0H                      AUDIT FAILURES QUALIFIER         07510000
         MVC   FAUDITF(1),4(R4)        AUDIT FAILURES QUALIFIER         07520000
         B     RET4                                                     07530000
GAUDITQS DS    0H                      GLOBAL AUDIT SUCCESS  QUALIFIER  07540000
         MVI   GCAUDIT,0               GAUDIT COUNTER                   07550000
         MVC   FGAUDITS(1),4(R4)       GLOBAL AUDIT SUCCESS  QUALIFIER  07560000
         B     RET4                                                     07570000
GAUDITQF DS    0H                      GLOBAL AUDIT FAILURES QUALIFIER  07580000
         MVC   FGAUDITF(1),4(R4)       GLOBAL AUDIT FAILURES QUALIFIER  07590000
         B     RET4                                                     07600000
LAUDIT   DS    0H                                                       07610000
         TM    4(R4),X'80'             AUDIT ALL ?                      07620000
         BO    AUDALL                                                   07630000
         TM    4(R4),X'40'             AUDIT SUCCESS ?                  07631000
         BO    AUDSUC                                                   07631100
         TM    4(R4),X'20'             AUDIT FAILURES ?                 07631200
         BO    AUDFAIL                                                  07631300
         B     RET0                    AUDIT=NONE                       07631400
AUDFAIL  DS    0H                                                       07631500
         MVC   0(4,R4),=F'2'           LENGTH OF UNIT FIELD             07631600
         MVC   5(1,R4),FAUDITF         AUDIT FAILURES QUALIFIER         07631700
         B     RET0                                                     07631800
AUDSUC   DS    0H                                                       07631900
         MVC   0(4,R4),=F'2'           LENGTH OF UNIT FIELD             07632000
         MVC   5(1,R4),FAUDITS         AUDIT SUCCESS  QUALIFIER         07632100
         B     RET0                                                     07632200
AUDALL   DS    0H                                                       07632300
         CLC   FAUDITS,FAUDITF         SUCCESS QUALIF==FAILURE QUALIF?  07632400
         BE    AUDALL1                 YES. ->AUDIT=ALL                 07632500
         SR    R5,R5                                                    07632600
         IC    R5,CAUDIT                                                07632700
         LA    R5,1(R5)                CAUDIT += 1                      07632800
         STC   R5,CAUDIT                                                07632900
         CLI   CAUDIT,2                                                 07633000
         BE    AUDSUC1                 AUDIT=SUCCESS                    07633100
         CLI   CAUDIT,3                                                 07633200
         BE    AUDFL1                  AUDIT=FAILURES                   07633300
         B     RET4                                                     07633400
AUDSUC1  DS    0H                      AUDIT=SUCCESS                    07633500
         MVC   0(4,R4),=F'2'           LENGTH OF UNIT FIELD             07633600
         MVI   4(R4),X'40'             AUDIT SUCCESS  QUALIFIER         07633700
         MVC   5(1,R4),FAUDITS         AUDIT SUCCESS  QUALIFIER         07633800
         B     RET0                                                     07633900
AUDFL1   DS    0H                      AUDIT=FAILURES                   07634000
         MVC   0(4,R4),=F'2'           LENGTH OF UNIT FIELD             07634100
         MVI   4(R4),X'20'             AUDIT FAILURES QUALIFIER         07634200
         MVC   5(1,R4),FAUDITF         AUDIT FAILURES QUALIFIER         07634300
         B     RET0                                                     07634400
AUDALL1  DS    0H                                                       07634500
         MVC   0(4,R4),=F'2'           LENGTH OF UNIT FIELD             07634600
         MVC   5(1,R4),FAUDITS         AUDIT SUCCESS  QUALIFIER         07634700
         B     RET0                                                     07634800
LGAUDIT  DS    0H                                                       07634900
         TM    4(R4),X'80'             AUDIT ALL ?                      07635000
         BO    GAUDALL                                                  07635100
         TM    4(R4),X'40'             AUDIT SUCCESS ?                  07635200
         BO    GAUDSUC                                                  07635300
         TM    4(R4),X'20'             AUDIT FAILURES ?                 07635400
         BO    GAUDFAIL                                                 07635500
         B     RET0                    AUDIT=NONE                       07635600
GAUDFAIL DS    0H                                                       07635700
         MVC   0(4,R4),=F'2'           LENGTH OF UNIT FIELD             07635800
         MVC   5(1,R4),FGAUDITF        AUDIT FAILURES QUALIFIER         07635900
         B     RET0                                                     07636000
GAUDSUC  DS    0H                                                       07636100
         MVC   0(4,R4),=F'2'           LENGTH OF UNIT FIELD             07636200
         MVC   5(1,R4),FGAUDITS        AUDIT SUCCESS  QUALIFIER         07636300
         B     RET0                                                     07636400
GAUDALL  DS    0H                                                       07636500
         CLC   FGAUDITS,FGAUDITF       SUCCESS QUALIF==FAILURE QUALIF?  07636600
         BE    GAUDALL1                YES. ->AUDIT=ALL                 07636700
         SR    R5,R5                                                    07636800
         IC    R5,GCAUDIT                                               07636900
         LA    R5,1(R5)                CAUDIT += 1                      07637000
         STC   R5,GCAUDIT                                               07637100
         CLI   GCAUDIT,2                                                07637200
         BE    GAUDSUC1                AUDIT=SUCCESS                    07637300
         CLI   GCAUDIT,3                                                07637400
         BE    GAUDFL1                 AUDIT=FAILURES                   07637500
         B     RET4                                                     07637600
GAUDSUC1 DS    0H                      AUDIT=SUCCESS                    07637700
         MVC   0(4,R4),=F'2'           LENGTH OF UNIT FIELD             07637800
         MVI   4(R4),X'40'             AUDIT SUCCESS  QUALIFIER         07637900
         MVC   5(1,R4),FGAUDITS        AUDIT SUCCESS  QUALIFIER         07638000
         B     RET0                                                     07638100
GAUDFL1  DS    0H                      AUDIT=FAILURES                   07638200
         MVC   0(4,R4),=F'2'           LENGTH OF UNIT FIELD             07638300
         MVI   4(R4),X'20'             AUDIT FAILURES QUALIFIER         07638400
         MVC   5(1,R4),FGAUDITF        AUDIT FAILURES QUALIFIER         07638500
         B     RET0                                                     07638600
GAUDALL1 DS    0H                                                       07638700
         MVC   0(4,R4),=F'2'           LENGTH OF UNIT FIELD             07638800
         MVC   5(1,R4),FGAUDITS        AUDIT SUCCESS  QUALIFIER         07638900
         B     RET0                                                     07639000
*                                      RETURN GENERIC FLAG              07640000
LVERSION DS    0H                                                       07650000
         TM    GENFLAG,X'80'                                            07660000
         BO    YESGEN                                                   07670000
         MVC   0(4,R4),=F'1'                                            07680000
         MVI   4(R4),C'N'                                               07690000
         B     RET0                                                     07700000
YESGEN   DS    0H                                                       07710000
         MVC   0(4,R4),=F'1'                                            07720000
         MVI   4(R4),C'Y'                                               07730000
         B     RET0                                                     07740000
*                                                                       07750000
LCLASS   DS    0H                                                       07760000
         MVC   0(4,R4),=F'8'           CLASS NAME LENGTH                07770000
         MVC   4(8,R4),TCLASS                                           07780000
         B     RET0                                                     07790000
*----------------------------------------------------------------       07800000
*        NUMBER OF CATEGORIES                                           07810000
*----------------------------------------------------------------       07820000
LNUMCTGY DS    0H                      NUMBER OF CATEGORIES             07830000
         LR    R6,R5                   FIELD LENGTH                     07840000
         LR    R5,R4                   ADDRESS OF VALUE                 07850000
         LA    R5,4(R5)                BRANCH OVER THE LENGTH           07860000
         MVC   NUMCTGY(4),0(R5)        MOVE VALUE                       07870000
         L     R5,NUMCTGY                                               07880000
         SLL   R5,1                    COUNT *= 2. EACH CODE  2 BYTE    07890000
         L     R6,PTRCTGAS             PTR TO STATIC AREA               07900000
         C     R5,0(R6)                CHECK LENGTH OF STATIC AREA      07910000
         BH    GTDYN                   NOT ENOUGH SPACE TO STATIC AREA  07920000
*                                      BRANCH TO GET DYNAMIC AREA       07930000
* -------------------------------------ENOUGH SPACE TO STATIC AREA      07940000
         MVC   4(4,R6),NUMCTGY         STORE COUNT OF CATEGORIES        07950000
         LA    R6,8(R6)                BRANCH OVER THE SERVICE AREA     07960000
         ST    R6,WORKPTR              STORE WORK PTR                   07970000
         ST    R6,WORKPTR0             STORE WORK PTR                   07980000
         B     RET4                    DO NOT PUT DATA TO EXTRACT AREA  07990000
* -------------------------------------NOT ENOUGH SPACE TO STATIC AREA  08000000
GTDYN    DS    0H                                                       08010000
         LA    R5,8(R5)                LENGTH OF AREA + 8 BYTE          08020000
*                                      1 - ST WORD NOT USE              08030000
*                                      2 - ND WORD COUNT OF CATEGORIES  08040000
         GETMAIN RC,LV=(5)                                              08050000
         LTR   R15,R15                                                  08060000
         BNZ   RET4                                                     08070000
         L     R6,PTRCTGAD             PTR TO STORE DYNAMIC AREA INF    08080000
         ST    R1,0(R6)                STORE ADDRESS                    08090000
         ST    R5,4(R6)                STORE LENGTH                     08100000
         ST    R1,WORKPTR              STORE WORK PTR                   08110000
         MVC   4(4,R1),NUMCTGY         STORE COUNT OF CATEGORIES        08120000
         L     R5,WORKPTR                                               08130000
         LA    R5,8(R5)                BRANCH OVER THE SERVICE AREA     08140000
         ST    R5,WORKPTR              STORE WORK PTR                   08150000
         ST    R5,WORKPTR0             STORE WORK PTR                   08160000
         B     RET4                    DO NOT PUT DATA TO EXTRACT AREA  08170000
*----------------------------------------------------------------       08180000
*        SECLEVEL                                                       08190000
*----------------------------------------------------------------       08200000
LSECL    DS    0H                                                       08210000
         MVC   SECLVL(1),4(R4)         STORE SECURITY LEVEL CODE        08220000
*                                                                       08230000
         CTSADBG 'PENDING SECLEVEL=$',(SECLVL,1),                      X08240000
               LEVEL=(DBGRES,5,6,7),RAREA=RAREA                         08250000
*                                                                       08260000
         B     RET4                    DO NOT PUT TO EXTRACT AREA       08270000
*----------------------------------------------------------------       08280000
*        SECLABEL                                                       08290000
*----------------------------------------------------------------       08300000
LSCLB    DS    0H                                                       08310000
         CLC   TCLASS(8),=CL8'SECDATA' CLASS NAME                       08320000
         BNE   RET0                    PUT DATA TO EXTRACT AREA         08320100
         B     RET4                    DO NOT PUT TO EXTRACT AREA       08320200
*                                                                       08320300
*----------------------------------------------------------------       08320400
*        GENERAL RESOURCE FIELDS PROCESSING                             08320500
*----------------------------------------------------------------       08320600
*                                                                       08320700
LLOGZONE DS    0H                                                       08320800
         CLC   0(4,R4),=F'0'           LENGTH = 0 ?                     08320900
         BE    RET4                    YES                              08321000
         CLC   0(4,R4),=F'3'                                            08322000
         BNE   RET4                                                     08323000
         MVC   TIME(3),4(R4)                                            08324000
         UNPK  TIMEF(5),TIME(3)        ZONE TIME                        08325000
         MVC   ZONE(1),TIMEF+4                                          08325100
         NI    ZONE,X'F0'                                               08325200
         NI    TIMEF+4,X'0F'                                            08325300
         OI    TIMEF+4,X'F0'                                            08325400
         MVC   0(4,R4),=F'4'           NEW FIELD LENGTH MINIMUM         08325500
         CLI   ZONE,X'C0'                                               08325600
         BE    EASTZONE                                                 08325700
         CLI   ZONE,X'D0'                                               08325800
         BE    WESTZONE                                                 08325900
         MVC   4(2,R4),=CL2'? '        UNKNOWN ZONE                     08326000
         B     PUTTIME                                                  08326100
EASTZONE DS    0H                                                       08326200
         MVC   4(2,R4),=CL2'E '        EAST    ZONE                     08326300
         B     PUTTIME                                                  08326400
WESTZONE DS    0H                                                       08326500
         MVC   4(2,R4),=CL2'W '        WEST    ZONE                     08326600
PUTTIME  DS    0H                                                       08326700
         MVC   6(2,R4),TIMEF+1         MOVE HOUERS                      08326800
         CLC   TIMEF+3(2),=CL2'00'                                      08326900
         BE    RET0                                                     08327000
         MVC   0(4,R4),=F'7'           NEW FIELD LENGTH MAXIMUM         08327100
         MVI   9(R4),C'.'                                               08327200
         MVC   10(2,R4),TIMEF+3        MINUTES                          08327300
         B     RET0                                                     08327400
LLOGTIME DS    0H                                                       08327500
         CLC   0(4,R4),=F'0'           LENGTH = 0 ?                     08327600
         BE    LOGANYT                 YES. LOG ANYTIME.                08327700
*                                      IF LENGTH NOT EQ 0. MUST BE 6    08327800
*                                      3 BYTE TIME FROM  DEC PACK       08327900
*                                      3 BYTE TIME TO    DEC PACK       08328000
         CLC   0(4,R4),=F'6'                                            08328100
         BNE   RET4                                                     08328200
         MVC   TIME(3),4(R4)           TIME FROM                        08328300
         UNPK  TIMEF(5),TIME(3)                                         08328400
         MVC   TIME(3),4(R4)           TIME TO                          08328500
         UNPK  TIMET(5),TIME(3)                                         08328600
         MVC   0(4,R4),=F'9'           LENGTH OF RESULT FIELD           08328700
         MVC   4(4,R4),TIMEF+1         TIME FROM                        08328800
         MVI   9(R4),C':'              :                                08328900
         MVC   10(4,R4),TIMET+1        TIME TO                          08329000
         B     RET0                                                     08329100
LOGANYT  DS    0H                      YES. LOG ANYTIME.                08329200
         MVC   0(4,R4),=F'7'                                            08329300
         MVC   4(7,R4),=CL7'ANYTIME'                                    08329400
         B     RET0                                                     08329500
LLOGDAYS DS    0H                                                       08329600
         CLI   FLGDT,0                 FLAG LOGDAYS FIELD.FIRST FIELD?  08329700
         BE    LGD1                    YES                              08329800
*                                      SECOND FIELD LOGDAYS             08329900
         CLI   4(R4),X'82'             WEEKDAYS ?                       08330000
         BE    RET4                    YES. NOT NEED .                  08330100
         CLI   4(R4),X'00'             ANYDAY   ?                       08330200
         BE    RET4                    YES. NOT NEED .                  08330300
         XI    4(R4),X'FF'             CHANGE FLAGS FROM 0 -> 1         08330400
         B     RET0                                                     08330500
LGD1     DS    0H                                                       08330600
         MVI   FLGDT,1                 FLAG LOGDAYS FIELD.              08330700
         B     RET0                                                     08330800
*                                                                       08330900
********************************************************************    08331000
*        LIST FIELD                                                *    08332000
********************************************************************    08333000
*                                                                       08334000
LLIST    DS    0H                                                       08335000
         L     R3,XPRFNML                                               08336000
         L     R4,XPRFADRL                                              08337000
         L     R5,0(R4)                FIELD LENGTH                     08338000
*                                                                       08339000
         CTSADBG 'LIST  FIELD=_ VALUE=#/_/$',                          *08340000
               (0(R3),8,?R5,4(R4),?R5,4(R4),?R5),                      *08350000
               LEVEL=(DBGRES,5,6,7),RAREA=RAREA                         08360000
*                                                                       08370000
         CLC   =CL8'CATEGORY',0(R3)    CATEGORIES                       08380000
         BE    LCATEGR                                                  08390000
         CLC   =CL8'FLDNAME',0(R3)     FLDNAME                          08400000
         BE    LFLDNAME                                                 08410000
         CLC   =CL8'FLDFLAG',0(R3)     FLDFLAG                          08420000
         BE    LFLDFLAG                                                 08430000
         CLC   =CL8'TVTOCCRD',0(R3)                                     08440000
         BE    LTVTCD                                                   08450000
         CLC   =CL8'MEMLST',0(R3)      MEMBER LIST                      08460000
         BE    LMLISTG                                                  08470000
         CLC   =CL8'VOLSER',0(R3)      'VOLUME_LIST'                    08480000
         BE    LVOLS                                                    08481000
         B     RET0                    PUT DATA TO EXTRACT AREA         08482000
*----------------------------------------------------------------       08483000
*        VOLUME_LIST                                                    08484000
*        KEEP FIRST FROM VOLUME LIST FOR RETURN 'VOLUME' FIELD          08485000
*----------------------------------------------------------------       08486000
LVOLS    DS    0H                                                       08487000
         CLI   VOL1,0                                                   08488000
         BNE   RET0                    PUT DATA TO EXTRACT AREA         08488100
         MVC   VOL1(6),4(R4)           SAVE FIRST VOLSER VALUE          08488200
         B     RET0                    PUT DATA TO EXTRACT AREA         08488300
*----------------------------------------------------------------       08488400
*        MEMLST            (MEMBER LIST)                                08488500
*        STRUCTURE OF MEMBER FOR 'SECDATA' : 2 BYTES HEX CODE           08488600
*                                            TEXT                       08488700
*                     NOTE:WHEN FIRST BYTE OF TEXT IS BLANK , THIS      08488800
*                     A SPECIAL MEMBER FOR RACF INTERNAL USE            08488900
*        STRUCTURE OF MEMBER FOR OTHERS    : TEXT                       08489000
*----------------------------------------------------------------       08489100
LMLISTG  DS    0H                                                       08489200
         CLC   TCLASS(8),=CL8'SECDATA' CLASS NAME                       08489300
         BE    LMLISSDT                SECDATA RESOURCE CLASS           08489400
         CLC   TCLASS(8),=CL8'PROGRAM' CLASS NAME                       08489500
         BE    LMLISPRG                PROGRAM RESOURCE CLASS           08489600
         B     RET0                    PUT DATA TO EXTRACT AREA         08489700
*                                                                       08489800
LMLISSDT DS    0H                      SECDATA RESOURCE CLASS           08489900
*                                                                       08490000
*        CATEGORY, SECLEVEL PROFILE NAMES PROCESSING                    08490100
*                                                                       08490200
         CLC   RSENTRY(8),=CL8'CATEGORY'                                08490300
         BE    LMLISTCT                CATEGORY PROFILE PROCESSING      08490400
         CLC   RSENTRY(8),=CL8'SECLEVEL'                                08490500
         BE    LMLISTLV                SECLEVEL PROFILE PROCESSING      08490600
         B     RET4                    UNKNOWN ENTRY NAME FOR SECDATA   08490700
*                                                                       08490800
*        CATEGORY PROFILE PROCESSING                                    08490900
*        FORMAT :  2 BYTES - CODE OF CATEGORY                           08491000
*                  CATEGORY NAME                                        08491100
*                                                                       08491200
LMLISTCT DS    0H                      CATEGORY PROFILE PROCESSING      08491300
         CLI   6(R4),X'40'             FIRST BYTE CATEG. NAME=" "       08491400
         BE    RET4                    YES . SPECIAL RACF NAME=HWS !    08491500
*                                                                       08491600
*        UPDATE LENGTH OF MEMBER                                        08491700
*                                                                       08491800
         S     R5,=F'2'                TWO BYTES CODE OF MEMBER         08491900
         ST    R5,0(R4)                SET NEW LENGTH                   08492000
*                                                                       08492100
         CTSADBG 'MEMBER=#/_/$',                                       *08492200
               (?R5,6(R4),?R5,6(R4),?R5),                              *08492300
               LEVEL=(DBGRES,5,6,7),RAREA=RAREA                         08492400
*                                                                       08492500
         BCTR  R5,0                    DECR FOR EXECUTE COMMAND         08492600
         LTR   R5,R5                                                    08492700
         BZ    RET4                                                     08492800
         EX    R5,SVMEMBR              SAVE MEMBER VALUE                08492900
         EX    R5,RTMEMBR              RESTORE MEMBER VALUE             08493000
         B     RET0                                                     08493100
*                                                                       08493200
*        SECLEVEL PROFILE PROCESSING                                    08493300
*        FORMAT :  2 BYTES - CODE OF SECLEVEL                           08493400
*                  SECLEVEL NAME                                        08493500
*                                                                       08493600
LMLISTLV DS    0H                      SECLEVEL PROFILE PROCESSING      08493700
         MVC   SLVLC(2),4(R4)          GET SECLEVEL CODE                08493800
*                                                                       08493900
*        CONVERT SECLEVEL CODE TO TEXT                                  08494000
*                                                                       08494100
         LH    R7,SLVLC                LOAD SECLEVEL CODE               08494200
         CVD   R7,PACDECL                                               08494300
         UNPK  NMBRL(9),PACDECL(8)                                      08494400
         OI    NMBRL+8,X'F0'           FIX UP LAST DIGIT                08494500
*                                                                       08494600
*        CALCULATE DATA LENGTH WITHOUT LEADING ZEROES                   08494700
*                                                                       08494800
         LA    R7,NMBRL+8                                               08494900
         LA    R8,9                    MAX DATA LENGTH                  08495000
         LR    R1,R7                                                    08495100
         BCTR  R8,0                    DECR FOR EXECUTE COMMAND         08495200
         EX    R8,SRCHNZ               SEARCH FIRST NON ZERO BYTE       08495300
         LR    R9,R1                   ADDR OF DATA                     08495400
         SR    R7,R1                   DATA LENGTH - 1                  08495500
         S     R5,=F'2'                TWO BYTES CODE OF MEMBER         08495600
         LA    R7,1(R7)                DATA LENGTH + 1                  08495700
*                                                                       08495800
         CTSADBG 'SECLEVEL=#/_/$ CODE=$/#/_',                          *08495900
               (?R5,6(R4),?R5,6(R4),?R5,SLVLC,2,?R7,0(R9),?R7),        *08496000
               LEVEL=(DBGRES,5,6,7),RAREA=RAREA                         08496100
*                                                                       08496200
         BCTR  R5,0                    DECR FOR EXECUTE COMMAND         08496300
         LTR   R5,R5                                                    08496400
         BZ    RET4                                                     08496500
*                                                                       08496600
*        CREATE SECLEVEL IN FORM : SECLEVEL/CODE                        08496700
*                                                                       08496800
         EX    R5,SVMEMBR              SAVE MEMBER VALUE                08496900
         LA    R5,1(R5)                RESTORE FIELD LENGTH             08497000
         LA    R8,MMLST                ADDR OF MEMBER LIST VALUE        08497100
         AR    R8,R5                   SKIP MEMBER NAME                 08497200
         MVI   0(R8),C'/'              PUT SEPARATOR                    08497300
         LA    R8,1(R8)                DATA ADDR    += 1                08497400
         LA    R5,1(R5)                TOTAL LENGTH += 1                08497500
         BCTR  R7,0                    DATA LENGTH - 1                  08497600
         EX    R7,MVLVLC               MOVE SEC LEVEL CODE              08497700
         LA    R7,1(R7)                RESTORE LENGTH                   08497800
         AR    R5,R7                   CALCULATE TOTAL LENGTH           08497900
         BCTR  R5,0                    DECR FOR EXECUTE COMMAND         08498000
         EX    R5,RTMEMBR              RETURN MEMBER VALUE              08498100
         LA    R5,1(R5)                LENGTH += 1                      08498200
         ST    R5,0(R4)                SET NEW LENGTH                   08498300
         B     RET0                                                     08498400
*                                                                       08498500
*        PROGRAM RESOURCE CLASS (MEMBER LIST) PROCESSING                08498600
*        FORMAT IS: FLAG   - X'80' -  NOPADCHK, X'00' - PADCHK          08498700
*                   VOLSER - LENGTH(6)                                  08498800
*                   DATASET NAME LENGTH                                 08498900
*                                                                       08499000
LMLISPRG DS    0H                      PROGRAM RESOURCE CLASS           08499100
         LR    R6,R5                                                    08499200
         BCTR  R6,0                    FIRST BYTE PADCHK FLAG           08499300
         S     R6,=F'6'                SIX BYTES VOLSER                 08499400
*                                                                       08499500
         CTSADBG 'MEMBER=$/_/#/_/$',                                   *08499600
               (4(R4),1,5(R4),6,?R6,11(R4),?R6,11(R4),?R6),            *08499700
               LEVEL=(DBGRES,5,6,7),RAREA=RAREA                         08499800
*                                                                       08499900
         BCTR  R6,0                    DECR FOR EXECUTE COMMAND         08500000
         LTR   R6,R6                                                    08500100
         BZ    RET4                                                     08500200
         EX    R6,SVMEMDS              SAVE MEMBER VALUE (DSN)          08500300
         MVC   MMLSTVOL(6),5(R4)       SAVE VOLSER FROM MEMBER LIST     08500400
         LA    R8,MMLST                ADDR OF MEMBER LIST VALUE        08500500
         LA    R6,1(R6)                RESTORE DSN NAME LENGTH          08500600
         AR    R8,R6                                                    08500700
         MVI   0(R8),C'/'              SET SEPARATOR                    08500800
         LA    R8,1(R8)                UPDATE ADDRESS                   08500900
         LA    R6,1(R6)                UPDATE TOTAL LENGTH              08501000
*                                                                       08502000
*        CALCULATE LENGTH OF VOLUME AND PUT IT                          08502100
*                                                                       08502200
         L     R1,=A(MMLSTVOL+6)       SET DEFAULT ADDR                 08502300
         TRT   MMLSTVOL(6),BLNKTAB     LOCATE FIRST BLANK               08502400
         S     R1,=A(MMLSTVOL)         DETERMINE LENGTH                 08502500
         LTR   R1,R1                   LENGTH = 0 ?                     08502600
         BZ    RET4                    Y, SKIP                          08502700
         BCTR  R1,0                    DECR FOR EXECUTE CMD             08502800
         EX    R1,MVLSTVOL             MOVE VOLSER                      08502900
         LA    R1,1(R1)                RESTORE LENGTH                   08503000
         AR    R8,R1                   UPDATE ADDRESS                   08503100
         AR    R6,R1                   UPDATE TOTAL LENGTH              08503200
*                                                                       08503300
         MVI   0(R8),C'/'              SET SEPARATOR                    08503400
         LA    R8,1(R8)                UPDATE ADDRESS                   08503500
         LA    R6,1(R6)                UPDATE TOTAL LENGTH              08503600
*                                                                       08503700
*        PADCHK FLAG PROCESSING                                         08503800
*                                                                       08503900
         TM    4(R4),X'80'                                              08504000
         BO    NOPADCHK                NOPADCHK                         08504100
         MVC   0(6,R8),=CL6'PADCHK'                                     08504200
         A     R8,=F'6'                UPDATE ADDRESS                   08504300
         A     R6,=F'6'                UPDATE TOTAL LENGTH              08504400
         B     LMLSPRGP                PUT BACK RESULT                  08504500
NOPADCHK DS    0H                      NOPADCHK                         08504600
         MVC   0(8,R8),=CL8'NOPADCHK'                                   08504700
         A     R8,=F'8'                UPDATE ADDRESS                   08504800
         A     R6,=F'8'                UPDATE TOTAL LENGTH              08504900
         B     LMLSPRGP                PUT BACK RESULT                  08505000
*                                                                       08505100
*        PUT BACK DATASET NAME                                          08505200
*                                                                       08505300
LMLSPRGP DS    0H                      PUT RESULT BACK                  08505400
*                                                                       08505500
         CTSADBG 'RESULT=#/_/$',                                       *08505600
               (?R6,MMLST,?R6,MMLST,?R6),                              *08505700
               LEVEL=(DBGRES,5,6,7),RAREA=RAREA                         08505800
*                                                                       08505900
         BCTR  R6,0                    DECR FOR EXECUTE CMD             08506000
         EX    R6,RTMEMBR              RESTORE MEMBER VALUE             08506100
         LA    R6,1(R6)                RESTORE LENGTH                   08506200
         ST    R6,0(R4)                SET NEW LENGTH                   08506300
         B     RET0                                                     08506400
*----------------------------------------------------------------       08506500
*        TVTOCCRD                                                       08506600
*----------------------------------------------------------------       08506700
LTVTCD   DS    0H                                                       08506800
         CLC   0(4,R4),=F'3'                                            08506900
         BNE   RET4                                                     08507000
         ST    R4,RDT4                                                  08507100
         CALL  CTSADTE,(RDT4)          CREATE DATE                      08507200
         B     RET0                                                     08507300
* ---------------------------------------------------------             08507400
*        FLDNAME                                                        08507500
*        EXTRACT 'EOSFLAG' FIELD ONLY.                                  08507600
*        THE FLDFLAG VALUE OF THIS FIELD                                08507700
*        IS EQUAL OF ERASE FIELD VALUE.                                 08507800
* ---------------------------------------------------------             08507900
LFLDNAME DS    0H                                                       08508000
         CLC   4(7,R4),=CL7'EOSFLAG'   ERASE FIELD ?                    08509000
         BNE   RET4                    DO NOT PUT DATA TO EXTRACT AREA  08510000
         MVI   FRASEF,1                ERASE FLAG FIELD NAME            08520000
         B     RET4                    DO NOT PUT DATA TO EXTRACT AREA  08520100
* --------------------------------------------------------              08520200
*        FLDFLAG                                                        08520300
*        IF FOUND 'EOSFLAG' FIELD GET THE VALUE.                        08520400
* --------------------------------------------------------              08520500
LFLDFLAG DS    0H                                                       08520600
         CLI   FRASEF,1                ERASE FLAG FIELD FLAG ?          08520700
         BNE   RET4                    DO NOT PUT DATA TO EXTRACT AREA  08520800
         MVC   ERASEF(1),4(R4)         ERASE FLAG                       08520900
         MVI   FRASEF,0                RESET ERASE FLAG FIELD           08521000
         B     RET4                    DO NOT PUT DATA TO EXTRACT AREA  08521100
* --------------------------------------------------------              08521200
*        CATEGORIES LIST                                                08521300
* --------------------------------------------------------              08521400
LCATEGR  DS    0H                                                       08521500
         LR    R6,R5                   FIELD LENGTH                     08521600
         LR    R5,R4                   ADDRESS OF VALUE                 08521700
         LA    R5,4(R5)                BRANCH OVER THE LENGTH           08521800
         XC    CATEGORY,CATEGORY                                        08521900
         MVC   CATEGORY(2),0(R5)       MOVE VALUE                       08522000
         L     R6,WORKPTR                                               08523000
         LTR   R6,R6                                                    08524000
         BZ    RET4                    WORK PTR = 0 ? WHY ?             08525000
         MVC   0(2,R6),0(R5)                                            08526000
         LA    R6,2(R6)                INCR WORK PTR                    08527000
         ST    R6,WORKPTR              STORE CURR ADDR FOR STORE CATEG  08528000
         B     RET4                    DON'T PUT CATEG CODE TO OUTPUT   08529000
* --------------------------------------------------------              08529101
*        LDAP BINDPW                                   WS10031          08529201
* --------------------------------------------------------              08529301
LBINDPW  DS    0H                                      WS10031          08529401
         CLC   0(4,R4),=F'0'                           WS10031          08529701
         BE    LBINDPW1                                WS10031          08529801
         MVC   0(4,R4),=F'3'                           WS10031          08529901
         MVC   4(3,R4),=CL4'YES'                       WS10031          08530001
         CTSADBG 'BINDPW IS SET TO YES',               WS10031         *08530101
               LEVEL=(DBGRES,5,6,7),RAREA=RAREA        WS10031          08530201
         B     RET0                                    WS10031          08530301
LBINDPW1 DS    0H                                                       08530401
         MVC   0(4,R4),=F'2'                           WS10031          08530501
         MVC   4(2,R4),=CL4'NO'                        WS10031          08530601
         CTSADBG 'BINDPW IS SET TO NO',                WS10031         *08530701
               LEVEL=(DBGRES,5,6,7),RAREA=RAREA        WS10031          08530801
         B     RET0                                    WS10031          08530901
* --------------------------------------------------------              08531001
*        END                                                            08540000
* --------------------------------------------------------              08550000
LEND     DS    0H                                                       08560000
         B     RET0                                                     08570000
* --------------------------------------------------------              08580000
*        EXITING                                                        08590000
* --------------------------------------------------------              08600000
RET0     DS    0H                                                       08610000
         SR    R15,R15                                                  08620000
         B     RETT                                                     08630000
RET4     DS    0H                                                       08640000
         LA    R15,4                                                    08650000
         B     RETT                                                     08660000
RET8     DS    0H                                                       08670000
         LA    R15,8                                                    08680000
         B     RETT                                                     08690000
RETT     DS    0H                                                       08700000
         BRTRN (15)                                                     08710000
********************************************************************    08720000
*        W O R K  A R E A  A N D   C O N S T A N T S                    08730000
********************************************************************    08740000
RAREA    DS    64F                                                      08750000
RESFLGC  DS    CL1                     RESFLG FIELD COUNTER             08760000
SECLVL   DS    CL1                     SECURITY LEVEL                   08770000
DBGRES   DS    CL1                     DEBUG LEVEL                      08780000
PACDECL  DS    D                       WORK VAR FOR CONVERT TO TEXT     08790000
NUMCTGY  DS    F                       NUMBER OF CATEGORIES             08800000
CATEGORY DS    F                       CATEGORY                         08810000
PTRCTGAS DS    F                       PTR TO CATEGORIES AREA STATIC    08820000
PTRCTGAD DS    F                       PTR TO CATEGORIES AREA DYNAMIC   08830000
WORKPTR  DS    F                       WORK PTR                         08840000
WORKPTR0 DS    F                       WORK PTR START VALUE             08850000
RDT4     DS    F                       WORK VAR                         08860000
SLVLC    DS    H                       SECLEVEL CODE                    08870000
GENFLAG  DS    CL1                     GENERIC FLAG                     08880000
FAUDITS  DS    CL1                     AUDIT SUCCESS  QUALIFIER         08890000
FAUDITF  DS    CL1                     AUDIT FAILURES QUALIFIER         08900000
FGAUDITS DS    CL1                     GLOBAL AUDIT SUCCESS  QUALIFIER  08910000
FGAUDITF DS    CL1                     GLOBAL AUDIT FAILURES QUALIFIER  08920000
CAUDIT   DS    CL1                     AUDIT COUNTER                    08930000
GCAUDIT  DS    CL1                     GLOBALAUDIT COUNTER              08940000
FLGDT    DS    CL1                     FLAG LOGDAYS FIELD               08950000
ZONE     DS    CL1                     TIME ZONE                        08960000
ERASEF   DS    CL1                     ERASE FLAG                       08970000
FRASEF   DS    CL1                     ERASE FLAG FIELD NAME            08980000
KEYINTC  DS    CL1                     SESSION.KEY_INTERVAL COUNTER     08990000
*                                                                       09000000
SKDT4    DC    A(SKEYDATE)             SESSION.KEY_DATE_CHANGE          09010000
SKEYDATE DS    0H                      SESSION.KEY_DATE_CHANGE          09011000
SKEYDTL  DS    CL4                     FIELD LENGTH                     09011100
SKEYDTV  DS    CL20                    FIELD VALUE                      09011200
*                                                                       09011300
TCLASS   DS    CL8                     CLASS NAME                       09011400
RSENTRY  DS    CL8                     ENTRY NAME FIRST 8 BYTES         09011500
NMBRL    DS    CL9                     WORK VAR FOR CONVERT TO TEXT     09011600
TIME     DS    CL3                     TIME                             09011700
TIMEF    DS    CL5                     TIME FROM                        09011800
TIMET    DS    CL5                     TIME TO                          09011900
LCNTRW   DS    H                       COUNTERS                         09012000
GRPCLSG  DS    CL8                     'INFO.GROUP_CLASS' FIELD VALUE   09012100
MBRCLSG  DS    CL8                     'INFO.MEMBER_CLASS' FIELD VALUE  09012200
VOL1     DS    CL6                     FIRST VOLUME FROM LIST           09012300
MMLST    DS    CL256                   MEMBER LIST VALUE                09012400
MMLSTVOL DS    CL6                     VOLSER FROM MEMBER LIST          09012500
SVMEMBR  MVC   MMLST(0),6(R4)          SAVE MEMBER VALUE                09012600
SVMEMDS  MVC   MMLST(0),11(R4)         SAVE MEMBER VALUE (DSN)          09012700
RTMEMBR  MVC   4(0,R4),MMLST           RETURN MEMBER VALUE              09012800
MVLVLC   MVC   0(0,R8),0(R9)           MOVE SEC LEVEL CODE              09012900
MVLSTVOL MVC   0(0,R8),MMLSTVOL        ADD VOLSER FROM MEMBER LIST      09013000
*                                                                       09013100
NZEROTAB DC    256X'FF'                                                 09013200
         ORG   NZEROTAB+C'0'                                            09013300
         DC    X'00'                                                    09013400
         ORG   ,                                                        09013500
*                                                                       09013600
BLNKTAB  DC    256AL1(00)                                               09013700
         ORG   BLNKTAB+X'40'                                            09013800
         DC    X'FF'                                                    09013900
         ORG   ,                                                        09014000
*                                                                       09015000
SRCHNZ   TRT   NMBRL(0),NZEROTAB       SEARCH FIRST NON ZERO BYTE       09016000
********************************************************************    09017000
*       W O R K  A R E A  A N D   C O N S T A N T S                     09018000
********************************************************************    09019000
         LTORG                                                          09020000
         DROP  ,                                                        09030000
*                                                                       09040000
****************************************************************        09050000
*                                                              *        09060000
* FUNCTION    : DETERMINE SEC LEVEL AND CATEGORIES INFORMATION *        09070000
*                                                              *        09080000
****************************************************************        09090000
*                                                                       09100000
TESTSCDT BEGIN                                                          09110000
*                                                                       09120000
*        ADDRESSABILITY MAIN PARAMETERS                                 09130000
*                                                                       09140000
         USING PARMM,R1                                                 09150000
         L     R2,XPROPCD                                               09160000
         CLI   0(R2),XPRSTRT          START  -  BEFORE READ RECORD FROM 09170000
         BE    LSTARTS                          RACF DATA BASE          09180000
         CLI   0(R2),XPRENTY          ENTRY  -  AFTER  READ RECORD FROM 09190000
         BE    LENTRYS                          RACF DATA BASE          09200000
         CLI   0(R2),XPRELMN          ELEMN  -  ELEMENTARY DATA         09210000
         BE    LELEMNS                                                  09220000
         CLI   0(R2),XPRLIST          LIST   -  LIST DATA               09230000
         BE    LLISTS                                                   09240000
         CLI   0(R2),XPREND           END    -  BEFORE RETURN FROM      09250000
         BE    LENDS                            EXTRACTOR               09260000
         B     RET0S                                                    09270000
*                                                                       09280000
********************************************************************    09290000
*        START                                                          09300000
********************************************************************    09310000
*                                                                       09320000
LSTARTS  DS    0H                                                       09330000
         MVI   YCTGF,0                 YES-CATEGORIES-FLAG              09340000
         MVI   YSLVF,0                 YES-SECLEVELS-FLAG               09350000
         MVI   GSLVF,0                 JUST-GETTING-SECLEVELS-FLAG      09360000
         XC    TSCLV,TSCLV             TEXT SEC LEVEL                   09370000
         B     RET0S                                                    09380000
*                                                                       09390000
********************************************************************    09400000
*        ENTRY                                                          09410000
********************************************************************    09420000
*                                                                       09430000
LENTRYS  DS    0H                                                       09440000
         L     R3,XPRENTRY             FIELD ADDR                       09450000
         L     R5,0(R3)                ENTRY NAME LENGTH                09460000
         L     R4,XPRPRFXY             FIELD VALUE                      09470000
         L     R4,0(R4)                                                 09480000
         USING RETAREA,R4                                               09490000
*                                                                       09500000
         CTSADBG 'ENTRY=#/_ FLAG=$',                                   X09510000
               (?R5,4(R3),?R5,XPFFLGS,1),                              X09520000
               LEVEL=(DBGGRS,6,7),RAREA=RAREAS                          09530000
*                                                                       09540000
         DROP  R4                                                       09550000
*                                      R5 = FIELD LENGTH                09560000
         LA    R3,4(R3)                BRANCH OVER THE LENGTH           09570000
         CLC   =CL8'CATEGORY',0(R3)                                     09580000
         BE    YCTG                                                     09590000
         CLC   =CL8'SECLEVEL',0(R3)                                     09600000
         BE    YSLV                                                     09610000
         B     RET0S                                                    09620000
YCTG     DS    0H                                                       09630000
         MVI   YCTGF,1                                                  09640000
         MVI   YSLVF,0                                                  09650000
         B     RET0S                                                    09660000
YSLV     DS    0H                                                       09670000
         MVI   YCTGF,0                                                  09680000
         MVI   YSLVF,1                                                  09690000
         B     RET0S                                                    09700000
*                                                                       09710000
********************************************************************    09720000
*        ELEMNTRY FIELD                                                 09730000
********************************************************************    09740000
*                                                                       09750000
LELEMNS  DS    0H                                                       09760000
         L     R3,XPRFNME                                               09770000
         L     R4,XPRFADRE                                              09780000
         L     R5,0(R4)                FIELD LENGTH                     09790000
         CTSADBG 'ELEMN FIELD=_ VALUE=#/_/$',                          *09800000
               (0(R3),8,?R5,4(R4),?R5,4(R4),?R5),                      *09810000
               LEVEL=(DBGGRS,6,7),RAREA=RAREAS                          09820000
         CLC   =CL8'CLASTYPE',0(R3)    FOR STORE INFO.UNKNOWN CATEG     09830000
         BE    LCLST                                                    09840000
         CLC   =CL8'LEVEL',0(R3)       FOR STORE SEC.LEVEL VALUE        09850000
         BE    LLEV                                                     09860000
         B     RET0S                                                    09870000
LLEV     DS    0H                                                       09880000
         CLI   YSLVF,1                 SEC. LEVEL ENTRY ?               09890000
         BNE   RET4S                   NO                               09900000
         CLI   YCTGF,1                 CATEG. ENTRY     ?               09910000
         BE    RET4S                   YES                              09920000
         CLI   SCLV,X'FF'              DEFAULT SEC. LEVEL ?             09930000
         BE    RET4S                   Y, DON'T PUT DATA                09940000
         CLC   TSCLV(4),=F'0'          SEC.LEVEL FOUND ?                09950000
         BNE   LLEVF                   Y, PUT IT                        09960000
*                                                                       09970000
*        CONVERT SEC LEVEL CODE TO TEXT                                 09980000
*                                                                       09990000
         SR    R5,R5                                                    10000000
         IC    R5,SCLV                                                  10010000
         LTR   R5,R5                   SEC LEVEL =0                     10020000
         BZ    RET4S                   Y, DON'T PUT DATA                10030000
         CVD   R5,PACDEC                                                10040000
         UNPK  NMBR(9),PACDEC(8)                                        10050000
         OI    NMBR+8,X'F0'            FIX UP LAST DIGIT                10060000
         MVC   TSCLV(4),=F'3'          RESULT LENGTH                    10070000
         MVC   TSCLV+4(3),NMBR+6       MOVE RESULT                      10080000
*                                                                       10090000
LLEVF    DS    0H                      PUT SEC LEVEL TO EXTRACT AREA    10100000
         L     R5,TSCLV                LENGTH SEC.LEVEL TXT             10110000
*                                                                       10120000
         CTSADBG 'RESULT SEC.LEVEL=#/_/$',                             *10130000
               (?R5,TSCLV+4,?R5,TSCLV+4,?R5),                          *10140000
               LEVEL=(DBGGRS,6,7),RAREA=RAREAS                          10150000
*                                                                       10160000
         LA    R5,3(R5)                LENGTH=LENGTH + 4 - 1            10170000
         EX    R5,MOVSLV               MOVE SEC LEVEL TO EXTRACT AREA   10180000
         B     RET0S                   PUT DATA TO EXTRACT AREA         10190000
*                                                                       10200000
*                                                                       10210000
*        CREATE  INFO.UNKNOWNCAT INFORMATION                            10220000
*                                                                       10230000
*                                                                       10240000
LCLST    DS    0H                                                       10250000
         CLI   YSLVF,1                 SEC. LEVEL ENTRY ?               10260000
         BE    RET4S                   YES, EXIT NOT FOR THIS ENTRY     10270000
         CLI   YCTGF,1                 CATEG. ENTRY     ?               10280000
         BNE   RET4S                   NO , RETURN                      10290000
         L     R7,AREAPTR              CURRENT USING WORK PTR           10300000
*                                      FOR STORE CATEG CODES            10310000
         LA    R7,4(R7)                BRANCH OVER THE MAX LENGTH       10320000
         L     R8,0(R7)                GET NUMBER OF CATEGORIES         10330000
         LTR   R8,R8                                                    10340000
         BZ    RET4S                   NUMBERS OF CATEG = 0. WHY ?      10350000
         LA    R7,4(R7)                BRANCH OVER THE COUNTER          10360000
         SR    R9,R9                   COUNTER UNKNOWN CATEGORIES       10370000
LPCTGF0  DS    0H                                                       10380000
         CLC   0(2,R7),=XL2'FFFF'      CATEG. WAS GETTING ?             10390000
         BE    LPCTGF1                 Y, SKIP                          10400000
         LA    R9,1(R9)                INCR COUNT UNKNOWN CATEG.        10410000
LPCTGF1  DS    0H                                                       10420000
         LA    R7,2(R7)                GOTO NEXT CATEG. CODE            10430000
         BCT   R8,LPCTGF0              LOOP THROUGH CATEG               10440000
         LTR   R9,R9                                                    10450000
         BZ    RET4S                   UNKNOWN. CATEG. NOT FOUND        10460000
         MVC   0(4,R4),=F'4'           LENGTH OF COUNTER                10470000
         ST    R9,4(R4)                STORE COUNTER                    10480000
*                                                                       10490000
         CTSADBG 'INFO.UNKNOWNCATEG=#/$',(?R9,4(R4),4),                *10500000
               LEVEL=(DBGGRS,6,7),RAREA=RAREAS                          10510000
*                                                                       10520000
         B     RET0S                   PUT DATA TO EXTRACT AREA         10530000
*                                                                       10540000
********************************************************************    10550000
*        LIST FIELD                                                     10560000
********************************************************************    10570000
*                                                                       10580000
LLISTS   DS    0H                                                       10590000
         L     R3,XPRFNML                                               10600000
         L     R4,XPRFADRL                                              10610000
         L     R5,0(R4)                FIELD LENGTH                     10620000
*                                                                       10630000
         CTSADBG 'LIST FIELD=_ VALUE=#/_/$',                           *10640000
               (0(R3),8,?R5,4(R4),?R5,4(R4),?R5),                      *10650000
               LEVEL=(DBGGRS,6,7),RAREA=RAREAS                          10660000
*                                                                       10670000
         CLC   =CL8'MEMLST',0(R3)      CATEGORIES                       10680000
         BE    LMEMLST                                                  10690000
         B     RET4S                   INTERESTING ONLY CATEGORIES      10700000
LMEMLST  DS    0H                      CATEGORIES LIST                  10710000
         CLI   YCTGF,1                 THIS LIST OF CATEGORIES ?        10720000
         BNE   MEMLLV                  N, LIST OF SEC LEVELS            10730000
*                                                                       10740000
*-----------------------------------------------------------------      10750000
*        CATEGORIES                                                     10760000
*-----------------------------------------------------------------      10770000
*                                                                       10780000
MEMLG    DS    0H                      Y, LIST OF CATEGORIES            10790000
         L     R7,AREAPTR                                               10800000
         LA    R7,4(R7)                SKIP THE MAX LENGTH              10810000
         L     R8,0(R7)                GET NUMBER OF CATEGORIES         10820000
         LTR   R8,R8                                                    10830000
         BZ    RET4S                   NUMBERS OF CATEG = 0. WHY ?      10840000
*                                      EXPLANATION 3(R4) :              10850000
*                                      4    - FIELD LENGTH              10860000
*                                      1-2  - CATEG. CODE               10870000
*                                      3... - CATEG. NAME               10880000
         CLI   6(R4),X'40'             FIRST BYTE CATEG. NAME=" "       10890000
         BE    RET4S                   YES . SPECIAL RACF NAME=HWS !    10900000
         LA    R7,4(R7)                SKIP THE COUNTER                 10910000
LPCTG0   DS    0H                                                       10920000
*                                                                       10930000
         CTSADBG 'SEARCH CATEG NAME:TBL CODE=$ CURRENT RACF CODE=$',   110940000
               (0(R7),2,4(R4),2),                                      210950000
               LEVEL=(DBGGRS,6,7),RAREA=RAREAS                          10960000
*                                                                       10970000
         CLC   0(2,R7),4(R4)           COMPARE CODES OF CATEGORIES      10980000
         BE    LPCTG1                                                   10990000
         LA    R7,2(R7)                GOTO NEXT CATEG. CODE            11000000
         BCT   R8,LPCTG0                                                11010000
* -------------------------------------CATEG. CODE NOT FOUND            11020000
         B     RET4S                   DONT'T PUT TO EXTRACT AREA       11030000
LPCTG1   DS    0H                      CATEG FOUND                      11040000
         MVC   0(2,R7),=XL2'FFFF'      SIGN CATEG. WAS GETTING          11050000
         L     R6,0(R4)                                                 11060000
         BCTR  R6,0                    | LENGTH=LENGTH - 2 (CODE LEN)   11070000
         BCTR  R6,0                    | CODE OF CATEG                  11080000
*                                      TOTAL LENGTH OF CATEG.           11090000
*                                      2 BYTE - CODE                    11100000
*                                      OTHER  - TEXT                    11110000
*                                                                       11120000
         CTSADBG 'FOUND CATEG TEXT=#/_',(?R6,6(R4),?R6),               111130000
               LEVEL=(DBGGRS,6,7),RAREA=RAREAS                          11140000
*                                                                       11150000
         ST    R6,0(R4)                STORE LENGTH OF CATEG. TEXT      11160000
         BCTR  R6,0                    DECR FOR EX COMMAND              11170000
         LTR   R6,R6                   CHECK LENGTH OF TEXT             11180000
         BM    RET4S                   LENGTH < 0 ? WHY ?               11190000
         EX    R6,MVCTG                MOVE CATEG TO EXTRACT AREA       11200000
         B     RET0S                   PUT TO EXTRACT AREA              11210000
*                                                                       11220000
*        SECURITY LEVEL                                                 11230000
*                                                                       11240000
MEMLLV   DS    0H                                                       11250000
         CLI   YSLVF,1                 THIS LIST OF SEC. LEVELS?        11260000
         BNE   RET4S                   NO,RETURN                        11270000
         CLI   SCLV,X'FF'              DEFAULT SEC LEVEL ?              11280000
         BE    RET4S                   Y,DON'T PUT TO EXTRACT AREA      11290000
         CLI   GSLVF,1                 SEC LEVEL WAS FOUND ?            11300000
         BE    RET4S                   Y,NOT INTERESTING NOW            11310000
*                                      DON'T PUT TO EXTRACT AREA        11320000
         MVC   CSCLV(2),4(R4)          MOVE CURRENT SEC.LEVEL           11330000
         SR    R8,R8                                                    11340000
         LH    R8,CSCLV                CURRENT SEC.LEVEL                11350000
         SR    R9,R9                                                    11360000
         IC    R9,SCLV                 SEC LEVEL FROM USER PROFILE      11370000
*                                                                       11380000
         CTSADBG 'USER.SEC.LEVEL(R9)=~ CURRENT RACF SEC.LEVEL(R8)=~',  111390000
               (?R9,?R8),                                              211400000
               LEVEL=(DBGGRS,6,7),RAREA=RAREAS                          11410000
*                                                                       11420000
         CR    R8,R9                   SEC.LEVEL FROM USER PROFILE=     11430000
*                                      SEC.LEVEL FROM GENERAL RES PROF  11440000
         BNE   RET4S                   NO,DON'T PUT TO EXTRACT AREA     11450000
         LA    R9,TSCLV                SAVE SEC LVL TXT TO INTERNAL VAR 11460000
         L     R6,0(R4)                TOTAL LENGTH OF SEC LEVL         11470000
*                                      2 BYTE - CODE                    11480000
*                                      OTHER  - TEXT                    11490000
         BCTR  R6,0                    | LENGTH - LENGTH OF CODE        11500000
         BCTR  R6,0                    | 2 BYTE                         11510000
         ST    R6,0(R9)                STORE LENGTH OF CATEG. TEXT      11520000
         BCTR  R6,0                    DECR FOR EX COMMAND              11530000
         LTR   R6,R6                                                    11540000
         BM    RET4S                   LENGTH < 0 ? WHY ?               11550000
         EX    R6,MVCLV                MOVE LEVEL TO INTERNAL AREA      11560000
         LA    R6,1(R6)                RESTORE LENGTH                   11570000
         MVI   GSLVF,1                 SEC LEVEL FOUND !                11580000
*                                                                       11590000
         CTSADBG 'FOUND SEC.LEVEL TXT=#/_/$',                          *11600000
               (?R6,TSCLV+4,?R6,TSCLV+4,?R6),                          *11610000
               LEVEL=(DBGGRS,6,7),RAREA=RAREAS                          11620000
*                                                                       11630000
         B     RET4S                                                    11640000
LENDS    DS    0H                                                       11650000
         B     RET0S                                                    11660000
*****************************************                               11670000
*        EXITING                        *                               11680000
*****************************************                               11690000
RET0S    DS    0H                                                       11700000
         SR    R15,R15                                                  11710000
         B     RETTS                                                    11720000
RET4S    DS    0H                                                       11730000
         LA    R15,4                                                    11740000
         B     RETTS                                                    11750000
RET8S    DS    0H                                                       11760000
         LA    R15,8                                                    11770000
         B     RETTS                                                    11780000
RETTS    DS    0H                                                       11790000
         BRTRN (15)                                                     11800000
********************************************************************    11810000
*        W O R K  A R E A  A N D   C O N S T A N T S                    11820000
********************************************************************    11830000
PACDEC   DS    D                                                        11840000
NMBR     DS    CL9                                                      11850000
YCTGF    DS    CL1                     YES-CATEG-FLAG                   11860000
YSLVF    DS    CL1                     YES-SECLEV-FLAG                  11870000
SCLV     DS    CL1                     SEC.LEVEL                        11880000
GSLVF    DS    CL1                     JUST-GETTING-SECLEVELS-FLAG      11890000
DBGGRS   DS    CL1                     DEBUG LEVEL                      11900000
AREAPTR  DS    F                       PTR TO LIST OF CATEGORIES        11910000
MVCTG    MVC   4(0,R4),6(R4)           MOVE CATEG TO EXTRACT AREA       11920000
MVCLV    MVC   4(0,R9),6(R4)           MOVE LEVEL TO INTERNAL AREA      11930000
MOVSLV   MVC   0(0,R4),TSCLV           MOVE INTERNAL SEC. LEVEL VALUE   11940000
CSCLV    DS    H                       CURRENT SEC.LEVEL CODE           11950000
TSCLV    DS    F                       LENGTH                           11960000
         DS    CL256                   CURRENT SEC.LEVEL TEXT           11970000
RAREAS   DS    64F                                                      11980000
         LTORG                                                          11990000
         DROP  ,                                                        12000000
*                                                                       12010000
******************************************************************      12020000
DUMMYR   DS   0H                       DUMMY OUTPUT SECTION             12030000
         BR   R14                                                       12040000
         DROP  ,                                                        12050000
*                                                                       12060000
******************************************************************      12070000
*        DETERMINE  'GROUP CLASS NAME'                           *      12080000
*    PARAMETERS : VIA REG 1.                                     *      12090000
*    -----------------------                                     *      12100000
*    GRSDEBUG       - IN     (DIAG LEVEL)                        *      12110000
*    GRSCLS         - IN     (RESOURCE CLASS)                    *      12111000
*    GRSRES         - OUT    (GROUP CLASS NAME)                  *      12111100
*    GRSMBRS        - OUT    (MEMBER RESOURCE CLASS)             *      12111200
******************************************************************      12111300
*                                                                       12111400
GETGRPCL BEGIN *,R12,R11                                                12111500
         LR    R2,R1                                                    12111600
         USING GRSGRPP,R2              ADDRESSABILITY PARAMETERS        12111700
         L     R3,GRSDEBUG                                              12111800
         SR    R5,R5                                                    12111900
         IC    R5,0(R3)                                                 12112000
         STC   R5,DEBUGR1              DEBUG LEVEL                      12113000
         L     R3,GRSCLS               RESOURCE CLASS                   12113100
         MVC   RSCLSG(8),0(R3)         SAVE IT                          12113200
         MVC   CLASSGMG(8),=CL8' '     CLEAR GROUP CLASS NAME           12113300
         MVC   CLASSGMB(8),=CL8' '     CLEAR MEMBER CLASS NAME          12113400
         CLC   RSCLSG(8),=CL8'DATASET' 'DATASET' CLASS ?                12113500
         BZ    RETGRG                  Y, RETURN                        12113600
*                                                                       12113700
*BS10130 L     R10,CVTPTR              LOAD ADDR CVT                    12113901
*BS10130 USING CVT,R10                 ADDRESSABILITY CVT DSECT         12114001
*BS10130 L     R8,CVTRAC               LOAD ADDR CVT RACF               12114101
*BS10130 USING RCVT,R8                 ADDRESSABILITY CVT RACF DSECT    12115001
*BS10130 MVC   RCFRELSG(4),RCVTVRMN    RACF RELEASE                     12115101
*                                                                       12115200
*********************************************************************   12115300
*        CDT TABLE PROCESSING                                           12115400
*********************************************************************   12115500
*                                                                       12115600
CDTSTRT  DS    0H                                                       12115700
*BS10130 MVC   CDTPTRG(4),RCVTCDTP     PTR TO CLASS DESC TABLE          12115901
*BS10130 DROP  R8                                                       12116001
*BS10130 DROP  R10                                                      12116101
*BS10130 SR    R8,R8                   CLASS COUNTER                    12116201
*BS10130 SR    R10,R10                                                  12116301
*BS10130 L     R5,CDTPTRG              PTR TO CLASS DESC TABLE          12116401
*BS10130                                                                12116501
*BS10130 CTSADBG 'RES=_ RACF=_ CDTPTR=~',                              112116601
               (RSCLSG,8,RCFRELSG,4,?R5),                              212116703
               LEVEL=(DEBUGR1,4,5,6,7),RAREA=DBGAREAM                   12116803
*BS10130                                                                12116901
*BS10130 LTR   R5,R5                   CDT PTR NULL ?                   12117001
*BS10130 BZ    RETGRG                  Y, RETURN                        12117101
*BS10130 USING CDT19,R5                                                 12117201
*BS10130 CDTGRG0  DS    0H                                              12117301
*BS10130 LA    R8,1(R8)                MASK COUNTER                     12117401
*BS10130                                                                12117501
*BS10130 CTSADBG 'RES=_ CDTCLS=_ CDTGRPCLS=_',                         112117601
               (RSCLSG,8,CDT19CLS,8,CDT19GRP,8),                       212117703
               LEVEL=(DEBUGR1,4,5,6,7),RAREA=DBGAREAM                   12117803
*BS10130                                                                12117901
*BS10130 CLC   RSCLSG(8),CDT19CLS      REQUIRED RESOURCE CLASS ?        12118001
*BS10130 BE    CDTGRGF1                Y, SKIP                          12118101
*BS10130 CLC   RSCLSG(8),CDT19GRP      REQIRED GROUP CLASS NAME ?       12118201
*BS10130 BE    CDTGRGF2                Y, SKIP                          12118301
*BS10130                                                                12118401
*BS10130 GET NEXT ENTRY FROM CDT                                        12118501
*BS10130                                                                12118601
*BS10130 SR    R10,R10                                                  12118701
*BS10130 ICM   R10,X'3',CDT19LN        LOAD CDTLEN                      12118801
*BS10130 LTR   R10,R10                 END-OF-CDT-TABLE                 12118901
*BS10130 BZ    RETGRG                  Y, RETURN                        12119001
*BS10130 AR    R5,R10                  INCR ADDR OF CDT TABLE           12119101
*BS10130 SR    R10,R10                 AND CHECK LEN OF CDT             12119201
*BS10130 ICM   R10,X'3',CDT19LN        LOAD CDTLEN                      12119301
*BS10130 LTR   R10,R10                 END-OF-CDT-TABLE                 12119401
*BS10130 BZ    RETGRG                  Y, RETURN                        12119501
*BS10130 B     CDTGRG0                                                  12119601
         LA    R0,CDTAREA                                      BS10130  12119804
         LA    R1,CDTLEN                                       BS10130  12119904
         SLR   R15,R15                                         BS10130  12120001
         MVCL  R0,R14               CLEAR RETURN AREA FOR CDT  BS10130  12120101
*                                                                       12120201
         RACROUTE REQUEST=STAT,COPY=CDTAREA,COPYLEN=CDTLEN,    BS10130 X12120304
               CLASS=RSCLSG,WORKA=RRWA,                        BS10130 X12120403
               RELEASE=7709,MF=(E,GCDTRR)                      BS10130  12120501
SAFPG    USING SAFP,GCDTRR                                     BS10130  12120601
         CTSADBG 'RACROUTE LOCATE FOR _:  R15 = #  RC/RS = ~/~', 10130 X12120701
               (RSCLSG,8,?R15,SAFPG.SAFPRRET,SAFPG.SAFPRREA),  BS10130 X12120801
               LEVEL=(DEBUGR1,4,5,6,7)                         BS10130  12120903
         CTSADBG TYPE=SNAP,ID=1,HDR='RETURNED CDT',            BS10130 X12121001
               ADDR=(CDTAREA,CDTAREA+CDTLEN-1),                BS10130 X12121104
               LEVEL=(DEBUGR1,4,5,6,7)                         BS10130  12121203
         DROP  SAFPG                                           BS10130  12121301
         LA    R5,CDTAREA              SAVE POINTER FOR...     BS10130  12121404
         USING CNST,R5                                         BS10130  12121501
         LH    R1,CNSTLGT              R1 = CDT LENGTH.        BS10130  12121601
         CHI   R1,0                    CDT WAS COPIED ?        BS10130  12121701
         BE    RETGRG                  ..NO - OUT.             BS10130  12121801
         TM    CNSTMFLG,CNSTRGRP       GROUP ?                          12122102
         BO    CDTGRGF2                                                 12122202
*                                                                       12123000
*   RESOURCE IS NOT A GROUP.   RETURN ITS GROUP, IF EXISTS.             12123102
*                                                                       12123200
CDTGRGF1 DS    0H                                                       12123300
*                                                                       12123400
         CTSADBG 'CLASS=_ GROUP MEMBER=_ MEMBER CLASS=_',              112123500
               (CNSTNAME,8,CNSTXREF,8,CNSTNAME,8),             BS10130 212123602
               LEVEL=(DEBUGR1,4,5,6,7),RAREA=DBGAREAM                   12123700
*BS10130       (CDT19CLS,8,CDT19GRP,8,CDT19CLS,8),                    2 12123803
*                                                                       12123900
*BS10130 MVC   CLASSGMG(8),CDT19GRP    GROUP CLASS NAME                 12124002
         MVC   CLASSGMG(8),CNSTXREF    GROUP CLASS NAME        BS10130  12124102
         MVC   CLASSGMB(8),=CL8' '     MEMBER CLASS NAME                12124202
         B     CDTGRGF                                                  12124302
*                                                                       12124402
*   RESOURCE IS A GROUP.  RETURN ITS MEMBER.                            12124502
*                                                                       12124602
CDTGRGF2 DS    0H                                                       12124700
*                                                                       12124800
         CTSADBG 'CLASS=_ GROUP MEMBER=_ MEMBER CLASS=_',              112124900
               (CNSTNAME,8,CNSTNAME,8,CNSTXREF,8),             BS10130 212125002
               LEVEL=(DEBUGR1,4,5,6,7),RAREA=DBGAREAM                   12125100
*BS10130       (CDT19CLS,8,CDT19CLS,8,CDT19GRP,8),                    2 12125203
*                                                                       12125300
         MVC   CLASSGMG(8),=CL8' '     GROUP CLASS NAME                 12125400
*BS10130 MVC   CLASSGMB(8),CDT19CLS    MEMBER CLASS NAME                12125502
         MVC   CLASSGMB(8),CNSTXREF    MEMBER CLASS NAME       BS10130  12125602
         B     CDTGRGF                                                  12125700
         DROP  R5                                              BS10130  12125802
*                                                                       12125900
CDTGRGF  DS    0H                                                       12126000
RETGRG   DS    0H                                                       12126100
         L     R5,GRSRES               GROUP CLASS NAME ADDR            12126200
         MVC   0(8,R5),CLASSGMG        RETURN GROUP CLASS NAME          12126300
         L     R5,GRSMBRS              MEMBER RESOURCE CLASS            12126400
         MVC   0(8,R5),CLASSGMB        RETURN GROUP CLASS NAME          12126500
         BRTRN 0                                                        12126600
*                                                                       12126700
*-----------------------------------------------------------            12126800
*        WORK AREA AND CONSTANTS                                        12126900
*-----------------------------------------------------------            12127000
*                                                                       12127100
         LTORG                                                          12127200
DBGAREAM DS    32D                     DEBUG MACRO AREA                 12127300
*BS10130 RCFRELSG DS    CL4                   RACF RELEASE FIELD VALUE  12127401
DEBUGR1  DS    CL1                     DEBUG LEVEL                      12127500
*                                                                       12127600
RSCLSG   DS    CL8                     RESOURCE CLASS                   12127700
CLASSGMG DS    CL8                     GROUP CLASS NAME                 12127800
CLASSGMB DS    CL8                     MEMBER CLASS NAME                12127900
*BS10130 CDTPTRG  DS    F                   PTR TO CLASS DESC TABLE     12128001
*                                                                       12128100
RRWA     DS    CL512           RACROUTE WORK AREA              BS10130  12128202
         DS    0D                                              BS10130  12128301
CDTAREA  DS    CL(CNSTCBLN)    AREA FOR CNST PORTION           BS10130  12128404
         DS    0D,CL(CNSXCBLN)    AREA FOR CNSX PORTION        BS10130  12128504
CDTLEN   EQU   *-CDTAREA       LENGTH OF CDT ENTRY             BS10130  12128604
*                                                                       12128702
GCDTRR   RACROUTE REQUEST=STAT,COPY=,COPYLEN=,CLASS=,WORKA=,   BS10130 X12128802
               RELEASE=7709,MF=L                               BS10130  12128902
         DROP  ,                                                        12129100
*                                                                       12129200
******************************************************************      12129300
*        GET 'GROUP CLASS NAME' AND 'RESOURCE GROUPS'            *      12129400
*        FIELDS VALUE                                            *      12129500
*    PARAMETERS : VIA REG 1.                                     *      12129600
*    -----------------------                                     *      12129700
*    DEBUG LEVEL                                                 *      12129800
*    GROUP RESCLASS                                              *      12129900
*    RESNAME  (1-ST BYTE LEN, FROM 2-ND STRING) - ENTRY NAME FORM*      12130000
*    EXTRACT AREA                                                *      12130100
******************************************************************      12130200
*                                                                       12130300
LDSGRP   BEGIN *,R12,R11                                                12130400
         LR    R2,R1                                                    12130500
         USING LDSGRPP,R2              ADDRESSABILITY PARAMETERS        12130600
         L     R3,LDSDEBUG                                              12130700
         SR    R5,R5                                                    12130800
         IC    R5,0(R3)                                                 12130900
         STC   R5,DEBUGM               DEBUG LEVEL                      12131000
         ST    R5,DEBUGMF              DEBUG LEVEL                      12131100
         L     R3,LDSCLS               RESOURCE CLASS                   12131200
         MVC   RSCLS(8),0(R3)          SAVE IT                          12131300
*                                                                       12131400
         L     R3,LDSRES               RESOURCE NAME                    12131500
         SR    R5,R5                                                    12131600
         IC    R5,0(R3)                RESOURCE NAME LENGTH             12131700
         STC   R5,ENTRYG1              SAVE RES NAME LENGTH             12131800
         LTR   R5,R5                   LENGTH 0 ?                       12131900
         BZ    RETG0                   Y, RETURN                        12132000
         BCTR  R5,0                                                     12132100
         EX    R5,SVRSNM               SAVE RESOURCE NAME               12132200
*                                                                       12132300
         L     R3,LDSXADDR             EXTRACT AREA ADDRESS             12132400
         MVC   XADDR(4),0(R3)          STORE EXTRACT AREA ADDR          12132500
         DROP  R2                                                       12132600
*                                                                       12132700
         SR    R5,R5                                                    12132800
         IC    R5,ENTRYG1              RES NAME LENGTH                  12132900
         CTSADBG 'GROUP CLASS=_ RESOURCE=#/_',                         112133000
               (RSCLS,8,?R5,ENTRYG2,?R5),                              212133100
               LEVEL=(DEBUGM,4,5,6,7),RAREA=DBGAREAG                    12133200
*                                                                       12133300
         CLC   RSCLS(8),=CL8' '        GROUP MEMBER RESOURCE CLASS ?    12133400
         BE    RETG0                   N, SKIP                          12133500
*                                                                       12134000
*        GET RESOURCE GROUPS                                            12135000
*                                                                       12136000
         MVC   CLASSGM(8),RSCLS        GROUP CLASS NAME                 12137000
         MVI   ENTRYM1,1               | CLEAR ENTRY NAME               12137100
         XC    ENTRYM2,ENTRYM2         | FOR ACCESS                     12137200
*                                                                       12137300
*        MOVE PARAMETERS TO TEST PROGRAM                                12137400
*                                                                       12137500
         L     R5,TSTGMEM              EXIT-TEST ROUTINE                12137600
         USING TESTGMEM,R5                                              12137700
         MVC   DBGGRM(1),DEBUGM        DEBUG LEVEL                      12137800
         MVI   CLASSMF,1               RETURN CLAS NAME FLAG            12137900
         MVC   CLASSM(8),CLASSGM       GROUP CLASS NAME                 12138000
         SR    R6,R6                                                    12138100
         IC    R6,ENTRYG1              RES NAME LENGTH                  12138200
         LA    R7,ENTRYT1              ENTRY NAME (TEST FUNCTION)       12138300
         STC   R6,0(R7)                                                 12138400
         BCTR  R6,0                    DECR FOR EXECUTE COMMAND         12138500
         EX    R6,MVRSTT               MOVE RESNAME TO TEST FUNC        12138600
         DROP  R5                                                       12138700
*                                                                       12138800
*        GET GENERAL RESOURCE ('GROUP' RESOURCE)                        12138900
*                                                                       12139000
LDSRGMEM CTSFAGR NEXT,                                                 112139100
               TYPE='GEN',OUTEP=OUTP,OUTAREA=XADDR,                    212139200
               DATAMAP=NEW,ENTRY=ENTRYM,RC=RETCODM,TEST=TSTGMEM,       312139300
               EOE=NO,GETPRG=CTSFRXT,CLASS=CLASSGM,DEBUG=DEBUGMF,      412139400
               (TXTL='RESOURCE-NAME=',REPEAT=YES,IGNORE=YES),          *12139500
               (MEMLST,L,C,TXTL='INFO.RESOURCE_GROUPS')                 12139600
         LTR   R15,R15                                                  12139700
         BZ    LDSRGMEM                                                 12139800
*                                                                       12139900
*        EXITING                                                        12140000
*                                                                       12140100
RETG0    DS    0H                      OK                               12140200
         SR    R15,R15                                                  12140300
         B     RETG                                                     12140400
RETG4    DS    0H                      RESCLASS NOT FOUND               12140500
         LA    R15,4                                                    12140600
         B     RETG                                                     12140700
RETG     DS    0H                                                       12140800
         BRTRN (15)                                                     12140900
*                                                                       12141000
*-----------------------------------------------------------            12141100
*        WORK AREA AND CONSTANTS                                        12141200
*-----------------------------------------------------------            12141300
*                                                                       12141400
         LTORG                                                          12141500
DBGAREAG DS    32D                     DEBUG MACRO AREA                 12141600
LIST     DS    A                       GENLIST/RACLIST PARAMETER        12141700
CLASSG   DS    CL8                     CLASS NAME                       12141800
RSCLS    DS    CL8                     RESOURCE CLASS                   12141900
CLASSGM  DS    CL8                     GROUP CLASS NAME                 12142000
RETCODM  DS    3F                      EXTRACTOR RETURN CODES           12142100
TSTGMEM  DC    A(TESTGMEM)             TEST ROUTINE FOR LIST RESOURCES  12142200
CDTPTR   DS    F                       PTR TO CLASS DESC TABLE          12142300
XADDR    DS    F                       EXTRACT AREA ADDR                12142400
DEBUGMF  DS    F                       DEBUG LEVEL                      12142500
DEBUGM   DS    X                       DEBUG LEVEL                      12142600
SVRSNM   MVC   ENTRYG2(0),1(R3)        SAVE RESOURCE NAME               12142700
MVRSTT   MVC   1(0,R7),ENTRYG2         MOVE RESNAME TO TEST FUNC        12142800
*                                                                       12142900
ENTRYG   DS   0H                       | ENTRY NAME                     12143000
ENTRYG1  DS   AL1                      |    FOR                         12143100
ENTRYG2  DS   CL256                    | RESOURCE PROFILE               12143200
*                                                                       12143300
ENTRYM   DS   0H                       | ENTRY NAME                     12143400
ENTRYM1  DS   AL1                      |    FOR                         12143500
ENTRYM2  DS   CL256                    | RESOURCE GROUPS                12143600
*                                                                       12143700
         DROP  ,                                                        12143800
****************************************************************        12143900
*                                                              *        12144000
* FUNCTION    : DETERMINE RESOURCE GROUPS FIELDS VALUE         *        12144100
*                                                              *        12144200
****************************************************************        12144300
*                                                                       12144400
TESTGMEM BEGIN                                                          12144500
*--------------------------------------------------------------------   12144600
*        ADDRESSABILITY MAIN PARAMETERS                                 12144700
*--------------------------------------------------------------------   12144800
         USING PARMM,R1                                                 12144900
         L     R2,XPROPCD                                               12145000
         CLI   0(R2),XPRSTRT          START  -  BEFORE READ RECORD FROM 12145100
         BE    LSTARTM                          RACF DATA BASE          12145200
         CLI   0(R2),XPRENTY          ENTRY  -  AFTER  READ RECORD FROM 12145300
         BE    LENTRYM                          RACF DATA BASE          12145400
         CLI   0(R2),XPRELMN          ELEMN  -  ELEMENTARY DATA         12145500
         BE    LELEMNM                                                  12145600
         CLI   0(R2),XPRLIST          LIST   -  LIST DATA               12145700
         BE    LLISTM                                                   12145800
         CLI   0(R2),XPREND           END    -  BEFORE RETURN FROM      12145900
         BE    LENDM                            EXTRACTOR               12146000
         B     RET0M                                                    12146100
*                                                                       12146200
********************************************************************    12146300
*        START                                                          12146400
********************************************************************    12146500
*                                                                       12146600
LSTARTM  DS    0H                                                       12146700
         MVI   PRFILE1,0               CURRENT PROCCESSING PROFILE LEN  12146800
         B     RET0M                                                    12146900
*                                                                       12147000
********************************************************************    12147100
*        ENTRY                                                          12147200
********************************************************************    12147300
*                                                                       12147400
LENTRYM  DS    0H                                                       12147500
         L     R3,XPRENTRY             FIELD ADDR                       12147600
         L     R5,0(R3)                ENTRY NAME LENGTH                12147700
         L     R4,XPRPRFXY             FIELD VALUE                      12147800
         L     R4,0(R4)                                                 12147900
         USING RETAREA,R4                                               12148000
*                                                                       12148100
         CTSADBG 'ENTRY=#/_ FLAG=$',                                   X12148200
               (?R5,4(R3),?R5,XPFFLGS,1),                              X12148300
               LEVEL=(DBGGRM,6,7),RAREA=RAREAM                          12148400
*                                                                       12148500
         STC   R5,PRFILE1              CURRENT PROCCESSING PROFILE LEN  12148600
         LTR   R5,R5                   LEN = 0                          12148700
         BZ    RET0M                   Y, SKIP                          12148800
         BCTR  R5,0                                                     12148900
         EX    R5,MVPRF                KEEP PROFILE NAME                12149000
         DROP  R4                                                       12149100
         B     RET0M                                                    12149200
*                                                                       12149300
********************************************************************    12149400
*        ELEMNTRY FIELD                                                 12149500
********************************************************************    12149600
*                                                                       12149700
LELEMNM  DS    0H                                                       12149800
         L     R3,XPRFNME                                               12149900
         L     R4,XPRFADRE                                              12150000
         L     R5,0(R4)                FIELD LENGTH                     12150100
         CTSADBG 'ELEMN FIELD=_ VALUE=#/_/$',                          *12150200
               (0(R3),8,?R5,4(R4),?R5,4(R4),?R5),                      *12150300
               LEVEL=(DBGGRM,6,7),RAREA=RAREAM                          12150400
         CLC   =CL8'CLASTYPE',0(R3)                                     12150500
         BE    LCLASM                                                   12150600
         B     RET0M                                                    12150700
*                                                                       12150800
********************************************************************    12150900
*        CLASTYPE FILED. RETURN GROUP CLASS NAME                        12151000
********************************************************************    12151100
*                                                                       12151200
LCLASM   DS    0H                                                       12151300
         CLI   CLASSMF,1               RETURN CLAS NAME ?               12151400
         BNE   RET4M                   N, SKIP                          12151500
         MVC   0(4,R4),=F'8'           CLASS NAME LENGTH                12151600
         MVC   4(8,R4),CLASSM                                           12151700
         MVI   CLASSMF,0               DO NOT RETURN CLAS NAME          12151800
         B     RET0M                                                    12151900
*                                                                       12152000
********************************************************************    12152100
*        LIST FIELD                                                     12152200
********************************************************************    12152300
*                                                                       12152400
LLISTM   DS    0H                                                       12152500
         L     R3,XPRFNML                                               12152600
         L     R4,XPRFADRL                                              12152700
         L     R5,0(R4)                FIELD LENGTH                     12152800
         SR    R6,R6                                                    12152900
         IC    R6,ENTRYT1              TARGET RESOURCE NAME             12153000
*                                                                       12153100
         CTSADBG 'LIST FIELD=_ VALUE=#/_/$ TARGET=#/_',                *12153200
               (0(R3),8,?R5,4(R4),?R5,4(R4),?R5,?R6,ENTRYT2,?R6),      *12153300
               LEVEL=(DBGGRM,6,7),RAREA=RAREAM                          12153400
*                                                                       12153500
         CR    R5,R6                   FIELD LEN = TARGET RES NAME LEN? 12153600
         BNE   RET4M                   NO, DO NOT PUT                   12153700
         BCTR  R5,0                    DECR FOR EXECUTE COMMAND         12153800
         EX    R5,CHKMEM               CHECK MEMBER NAME                12153900
         BNE   RET4M                   NOT EQUAL, DO NOT PUT            12154000
*                                                                       12154100
*        REPLACE MEMBER NAME INSTEAD MEMBER PUT PROFILE                 12154200
*                                                                       12154300
         SR    R5,R5                                                    12154400
         IC    R5,PRFILE1              CURRENT PROCCESSING PROFILE LEN  12154500
         ST    R5,0(R4)                CLASS NAME LENGTH                12154600
         LTR   R5,R5                                                    12154700
         BZ    RET4M                   WE DO NOT HAVE APPR INFO         12154800
         BCTR  R5,0                                                     12154900
         EX    R5,RETPRF               RETURN PROFILE NAME              12155000
         B     RET0M                   INTERESTING ONLY CATEGORIES      12155100
*                                                                       12155200
********************************************************************    12155300
*        'END' ENTRY PROCESSING                                         12155400
********************************************************************    12155500
*                                                                       12155600
LENDM    DS    0H                                                       12155700
         B     RET0M                                                    12155800
*********************************************************               12155900
*        EXITING                                        *               12156000
*********************************************************               12157000
RET0M    DS    0H                                                       12158000
         SR    R15,R15                                                  12159000
         B     RETTM                                                    12160000
RET4M    DS    0H                                                       12161000
         LA    R15,4                                                    12162000
         B     RETTM                                                    12163000
RET8M    DS    0H                                                       12163100
         LA    R15,8                                                    12163200
         B     RETTM                                                    12163300
RETTM    DS    0H                                                       12163400
         BRTRN (15)                                                     12163500
********************************************************************    12163600
*       W O R K  A R E A  A N D   C O N S T A N T S                     12163700
********************************************************************    12163800
DBGGRM   DS    CL1                     DEBUG LEVEL                      12163900
RAREAM   DS    64F                                                      12164000
CLASSM   DS    CL8                     CLASS NAME                       12165000
CLASSMF  DS    XL1                     RETURN CLAS NAME FLAG            12166000
*                                                                       12166100
ENTRYT   DS    0H                      | ENTRY NAME                     12166200
ENTRYT1  DS    AL1                     |    FOR                         12166300
ENTRYT2  DS    CL256                   | RESOURCE GROUPS                12166400
*                                                                       12166500
MVPRF    MVC   PRFILE2(0),4(R3)        KEEP PROFILE NAME                12166600
CHKMEM   CLC   ENTRYT2(0),4(R4)        CHECK MEMBER NAME                12166700
RETPRF   MVC   4(0,R4),PRFILE2         RETURN PROFILE NAME              12166800
PRFILE   DS    0H                      | CURRENT PROCCESSING            12166900
PRFILE1  DS    AL1                     |    PROCCEED                    12167000
PRFILE2  DS    CL256                   |      PROFILE                   12167100
*                                                                       12167200
         LTORG                                                          12167300
         DROP  ,                                                        12167400
******************************************************************      12167500
*        MAIN PARAMETERS LIST FOR TEST FUNCTIONS                        12167600
******************************************************************      12167700
PARMM    DSECT                                                          12167800
         COPY  CTSFXPR                                                  12167900
******************************************************************      12168000
*        RACF RETURN AREA PREFIX                                        12169000
******************************************************************      12170000
RETAREA  DSECT                                                          12180000
         COPY  CTSFXPF                                                  12190000
******************************************************************      12200000
*        LDSGRP FUNCTION PARAMETER LIST                                 12200100
******************************************************************      12200200
LDSGRPP  DSECT                         LDSGRPP PARAMETERS LIST          12200300
LDSDEBUG DS    A                       DEBUG LEVEL                      12200400
LDSCLS   DS    A                       RESOURCE CLASS                   12200500
LDSRES   DS    A                       RESOURCE NAME                    12200600
LDSXADDR DS    A                       EXTRACT AREA ADDRESS             12200700
*                                                                       12200800
******************************************************************      12200900
*        GETGRPCL FUNCTION PARAMETER LIST                               12201000
******************************************************************      12202000
GRSGRPP  DSECT                         GETGRPCL PARAMETERS LIST         12203000
GRSDEBUG DS    A                       DEBUG LEVEL           - IN       12204000
GRSCLS   DS    A                       RESOURCE CLASS        - IN       12205000
GRSRES   DS    A                       GROUP RESOURCE CLASS  - OUT      12206000
GRSMBRS  DS    A                       MEMBER RESOURCE CLASS - OUT      12206100
*                                                                       12206200
***************************************************************         12206300
*                                                             *         12206400
*        SYSTEM CONTROL BLOCKS MAPPING                        *         12206500
*                                                             *         12206600
***************************************************************         12206700
         PRINT GEN                                                      12206800
*                                                                       12206900
         CVT   DSECT=YES,LIST=YES                                       12207000
         ICHPRCVT                      RACF 1.9                         12208000
         ICHPCNST                      CDT                     BS10130  12208101
         ICHSAFP                       RACROUTE PARM LIST DSECT BS10130 12208201
*                                                                       12208300
*BS10130  CDT19    DSECT                                                12208501
*BS10130  CDT19LN  DS    AL2           LENGTH OF DESCRIPTOR             12208601
*BS10130  CDT19ID  DS    AL1(128)      ID                               12208701
*BS10130  CDT19CLS DS    CL8'$$FDSFAC' CLASS NAME                       12208801
*BS10130  CDT19GRP DS    CL8' '        GROUP MEMBER XREF NULL           12208901
*BS10130  CDT19PFL DS    AL1(39)       MAXIMUM RESOURCE NAME LENGTH     12209001
*BS10130  CDT19F1  DS    B'11100000'   FIRST CHAR FLAGS                 12209101
*BS10130  CDT19F2  DS    B'11110000'   OTHER CHAR FLAGS                 12209201
*BS10130  CDT19UAC DS    B'00000000'   DFTUACC FLAGS                    12209301
*BS10130  CDT19MSC DS    B'01000000'   MISC. FLAGS                      12209401
*BS10130  CDT19PST DS    3B'0'         POSIT MASK                       12209501
*BS10130           DS    B'01000000'   POSIT MASK                       12209601
*BS10130           DS    12B'0'        POSIT MASK                       12209701
*BS10130  CDT19GPR DS    AL4(0)        GENLIST POINTER                  12209801
*BS10130  CDT19LPR DS    AL4(0)        RACLIST POINTER                  12209901
*BS10130  CDT19RC  DS    AL1(4)        SET THE DEFAULT RETURN CODE      12210001
*BS10130  CDT19B1M DS    B'00000000'   B1 MISC. FLAGS                   12210101
*BS10130  CDT19KEY DS    AL1(0)        SET THE KEYQUAL VALUE            12210201
*BS10130  CDT19ORG DS    AL1(39)       ORIGINAL MAX NAME LENGTH         12210301
*BS10130  CDT19ALG DS    XL4'00'       ALLIGN TO DWORD BDY              12210401
*BS10130  CDT19OK  DS    XL8'00'       STOKEN FOR RACLIST DATA SPACE    12210501
*BS10130  *                                                             12210601
*BS10130  CDT22    DSECT                                                12210701
*BS10130  CDT22LN  DS    AL2           LENGTH OF DESCRIPTOR             12210801
*BS10130  CDT22ID  DS    AL1(128)      ID                               12210901
*BS10130  CDT22CLS DS    CL8'$$FDSFAC' CLASS NAME                       12211001
*BS10130  CDT22GRP DS    CL8' '        GROUP MEMBER XREF NULL           12211101
*BS10130  CDT22PFL DS    AL1(39)       MAXIMUM RESOURCE NAME LENGTH     12211201
*BS10130  CDT22F1  DS    B'11100000'   FIRST CHAR FLAGS                 12211301
*BS10130  CDT22F2  DS    B'11110000'   OTHER CHAR FLAGS                 12211401
*BS10130  CDT22UAC DS    B'00000000'   DFTUACC FLAGS                    12211501
*BS10130  CDT22MSC DS    B'01000000'   MISC. FLAGS                      12211601
*BS10130  CDT22PST DS    3B'0'         POSIT MASK                       12211701
*BS10130           DS    B'01000000'   POSIT MASK                       12211801
*BS10130           DS    124B'0'       POSIT MASK                       12211901
*BS10130  CDT22GPR DS    AL4(0)        GENLIST POINTER                  12212001
*BS10130  CDT22LPR DS    AL4(0)        RACLIST POINTER                  12212101
*BS10130  CDT22RC  DS    AL1(4)        SET THE DEFAULT RETURN CODE      12212201
*BS10130  CDT22B1M DS    B'00000000'   B1 MISC. FLAGS                   12212301
*BS10130  CDT22KEY DS    AL1(0)        SET THE KEYQUAL VALUE            12212401
*BS10130  CDT22ORG DS    AL1(39)       ORIGINAL MAX NAME LENGTH         12212501
*BS10130  CDT22ALG DS    XL4'00'       ALLIGN TO DWORD BDY              12212601
*BS10130  CDT22OK  DS    XL8'00'       STOKEN FOR RACLIST DATA SPACE    12212701
******************************************************************      12212800
*        MAIN EXTRACTOR PARAMETERS LIST                                 12212900
******************************************************************      12213000
RXTPRM   DSECT                                                          12213100
RXTINTY  DS    A                       ADDRESS ICHEINTY MACRO           12213200
RXTEXT   DS    A                       ADDRESS GET PROGRAM              12213300
RXTDBG   DS    A                       DEBUG LEVEL                      12213400
RXTRC    DS    A                       RETURN CODE - 3 WORDS            12213500
*                                       1  - RACF RETURN CODE           12213600
*                                       2  - RACF REASON CODE           12213700
*                                       3  - EXTRACTOR RC               12213800
*                                                                       12213900
RXTOP    DS    CL8                     OPERATION  ( NEXT / LOCATE )     12214000
RXTPRF   DS    CL8                     PROFILE TYPE ( USR,GRP,..  )     12214100
RXTENTRY DS    A                       ENTRY VALUE                      12214200
RXTFLDS  DS    A                       ADDR FIELDS DESCRIPTIONS         12214300
RXTETXT  DS    A                       TEXT FOR ENTRY FIELD             12214400
RXTOUT   DS    A                       EXT OUTPUT ROUT. ( V - CONTST)   12214500
RXTEXTA  DS    A                       ADDR OF EXTRCAT AREA             12214600
RXT1LINE DS    A                       ONE LINE PARAMETER               12214700
RXTALST  DS    A                       ADDRESS ACTION LIST              12214800
RXTRULE  DS    A                       ADDR RULE LIST                   12214900
RXTGEN   DS    A                       ADDRESS GENERIC PARAMETER        12215000
RXTRST   DS    A                       ADDRESS RESET PARAMETER          12215100
RXTTSTP  DS    A                       ADDRESS EXIT TEST ROUTINE        12215200
RXTPRX   DS    A                       ICHEINTY MIN. WORK AREA          12215300
RXTMAP   DS    A                       ADDR MAP PARAMETER               12215400
RXTDELAY DS    A                       DELAY PARAMETER LIST             12215500
*                                                                       12215600
*   ADDITIONAL PARAMETERS  (2.1.0)                                      12215700
*                                                                       12215800
RXTRAREA DS    A                       RACF RETURN AREA                 12215900
RXTRSGLT DS    A                       SEGMENT'S LIST ADDR              12216000
*                                      HL2:0- UPDATE ICHEINTY REQUIRED  12216100
*                                          1- UPDATE ICHEINTY DONE      12216200
*                                      HL2: NUMBER OF SEGMENTS          12216300
*                                      CL8'SEGM-NAME',A(ICHEINTY-ADDR), 12216400
*                                                     A(0)-SEGM EXISTS  12216500
         END   CTSFGRS                                                  12216600
